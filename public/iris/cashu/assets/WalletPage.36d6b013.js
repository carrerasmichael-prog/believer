import{C as da,D as gi,r as he,E as U,F as Ht,o as pn,ak as Yo,G as ze,al as Li,k as z,A as nt,ad as Oi,am as Zo,Q as de,a7 as si,e as ut,an as fn,B as it,w as je,a1 as Jo,ah as Ui,ao as Ni,I as Qt,l as fa,c as Pn,m as er,p as ha,q as Bn,t as vi,y as $i,z as pi,X as Ct,ap as ma,n as qt,aq as ga,H as Vi,af as va,ar as tr,ae as vo,as as pa,W as H,j as Je,at as Se,au as ye,_ as He,K as $,L as Q,av as De,U as Ee,V as J,$ as P,O as h,M as y,Y as ct,Z as Et,S as O,T as me,R as Z,aw as nr,ax as ir,ay as ya,az as wa,aA as _a,aB as ba,aC as ka,v as yi,x as dn,f as Da,a5 as Ca,aD as Bt,aE as wi,aF as Sa,aG as po,aH as Pa,aI as or,aJ as rr,aK as qa,aL as Ta,aM as Ma,aN as xa,aO as Ai,a4 as $a,aP as Aa,ai as Xn,aQ as Ea,aR as Ia,aS as Ra}from"./index.f0702a55.js";import{e as An,c as La,a as yn,d as wn,u as Oa,b as Ua,f as Na,Q as Be,i as we,j as et,l as hn,k as Ft}from"./selection.05db5733.js";import{u as Va,a as Gn,g as Tt,Q as It,b as at,c as Bi,d as ar,e as sr,f as lr,h as Ba,i as Fa,v as yo,j as za,k as ja,l as Wa,m as Ha,n as Qa,r as wo,o as _o,s as Ka,p as bo,q as ur,t as Xa,w as Ga,x as Ya,y as Za,z as Ja,A as ko,B as st,C as es,D as dt,E as Fi,F as St,G as We,H as Do,I as tt,J as cr,K as zi,L as ts,M as ns,P as is,N as Co,O as os}from"./P2PKDialog.3c245219.js";import{a as rs,Q as as}from"./QToolbar.d53a2446.js";import{g as So,s as Po,Q as ss}from"./touch.5019c7c2.js";import{b as xe,c as ti,d as zt,u as lt,e as Ze,a as ls,r as us,n as qo,M as dr,f as cs,g as ds,h as Gt,i as Yt,j as vn,t as ke,k as Oe,s as fs,l as hs,m as ms,o as To,p as ni,q as fr,v as Mo}from"./token.aedbecc1.js";import{s as gs,g as vs}from"./scroll.effc5c98.js";import{n as xo,b as ps}from"./format.054b8074.js";import{i as hr}from"./vue-qrcode.esm.ae118260.js";let ys=0;const ws=["click","keydown"],_s={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${ys++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function bs(e,t,n,i){const o=da(Yo,gi);if(o===gi)return console.error("QTab/QRouteTab component needs to be child of QTabs"),gi;const{proxy:r}=ut(),a=he(null),s=he(null),l=he(null),g=U(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),f=U(()=>o.currentModel.value===e.name),k=U(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(f.value===!0?" q-tab--active"+(o.tabProps.value.activeClass?" "+o.tabProps.value.activeClass:"")+(o.tabProps.value.activeColor?` text-${o.tabProps.value.activeColor}`:"")+(o.tabProps.value.activeBgColor?` bg-${o.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&o.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||o.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(i!==void 0?i.linkClass.value:"")),w=U(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(o.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),S=U(()=>e.disable===!0||o.hasFocus.value===!0||f.value===!1&&o.hasActiveTab.value===!0?-1:e.tabindex||0);function A(B,F){if(F!==!0&&a.value!==null&&a.value.focus(),e.disable===!0){i!==void 0&&i.hasRouterLink.value===!0&&nt(B);return}if(i===void 0){o.updateModel({name:e.name}),n("click",B);return}if(i.hasRouterLink.value===!0){const ce=(ne={})=>{let se;const u=ne.to===void 0||fn(ne.to,e.to)===!0?o.avoidRouteWatcher=Va():null;return i.navigateToRouterLink(B,{...ne,returnRouterError:!0}).catch(d=>{se=d}).then(d=>{if(u===o.avoidRouteWatcher&&(o.avoidRouteWatcher=!1,se===void 0&&(d===void 0||d.message!==void 0&&d.message.startsWith("Avoided redundant navigation")===!0)&&o.updateModel({name:e.name})),ne.returnRouterError===!0)return se!==void 0?Promise.reject(se):d})};n("click",B,ce),B.defaultPrevented!==!0&&ce();return}n("click",B)}function L(B){Oi(B,[13,32])?A(B,!0):Zo(B)!==!0&&B.keyCode>=35&&B.keyCode<=40&&B.altKey!==!0&&B.metaKey!==!0&&o.onKbdNavigate(B.keyCode,r.$el)===!0&&nt(B),n("keydown",B)}function I(){const B=o.tabProps.value.narrowIndicator,F=[],ce=z("div",{ref:l,class:["q-tab__indicator",o.tabProps.value.indicatorClass]});e.icon!==void 0&&F.push(z(de,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&F.push(z("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&F.push(e.alertIcon!==void 0?z(de,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):z("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),B===!0&&F.push(ce);const ne=[z("div",{class:"q-focus-helper",tabindex:-1,ref:a}),z("div",{class:w.value},si(t.default,F))];return B===!1&&ne.push(ce),ne}const j={name:U(()=>e.name),rootRef:s,tabIndicatorRef:l,routeData:i};Ht(()=>{o.unregisterTab(j)}),pn(()=>{o.registerTab(j)});function E(B,F){const ce={ref:s,class:k.value,tabindex:S.value,role:"tab","aria-selected":f.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:A,onKeydown:L,...F};return ze(z(B,ce,I()),[[Li,g.value]])}return{renderTab:E,$tabs:o}}var _i=it({name:"QTab",props:_s,emits:ws,setup(e,{slots:t,emit:n}){const{renderTab:i}=bs(e,t,n);return()=>i("div")}});let En=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const t=document.createElement("div");Object.assign(t.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,En=e.scrollLeft>=0,e.remove()}function ks(e,t,n){const i=n===!0?["left","right"]:["top","bottom"];return`absolute-${t===!0?i[0]:i[1]}${e?` text-${e}`:""}`}const Ds=["left","center","right","justify"];var Cs=it({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>Ds.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:n}){const{proxy:i}=ut(),{$q:o}=i,{registerTick:r}=Gn(),{registerTick:a}=Gn(),{registerTick:s}=Gn(),{registerTimeout:l,removeTimeout:g}=An(),{registerTimeout:f,removeTimeout:k}=An(),w=he(null),S=he(null),A=he(e.modelValue),L=he(!1),I=he(!0),j=he(!1),E=he(!1),B=[],F=he(0),ce=he(!1);let ne=null,se=null,u;const d=U(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:ks(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),v=U(()=>{const W=F.value,te=A.value;for(let fe=0;fe<W;fe++)if(B[fe].name.value===te)return!0;return!1}),q=U(()=>`q-tabs__content--align-${L.value===!0?"left":E.value===!0?"justify":e.align}`),p=U(()=>`q-tabs row no-wrap items-center q-tabs--${L.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),m=U(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+q.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),b=U(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),_=U(()=>e.vertical!==!0&&o.lang.rtl===!0),C=U(()=>En===!1&&_.value===!0);je(_,N),je(()=>e.modelValue,W=>{x({name:W,setCurrent:!0,skipEmit:!0})}),je(()=>e.outsideArrows,T);function x({name:W,setCurrent:te,skipEmit:fe}){A.value!==W&&(fe!==!0&&e["onUpdate:modelValue"]!==void 0&&n("update:modelValue",W),(te===!0||e["onUpdate:modelValue"]===void 0)&&(ie(A.value,W),A.value=W))}function T(){r(()=>{R({width:w.value.offsetWidth,height:w.value.offsetHeight})})}function R(W){if(b.value===void 0||S.value===null)return;const te=W[b.value.container],fe=Math.min(S.value[b.value.scroll],Array.prototype.reduce.call(S.value.children,(Ne,qe)=>Ne+(qe[b.value.content]||0),0)),$e=te>0&&fe>te;L.value=$e,$e===!0&&a(N),E.value=te<parseInt(e.breakpoint,10)}function ie(W,te){const fe=W!=null&&W!==""?B.find(Ne=>Ne.name.value===W):null,$e=te!=null&&te!==""?B.find(Ne=>Ne.name.value===te):null;if(fe&&$e){const Ne=fe.tabIndicatorRef.value,qe=$e.tabIndicatorRef.value;ne!==null&&(clearTimeout(ne),ne=null),Ne.style.transition="none",Ne.style.transform="none",qe.style.transition="none",qe.style.transform="none";const be=Ne.getBoundingClientRect(),Ke=qe.getBoundingClientRect();qe.style.transform=e.vertical===!0?`translate3d(0,${be.top-Ke.top}px,0) scale3d(1,${Ke.height?be.height/Ke.height:1},1)`:`translate3d(${be.left-Ke.left}px,0,0) scale3d(${Ke.width?be.width/Ke.width:1},1,1)`,s(()=>{ne=setTimeout(()=>{ne=null,qe.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",qe.style.transform="none"},70)})}$e&&L.value===!0&&M($e.rootRef.value)}function M(W){const{left:te,width:fe,top:$e,height:Ne}=S.value.getBoundingClientRect(),qe=W.getBoundingClientRect();let be=e.vertical===!0?qe.top-$e:qe.left-te;if(be<0){S.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(be),N();return}be+=e.vertical===!0?qe.height-Ne:qe.width-fe,be>0&&(S.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(be),N())}function N(){const W=S.value;if(W===null)return;const te=W.getBoundingClientRect(),fe=e.vertical===!0?W.scrollTop:Math.abs(W.scrollLeft);_.value===!0?(I.value=Math.ceil(fe+te.width)<W.scrollWidth-1,j.value=fe>0):(I.value=fe>0,j.value=e.vertical===!0?Math.ceil(fe+te.height)<W.scrollHeight:Math.ceil(fe+te.width)<W.scrollWidth)}function oe(W){se!==null&&clearInterval(se),se=setInterval(()=>{K(W)===!0&&G()},5)}function ue(){oe(C.value===!0?Number.MAX_SAFE_INTEGER:0)}function ae(){oe(C.value===!0?0:Number.MAX_SAFE_INTEGER)}function G(){se!==null&&(clearInterval(se),se=null)}function re(W,te){const fe=Array.prototype.filter.call(S.value.children,Ke=>Ke===te||Ke.matches&&Ke.matches(".q-tab.q-focusable")===!0),$e=fe.length;if($e===0)return;if(W===36)return M(fe[0]),fe[0].focus(),!0;if(W===35)return M(fe[$e-1]),fe[$e-1].focus(),!0;const Ne=W===(e.vertical===!0?38:37),qe=W===(e.vertical===!0?40:39),be=Ne===!0?-1:qe===!0?1:void 0;if(be!==void 0){const Ke=_.value===!0?-1:1,ft=fe.indexOf(te)+be*Ke;return ft>=0&&ft<$e&&(M(fe[ft]),fe[ft].focus({preventScroll:!0})),!0}}const Te=U(()=>C.value===!0?{get:W=>Math.abs(W.scrollLeft),set:(W,te)=>{W.scrollLeft=-te}}:e.vertical===!0?{get:W=>W.scrollTop,set:(W,te)=>{W.scrollTop=te}}:{get:W=>W.scrollLeft,set:(W,te)=>{W.scrollLeft=te}});function K(W){const te=S.value,{get:fe,set:$e}=Te.value;let Ne=!1,qe=fe(te);const be=W<qe?-1:1;return qe+=be*5,qe<0?(Ne=!0,qe=0):(be===-1&&qe<=W||be===1&&qe>=W)&&(Ne=!0,qe=W),$e(te,qe),N(),Ne}function Le(W,te){for(const fe in W)if(W[fe]!==te[fe])return!1;return!0}function Ue(){let W=null,te={matchedLen:0,queryDiff:9999,hrefLen:0};const fe=B.filter(be=>be.routeData!==void 0&&be.routeData.hasRouterLink.value===!0),{hash:$e,query:Ne}=i.$route,qe=Object.keys(Ne).length;for(const be of fe){const Ke=be.routeData.exact.value===!0;if(be.routeData[Ke===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:ft,query:_t,matched:Ot,href:an}=be.routeData.resolvedLink.value,Cn=Object.keys(_t).length;if(Ke===!0){if(ft!==$e||Cn!==qe||Le(Ne,_t)===!1)continue;W=be.name.value;break}if(ft!==""&&ft!==$e||Cn!==0&&Le(_t,Ne)===!1)continue;const ht={matchedLen:Ot.length,queryDiff:qe-Cn,hrefLen:an.length-ft.length};if(ht.matchedLen>te.matchedLen){W=be.name.value,te=ht;continue}else if(ht.matchedLen!==te.matchedLen)continue;if(ht.queryDiff<te.queryDiff)W=be.name.value,te=ht;else if(ht.queryDiff!==te.queryDiff)continue;ht.hrefLen>te.hrefLen&&(W=be.name.value,te=ht)}W===null&&B.some(be=>be.routeData===void 0&&be.name.value===A.value)===!0||x({name:W,setCurrent:!0})}function ot(W){if(g(),ce.value!==!0&&w.value!==null&&W.target&&typeof W.target.closest=="function"){const te=W.target.closest(".q-tab");te&&w.value.contains(te)===!0&&(ce.value=!0,L.value===!0&&M(te))}}function Ie(){l(()=>{ce.value=!1},30)}function Re(){Rt.avoidRouteWatcher===!1?f(Ue):k()}function Ce(){if(u===void 0){const W=je(()=>i.$route.fullPath,Re);u=()=>{W(),u=void 0}}}function xt(W){B.push(W),F.value++,T(),W.routeData===void 0||i.$route===void 0?f(()=>{if(L.value===!0){const te=A.value,fe=te!=null&&te!==""?B.find($e=>$e.name.value===te):null;fe&&M(fe.rootRef.value)}}):(Ce(),W.routeData.hasRouterLink.value===!0&&Re())}function on(W){B.splice(B.indexOf(W),1),F.value--,T(),u!==void 0&&W.routeData!==void 0&&(B.every(te=>te.routeData===void 0)===!0&&u(),Re())}const Rt={currentModel:A,tabProps:d,hasFocus:ce,hasActiveTab:v,registerTab:xt,unregisterTab:on,verifyRouteModel:Re,updateModel:x,onKbdNavigate:re,avoidRouteWatcher:!1};Jo(Yo,Rt);function rn(){ne!==null&&clearTimeout(ne),G(),u!==void 0&&u()}let Lt;return Ht(rn),Ui(()=>{Lt=u!==void 0,rn()}),Ni(()=>{Lt===!0&&Ce(),T()}),()=>z("div",{ref:w,class:p.value,role:"tablist",onFocusin:ot,onFocusout:Ie},[z(rs,{onResize:R}),z("div",{ref:S,class:m.value,onScroll:N},Qt(t.default)),z(de,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(I.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||o.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:ue,onTouchstartPassive:ue,onMouseupPassive:G,onMouseleavePassive:G,onTouchendPassive:G}),z(de,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(j.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||o.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:ae,onTouchstartPassive:ae,onMouseupPassive:G,onMouseleavePassive:G,onTouchendPassive:G})])}});function Ss(e){const t=[.06,6,50];return typeof e=="string"&&e.length&&e.split(":").forEach((n,i)=>{const o=parseFloat(n);o&&(t[i]=o)}),t}var Ps=fa({name:"touch-swipe",beforeMount(e,{value:t,arg:n,modifiers:i}){if(i.mouse!==!0&&Pn.has.touch!==!0)return;const o=i.mouseCapture===!0?"Capture":"",r={handler:t,sensitivity:Ss(n),direction:So(i),noop:er,mouseStart(a){Po(a,r)&&ha(a)&&(Bn(r,"temp",[[document,"mousemove","move",`notPassive${o}`],[document,"mouseup","end","notPassiveCapture"]]),r.start(a,!0))},touchStart(a){if(Po(a,r)){const s=a.target;Bn(r,"temp",[[s,"touchmove","move","notPassiveCapture"],[s,"touchcancel","end","notPassiveCapture"],[s,"touchend","end","notPassiveCapture"]]),r.start(a)}},start(a,s){Pn.is.firefox===!0&&vi(e,!0);const l=$i(a);r.event={x:l.left,y:l.top,time:Date.now(),mouse:s===!0,dir:!1}},move(a){if(r.event===void 0)return;if(r.event.dir!==!1){nt(a);return}const s=Date.now()-r.event.time;if(s===0)return;const l=$i(a),g=l.left-r.event.x,f=Math.abs(g),k=l.top-r.event.y,w=Math.abs(k);if(r.event.mouse!==!0){if(f<r.sensitivity[1]&&w<r.sensitivity[1]){r.end(a);return}}else if(window.getSelection().toString()!==""){r.end(a);return}else if(f<r.sensitivity[2]&&w<r.sensitivity[2])return;const S=f/s,A=w/s;r.direction.vertical===!0&&f<w&&f<100&&A>r.sensitivity[0]&&(r.event.dir=k<0?"up":"down"),r.direction.horizontal===!0&&f>w&&w<100&&S>r.sensitivity[0]&&(r.event.dir=g<0?"left":"right"),r.direction.up===!0&&f<w&&k<0&&f<100&&A>r.sensitivity[0]&&(r.event.dir="up"),r.direction.down===!0&&f<w&&k>0&&f<100&&A>r.sensitivity[0]&&(r.event.dir="down"),r.direction.left===!0&&f>w&&g<0&&w<100&&S>r.sensitivity[0]&&(r.event.dir="left"),r.direction.right===!0&&f>w&&g>0&&w<100&&S>r.sensitivity[0]&&(r.event.dir="right"),r.event.dir!==!1?(nt(a),r.event.mouse===!0&&(document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),La(),r.styleCleanup=L=>{r.styleCleanup=void 0,document.body.classList.remove("non-selectable");const I=()=>{document.body.classList.remove("no-pointer-events--children")};L===!0?setTimeout(I,50):I()}),r.handler({evt:a,touch:r.event.mouse!==!0,mouse:r.event.mouse,direction:r.event.dir,duration:s,distance:{x:f,y:w}})):r.end(a)},end(a){r.event!==void 0&&(pi(r,"temp"),Pn.is.firefox===!0&&vi(e,!1),r.styleCleanup!==void 0&&r.styleCleanup(!0),a!==void 0&&r.event.dir!==!1&&nt(a),r.event=void 0)}};if(e.__qtouchswipe=r,i.mouse===!0){const a=i.mouseCapture===!0||i.mousecapture===!0?"Capture":"";Bn(r,"main",[[e,"mousedown","mouseStart",`passive${a}`]])}Pn.has.touch===!0&&Bn(r,"main",[[e,"touchstart","touchStart",`passive${i.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const n=e.__qtouchswipe;n!==void 0&&(t.oldValue!==t.value&&(typeof t.value!="function"&&n.end(),n.handler=t.value),n.direction=So(t.modifiers))},beforeUnmount(e){const t=e.__qtouchswipe;t!==void 0&&(pi(t,"main"),pi(t,"temp"),Pn.is.firefox===!0&&vi(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(),delete e.__qtouchswipe)}});function qs(){let e=Object.create(null);return{getCache:(t,n)=>e[t]===void 0?e[t]=typeof n=="function"?n():n:e[t],setCache(t,n){e[t]=n},hasCache(t){return Object.hasOwnProperty.call(e,t)},clearCache(t){t!==void 0?delete e[t]:e=Object.create(null)}}}const mr={name:{required:!0},disable:Boolean},$o={setup(e,{slots:t}){return()=>z("div",{class:"q-panel scroll",role:"tabpanel"},Qt(t.default))}},gr={modelValue:{required:!0},animated:Boolean,infinite:Boolean,swipeable:Boolean,vertical:Boolean,transitionPrev:String,transitionNext:String,transitionDuration:{type:[String,Number],default:300},keepAlive:Boolean,keepAliveInclude:[String,Array,RegExp],keepAliveExclude:[String,Array,RegExp],keepAliveMax:Number},vr=["update:modelValue","beforeTransition","transition"];function pr(){const{props:e,emit:t,proxy:n}=ut(),{getCache:i}=qs();let o,r;const a=he(null),s=he(null);function l(m){const b=e.vertical===!0?"up":"left";se((n.$q.lang.rtl===!0?-1:1)*(m.direction===b?1:-1))}const g=U(()=>[[Ps,l,void 0,{horizontal:e.vertical!==!0,vertical:e.vertical,mouse:!0}]]),f=U(()=>e.transitionPrev||`slide-${e.vertical===!0?"down":"right"}`),k=U(()=>e.transitionNext||`slide-${e.vertical===!0?"up":"left"}`),w=U(()=>`--q-transition-duration: ${e.transitionDuration}ms`),S=U(()=>typeof e.modelValue=="string"||typeof e.modelValue=="number"?e.modelValue:String(e.modelValue)),A=U(()=>({include:e.keepAliveInclude,exclude:e.keepAliveExclude,max:e.keepAliveMax})),L=U(()=>e.keepAliveInclude!==void 0||e.keepAliveExclude!==void 0);je(()=>e.modelValue,(m,b)=>{const _=B(m)===!0?F(m):-1;r!==!0&&ne(_===-1?0:_<F(b)?-1:1),a.value!==_&&(a.value=_,t("beforeTransition",m,b),qt(()=>{t("transition",m,b)}))});function I(){se(1)}function j(){se(-1)}function E(m){t("update:modelValue",m)}function B(m){return m!=null&&m!==""}function F(m){return o.findIndex(b=>b.props.name===m&&b.props.disable!==""&&b.props.disable!==!0)}function ce(){return o.filter(m=>m.props.disable!==""&&m.props.disable!==!0)}function ne(m){const b=m!==0&&e.animated===!0&&a.value!==-1?"q-transition--"+(m===-1?f.value:k.value):null;s.value!==b&&(s.value=b)}function se(m,b=a.value){let _=b+m;for(;_!==-1&&_<o.length;){const C=o[_];if(C!==void 0&&C.props.disable!==""&&C.props.disable!==!0){ne(m),r=!0,t("update:modelValue",C.props.name),setTimeout(()=>{r=!1});return}_+=m}e.infinite===!0&&o.length!==0&&b!==-1&&b!==o.length&&se(m,m===-1?o.length:-1)}function u(){const m=F(e.modelValue);return a.value!==m&&(a.value=m),!0}function d(){const m=B(e.modelValue)===!0&&u()&&o[a.value];return e.keepAlive===!0?[z(ga,A.value,[z(L.value===!0?i(S.value,()=>({...$o,name:S.value})):$o,{key:S.value,style:w.value},()=>m)])]:[z("div",{class:"q-panel scroll",style:w.value,key:S.value,role:"tabpanel"},[m])]}function v(){if(o.length!==0)return e.animated===!0?[z(Ct,{name:s.value},d)]:d()}function q(m){return o=ma(Qt(m.default,[])).filter(b=>b.props!==null&&b.props.slot===void 0&&B(b.props.name)===!0),o.length}function p(){return o}return Object.assign(n,{next:I,previous:j,goTo:E}),{panelIndex:a,panelDirectives:g,updatePanelsList:q,updatePanelIndex:u,getPanelContent:v,getEnabledPanels:ce,getPanels:p,isValidPanelName:B,keepAliveProps:A,needsUniqueKeepAliveWrapper:L,goToPanelByOffset:se,goToPanel:E,nextPanel:I,previousPanel:j}}var bi=it({name:"QTabPanel",props:mr,setup(e,{slots:t}){return()=>z("div",{class:"q-tab-panel",role:"tabpanel"},Qt(t.default))}}),Ts=it({name:"QTabPanels",props:{...gr,...yn},emits:vr,setup(e,{slots:t}){const n=ut(),i=wn(e,n.proxy.$q),{updatePanelsList:o,getPanelContent:r,panelDirectives:a}=pr(),s=U(()=>"q-tab-panels q-panel-parent"+(i.value===!0?" q-tab-panels--dark q-dark":""));return()=>(o(t),Vi("div",{class:s.value},r(),"pan",e.swipeable,()=>a.value))}});function ji(e,t=20,n=5){if(e.length>t+n)return e.substring(0,t)+"..."+e.substring(e.length-n,e.length)}var Ms=it({name:"QCarouselSlide",props:{...mr,imgSrc:String},setup(e,{slots:t}){const n=U(()=>e.imgSrc?{backgroundImage:`url("${e.imgSrc}")`}:{});return()=>z("div",{class:"q-carousel__slide",style:n.value},Qt(t.default))}});let qn=0;const xs={fullscreen:Boolean,noRouteFullscreenExit:Boolean},$s=["update:fullscreen","fullscreen"];function As(){const e=ut(),{props:t,emit:n,proxy:i}=e;let o,r,a;const s=he(!1);va(e)===!0&&je(()=>i.$route.fullPath,()=>{t.noRouteFullscreenExit!==!0&&f()}),je(()=>t.fullscreen,k=>{s.value!==k&&l()}),je(s,k=>{n("update:fullscreen",k),n("fullscreen",k)});function l(){s.value===!0?f():g()}function g(){s.value!==!0&&(s.value=!0,a=i.$el.parentNode,a.replaceChild(r,i.$el),document.body.appendChild(i.$el),qn++,qn===1&&document.body.classList.add("q-body--fullscreen-mixin"),o={handler:f},vo.add(o))}function f(){s.value===!0&&(o!==void 0&&(vo.remove(o),o=void 0),a.replaceChild(i.$el,r),s.value=!1,qn=Math.max(0,qn-1),qn===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),i.$el.scrollIntoView!==void 0&&setTimeout(()=>{i.$el.scrollIntoView()})))}return tr(()=>{r=document.createElement("span")}),pn(()=>{t.fullscreen===!0&&g()}),Ht(f),Object.assign(i,{toggleFullscreen:l,setFullscreen:g,exitFullscreen:f}),{inFullscreen:s,toggleFullscreen:l}}const Es=["top","right","bottom","left"],Is=["regular","flat","outline","push","unelevated"];var Rs=it({name:"QCarousel",props:{...yn,...gr,...xs,transitionPrev:{type:String,default:"fade"},transitionNext:{type:String,default:"fade"},height:String,padding:Boolean,controlColor:String,controlTextColor:String,controlType:{type:String,validator:e=>Is.includes(e),default:"flat"},autoplay:[Number,Boolean],arrows:Boolean,prevIcon:String,nextIcon:String,navigation:Boolean,navigationPosition:{type:String,validator:e=>Es.includes(e)},navigationIcon:String,navigationActiveIcon:String,thumbnails:Boolean},emits:[...$s,...vr],setup(e,{slots:t}){const{proxy:{$q:n}}=ut(),i=wn(e,n);let o=null,r;const{updatePanelsList:a,getPanelContent:s,panelDirectives:l,goToPanel:g,previousPanel:f,nextPanel:k,getEnabledPanels:w,panelIndex:S}=pr(),{inFullscreen:A}=As(),L=U(()=>A.value!==!0&&e.height!==void 0?{height:e.height}:{}),I=U(()=>e.vertical===!0?"vertical":"horizontal"),j=U(()=>e.navigationPosition||(e.vertical===!0?"right":"bottom")),E=U(()=>`q-carousel q-panel-parent q-carousel--with${e.padding===!0?"":"out"}-padding`+(A.value===!0?" fullscreen":"")+(i.value===!0?" q-carousel--dark q-dark":"")+(e.arrows===!0?` q-carousel--arrows-${I.value}`:"")+(e.navigation===!0?` q-carousel--navigation-${j.value}`:"")),B=U(()=>{const v=[e.prevIcon||n.iconSet.carousel[e.vertical===!0?"up":"left"],e.nextIcon||n.iconSet.carousel[e.vertical===!0?"down":"right"]];return e.vertical===!1&&n.lang.rtl===!0?v.reverse():v}),F=U(()=>e.navigationIcon||n.iconSet.carousel.navigationIcon),ce=U(()=>e.navigationActiveIcon||F.value),ne=U(()=>({color:e.controlColor,textColor:e.controlTextColor,round:!0,[e.controlType]:!0,dense:!0}));je(()=>e.modelValue,()=>{e.autoplay&&se()}),je(()=>e.autoplay,v=>{v?se():o!==null&&(clearTimeout(o),o=null)});function se(){const v=pa(e.autoplay)===!0?Math.abs(e.autoplay):5e3;o!==null&&clearTimeout(o),o=setTimeout(()=>{o=null,v>=0?k():f()},v)}pn(()=>{e.autoplay&&se()}),Ht(()=>{o!==null&&clearTimeout(o)});function u(v,q){return z("div",{class:`q-carousel__control q-carousel__navigation no-wrap absolute flex q-carousel__navigation--${v} q-carousel__navigation--${j.value}`+(e.controlColor!==void 0?` text-${e.controlColor}`:"")},[z("div",{class:"q-carousel__navigation-inner flex flex-center no-wrap"},w().map(q))])}function d(){const v=[];if(e.navigation===!0){const q=t["navigation-icon"]!==void 0?t["navigation-icon"]:m=>z(H,{key:"nav"+m.name,class:`q-carousel__navigation-icon q-carousel__navigation-icon--${m.active===!0?"":"in"}active`,...m.btnProps,onClick:m.onClick}),p=r-1;v.push(u("buttons",(m,b)=>{const _=m.props.name,C=S.value===b;return q({index:b,maxIndex:p,name:_,active:C,btnProps:{icon:C===!0?ce.value:F.value,size:"sm",...ne.value},onClick:()=>{g(_)}})}))}else if(e.thumbnails===!0){const q=e.controlColor!==void 0?` text-${e.controlColor}`:"";v.push(u("thumbnails",p=>{const m=p.props;return z("img",{key:"tmb#"+m.name,class:`q-carousel__thumbnail q-carousel__thumbnail--${m.name===e.modelValue?"":"in"}active`+q,src:m.imgSrc||m["img-src"],onClick:()=>{g(m.name)}})}))}return e.arrows===!0&&S.value>=0&&((e.infinite===!0||S.value>0)&&v.push(z("div",{key:"prev",class:`q-carousel__control q-carousel__arrow q-carousel__prev-arrow q-carousel__prev-arrow--${I.value} absolute flex flex-center`},[z(H,{icon:B.value[0],...ne.value,onClick:f})])),(e.infinite===!0||S.value<r-1)&&v.push(z("div",{key:"next",class:`q-carousel__control q-carousel__arrow q-carousel__next-arrow q-carousel__next-arrow--${I.value} absolute flex flex-center`},[z(H,{icon:B.value[1],...ne.value,onClick:k})]))),si(t.control,v)}return()=>(r=a(t),z("div",{class:E.value,style:L.value},[Vi("div",{class:"q-carousel__slides-container"},s(),"sl-cont",e.swipeable,()=>l.value)].concat(d())))}});const Ls=Je({name:"ToggleUnit",mixins:[windowMixin],props:{balanceView:{type:Boolean,required:!1}},data:function(){return{chosenMint:null}},mounted(){},watch:{},computed:{...Se(xe,["activeUnit","activeUnitLabel"]),activeUnitLabelAdopted:function(){return this.balanceView?this.activeUnitLabel==="SAT"?"BTC":this.activeUnitLabel:this.activeUnitLabel}},methods:{...ye(xe,["toggleUnit"])}});function Os(e,t,n,i,o,r){return $(),Q(H,{rounded:"",outline:"",color:"primary",onClick:t[0]||(t[0]=a=>e.toggleUnit()),label:e.activeUnitLabelAdopted},null,8,["label"])}var yr=He(Ls,[["render",Os]]);const Us=Je({name:"BalanceView",mixins:[windowMixin],components:{ToggleUnit:yr},props:{setTab:Function},computed:{...Se(xe,["activeMintUrl","activeProofs","mints","proofs","activeBalance","activeUnit","activeMint"]),...Se(zt,["historyTokens"]),...Se(ti,["getBitcoinPrice"]),...Se(lt,["globalMutexLock"]),...De(xe,["activeUnit"]),...De(lt,["hideBalance"]),pendingBalance:function(){return-this.historyTokens.filter(e=>e.status=="pending").filter(e=>e.unit==this.activeUnit).reduce((e,t)=>e+=t.amount,0)},balance:function(){return this.activeProofs.flat().reduce((e,t)=>e+=t.amount,0)},balancesOptions:function(){const e=this.activeMint();return Object.entries(e.allBalances).map(([t,n])=>({label:t,value:t}))},allMintKeysets:function(){return[].concat(...this.mints.map(e=>e.keysets))},getTotalBalance:function(){return this.activeBalance},getActiveMintBalance:function(){return this.activeProofs.flat().reduce((e,t)=>e+=t.amount,0)},activeMintLabel:function(){return this.activeMint().mint.nickname||Tt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.flat().reduce((t,n)=>t+=n.amount,0);return e}},data(){return{bitcoinPrice:null,priceLabel:null}},mounted(){ti(),this.getBitcoinPrice&&this.fetchPrice()},methods:{...ye(Ze,["checkPendingInvoices","checkPendingTokens","fetchBitcoinPriceUSD"]),async fetchPrice(){try{this.bitcoinPrice=await this.fetchBitcoinPriceUSD(),console.log(`bitcoinPrice: ${this.bitcoinPrice}`)}catch(e){console.warn(`Could not get Bitcoin price. ${e}`)}},toggleUnit:function(){const e=this.activeMint().units;return this.activeUnit=e[(e.indexOf(this.activeUnit)+1)%e.length],this.activeUnit},toggleHideBalance(){this.hideBalance=!this.hideBalance}}}),Ns={class:"q-pt-xl q-pb-md"},Vs={class:"row justify-center q-pb-lg",style:{height:"80px"}},Bs={key:0},Fs={key:1},zs={class:"row"},js={class:"col-12"},Ws={key:0},Hs={key:0},Qs={key:1},Ks={key:0,class:"row q-mt-md q-mb-none text-secondary"},Xs={class:"col-12 cursor-pointer"},Gs={key:1,class:"row q-mb-none text-secondary"},Ys={class:"col-12"},Zs={class:"q-my-none q-py-none text-weight-regular"},Js={key:0,class:"row q-mt-xs q-mb-none"},el={class:"col-12"};function tl(e,t,n,i,o,r){const a=Ee("ToggleUnit");return $(),J(ct,null,[P("div",Ns,[P("div",Vs,[e.globalMutexLock?($(),J("div",Bs,[h(Ct,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:y(()=>[h(It,{class:"q-mt-lg q-mb-none",size:"lg",color:"primary"})]),_:1})])):($(),J("div",Fs,[h(Ct,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:y(()=>[h(a,{class:"q-mt-lg q-mb-none",balanceView:!0})]),_:1})]))]),h(Ct,{appear:"","enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeInDown",mode:"out-in"},{default:y(()=>[h(Rs,{modelValue:this.activeUnit,"onUpdate:modelValue":t[1]||(t[1]=s=>this.activeUnit=s),"transition-prev":"jump-up","transition-next":"jump-up",swipeable:"",animated:"",height:e.$q.screen.width<390?"130px":"80px","control-color":"primary",class:"bg-transparent rounded-borders q-mb-xl q-mt-xl text-primary"},{default:y(()=>[($(!0),J(ct,null,Et(e.balancesOptions,s=>($(),Q(Ms,{key:s.value,name:s.value,class:"q-pt-none"},{default:y(()=>[P("div",zs,[P("div",js,[P("h3",{class:"q-my-none q-py-none cursor-pointer",onClick:t[0]||(t[0]=(...l)=>e.toggleHideBalance&&e.toggleHideBalance(...l))},[P("strong",null,me(e.formatCurrency(e.getTotalBalance,e.activeUnit)),1)]),e.bitcoinPrice?($(),J("div",Ws,[this.activeUnit=="sat"?($(),J("strong",Hs,me(e.formatCurrency(e.bitcoinPrice/1e8*e.getTotalBalance,"USD")),1)):Z("",!0),this.activeUnit=="usd"||this.activeUnit=="eur"?($(),J("strong",Qs,me(e.formatCurrency(e.getTotalBalance/100/e.bitcoinPrice*1e8,"sat")),1)):Z("",!0),h(at,null,{default:y(()=>[O(me(e.formatCurrency(e.bitcoinPrice,"USD").slice(1))+" USD/BTC",1)]),_:1})])):Z("",!0)])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","height"])]),_:1}),e.activeMintUrl?($(),J("div",Ks,[P("div",Xs,[P("span",{class:"text-weight-light",onClick:t[2]||(t[2]=s=>e.setTab("settings"))},[O(" Mint: "),P("b",null,me(e.activeMintLabel),1),h(at,null,{default:y(()=>[O("Configure mint(s)")]),_:1})])])])):Z("",!0),e.mints.length>1?($(),J("div",Gs,[P("div",Ys,[P("span",Zs,[O(" Balance: "),P("b",null,me(e.formatCurrency(e.getActiveMintBalance,e.activeUnit)),1)])])])):Z("",!0)]),e.pendingBalance>0?($(),J("div",Js,[P("div",el,[h(H,{name:"history",size:"sm",align:"between",color:"secondary",dense:"",outline:"",class:"q-mx-none q-mt-xs q-pr-sm cursor-pointer",onClick:t[3]||(t[3]=s=>e.checkPendingTokens())},{default:y(()=>[h(de,{name:"history",size:"1rem",class:"q-mx-xs"}),O(" Pending: "+me(e.formatCurrency(e.pendingBalance,this.activeUnit))+" ",1),h(at,null,{default:y(()=>[O("Check all pending tokens")]),_:1})]),_:1})])])):Z("",!0)],64)}var nl=He(Us,[["render",tl]]),il=it({name:"QField",inheritAttrs:!1,props:{...Bi,tag:{type:String,default:"label"}},emits:ar,setup(){return sr(lr({tagProp:!0}))}});const ol={xs:8,sm:10,md:14,lg:20,xl:24};var mn=it({name:"QChip",props:{...yn,...nr,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:t,emit:n}){const{proxy:{$q:i}}=ut(),o=wn(e,i),r=ir(e,ol),a=U(()=>e.selected===!0||e.icon!==void 0),s=U(()=>e.selected===!0?e.iconSelected||i.iconSet.chip.selected:e.icon),l=U(()=>e.iconRemove||i.iconSet.chip.remove),g=U(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),f=U(()=>{const I=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(I?` text-${I} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(g.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(o.value===!0?" q-chip--dark q-dark":"")}),k=U(()=>{const I=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},j={...I,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||i.lang.label.remove};return{chip:I,remove:j}});function w(I){I.keyCode===13&&S(I)}function S(I){e.disable||(n("update:selected",!e.selected),n("click",I))}function A(I){(I.keyCode===void 0||I.keyCode===13)&&(nt(I),e.disable===!1&&(n("update:modelValue",!1),n("remove")))}function L(){const I=[];g.value===!0&&I.push(z("div",{class:"q-focus-helper"})),a.value===!0&&I.push(z(de,{class:"q-chip__icon q-chip__icon--left",name:s.value}));const j=e.label!==void 0?[z("div",{class:"ellipsis"},[e.label])]:void 0;return I.push(z("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},ya(t.default,j))),e.iconRight&&I.push(z(de,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&I.push(z(de,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...k.value.remove,onClick:A,onKeyup:A})),I}return()=>{if(e.modelValue===!1)return;const I={class:f.value,style:r.value};return g.value===!0&&Object.assign(I,k.value.chip,{onClick:S,onKeyup:w}),Vi("div",I,L(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Li,e.ripple]])}}}),rl=it({name:"QMenu",inheritAttrs:!1,props:{...Ba,...Oa,...yn,...Fa,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:yo},self:{type:String,validator:yo},offset:{type:Array,validator:za},scrollTarget:gs,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Ua,"click","escapeKey"],setup(e,{slots:t,emit:n,attrs:i}){let o=null,r,a,s;const l=ut(),{proxy:g}=l,{$q:f}=g,k=he(null),w=he(!1),S=U(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),A=wn(e,f),{registerTick:L,removeTick:I}=Gn(),{registerTimeout:j}=An(),{transitionProps:E,transitionStyle:B}=ja(e),{localScrollTarget:F,changeScrollEvent:ce,unconfigureScrollTarget:ne}=Wa(e,oe),{anchorEl:se,canShow:u}=Ha({showing:w}),{hide:d}=Na({showing:w,canShow:u,handleShow:ie,handleHide:M,hideOnRouteChange:S,processOnMount:!0}),{showPortal:v,hidePortal:q,renderPortal:p}=Qa(l,k,Te,"menu"),m={anchorEl:se,innerRef:k,onClickOutside(K){if(e.persistent!==!0&&w.value===!0)return d(K),(K.type==="touchstart"||K.target.classList.contains("q-dialog__backdrop"))&&nt(K),!0}},b=U(()=>bo(e.anchor||(e.cover===!0?"center middle":"bottom start"),f.lang.rtl)),_=U(()=>e.cover===!0?b.value:bo(e.self||"top start",f.lang.rtl)),C=U(()=>(e.square===!0?" q-menu--square":"")+(A.value===!0?" q-menu--dark q-dark":"")),x=U(()=>e.autoClose===!0?{onClick:ue}:{}),T=U(()=>w.value===!0&&e.persistent!==!0);je(T,K=>{K===!0?(Ga(G),Ya(m)):(_o(G),wo(m))});function R(){ur(()=>{let K=k.value;K&&K.contains(document.activeElement)!==!0&&(K=K.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||K.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||K.querySelector("[autofocus], [data-autofocus]")||K,K.focus({preventScroll:!0}))})}function ie(K){if(o=e.noRefocus===!1?document.activeElement:null,ls(ae),v(),oe(),r=void 0,K!==void 0&&(e.touchPosition||e.contextMenu)){const Le=$i(K);if(Le.left!==void 0){const{top:Ue,left:ot}=se.value.getBoundingClientRect();r={left:Le.left-ot,top:Le.top-Ue}}}a===void 0&&(a=je(()=>f.screen.width+"|"+f.screen.height+"|"+e.self+"|"+e.anchor+"|"+f.lang.rtl,re)),e.noFocus!==!0&&document.activeElement.blur(),L(()=>{re(),e.noFocus!==!0&&R()}),j(()=>{f.platform.is.ios===!0&&(s=e.autoClose,k.value.click()),re(),v(!0),n("show",K)},e.transitionDuration)}function M(K){I(),q(),N(!0),o!==null&&(K===void 0||K.qClickOutside!==!0)&&(((K&&K.type.indexOf("key")===0?o.closest('[tabindex]:not([tabindex^="-"])'):void 0)||o).focus(),o=null),j(()=>{q(!0),n("hide",K)},e.transitionDuration)}function N(K){r=void 0,a!==void 0&&(a(),a=void 0),(K===!0||w.value===!0)&&(us(ae),ne(),wo(m),_o(G)),K!==!0&&(o=null)}function oe(){(se.value!==null||e.scrollTarget!==void 0)&&(F.value=vs(se.value,e.scrollTarget),ce(F.value,re))}function ue(K){s!==!0?(Xa(g,K),n("click",K)):s=!1}function ae(K){T.value===!0&&e.noFocus!==!0&&wa(k.value,K.target)!==!0&&R()}function G(K){n("escapeKey"),d(K)}function re(){Ka({targetEl:k.value,offset:e.offset,anchorEl:se.value,anchorOrigin:b.value,selfOrigin:_.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Te(){return z(Ct,E.value,()=>w.value===!0?z("div",{role:"menu",...i,ref:k,tabindex:-1,class:["q-menu q-position-engine scroll"+C.value,i.class],style:[i.style,B.value],...x.value},Qt(t.default)):null)}return Ht(N),Object.assign(g,{focus:R,updatePosition:re}),p}});const Dt=1e3,al=["start","center","end","start-force","center-force","end-force"],wr=Array.prototype.filter,sl=window.getComputedStyle(document.body).overflowAnchor===void 0?er:function(e,t){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const n=e.children||[];wr.call(n,o=>o.dataset&&o.dataset.qVsAnchor!==void 0).forEach(o=>{delete o.dataset.qVsAnchor});const i=n[t];i&&i.dataset&&(i.dataset.qVsAnchor="")}))};function gn(e,t){return e+t}function ki(e,t,n,i,o,r,a,s){const l=e===window?document.scrollingElement||document.documentElement:e,g=o===!0?"offsetWidth":"offsetHeight",f={scrollStart:0,scrollViewSize:-a-s,scrollMaxSize:0,offsetStart:-a,offsetEnd:-s};if(o===!0?(e===window?(f.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,f.scrollViewSize+=document.documentElement.clientWidth):(f.scrollStart=l.scrollLeft,f.scrollViewSize+=l.clientWidth),f.scrollMaxSize=l.scrollWidth,r===!0&&(f.scrollStart=(En===!0?f.scrollMaxSize-f.scrollViewSize:0)-f.scrollStart)):(e===window?(f.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,f.scrollViewSize+=document.documentElement.clientHeight):(f.scrollStart=l.scrollTop,f.scrollViewSize+=l.clientHeight),f.scrollMaxSize=l.scrollHeight),n!==null)for(let k=n.previousElementSibling;k!==null;k=k.previousElementSibling)k.classList.contains("q-virtual-scroll--skip")===!1&&(f.offsetStart+=k[g]);if(i!==null)for(let k=i.nextElementSibling;k!==null;k=k.nextElementSibling)k.classList.contains("q-virtual-scroll--skip")===!1&&(f.offsetEnd+=k[g]);if(t!==e){const k=l.getBoundingClientRect(),w=t.getBoundingClientRect();o===!0?(f.offsetStart+=w.left-k.left,f.offsetEnd-=w.width):(f.offsetStart+=w.top-k.top,f.offsetEnd-=w.height),e!==window&&(f.offsetStart+=f.scrollStart),f.offsetEnd+=f.scrollMaxSize-f.offsetStart}return f}function Ao(e,t,n,i){t==="end"&&(t=(e===window?document.body:e)[n===!0?"scrollWidth":"scrollHeight"]),e===window?n===!0?(i===!0&&(t=(En===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-t),window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t):n===!0?(i===!0&&(t=(En===!0?e.scrollWidth-e.offsetWidth:0)-t),e.scrollLeft=t):e.scrollTop=t}function Tn(e,t,n,i){if(n>=i)return 0;const o=t.length,r=Math.floor(n/Dt),a=Math.floor((i-1)/Dt)+1;let s=e.slice(r,a).reduce(gn,0);return n%Dt!==0&&(s-=t.slice(r*Dt,n).reduce(gn,0)),i%Dt!==0&&i!==o&&(s-=t.slice(i,a*Dt).reduce(gn,0)),s}const ll={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},Eo={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...ll};function ul({virtualScrollLength:e,getVirtualScrollTarget:t,getVirtualScrollEl:n,virtualScrollItemSizeComputed:i}){const o=ut(),{props:r,emit:a,proxy:s}=o,{$q:l}=s;let g,f,k,w=[],S;const A=he(0),L=he(0),I=he({}),j=he(null),E=he(null),B=he(null),F=he({from:0,to:0}),ce=U(()=>r.tableColspan!==void 0?r.tableColspan:100);i===void 0&&(i=U(()=>r.virtualScrollItemSize));const ne=U(()=>i.value+";"+r.virtualScrollHorizontal),se=U(()=>ne.value+";"+r.virtualScrollSliceRatioBefore+";"+r.virtualScrollSliceRatioAfter);je(se,()=>{C()}),je(ne,u);function u(){_(f,!0)}function d(M){_(M===void 0?f:M)}function v(M,N){const oe=t();if(oe==null||oe.nodeType===8)return;const ue=ki(oe,n(),j.value,E.value,r.virtualScrollHorizontal,l.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd);k!==ue.scrollViewSize&&C(ue.scrollViewSize),p(oe,ue,Math.min(e.value-1,Math.max(0,parseInt(M,10)||0)),0,al.indexOf(N)!==-1?N:f!==-1&&M>f?"end":"start")}function q(){const M=t();if(M==null||M.nodeType===8)return;const N=ki(M,n(),j.value,E.value,r.virtualScrollHorizontal,l.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd),oe=e.value-1,ue=N.scrollMaxSize-N.offsetStart-N.offsetEnd-L.value;if(g===N.scrollStart)return;if(N.scrollMaxSize<=0){p(M,N,0,0);return}k!==N.scrollViewSize&&C(N.scrollViewSize),m(F.value.from);const ae=Math.floor(N.scrollMaxSize-Math.max(N.scrollViewSize,N.offsetEnd)-Math.min(S[oe],N.scrollViewSize/2));if(ae>0&&Math.ceil(N.scrollStart)>=ae){p(M,N,oe,N.scrollMaxSize-N.offsetEnd-w.reduce(gn,0));return}let G=0,re=N.scrollStart-N.offsetStart,Te=re;if(re<=ue&&re+N.scrollViewSize>=A.value)re-=A.value,G=F.value.from,Te=re;else for(let K=0;re>=w[K]&&G<oe;K++)re-=w[K],G+=Dt;for(;re>0&&G<oe;)re-=S[G],re>-N.scrollViewSize?(G++,Te=re):Te=S[G]+re;p(M,N,G,Te)}function p(M,N,oe,ue,ae){const G=typeof ae=="string"&&ae.indexOf("-force")!==-1,re=G===!0?ae.replace("-force",""):ae,Te=re!==void 0?re:"start";let K=Math.max(0,oe-I.value[Te]),Le=K+I.value.total;Le>e.value&&(Le=e.value,K=Math.max(0,Le-I.value.total)),g=N.scrollStart;const Ue=K!==F.value.from||Le!==F.value.to;if(Ue===!1&&re===void 0){T(oe);return}const{activeElement:ot}=document,Ie=B.value;Ue===!0&&Ie!==null&&Ie!==ot&&Ie.contains(ot)===!0&&(Ie.addEventListener("focusout",b),setTimeout(()=>{Ie!==null&&Ie.removeEventListener("focusout",b)})),sl(Ie,oe-K);const Re=re!==void 0?S.slice(K,oe).reduce(gn,0):0;if(Ue===!0){const Ce=Le>=F.value.from&&K<=F.value.to?F.value.to:Le;F.value={from:K,to:Ce},A.value=Tn(w,S,0,K),L.value=Tn(w,S,Le,e.value),requestAnimationFrame(()=>{F.value.to!==Le&&g===N.scrollStart&&(F.value={from:F.value.from,to:Le},L.value=Tn(w,S,Le,e.value))})}requestAnimationFrame(()=>{if(g!==N.scrollStart)return;Ue===!0&&m(K);const Ce=S.slice(K,oe).reduce(gn,0),xt=Ce+N.offsetStart+A.value,on=xt+S[oe];let Rt=xt+ue;if(re!==void 0){const rn=Ce-Re,Lt=N.scrollStart+rn;Rt=G!==!0&&Lt<xt&&on<Lt+N.scrollViewSize?Lt:re==="end"?on-N.scrollViewSize:xt-(re==="start"?0:Math.round((N.scrollViewSize-S[oe])/2))}g=Rt,Ao(M,Rt,r.virtualScrollHorizontal,l.lang.rtl),T(oe)})}function m(M){const N=B.value;if(N){const oe=wr.call(N.children,K=>K.classList&&K.classList.contains("q-virtual-scroll--skip")===!1),ue=oe.length,ae=r.virtualScrollHorizontal===!0?K=>K.getBoundingClientRect().width:K=>K.offsetHeight;let G=M,re,Te;for(let K=0;K<ue;){for(re=ae(oe[K]),K++;K<ue&&oe[K].classList.contains("q-virtual-scroll--with-prev")===!0;)re+=ae(oe[K]),K++;Te=re-S[G],Te!==0&&(S[G]+=Te,w[Math.floor(G/Dt)]+=Te),G++}}}function b(){B.value!==null&&B.value!==void 0&&B.value.focus()}function _(M,N){const oe=1*i.value;(N===!0||Array.isArray(S)===!1)&&(S=[]);const ue=S.length;S.length=e.value;for(let G=e.value-1;G>=ue;G--)S[G]=oe;const ae=Math.floor((e.value-1)/Dt);w=[];for(let G=0;G<=ae;G++){let re=0;const Te=Math.min((G+1)*Dt,e.value);for(let K=G*Dt;K<Te;K++)re+=S[K];w.push(re)}f=-1,g=void 0,A.value=Tn(w,S,0,F.value.from),L.value=Tn(w,S,F.value.to,e.value),M>=0?(m(F.value.from),qt(()=>{v(M)})):R()}function C(M){if(M===void 0&&typeof window<"u"){const re=t();re!=null&&re.nodeType!==8&&(M=ki(re,n(),j.value,E.value,r.virtualScrollHorizontal,l.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd).scrollViewSize)}k=M;const N=parseFloat(r.virtualScrollSliceRatioBefore)||0,oe=parseFloat(r.virtualScrollSliceRatioAfter)||0,ue=1+N+oe,ae=M===void 0||M<=0?1:Math.ceil(M/i.value),G=Math.max(1,ae,Math.ceil((r.virtualScrollSliceSize>0?r.virtualScrollSliceSize:10)/ue));I.value={total:Math.ceil(G*ue),start:Math.ceil(G*N),center:Math.ceil(G*(.5+N)),end:Math.ceil(G*(1+N)),view:ae}}function x(M,N){const oe=r.virtualScrollHorizontal===!0?"width":"height",ue={["--q-virtual-scroll-item-"+oe]:i.value+"px"};return[M==="tbody"?z(M,{class:"q-virtual-scroll__padding",key:"before",ref:j},[z("tr",[z("td",{style:{[oe]:`${A.value}px`,...ue},colspan:ce.value})])]):z(M,{class:"q-virtual-scroll__padding",key:"before",ref:j,style:{[oe]:`${A.value}px`,...ue}}),z(M,{class:"q-virtual-scroll__content",key:"content",ref:B,tabindex:-1},N.flat()),M==="tbody"?z(M,{class:"q-virtual-scroll__padding",key:"after",ref:E},[z("tr",[z("td",{style:{[oe]:`${L.value}px`,...ue},colspan:ce.value})])]):z(M,{class:"q-virtual-scroll__padding",key:"after",ref:E,style:{[oe]:`${L.value}px`,...ue}})]}function T(M){f!==M&&(r.onVirtualScroll!==void 0&&a("virtualScroll",{index:M,from:F.value.from,to:F.value.to-1,direction:M<f?"decrease":"increase",ref:s}),f=M)}C();const R=_a(q,l.platform.is.ios===!0?120:35);tr(()=>{C()});let ie=!1;return Ui(()=>{ie=!0}),Ni(()=>{if(ie!==!0)return;const M=t();g!==void 0&&M!==void 0&&M!==null&&M.nodeType!==8?Ao(M,g,r.virtualScrollHorizontal,l.lang.rtl):v(f)}),Ht(()=>{R.cancel()}),Object.assign(s,{scrollTo:v,reset:u,refresh:d}),{virtualScrollSliceRange:F,virtualScrollSliceSizeComputed:I,setVirtualScrollSize:C,onVirtualScrollEvt:R,localResetVirtualScroll:_,padVirtualScroll:x,scrollTo:v,reset:u,refresh:d}}const Io=e=>["add","add-unique","toggle"].includes(e),cl=".*+?^${}()|[]\\",dl=Object.keys(Bi);var Ei=it({name:"QSelect",inheritAttrs:!1,props:{...Eo,...Za,...Bi,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:Io},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:Eo.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...ar,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:t,emit:n}){const{proxy:i}=ut(),{$q:o}=i,r=he(!1),a=he(!1),s=he(-1),l=he(""),g=he(!1),f=he(!1);let k=null,w=null,S,A,L,I=null,j,E,B,F;const ce=he(null),ne=he(null),se=he(null),u=he(null),d=he(null),v=Ja(e),q=es(co),p=U(()=>Array.isArray(e.options)?e.options.length:0),m=U(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:b,virtualScrollSliceSizeComputed:_,localResetVirtualScroll:C,padVirtualScroll:x,onVirtualScrollEvt:T,scrollTo:R,setVirtualScrollSize:ie}=ul({virtualScrollLength:p,getVirtualScrollTarget:Zr,getVirtualScrollEl:lo,virtualScrollItemSizeComputed:m}),M=lr(),N=U(()=>{const D=e.mapOptions===!0&&e.multiple!==!0,ee=e.modelValue!==void 0&&(e.modelValue!==null||D===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const Y=e.mapOptions===!0&&S!==void 0?S:[],ge=ee.map(Ae=>Cn(Ae,Y));return e.modelValue===null&&D===!0?ge.filter(Ae=>Ae!==null):ge}return ee}),oe=U(()=>{const D={};return dl.forEach(ee=>{const Y=e[ee];Y!==void 0&&(D[ee]=Y)}),D}),ue=U(()=>e.optionsDark===null?M.isDark.value:e.optionsDark),ae=U(()=>ko(N.value)),G=U(()=>{let D="q-field__input q-placeholder col";return e.hideSelected===!0||N.value.length===0?[D,e.inputClass]:(D+=" q-field__input--padding",e.inputClass===void 0?D:[D,e.inputClass])}),re=U(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),Te=U(()=>p.value===0),K=U(()=>N.value.map(D=>te.value(D)).join(", ")),Le=U(()=>e.displayValue!==void 0?e.displayValue:K.value),Ue=U(()=>e.optionsHtml===!0?()=>!0:D=>D!=null&&D.html===!0),ot=U(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||N.value.some(Ue.value))),Ie=U(()=>M.focused.value===!0?e.tabindex:-1),Re=U(()=>{const D={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":r.value===!0?"true":"false","aria-controls":`${M.targetUid.value}_lb`};return s.value>=0&&(D["aria-activedescendant"]=`${M.targetUid.value}_${s.value}`),D}),Ce=U(()=>({id:`${M.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),xt=U(()=>N.value.map((D,ee)=>({index:ee,opt:D,html:Ue.value(D),selected:!0,removeAtIndex:Ke,toggleOption:_t,tabindex:Ie.value}))),on=U(()=>{if(p.value===0)return[];const{from:D,to:ee}=b.value;return e.options.slice(D,ee).map((Y,ge)=>{const Ae=fe.value(Y)===!0,Me=fi(Y)===!0,Xe=D+ge,Fe={clickable:!0,active:Me,activeClass:Lt.value,manualFocus:!0,focused:!1,disable:Ae,tabindex:-1,dense:e.optionsDense,dark:ue.value,role:"option","aria-selected":Me===!0?"true":"false",id:`${M.targetUid.value}_${Xe}`,onClick:()=>{_t(Y)}};return Ae!==!0&&(s.value===Xe&&(Fe.focused=!0),o.platform.is.desktop===!0&&(Fe.onMousemove=()=>{r.value===!0&&Ot(Xe)})),{index:Xe,opt:Y,html:Ue.value(Y),label:te.value(Y),selected:Fe.active,focused:Fe.focused,toggleOption:_t,setOptionIndex:Ot,itemProps:Fe}})}),Rt=U(()=>e.dropdownIcon!==void 0?e.dropdownIcon:o.iconSet.arrow.dropdown),rn=U(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Lt=U(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),W=U(()=>ht(e.optionValue,"value")),te=U(()=>ht(e.optionLabel,"label")),fe=U(()=>ht(e.optionDisable,"disable")),$e=U(()=>N.value.map(D=>W.value(D))),Ne=U(()=>{const D={onInput:co,onChange:q,onKeydown:so,onKeyup:ro,onKeypress:ao,onFocus:io,onClick(ee){A===!0&&dn(ee)}};return D.onCompositionstart=D.onCompositionupdate=D.onCompositionend=q,D});je(N,D=>{S=D,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&M.innerLoading.value!==!0&&(a.value!==!0&&r.value!==!0||ae.value!==!0)&&(L!==!0&&cn(),(a.value===!0||r.value===!0)&&sn(""))},{immediate:!0}),je(()=>e.fillInput,cn),je(r,hi),je(p,ca);function qe(D){return e.emitValue===!0?W.value(D):D}function be(D){if(D!==-1&&D<N.value.length)if(e.multiple===!0){const ee=e.modelValue.slice();n("remove",{index:D,value:ee.splice(D,1)[0]}),n("update:modelValue",ee)}else n("update:modelValue",null)}function Ke(D){be(D),M.focus()}function ft(D,ee){const Y=qe(D);if(e.multiple!==!0){e.fillInput===!0&&Sn(te.value(D),!0,!0),n("update:modelValue",Y);return}if(N.value.length===0){n("add",{index:0,value:Y}),n("update:modelValue",e.multiple===!0?[Y]:Y);return}if(ee===!0&&fi(D)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const ge=e.modelValue.slice();n("add",{index:ge.length,value:Y}),ge.push(Y),n("update:modelValue",ge)}function _t(D,ee){if(M.editable.value!==!0||D===void 0||fe.value(D)===!0)return;const Y=W.value(D);if(e.multiple!==!0){ee!==!0&&(Sn(e.fillInput===!0?te.value(D):"",!0,!0),Kt()),ne.value!==null&&ne.value.focus(),(N.value.length===0||fn(W.value(N.value[0]),Y)!==!0)&&n("update:modelValue",e.emitValue===!0?Y:D);return}if((A!==!0||g.value===!0)&&M.focus(),io(),N.value.length===0){const Me=e.emitValue===!0?Y:D;n("add",{index:0,value:Me}),n("update:modelValue",e.multiple===!0?[Me]:Me);return}const ge=e.modelValue.slice(),Ae=$e.value.findIndex(Me=>fn(Me,Y));if(Ae!==-1)n("remove",{index:Ae,value:ge.splice(Ae,1)[0]});else{if(e.maxValues!==void 0&&ge.length>=e.maxValues)return;const Me=e.emitValue===!0?Y:D;n("add",{index:ge.length,value:Me}),ge.push(Me)}n("update:modelValue",ge)}function Ot(D){if(o.platform.is.desktop!==!0)return;const ee=D!==-1&&D<p.value?D:-1;s.value!==ee&&(s.value=ee)}function an(D=1,ee){if(r.value===!0){let Y=s.value;do Y=xo(Y+D,-1,p.value-1);while(Y!==-1&&Y!==s.value&&fe.value(e.options[Y])===!0);s.value!==Y&&(Ot(Y),R(Y),ee!==!0&&e.useInput===!0&&e.fillInput===!0&&Vn(Y>=0?te.value(e.options[Y]):j,!0))}}function Cn(D,ee){const Y=ge=>fn(W.value(ge),D);return e.options.find(Y)||ee.find(Y)||D}function ht(D,ee){const Y=D!==void 0?D:ee;return typeof Y=="function"?Y:ge=>ge!==null&&typeof ge=="object"&&Y in ge?ge[Y]:ge}function fi(D){const ee=W.value(D);return $e.value.find(Y=>fn(Y,ee))!==void 0}function io(D){e.useInput===!0&&ne.value!==null&&(D===void 0||ne.value===D.target&&D.target.value===K.value)&&ne.value.select()}function oo(D){Oi(D,27)===!0&&r.value===!0&&(dn(D),Kt(),cn()),n("keyup",D)}function ro(D){const{value:ee}=D.target;if(D.keyCode!==void 0){oo(D);return}if(D.target.value="",k!==null&&(clearTimeout(k),k=null),w!==null&&(clearTimeout(w),w=null),cn(),typeof ee=="string"&&ee.length!==0){const Y=ee.toLocaleLowerCase(),ge=Me=>{const Xe=e.options.find(Fe=>Me.value(Fe).toLocaleLowerCase()===Y);return Xe===void 0?!1:(N.value.indexOf(Xe)===-1?_t(Xe):Kt(),!0)},Ae=Me=>{ge(W)!==!0&&(ge(te)===!0||Me===!0||sn(ee,!0,()=>Ae(!0)))};Ae()}else M.clearValue(D)}function ao(D){n("keypress",D)}function so(D){if(n("keydown",D),Zo(D)===!0)return;const ee=l.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),Y=D.shiftKey!==!0&&e.multiple!==!0&&(s.value!==-1||ee===!0);if(D.keyCode===27){yi(D);return}if(D.keyCode===9&&Y===!1){ln();return}if(D.target===void 0||D.target.id!==M.targetUid.value||M.editable.value!==!0)return;if(D.keyCode===40&&M.innerLoading.value!==!0&&r.value===!1){nt(D),un();return}if(D.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&l.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?be(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&n("update:modelValue",null);return}(D.keyCode===35||D.keyCode===36)&&(typeof l.value!="string"||l.value.length===0)&&(nt(D),s.value=-1,an(D.keyCode===36?1:-1,e.multiple)),(D.keyCode===33||D.keyCode===34)&&_.value!==void 0&&(nt(D),s.value=Math.max(-1,Math.min(p.value,s.value+(D.keyCode===33?-1:1)*_.value.view)),an(D.keyCode===33?1:-1,e.multiple)),(D.keyCode===38||D.keyCode===40)&&(nt(D),an(D.keyCode===38?-1:1,e.multiple));const ge=p.value;if((B===void 0||F<Date.now())&&(B=""),ge>0&&e.useInput!==!0&&D.key!==void 0&&D.key.length===1&&D.altKey===!1&&D.ctrlKey===!1&&D.metaKey===!1&&(D.keyCode!==32||B.length!==0)){r.value!==!0&&un(D);const Ae=D.key.toLocaleLowerCase(),Me=B.length===1&&B[0]===Ae;F=Date.now()+1500,Me===!1&&(nt(D),B+=Ae);const Xe=new RegExp("^"+B.split("").map(mi=>cl.indexOf(mi)!==-1?"\\"+mi:mi).join(".*"),"i");let Fe=s.value;if(Me===!0||Fe<0||Xe.test(te.value(e.options[Fe]))!==!0)do Fe=xo(Fe+1,-1,ge-1);while(Fe!==s.value&&(fe.value(e.options[Fe])===!0||Xe.test(te.value(e.options[Fe]))!==!0));s.value!==Fe&&qt(()=>{Ot(Fe),R(Fe),Fe>=0&&e.useInput===!0&&e.fillInput===!0&&Vn(te.value(e.options[Fe]),!0)});return}if(!(D.keyCode!==13&&(D.keyCode!==32||e.useInput===!0||B!=="")&&(D.keyCode!==9||Y===!1))){if(D.keyCode!==9&&nt(D),s.value!==-1&&s.value<ge){_t(e.options[s.value]);return}if(ee===!0){const Ae=(Me,Xe)=>{if(Xe){if(Io(Xe)!==!0)return}else Xe=e.newValueMode;if(Sn("",e.multiple!==!0,!0),Me==null)return;(Xe==="toggle"?_t:ft)(Me,Xe==="add-unique"),e.multiple!==!0&&(ne.value!==null&&ne.value.focus(),Kt())};if(e.onNewValue!==void 0?n("newValue",l.value,Ae):Ae(l.value),e.multiple!==!0)return}r.value===!0?ln():M.innerLoading.value!==!0&&un()}}function lo(){return A===!0?d.value:se.value!==null&&se.value.contentEl!==null?se.value.contentEl:void 0}function Zr(){return lo()}function Jr(){return e.hideSelected===!0?[]:t["selected-item"]!==void 0?xt.value.map(D=>t["selected-item"](D)).slice():t.selected!==void 0?[].concat(t.selected()):e.useChips===!0?xt.value.map((D,ee)=>z(mn,{key:"option-"+ee,removable:M.editable.value===!0&&fe.value(D.opt)!==!0,dense:!0,textColor:e.color,tabindex:Ie.value,onRemove(){D.removeAtIndex(ee)}},()=>z("span",{class:"ellipsis",[D.html===!0?"innerHTML":"textContent"]:te.value(D.opt)}))):[z("span",{[ot.value===!0?"innerHTML":"textContent"]:Le.value})]}function uo(){if(Te.value===!0)return t["no-option"]!==void 0?t["no-option"]({inputValue:l.value}):void 0;const D=t.option!==void 0?t.option:Y=>z(et,{key:Y.index,...Y.itemProps},()=>z(Be,()=>z(we,()=>z("span",{[Y.html===!0?"innerHTML":"textContent"]:Y.label}))));let ee=x("div",on.value.map(D));return t["before-options"]!==void 0&&(ee=t["before-options"]().concat(ee)),si(t["after-options"],ee)}function ea(D,ee){const Y=ee===!0?{...Re.value,...M.splitAttrs.attributes.value}:void 0,ge={ref:ee===!0?ne:void 0,key:"i_t",class:G.value,style:e.inputStyle,value:l.value!==void 0?l.value:"",type:"search",...Y,id:ee===!0?M.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":D===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...Ne.value};return D!==!0&&A===!0&&(Array.isArray(ge.class)===!0?ge.class=[...ge.class,"no-pointer-events"]:ge.class+=" no-pointer-events"),z("input",ge)}function co(D){k!==null&&(clearTimeout(k),k=null),w!==null&&(clearTimeout(w),w=null),!(D&&D.target&&D.target.qComposing===!0)&&(Vn(D.target.value||""),L=!0,j=l.value,M.focused.value!==!0&&(A!==!0||g.value===!0)&&M.focus(),e.onFilter!==void 0&&(k=setTimeout(()=>{k=null,sn(l.value)},e.inputDebounce)))}function Vn(D,ee){l.value!==D&&(l.value=D,ee===!0||e.inputDebounce===0||e.inputDebounce==="0"?n("inputValue",D):w=setTimeout(()=>{w=null,n("inputValue",D)},e.inputDebounce))}function Sn(D,ee,Y){L=Y!==!0,e.useInput===!0&&(Vn(D,!0),(ee===!0||Y!==!0)&&(j=D),ee!==!0&&sn(D))}function sn(D,ee,Y){if(e.onFilter===void 0||ee!==!0&&M.focused.value!==!0)return;M.innerLoading.value===!0?n("filterAbort"):(M.innerLoading.value=!0,f.value=!0),D!==""&&e.multiple!==!0&&N.value.length!==0&&L!==!0&&D===te.value(N.value[0])&&(D="");const ge=setTimeout(()=>{r.value===!0&&(r.value=!1)},10);I!==null&&clearTimeout(I),I=ge,n("filter",D,(Ae,Me)=>{(ee===!0||M.focused.value===!0)&&I===ge&&(clearTimeout(I),typeof Ae=="function"&&Ae(),f.value=!1,qt(()=>{M.innerLoading.value=!1,M.editable.value===!0&&(ee===!0?r.value===!0&&Kt():r.value===!0?hi(!0):r.value=!0),typeof Me=="function"&&qt(()=>{Me(i)}),typeof Y=="function"&&qt(()=>{Y(i)})}))},()=>{M.focused.value===!0&&I===ge&&(clearTimeout(I),M.innerLoading.value=!1,f.value=!1),r.value===!0&&(r.value=!1)})}function ta(){return z(rl,{ref:se,class:re.value,style:e.popupContentStyle,modelValue:r.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&Te.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:ue.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:rn.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...Ce.value,onScrollPassive:T,onBeforeShow:ho,onBeforeHide:na,onShow:ia},uo)}function na(D){mo(D),ln()}function ia(){ie()}function oa(D){dn(D),ne.value!==null&&ne.value.focus(),g.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function ra(D){dn(D),qt(()=>{g.value=!1})}function aa(){const D=[z(il,{class:`col-auto ${M.fieldClass.value}`,...oe.value,for:M.targetUid.value,dark:ue.value,square:!0,loading:f.value,itemAligned:!1,filled:!0,stackLabel:l.value.length!==0,...M.splitAttrs.listeners.value,onFocus:oa,onBlur:ra},{...t,rawControl:()=>M.getControl(!0),before:void 0,after:void 0})];return r.value===!0&&D.push(z("div",{ref:d,class:re.value+" scroll",style:e.popupContentStyle,...Ce.value,onClick:yi,onScrollPassive:T},uo())),z(st,{ref:u,modelValue:a.value,position:e.useInput===!0?"top":void 0,transitionShow:E,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:ho,onBeforeHide:sa,onHide:la,onShow:ua},()=>z("div",{class:"q-select__dialog"+(ue.value===!0?" q-select__dialog--dark q-dark":"")+(g.value===!0?" q-select__dialog--focused":"")},D))}function sa(D){mo(D),u.value!==null&&u.value.__updateRefocusTarget(M.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),M.focused.value=!1}function la(D){Kt(),M.focused.value===!1&&n("blur",D),cn()}function ua(){const D=document.activeElement;(D===null||D.id!==M.targetUid.value)&&ne.value!==null&&ne.value!==D&&ne.value.focus(),ie()}function ln(){a.value!==!0&&(s.value=-1,r.value===!0&&(r.value=!1),M.focused.value===!1&&(I!==null&&(clearTimeout(I),I=null),M.innerLoading.value===!0&&(n("filterAbort"),M.innerLoading.value=!1,f.value=!1)))}function un(D){M.editable.value===!0&&(A===!0?(M.onControlFocusin(D),a.value=!0,qt(()=>{M.focus()})):M.focus(),e.onFilter!==void 0?sn(l.value):(Te.value!==!0||t["no-option"]!==void 0)&&(r.value=!0))}function Kt(){a.value=!1,ln()}function cn(){e.useInput===!0&&Sn(e.multiple!==!0&&e.fillInput===!0&&N.value.length!==0&&te.value(N.value[0])||"",!0,!0)}function hi(D){let ee=-1;if(D===!0){if(N.value.length!==0){const Y=W.value(N.value[0]);ee=e.options.findIndex(ge=>fn(W.value(ge),Y))}C(ee)}Ot(ee)}function ca(D,ee){r.value===!0&&M.innerLoading.value===!1&&(C(-1,!0),qt(()=>{r.value===!0&&M.innerLoading.value===!1&&(D>ee?C():hi(!0))}))}function fo(){a.value===!1&&se.value!==null&&se.value.updatePosition()}function ho(D){D!==void 0&&dn(D),n("popupShow",D),M.hasPopupOpen=!0,M.onControlFocusin(D)}function mo(D){D!==void 0&&dn(D),n("popupHide",D),M.hasPopupOpen=!1,M.onControlFocusout(D)}function go(){A=o.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?t["no-option"]!==void 0||e.onFilter!==void 0||Te.value===!1:!0),E=o.platform.is.ios===!0&&A===!0&&e.useInput===!0?"fade":e.transitionShow}return ba(go),ka(fo),go(),Ht(()=>{k!==null&&clearTimeout(k),w!==null&&clearTimeout(w)}),Object.assign(i,{showPopup:un,hidePopup:Kt,removeAtIndex:be,add:ft,toggleOption:_t,getOptionIndex:()=>s.value,setOptionIndex:Ot,moveOptionSelection:an,filter:sn,updateMenuPosition:fo,updateInputValue:Sn,isOptionSelected:fi,getEmittingOptionValue:qe,isOptionDisabled:(...D)=>fe.value.apply(null,D)===!0,getOptionValue:(...D)=>W.value.apply(null,D),getOptionLabel:(...D)=>te.value.apply(null,D)}),Object.assign(M,{innerValue:N,fieldClass:U(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:ce,targetRef:ne,hasValue:ae,showPopup:un,floatingLabel:U(()=>e.hideSelected!==!0&&ae.value===!0||typeof l.value=="number"||l.value.length!==0||ko(e.displayValue)),getControlChild:()=>{if(M.editable.value!==!1&&(a.value===!0||Te.value!==!0||t["no-option"]!==void 0))return A===!0?aa():ta();M.hasPopupOpen===!0&&(M.hasPopupOpen=!1)},controlEvents:{onFocusin(D){M.onControlFocusin(D)},onFocusout(D){M.onControlFocusout(D,()=>{cn(),ln()})},onClick(D){if(yi(D),A!==!0&&r.value===!0){ln(),ne.value!==null&&ne.value.focus();return}un(D)}},getControl:D=>{const ee=Jr(),Y=D===!0||a.value!==!0||A!==!0;if(e.useInput===!0)ee.push(ea(D,Y));else if(M.editable.value===!0){const Ae=Y===!0?Re.value:void 0;ee.push(z("input",{ref:Y===!0?ne:void 0,key:"d_t",class:"q-select__focus-target",id:Y===!0?M.targetUid.value:void 0,value:Le.value,readonly:!0,"data-autofocus":D===!0||e.autofocus===!0||void 0,...Ae,onKeydown:so,onKeyup:oo,onKeypress:ao})),Y===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&ee.push(z("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:ro}))}if(v.value!==void 0&&e.disable!==!0&&$e.value.length!==0){const Ae=$e.value.map(Me=>z("option",{value:Me,selected:!0}));ee.push(z("select",{class:"hidden",name:v.value,multiple:e.multiple},Ae))}const ge=e.useInput===!0||Y!==!0?void 0:M.splitAttrs.attributes.value;return z("div",{class:"q-field__native row items-center",...ge,...M.splitAttrs.listeners.value},ee)},getInnerAppend:()=>e.loading!==!0&&f.value!==!0&&e.hideDropdownIcon!==!0?[z(de,{class:"q-select__dropdown-icon"+(r.value===!0?" rotate-180":""),name:Rt.value})]:null}),sr(M)}});const yt=Da("camera",{state:()=>({camera:{data:null,show:!1,camera:"auto"},hasCamera:function(){navigator.permissions.query({name:"camera"}).then(e=>e.state=="granted")}}),actions:{closeCamera:function(){this.camera.show=!1},showCamera:function(){this.camera.show=!0}}}),fl=Je({name:"MintInfoDialog",mixins:[windowMixin],components:{VueQrcode:hr},data:function(){return{contactIcons:{email:"mail_outline"},contactMethods:{twitter:"X",nostr:"Nostr"}}},computed:{...Se(xe,["showMintInfoData"]),...De(xe,["showMintInfoDialog"])},methods:{shortenText:function(e,t){return e.length>t?e.substring(0,t)+"...":e}}}),hl={class:"text-center q-mb-md q-mt-none q-pt-none"},ml={class:"row justify-center"},gl={class:"row justify-center"},vl={key:0,class:"row justify-center q-pt-sm"},pl={key:1,class:"row justify-center q-pt-sm"},yl={key:2,class:"row justify-center q-pt-sm"},wl={key:3,class:"row justify-center q-pt-sm"},_l={key:4,class:"row justify-center q-pt-sm"},bl={key:0,class:"justify-center"},kl={key:1,class:"text-weight-bold q-mr-xs"},Dl={class:"row q-mt-lg"};function Cl(e,t,n,i,o,r){const a=Ee("vue-qrcode");return $(),Q(st,{modelValue:e.showMintInfoDialog,"onUpdate:modelValue":t[1]||(t[1]=s=>e.showMintInfoDialog=s),position:"top","backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[e.showMintInfoData?($(),Q(dt,{key:0,class:"q-px-lg q-pt-md q-pb-md qcard"},{default:y(()=>[P("div",hl,[h(Fi,{ratio:1,class:"q-mx-md q-mt-none q-pt-none"},{default:y(()=>[h(a,{value:e.showMintInfoData.url,options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1}),P("div",ml,[P("div",gl,[h(mn,{outline:"",class:"q-pa-md q-mt-md"},{default:y(()=>[h(de,{name:"account_balance",size:"xs",class:"q-mr-xs"}),O(" "+me(e.showMintInfoData.url),1)]),_:1})]),h(St,{class:"q-pa-sm"},{default:y(()=>[e.showMintInfoData.info.name?($(),J("div",vl,[e.showMintInfoData.info.name?($(),Q(we,{key:0,caption:"",class:"text-weight-bold text-white",style:{"font-size":"16px"}},{default:y(()=>[O(me(e.showMintInfoData.info.name),1)]),_:1})):Z("",!0)])):Z("",!0),e.showMintInfoData.info.description?($(),J("div",pl,[e.showMintInfoData.info.description?($(),Q(we,{key:0,caption:"",class:"text-white",style:{"font-size":"12px"}},{default:y(()=>[O(me(e.showMintInfoData.info.description),1)]),_:1})):Z("",!0)])):Z("",!0),e.showMintInfoData.info.description_long?($(),J("div",yl,[e.showMintInfoData.info.description_long?($(),Q(we,{key:0,caption:"",class:"text-weight-light text-white",style:{"font-size":"12px"}},{default:y(()=>[O(me(e.showMintInfoData.info.description_long),1)]),_:1})):Z("",!0)])):Z("",!0),e.showMintInfoData.info.version?($(),J("div",wl,[e.showMintInfoData.info.version?($(),Q(we,{key:0,caption:"",class:"text-weight-light text-white",style:{"font-size":"10px"}},{default:y(()=>[O(" Version: "+me(e.showMintInfoData.info.version),1)]),_:1})):Z("",!0)])):Z("",!0),e.showMintInfoData.info.nuts?($(),J("div",_l,[e.showMintInfoData.info.nuts?($(),Q(we,{key:0,caption:"",class:"text-weight-light text-white",style:{"font-size":"10px"}},{default:y(()=>[O(" Nuts: "+me(Object.keys(e.showMintInfoData.info.nuts).join(", ")),1)]),_:1})):Z("",!0)])):Z("",!0)]),_:1}),h(St,null,{default:y(()=>[e.showMintInfoData.info.contact&&e.showMintInfoData.info.contact.length>0?($(),J("div",bl,[($(!0),J(ct,null,Et(e.showMintInfoData.info.contact,s=>($(),J("div",{key:s.method,class:"row justify-center q-pt-sm"},[h(we,{caption:"",class:"text-weight-light text-white",style:{"font-size":"12px"}},{default:y(()=>[e.contactIcons[s.method]?($(),Q(de,{key:0,name:e.contactIcons[s.method],size:"xs",class:"q-mr-xs"},null,8,["name"])):($(),J("span",kl,me(e.contactMethods[s.method]),1)),O(" "+me(e.shortenText(s.info,30))+" ",1),h(de,{name:"content_copy",onClick:l=>e.copyText(s.info),size:"1em",color:"grey",class:"q-mr-xs cursor-pointer"},null,8,["onClick"])]),_:2},1024)]))),128))])):Z("",!0)]),_:1})]),P("div",Dl,[h(H,{class:"q-mx-xs",size:"md",flat:"",onClick:t[0]||(t[0]=s=>e.copyText(e.showMintInfoData.url))},{default:y(()=>[O("Copy URL")]),_:1}),ze(($(),Q(H,{flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])])]),_:1})):Z("",!0)]),_:1},8,["modelValue"])}var Sl=He(fl,[["render",Cl]]);const Ii=Ca({events:{},on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},off(e,t){!this.events[e]||(this.events[e]=this.events[e].filter(n=>n!==t))},emit(e,t){console.log("eventBus emit",e,t),this.events[e]&&this.events[e].forEach(n=>n(t))}}),Pl=Je({name:"MintSettings",mixins:[windowMixin],components:{MintDetailsDialog:Sl},props:{tickerShort:String},setup(){const e=he(null),t=()=>{if(e.value){const n=e.value.getBoundingClientRect();window.scrollTo({top:window.scrollY+n.top,behavior:"smooth"})}};return pn(()=>{Ii.on("scrollToAddMintDiv",t)}),Ht(()=>{Ii.off("scrollToAddMintDiv",t)}),{addMintDiv:e}},data:function(){return{discoveringMints:!1,addingMint:!1,hideMnemonic:!0,confirmMnemonic:!1,swapData:{from_url:"",to_url:"",amount:0},mintToEdit:{url:"",nickname:""},mintToRemove:{url:"",nickname:"",balances:{}},editMintData:{url:"",nickname:""},addMintDialog:{show:!1},showEditMintDialog:!1,swapBlocking:!1}},computed:{...De(ti,["getBitcoinPrice","checkSentTokens"]),...Se(Gt,["p2pkKeys"]),...Se(xe,["activeMintUrl","mints","activeProofs","addMintBlocking"]),...Se(Do,["pubkey","mintRecommendations"]),...Se(Ze,["mnemonic"]),...Se(Yt,["invoiceWorkerRunning"]),...De(xe,["addMintData","showAddMintDialog","showRemoveMintDialog","showMintInfoDialog","showMintInfoData"]),hiddenMnemonic(){return this.hideMnemonic?this.mnemonic.split(" ").map(e=>"*".repeat(e.length)).join(" "):this.mnemonic}},watch:{invoiceWorkerRunning:function(e){this.swapBlocking&&!e&&(this.swapBlocking=!1)}},methods:{...ye(Do,["init","initNdkReadOnly","getUserPubkey","fetchEventsFromUser","fetchMints"]),...ye(Gt,["generateKeypair","showKeyDetails"]),...ye(xe,["addMint","removeMint","activateMintUrl","updateMint"]),...ye(Ze,["newMnemonic","decodeRequest","checkProofsSpendable","requestMint","melt"]),...ye(Yt,["clearAllWorkers","invoiceCheckWorker","checkTokenSpendableWorker"]),...ye(yt,["closeCamera","showCamera"]),editMint:function(e){this.mintToEdit=Object.assign({},e),this.editMintData=Object.assign({},e),this.showEditMintDialog=!0},validateMintUrl:function(e){try{return new URL(e),!0}catch{return!1}},sanitizeMintUrlAndShowAddDialog:function(){if(this.addMintData.url.match(/^[a-zA-Z]+:\/\//)||(this.addMintData.url="https://"+this.addMintData.url),!this.validateMintUrl(this.addMintData.url)){qo("Invalid URL");return}let e=new URL(this.addMintData.url);e.hostname=e.hostname.toLowerCase(),this.addMintData.url=e.toString(),this.addMintData.url=this.addMintData.url.replace(/\/$/,""),this.showAddMintDialog=!0},addMintInternal:function(e,t){this.addingMint=!0;try{this.addMint(e,t)}finally{this.addingMint=!1}},generateNewMnemonic(){this.newMnemonic()},toggleMnemonicVisibility:function(){this.hideMnemonic=!this.hideMnemonic},mintClass(e){return new dr(e)},swapDataOptions:function(){let e=[];for(const[t,n]of Object.entries(this.mints))e.push({url:n.url,shorturl:n.nickname||Tt(n.url)});return e},showRemoveMintDialogWrapper:function(e){let t=this.mints.find(n=>n.url==e);this.mintToRemove=t,this.showRemoveMintDialog=!0},mintSwap:async function(e,t,n){if(this.swapBlocking){cs("Swap in progress");return}this.swapBlocking=!0;try{await this.activateMintUrl(t);let i=await this.requestMint(n);await this.activateMintUrl(e),await this.decodeRequest(i.request),await this.melt(),await this.activateMintUrl(t),await this.invoiceCheckWorker()}catch(i){console.error("Error swapping",i),qo("Error swapping")}},enable_terminal:function(){var e=document.createElement("script");e.src="//cdn.jsdelivr.net/npm/eruda",document.body.appendChild(e),e.onload=function(){eruda.init()}},getLocalstorageToFile:async function(){const e=`cashu_backup_${ds()}.json`;for(var t={},n=0;n<localStorage.length;n++){var i=localStorage.key(n),o=localStorage.getItem(i);t[i]=o}var r=JSON.stringify(t),a=new Blob([r],{type:"text/plain"}),s=window.URL.createObjectURL(a),l=document.createElement("a");l.download=e,l.innerHTML="Download File",l.href=s,l.onclick=function(){document.body.removeChild(event.target)},l.style.display="none",document.body.appendChild(l),l.click()},toggleGetBitcoinPrice:function(){this.getBitcoinPrice=!this.getBitcoinPrice},checkActiveProofsSpendable:async function(){let e=this.activeProofs.flat();console.log("Checking proofs",e);let t=[],n=50;for(let o=0;o<e.length;o+=n){console.log("Checking proofs",o,o+n);let r=e.slice(o,o+n),a=await this.checkProofsSpendable(r,!0);t.push(a)}let i=t.flat();i.length>0?(console.log("Spent proofs",i),this.notifySuccess("Removed "+i.length+" spent proofs")):this.notifySuccess("No spent proofs found")},initNdk:async function(){await this.initNdkReadOnly(),console.log(await this.getUserPubkey())},fetchMintsFromNdk:async function(){this.discoveringMints=!0,await this.initNdkReadOnly(),console.log("### fetch mints");let e=5,t=0,n=[];for(;n.length==0&&t<e;){try{n=await this.fetchMints()}catch(i){console.log("Error fetching mints",i)}t++}n.length==0?this.notifyError("No mints found"):this.notifySuccess("Found "+n.length+" mints"),console.log(n),this.discoveringMints=!1},showMintInfo:async function(e){this.showMintInfoData=e,this.showMintInfoDialog=!0}},created:function(){}}),ql={style:{"max-width":"800px",margin:"0 auto"}},Tl={class:"q-py-md q-px-xs text-left","on-left":""},Ml={class:"q-pt-xs q-px-xs",ref:"addMintDiv"},xl={class:"row-12 text-left"},$l={class:"row-12"},Al={class:"row-12"},El={class:"row-12"},Il={class:"q-py-sm q-px-xs text-left","on-left":""},Rl={key:1},Ll=P("a",{href:"https://bitcoinmints.com",target:"_blank",class:"text-primary"},"bitcoinmints.com",-1),Ol={class:"q-py-sm q-px-xs text-left","on-left":""},Ul=P("h6",{class:"q-my-md"},"Edit mint",-1),Nl={class:"row q-mt-lg"},Vl=P("h6",{class:"q-my-md"},"Do you trust this mint?",-1),Bl=P("p",null," A Cashu mint controls the funds you send to it. Make sure that you trust the operator of this mint. ",-1),Fl={class:"row q-mt-lg"},zl={class:"col"},jl={class:"col"},Wl=P("h6",{class:"q-my-md"},"Are you sure you want to delete this mint?",-1),Hl={key:0},Ql=P("span",{class:"text-weight-bold"}," Nickname: ",-1),Kl={class:"text-weight-light"},Xl={class:"row q-my-md"},Gl={class:"col"},Yl=P("span",{class:"text-weight-bold"},"Balances:",-1),Zl=P("div",{class:"row q-my-md"},[P("div",{class:"col"},[P("span",{class:"text-caption"},"Note: Because this wallet is paranoid, your ecash from this mint will not be actually deleted but will remain stored on your device. You will see it reappear if you re-add this mint later again.")])],-1),Jl={class:"row q-mt-lg"},eu={class:"col"},tu={class:"col"};function nu(e,t,n,i,o,r){const a=Ee("MintDetailsDialog");return $(),J(ct,null,[h(a),P("div",ql,[P("div",Tl,[h(hn,{padding:""},{default:y(()=>[h(et,null,{default:y(()=>[h(Be,null,{default:y(()=>[h(we,{overline:""},{default:y(()=>[O("Mints")]),_:1})]),_:1})]),_:1}),($(!0),J(ct,null,Et(e.mints,s=>($(),J("div",{key:s.url},[h(et,{active:s.url==e.activeMintUrl,"active-class":"text-weight-bold text-primary",clickable:""},{default:y(()=>[h(Be,{avatar:""},{default:y(()=>[h(de,{color:s.url==e.activeMintUrl?"primary":"grey",name:s.url==e.activeMintUrl?"check_circle":"radio_button_unchecked",onClick:l=>e.activateMintUrl(s.url,e.verbose=!1,e.force=!0),class:"cursor-pointer"},null,8,["color","name","onClick"])]),_:2},1024),h(Be,null,{default:y(()=>[s.nickname?($(),Q(we,{key:0,lines:"1",onClick:l=>e.activateMintUrl(s.url,e.verbose=!1,e.force=!1),class:"cursor-pointer",style:{"word-break":"break-word"}},{default:y(()=>[O(me(s.nickname),1)]),_:2},1032,["onClick"])):Z("",!0),h(we,{lines:"1",onClick:l=>e.activateMintUrl(s.url,e.verbose=!1,e.force=!1),class:"cursor-pointer",style:{"word-break":"break-word"}},{default:y(()=>[O(me(s.url),1)]),_:2},1032,["onClick"]),h(we,null,{default:y(()=>[($(!0),J(ct,null,Et(e.mintClass(s).units,l=>($(),Q(Ft,{key:l,color:s.url==e.activeMintUrl?"primary":"grey",label:e.formatCurrency(e.mintClass(s).unitBalance(l),l),class:"q-mx-xs"},null,8,["color","label"]))),128))]),_:2},1024)]),_:2},1024),h(Be,{side:"",class:"q-mx-none q-pl-none"},{default:y(()=>[h(de,{name:"info_outline",onClick:l=>e.showMintInfo(s),color:"grey",class:"q-mr-xs cursor-pointer"},null,8,["onClick"])]),_:2},1024),h(Be,{side:""},{default:y(()=>[h(de,{name:"edit",onClick:l=>e.editMint(s),class:"cursor-pointer"},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["active"]),h(zi,{spaced:"",inset:"item"})]))),128))]),_:1})]),P("div",Ml,[h(hn,{padding:""},{default:y(()=>[P("div",xl,[h(et,null,{default:y(()=>[h(Be,null,{default:y(()=>[h(we,{overline:""},{default:y(()=>[O("Add mint")]),_:1}),h(we,{caption:""},{default:y(()=>[O("Enter the URL of a Cashu mint to connect to it. This wallet is not affiliated with any mint. ")]),_:1})]),_:1})]),_:1})]),P("div",$l,[h(tt,{"bottom-slots":"",rounded:"",dense:"",outlined:"",onKeydown:Bt(wi(e.sanitizeMintUrlAndShowAddDialog,["prevent"]),["enter"]),modelValue:e.addMintData.url,"onUpdate:modelValue":t[0]||(t[0]=s=>e.addMintData.url=s),placeholder:"https://",ref:"mintInput",class:"q-pb-none q-mb-sm q-px-md"},null,8,["onKeydown","modelValue"])]),P("div",Al,[h(tt,{"bottom-slots":"",rounded:"",dense:"",outlined:"",onKeydown:Bt(wi(e.sanitizeMintUrlAndShowAddDialog,["prevent"]),["enter"]),modelValue:e.addMintData.nickname,"onUpdate:modelValue":t[1]||(t[1]=s=>e.addMintData.nickname=s),label:"Nickname (e.g. Testnet)",ref:"mintNicknameInput",class:"q-pb-sm q-px-md"},null,8,["onKeydown","modelValue"])]),P("div",El,[e.addMintData.url.length==0?($(),Q(H,{key:0,rounded:"",class:"q-px-lg q-mt-xs",color:"primary",onClick:e.showCamera},{default:y(()=>[h(de,{size:"xs",name:"qr_code",class:"q-pr-xs"}),O(" Scan QR code ")]),_:1},8,["onClick"])):Z("",!0),e.addMintData.url.length>0?($(),Q(H,{key:1,rounded:"",class:"q-px-lg q-mt-xs",color:"primary",disabled:e.addMintData.url.length==0,loading:e.addMintBlocking,onClick:e.sanitizeMintUrlAndShowAddDialog},{loading:y(()=>[h(It),O(" Adding mint ")]),default:y(()=>[h(de,{size:"xs",name:"add",class:"q-pr-xs"}),O(" Add mint ")]),_:1},8,["disabled","loading","onClick"])):Z("",!0)])]),_:1})],512),P("div",Il,[h(hn,{padding:""},{default:y(()=>[h(et,null,{default:y(()=>[h(Be,null,{default:y(()=>[h(we,{overline:""},{default:y(()=>[O("Discover")]),_:1}),h(we,{caption:""},{default:y(()=>[O("Discover mints other users have recommended on nostr.")]),_:1})]),_:1})]),_:1}),Z("",!0),h(et,null,{default:y(()=>[h(H,{class:"q-ml-sm q-px-md",color:"primary",rounded:"",outline:"",loading:e.discoveringMints,onClick:e.fetchMintsFromNdk},{loading:y(()=>[h(It,{class:"on-left"}),O(" Loading... ")]),default:y(()=>[O("Discover mints ")]),_:1},8,["loading","onClick"])]),_:1}),e.mintRecommendations.length>0?($(),J("div",Rl,[h(et,null,{default:y(()=>[h(Be,null,{default:y(()=>[h(we,{overline:""},{default:y(()=>[O("Found "+me(e.mintRecommendations.length)+" mints",1)]),_:1}),h(we,{caption:""},{default:y(()=>[O("These mints were recommended by other Nostr users. Read reviews at "),Ll,O(". Be careful and do your own research before using a mint. ")]),_:1})]),_:1})]),_:1}),h(cr,{dense:"","dense-toggle":"",class:"text-left",label:"Click to browse mints"},{default:y(()=>[($(!0),J(ct,null,Et(e.mintRecommendations,s=>($(),Q(et,{key:s.url},{default:y(()=>[h(Be,{class:"q-mx-none q-pl-none",style:{"max-width":"1.05em"}},{default:y(()=>[h(de,{name:"content_copy",onClick:l=>e.copyText(s.url),size:"1em",color:"grey",class:"q-mr-xs cursor-pointer"},null,8,["onClick"])]),_:2},1024),h(Be,null,{default:y(()=>[h(we,{caption:"",style:{"word-break":"break-word"}},{default:y(()=>[O(me(s.url),1)]),_:2},1024)]),_:2},1024),h(Be,{side:""},{default:y(()=>[h(Ft,{label:s.count,color:"primary"},null,8,["label"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):Z("",!0)]),_:1})]),P("div",Ol,[h(hn,{padding:""},{default:y(()=>[h(et,null,{default:y(()=>[h(Be,null,{default:y(()=>[h(we,{overline:""},{default:y(()=>[O("Multimint Swaps")]),_:1}),h(we,{caption:""},{default:y(()=>[O("Swap funds from one mint to another via Lightning. Note: This is an experimental feature and should be used carefully. Leave room for potential Lightning fees. If the incoming payment does not succeed, check the incoming pending invoice manually by clicking the refresh button. ")]),_:1})]),_:1})]),_:1}),h(et,null,{default:y(()=>[h(Ei,{clearable:"",rounded:"",outlined:"",dense:"",color:"primary",modelValue:e.swapData.from_url,"onUpdate:modelValue":t[2]||(t[2]=s=>e.swapData.from_url=s),options:e.swapDataOptions(),"option-value":"url","option-label":"shorturl",label:"From",style:{"min-width":"200px",width:"100%"}},null,8,["modelValue","options"])]),_:1}),h(et,null,{default:y(()=>[h(Ei,{clearable:"",rounded:"",outlined:"",dense:"",color:"primary",modelValue:e.swapData.to_url,"onUpdate:modelValue":t[3]||(t[3]=s=>e.swapData.to_url=s),options:e.swapDataOptions(),"option-value":"url","option-label":"shorturl",label:"To",style:{"min-width":"200px",width:"100%"}},null,8,["modelValue","options"])]),_:1}),h(et,null,{default:y(()=>[h(tt,{rounded:"",outlined:"",dense:"",modelValue:e.swapData.amount,"onUpdate:modelValue":t[4]||(t[4]=s=>e.swapData.amount=s),modelModifiers:{number:!0},type:"number",label:"Amount ("+e.tickerShort+")",style:{"min-width":"200px"}},null,8,["modelValue","label"]),h(H,{class:"q-ml-sm q-px-md",color:"primary",rounded:"",onClick:t[5]||(t[5]=s=>e.mintSwap(e.swapData.from_url.url,e.swapData.to_url.url,e.swapData.amount)),disable:!e.swapData.from_url||!e.swapData.to_url||!(e.swapData.amount>0)||e.swapData.from_url==e.swapData.to_url,loading:e.swapBlocking},{loading:y(()=>[h(It,{size:"xs"}),O(" Swap ")]),default:y(()=>[h(de,{size:"xs",name:"swap_horiz",class:"q-pr-xs"}),O(" Swap ")]),_:1},8,["disable","loading"])]),_:1})]),_:1})]),h(st,{modelValue:e.showEditMintDialog,"onUpdate:modelValue":t[10]||(t[10]=s=>e.showEditMintDialog=s),"backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(dt,{class:"q-pa-lg",style:{"max-width":"500px",width:"100%"}},{default:y(()=>[Ul,h(tt,{outlined:"",modelValue:e.editMintData.url,"onUpdate:modelValue":t[6]||(t[6]=s=>e.editMintData.url=s),label:"Mint URL",type:"textarea",autogrow:"",class:"q-mb-xs"},null,8,["modelValue"]),h(tt,{outlined:"",modelValue:e.editMintData.nickname,"onUpdate:modelValue":t[7]||(t[7]=s=>e.editMintData.nickname=s),label:"Nickname",type:"textarea",autogrow:"",class:"q-mb-xs"},null,8,["modelValue"]),P("div",Nl,[ze(($(),Q(H,{class:"float-left",color:"primary",onClick:t[8]||(t[8]=s=>e.updateMint(e.mintToEdit,e.editMintData))},{default:y(()=>[O("Update")]),_:1})),[[We]]),h(H,{icon:"delete",flat:"",class:"float-left item-left text-left",onClick:t[9]||(t[9]=s=>e.showRemoveMintDialogWrapper(e.mintToEdit.url))}),ze(($(),Q(H,{flat:"",class:"q-ml-auto",color:"grey"},{default:y(()=>[O("Cancel")]),_:1})),[[We]])])]),_:1})]),_:1},8,["modelValue"]),h(st,{modelValue:e.showAddMintDialog,"onUpdate:modelValue":t[13]||(t[13]=s=>e.showAddMintDialog=s),onKeydown:t[14]||(t[14]=Bt(wi(s=>e.addMintInternal(e.addMintData,e.verbose=!0),["prevent"]),["enter"])),"backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(dt,{class:"q-pa-lg"},{default:y(()=>[Vl,Bl,h(tt,{outlined:"",readonly:"",modelValue:e.addMintData.url,"onUpdate:modelValue":t[11]||(t[11]=s=>e.addMintData.url=s),label:"Mint URL",type:"textarea",autogrow:"",class:"q-mb-xs"},null,8,["modelValue"]),P("div",Fl,[P("div",zl,[ze(($(),Q(H,{class:"float-left",color:"primary",icon:"check",loading:e.addMintBlocking,onClick:t[12]||(t[12]=s=>e.addMintInternal(e.addMintData,e.verbose=!0))},{loading:y(()=>[h(It),O(" Adding mint ")]),default:y(()=>[O("Add mint ")]),_:1},8,["loading"])),[[We]])]),P("div",jl,[ze(($(),Q(H,{flat:"",class:"float-right",color:"grey"},{default:y(()=>[O("Cancel")]),_:1})),[[We]])])])]),_:1})]),_:1},8,["modelValue"]),h(st,{modelValue:e.showRemoveMintDialog,"onUpdate:modelValue":t[17]||(t[17]=s=>e.showRemoveMintDialog=s),"backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(dt,{class:"q-pa-lg"},{default:y(()=>[Wl,e.mintToRemove.nickname?($(),J("div",Hl,[Ql,P("span",Kl,me(e.mintToRemove.nickname),1)])):Z("",!0),P("div",Xl,[P("div",Gl,[Yl,($(!0),J(ct,null,Et(e.mintClass(e.mintToRemove).units,s=>($(),Q(Ft,{key:s,color:"primary",label:e.formatCurrency(e.mintClass(e.mintToRemove).unitBalance(s),s),class:"q-mx-xs"},null,8,["label"]))),128))])]),h(tt,{outlined:"",readonly:"",modelValue:e.mintToRemove.url,"onUpdate:modelValue":t[15]||(t[15]=s=>e.mintToRemove.url=s),label:"Mint URL",type:"textarea",autogrow:"",class:"q-mb-xs"},null,8,["modelValue"]),Zl,P("div",Jl,[P("div",eu,[ze(($(),Q(H,{class:"float-left",color:"primary",onClick:t[16]||(t[16]=s=>{e.showEditMintDialog=!1,e.removeMint(e.mintToRemove.url,e.verbose=!0)})},{default:y(()=>[O("Remove mint")]),_:1})),[[We]])]),P("div",tu,[ze(($(),Q(H,{flat:"",color:"grey",class:"float-right"},{default:y(()=>[O("Cancel")]),_:1})),[[We]])])])]),_:1})]),_:1},8,["modelValue"])])],64)}var iu=He(Pl,[["render",nu]]);function Fn(e,t){return[!0,!1].includes(e)?e:t}var _r=it({name:"QPagination",props:{...yn,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>(typeof e=="string"?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>e===""||Sa.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:t}){const{proxy:n}=ut(),{$q:i}=n,o=wn(e,i),r=U(()=>parseInt(e.min,10)),a=U(()=>parseInt(e.max,10)),s=U(()=>parseInt(e.maxPages,10)),l=U(()=>A.value+" / "+a.value),g=U(()=>Fn(e.boundaryLinks,e.input)),f=U(()=>Fn(e.boundaryNumbers,!e.input)),k=U(()=>Fn(e.directionLinks,e.input)),w=U(()=>Fn(e.ellipses,!e.input)),S=he(null),A=U({get:()=>e.modelValue,set:m=>{if(m=parseInt(m,10),e.disable||isNaN(m))return;const b=ps(m,r.value,a.value);e.modelValue!==b&&t("update:modelValue",b)}});je(()=>`${r.value}|${a.value}`,()=>{A.value=e.modelValue});const L=U(()=>"q-pagination row no-wrap items-center"+(e.disable===!0?" disabled":"")),I=U(()=>e.gutter in po?`${po[e.gutter]}px`:e.gutter||null),j=U(()=>I.value!==null?`--q-pagination-gutter-parent:-${I.value};--q-pagination-gutter-child:${I.value}`:null),E=U(()=>{const m=[e.iconFirst||i.iconSet.pagination.first,e.iconPrev||i.iconSet.pagination.prev,e.iconNext||i.iconSet.pagination.next,e.iconLast||i.iconSet.pagination.last];return i.lang.rtl===!0?m.reverse():m}),B=U(()=>({"aria-disabled":e.disable===!0?"true":"false",role:"navigation"})),F=U(()=>Pa(e,"flat")),ce=U(()=>({[F.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:e.ripple!==null?e.ripple:!0})),ne=U(()=>{const m={[F.value]:!1};return e.activeDesign!==""&&(m[e.activeDesign]=!0),m}),se=U(()=>({...ne.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor})),u=U(()=>{let m=Math.max(s.value,1+(w.value?2:0)+(f.value?2:0));const b={pgFrom:r.value,pgTo:a.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(a.value).length)}em`}};return s.value&&m<a.value-r.value+1&&(m=1+Math.floor(m/2)*2,b.pgFrom=Math.max(r.value,Math.min(a.value-m+1,e.modelValue-Math.floor(m/2))),b.pgTo=Math.min(a.value,b.pgFrom+m-1),f.value&&(b.boundaryStart=!0,b.pgFrom++),w.value&&b.pgFrom>r.value+(f.value?1:0)&&(b.ellipsesStart=!0,b.pgFrom++),f.value&&(b.boundaryEnd=!0,b.pgTo--),w.value&&b.pgTo<a.value-(f.value?1:0)&&(b.ellipsesEnd=!0,b.pgTo--)),b});function d(m){A.value=m}function v(m){A.value=A.value+m}const q=U(()=>{function m(){A.value=S.value,S.value=null}return{"onUpdate:modelValue":b=>{S.value=b},onKeyup:b=>{Oi(b,13)===!0&&m()},onBlur:m}});function p(m,b,_){const C={"aria-label":b,"aria-current":"false",...ce.value,...m};return _===!0&&Object.assign(C,{"aria-current":"true",...se.value}),b!==void 0&&(e.toFn!==void 0?C.to=e.toFn(b):C.onClick=()=>{d(b)}),z(H,C)}return Object.assign(n,{set:d,setByOffset:v}),()=>{const m=[],b=[];let _;if(g.value===!0&&(m.push(p({key:"bls",disable:e.disable||e.modelValue<=r.value,icon:E.value[0]},r.value)),b.unshift(p({key:"ble",disable:e.disable||e.modelValue>=a.value,icon:E.value[3]},a.value))),k.value===!0&&(m.push(p({key:"bdp",disable:e.disable||e.modelValue<=r.value,icon:E.value[1]},e.modelValue-1)),b.unshift(p({key:"bdn",disable:e.disable||e.modelValue>=a.value,icon:E.value[2]},e.modelValue+1))),e.input!==!0){_=[];const{pgFrom:C,pgTo:x,marginalStyle:T}=u.value;if(u.value.boundaryStart===!0){const R=r.value===e.modelValue;m.push(p({key:"bns",style:T,disable:e.disable,label:r.value},r.value,R))}if(u.value.boundaryEnd===!0){const R=a.value===e.modelValue;b.unshift(p({key:"bne",style:T,disable:e.disable,label:a.value},a.value,R))}u.value.ellipsesStart===!0&&m.push(p({key:"bes",style:T,disable:e.disable,label:"\u2026",ripple:!1},C-1)),u.value.ellipsesEnd===!0&&b.unshift(p({key:"bee",style:T,disable:e.disable,label:"\u2026",ripple:!1},x+1));for(let R=C;R<=x;R++)_.push(p({key:`bpg${R}`,style:T,disable:e.disable,label:R},R,R===e.modelValue))}return z("div",{class:L.value,...B.value},[z("div",{class:"q-pagination__content row no-wrap items-center",style:j.value},[...m,e.input===!0?z(tt,{class:"inline",style:{width:`${l.value.length/1.5}em`},type:"number",dense:!0,value:S.value,disable:e.disable,dark:o.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:l.value,min:r.value,max:a.value,...q.value}):z("div",{class:"q-pagination__middle row justify-center"},_),...b])])}}});function Ye(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function ou(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const br=6e4,kr=36e5,zn=43200,Ro=1440;let ru={};function au(){return ru}function Lo(e){const t=Ye(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Yn(e,t){const n=Ye(e),i=Ye(t),o=n.getTime()-i.getTime();return o<0?-1:o>0?1:o}function su(e){return ou(e,Date.now())}function lu(e,t){const n=Ye(e),i=Ye(t),o=n.getFullYear()-i.getFullYear(),r=n.getMonth()-i.getMonth();return o*12+r}function uu(e){return t=>{const i=(e?Math[e]:Math.trunc)(t);return i===0?0:i}}function cu(e,t){return+Ye(e)-+Ye(t)}function du(e){const t=Ye(e);return t.setHours(23,59,59,999),t}function fu(e){const t=Ye(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function hu(e){const t=Ye(e);return+du(t)==+fu(t)}function mu(e,t){const n=Ye(e),i=Ye(t),o=Yn(n,i),r=Math.abs(lu(n,i));let a;if(r<1)a=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*r);let s=Yn(n,i)===-o;hu(Ye(e))&&r===1&&Yn(e,i)===1&&(s=!1),a=o*(r-Number(s))}return a===0?0:a}function gu(e,t,n){const i=cu(e,t)/1e3;return uu(n?.roundingMethod)(i)}const vu={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},pu=(e,t,n)=>{let i;const o=vu[e];return typeof o=="string"?i=o:t===1?i=o.one:i=o.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function Di(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const yu={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},wu={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},_u={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bu={date:Di({formats:yu,defaultWidth:"full"}),time:Di({formats:wu,defaultWidth:"full"}),dateTime:Di({formats:_u,defaultWidth:"full"})},ku={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Du=(e,t,n,i)=>ku[e];function Mn(e){return(t,n)=>{const i=n?.context?String(n.context):"standalone";let o;if(i==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,s=n?.width?String(n.width):a;o=e.formattingValues[s]||e.formattingValues[a]}else{const a=e.defaultWidth,s=n?.width?String(n.width):e.defaultWidth;o=e.values[s]||e.values[a]}const r=e.argumentCallback?e.argumentCallback(t):t;return o[r]}}const Cu={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Su={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Pu={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},qu={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Tu={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Mu={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},xu=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},$u={ordinalNumber:xu,era:Mn({values:Cu,defaultWidth:"wide"}),quarter:Mn({values:Su,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Mn({values:Pu,defaultWidth:"wide"}),day:Mn({values:qu,defaultWidth:"wide"}),dayPeriod:Mn({values:Tu,defaultWidth:"wide",formattingValues:Mu,defaultFormattingWidth:"wide"})};function xn(e){return(t,n={})=>{const i=n.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],r=t.match(o);if(!r)return null;const a=r[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?Eu(s,k=>k.test(a)):Au(s,k=>k.test(a));let g;g=e.valueCallback?e.valueCallback(l):l,g=n.valueCallback?n.valueCallback(g):g;const f=t.slice(a.length);return{value:g,rest:f}}}function Au(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Eu(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function Iu(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const o=i[0],r=t.match(e.parsePattern);if(!r)return null;let a=e.valueCallback?e.valueCallback(r[0]):r[0];a=n.valueCallback?n.valueCallback(a):a;const s=t.slice(o.length);return{value:a,rest:s}}}const Ru=/^(\d+)(th|st|nd|rd)?/i,Lu=/\d+/i,Ou={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Uu={any:[/^b/i,/^(a|c)/i]},Nu={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Vu={any:[/1/i,/2/i,/3/i,/4/i]},Bu={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Fu={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},zu={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},ju={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Wu={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Hu={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Qu={ordinalNumber:Iu({matchPattern:Ru,parsePattern:Lu,valueCallback:e=>parseInt(e,10)}),era:xn({matchPatterns:Ou,defaultMatchWidth:"wide",parsePatterns:Uu,defaultParseWidth:"any"}),quarter:xn({matchPatterns:Nu,defaultMatchWidth:"wide",parsePatterns:Vu,defaultParseWidth:"any",valueCallback:e=>e+1}),month:xn({matchPatterns:Bu,defaultMatchWidth:"wide",parsePatterns:Fu,defaultParseWidth:"any"}),day:xn({matchPatterns:zu,defaultMatchWidth:"wide",parsePatterns:ju,defaultParseWidth:"any"}),dayPeriod:xn({matchPatterns:Wu,defaultMatchWidth:"any",parsePatterns:Hu,defaultParseWidth:"any"})},Ku={code:"en-US",formatDistance:pu,formatLong:bu,formatRelative:Du,localize:$u,match:Qu,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Xu(e,t,n){const i=au(),o=n?.locale??i.locale??Ku,r=2520,a=Yn(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const s=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:a});let l,g;a>0?(l=Ye(t),g=Ye(e)):(l=Ye(e),g=Ye(t));const f=gu(g,l),k=(Lo(g)-Lo(l))/1e3,w=Math.round((f-k)/60);let S;if(w<2)return n?.includeSeconds?f<5?o.formatDistance("lessThanXSeconds",5,s):f<10?o.formatDistance("lessThanXSeconds",10,s):f<20?o.formatDistance("lessThanXSeconds",20,s):f<40?o.formatDistance("halfAMinute",0,s):f<60?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",1,s):w===0?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",w,s);if(w<45)return o.formatDistance("xMinutes",w,s);if(w<90)return o.formatDistance("aboutXHours",1,s);if(w<Ro){const A=Math.round(w/60);return o.formatDistance("aboutXHours",A,s)}else{if(w<r)return o.formatDistance("xDays",1,s);if(w<zn){const A=Math.round(w/Ro);return o.formatDistance("xDays",A,s)}else if(w<zn*2)return S=Math.round(w/zn),o.formatDistance("aboutXMonths",S,s)}if(S=mu(g,l),S<12){const A=Math.round(w/zn);return o.formatDistance("xMonths",A,s)}else{const A=S%12,L=Math.trunc(S/12);return A<3?o.formatDistance("aboutXYears",L,s):A<9?o.formatDistance("overXYears",L,s):o.formatDistance("almostXYears",L+1,s)}}function Dr(e,t){return Xu(e,su(e),t)}function Cr(e,t){const n=t?.additionalDigits??2,i=Ju(e);let o;if(i.date){const l=ec(i.date,n);o=tc(l.restDateString,l.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);const r=o.getTime();let a=0,s;if(i.time&&(a=nc(i.time),isNaN(a)))return new Date(NaN);if(i.timezone){if(s=ic(i.timezone),isNaN(s))return new Date(NaN)}else{const l=new Date(r+a),g=new Date(0);return g.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),g.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),g}return new Date(r+a+s)}const jn={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Gu=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Yu=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Zu=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ju(e){const t={},n=e.split(jn.dateTimeDelimiter);let i;if(n.length>2)return t;if(/:/.test(n[0])?i=n[0]:(t.date=n[0],i=n[1],jn.timeZoneDelimiter.test(t.date)&&(t.date=e.split(jn.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const o=jn.timezone.exec(i);o?(t.time=i.replace(o[1],""),t.timezone=o[1]):t.time=i}return t}function ec(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(n);if(!i)return{year:NaN,restDateString:""};const o=i[1]?parseInt(i[1]):null,r=i[2]?parseInt(i[2]):null;return{year:r===null?o:r*100,restDateString:e.slice((i[1]||i[2]).length)}}function tc(e,t){if(t===null)return new Date(NaN);const n=e.match(Gu);if(!n)return new Date(NaN);const i=!!n[4],o=$n(n[1]),r=$n(n[2])-1,a=$n(n[3]),s=$n(n[4]),l=$n(n[5])-1;if(i)return lc(t,s,l)?oc(t,s,l):new Date(NaN);{const g=new Date(0);return!ac(t,r,a)||!sc(t,o)?new Date(NaN):(g.setUTCFullYear(t,r,Math.max(o,a)),g)}}function $n(e){return e?parseInt(e):1}function nc(e){const t=e.match(Yu);if(!t)return NaN;const n=Ci(t[1]),i=Ci(t[2]),o=Ci(t[3]);return uc(n,i,o)?n*kr+i*br+o*1e3:NaN}function Ci(e){return e&&parseFloat(e.replace(",","."))||0}function ic(e){if(e==="Z")return 0;const t=e.match(Zu);if(!t)return 0;const n=t[1]==="+"?-1:1,i=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return cc(i,o)?n*(i*kr+o*br):NaN}function oc(e,t,n){const i=new Date(0);i.setUTCFullYear(e,0,4);const o=i.getUTCDay()||7,r=(t-1)*7+n+1-o;return i.setUTCDate(i.getUTCDate()+r),i}const rc=[31,null,31,30,31,30,31,31,30,31,30,31];function Sr(e){return e%400===0||e%4===0&&e%100!==0}function ac(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(rc[t]||(Sr(e)?29:28))}function sc(e,t){return t>=1&&t<=(Sr(e)?366:365)}function lc(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function uc(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function cc(e,t){return t>=0&&t<=59}const dc=Je({name:"InvoicesTable",mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5,filterPending:!1}},watch:{filterPending:function(){this.currentPage=1}},computed:{...De(lt,["showInvoiceDetails"]),...De(Ze,["invoiceHistory","invoiceData","payInvoiceData"]),maxPages(){return Math.ceil(this.invoiceHistory.length/this.pageSize)},paginatedInvoices(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filterPending?this.invoiceHistory.filter(n=>n.status==="pending").slice(e,t):this.invoiceHistory.slice().reverse().slice(e,t)}},methods:{...ye(Ze,["checkInvoice","checkOutgoingInvoice"]),shortenString:function(e){return ji(e,20,10)},handlePageChange(e){this.currentPage=e},showInvoiceDialog(e){this.invoiceData=e,this.showInvoiceDetails=!0},formattedDate(e){const t=Cr(e);return Dr(t,{addSuffix:!1})}},created:function(){}}),fc={style:{"max-width":"1000px",margin:"0 auto"}},hc={class:"q-pa-xs",style:{"max-width":"500px",margin:"0 auto"}},mc={class:"text-center q-mt-lg"},gc={key:0,class:"text-center q-mt-lg"},vc={key:1,class:"text-center q-mt-lg"},pc={style:{display:"flex","justify-content":"center"}};function yc(e,t,n,i,o,r){return $(),J("div",fc,[P("div",hc,[h(hn,null,{default:y(()=>[($(!0),J(ct,null,Et(e.paginatedInvoices,a=>($(),Q(et,{key:a.id},{default:y(()=>[h(Be,{side:"",onClick:s=>e.showInvoiceDialog(a),style:{width:"140px"},class:"q-pr-none items-center"},{default:y(()=>[h(we,{class:"text-weight-bold"},{default:y(()=>[h(de,{name:a.amount>=0?"call_received":"call_made",color:a.status==="paid"?a.amount>=0?"green":"red":"",class:"q-mr-xs",size:"xs"},null,8,["name","color"]),O(" "+me(e.formatCurrency(a.amount,a.unit)),1)]),_:2},1024)]),_:2},1032,["onClick"]),h(Be,null,{default:y(()=>[h(we,{onClick:s=>e.copyText(a.bolt11)},{default:y(()=>[O(" Lightning "),h(at,null,{default:y(()=>[O("Click to copy")]),_:1})]),_:2},1032,["onClick"]),h(we,{caption:""},{default:y(()=>[O(me(e.formattedDate(a.date)),1)]),_:2},1024)]),_:2},1024),h(Be,{side:"",top:""},{default:y(()=>[a.status==="pending"?($(),Q(H,{key:0,flat:"",dense:"",icon:"sync",onClick:s=>a.amount>0?e.checkInvoice(a.quote,!0):e.checkOutgoingInvoice(a.quote,!0),class:"cursor-pointer",style:{position:"absolute",right:"0"}},{default:y(()=>[h(at,null,{default:y(()=>[O("Check status")]),_:1})]),_:2},1032,["onClick"])):Z("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),P("div",mc,[h(H,{rounded:"",outline:"",dense:"",onClick:t[0]||(t[0]=a=>e.filterPending=!e.filterPending),color:e.filterPending?"primary":"grey",label:e.filterPending?"Show all":"Filter pending",class:"q-ml-sm q-px-md",size:"sm"},null,8,["color","label"])]),e.paginatedInvoices.length===0?($(),J("div",gc,[h(we,{caption:"",class:"text-primary"},{default:y(()=>[O("No invoices yet")]),_:1})])):e.maxPages>1?($(),J("div",vc,[P("div",pc,[h(_r,{modelValue:e.currentPage,"onUpdate:modelValue":t[1]||(t[1]=a=>e.currentPage=a),max:e.maxPages,"max-pages":5,"direction-links":"","boundary-links":"",onInput:e.handlePageChange},null,8,["modelValue","max","onInput"])])])):Z("",!0)])])}var wc=He(dc,[["render",yc]]);const _c=Je({name:"HistoryTable",mixins:[windowMixin],props:{showTokenDialog:Function},data:function(){return{currentPage:1,pageSize:5,filterPending:!1}},watch:{filterPending:function(){this.currentPage=1}},computed:{...Se(zt,["historyTokens"]),...De(vn,["showReceiveTokens","receiveData"]),maxPages(){return Math.ceil(this.historyTokens.length/this.pageSize)},paginatedTokens(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filterPending?this.historyTokens.filter(n=>n.status==="pending").slice().reverse().slice(e,t):this.historyTokens.slice().reverse().slice(e,t)}},methods:{...ye(Ze,["checkTokenSpendable"]),formattedDate(e){const t=Cr(e);return Dr(t,{addSuffix:!1})},shortenString:function(e){return ji(e,20,10)},handlePageChange(e){this.currentPage=e},receiveToken(e){this.receiveData.tokensBase64=e,this.showReceiveTokens=!0}},created:function(){}}),bc={class:"q-pa-xs",style:{"max-width":"500px",margin:"0 auto"}},kc={class:"text-center q-mt-lg"},Dc={key:0,class:"text-center q-mt-lg"},Cc={key:1,class:"text-center q-mt-lg"},Sc={style:{display:"flex","justify-content":"center"}};function Pc(e,t,n,i,o,r){return $(),J("div",bc,[h(hn,null,{default:y(()=>[($(!0),J(ct,null,Et(e.paginatedTokens,a=>ze(($(),Q(et,{key:a.id,clickable:"",class:"q-px-md"},{default:y(()=>[h(Be,{side:"",onClick:s=>e.showTokenDialog(a.token),style:{width:"140px"},class:"q-pr-none items-center"},{default:y(()=>[h(we,{class:"text-weight-bold"},{default:y(()=>[h(de,{name:a.amount>=0?"call_received":"call_made",color:a.status==="paid"?a.amount>=0?"green":"red":"",class:"q-mr-xs",size:"xs"},null,8,["name","color"]),O(" "+me(e.formatCurrency(a.amount,a.unit)),1)]),_:2},1024)]),_:2},1032,["onClick"]),h(Be,{class:"items-center q-pl-lg",onClick:s=>e.showTokenDialog(a.token),style:{width:"300px"}},{default:y(()=>[h(we,null,{default:y(()=>[O(" Ecash ")]),_:1}),h(we,{caption:""},{default:y(()=>[O(me(e.formattedDate(a.date)),1)]),_:2},1024)]),_:2},1032,["onClick"]),h(Be,{side:"",top:""},{default:y(()=>[a.status==="pending"&&a.amount<0?($(),Q(H,{key:0,flat:"",dense:"",icon:"sync",onClick:s=>e.checkTokenSpendable(a.token),class:"cursor-pointer",style:{position:"absolute",right:"0"}},{default:y(()=>[h(at,null,{default:y(()=>[O("Check status")]),_:1})]),_:2},1032,["onClick"])):Z("",!0),a.status==="pending"&&a.amount>0?($(),Q(H,{key:1,flat:"",dense:"",icon:"arrow_circle_down",onClick:s=>e.receiveToken(a.token),class:"cursor-pointer",style:{position:"absolute",right:"0"}},{default:y(()=>[h(at,null,{default:y(()=>[O("Receive")]),_:1})]),_:2},1032,["onClick"])):Z("",!0)]),_:2},1024)]),_:2},1024)),[[Li]])),128))]),_:1}),P("div",kc,[h(H,{rounded:"",outline:"",dense:"",onClick:t[0]||(t[0]=a=>e.filterPending=!e.filterPending),color:e.filterPending?"primary":"grey",label:e.filterPending?"Show all":"Filter pending",class:"q-ml-sm q-px-md",size:"sm"},null,8,["color","label"])]),e.paginatedTokens.length===0?($(),J("div",Dc,[h(we,{caption:"",class:"text-primary"},{default:y(()=>[O("No history yet")]),_:1})])):e.maxPages>1?($(),J("div",Cc,[P("div",Sc,[h(_r,{modelValue:e.currentPage,"onUpdate:modelValue":t[1]||(t[1]=a=>e.currentPage=a),max:e.maxPages,"max-pages":5,"direction-links":"","boundary-links":"",onInput:e.handlePageChange},null,8,["modelValue","max","onInput"])])])):Z("",!0)])}var qc=He(_c,[["render",Pc]]);const Tc=Je({name:"NoMintWarnBanner",mixins:[windowMixin],props:{proofs:Array,activeProofs:Array,mints:Array,tickerShort:String,activeMintUrl:String},computed:{...De(lt,["tab","expandHistory"]),...De(vn,["showReceiveTokens","receiveData"]),balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)},getActiveMintUrlShort:function(){return Tt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.map(t=>t).flat().reduce((t,n)=>t+=n.amount,0);return e}},methods:{showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0},handleAddMintClick:function(){this.expandHistory=!0,this.tab="mints",Ii.emit("scrollToAddMintDiv")}}}),Mc={class:"q-ma-lg q-pa-md",style:{border:"2px solid","border-radius":"10px"}},xc={class:"row items-center justify-center"},$c=P("div",{class:"row items-center justify-center"},[P("div",{class:"text-h6"},"Join a mint")],-1),Ac=P("div",{class:"row items-center justify-center"},[P("div",{class:"text-subtitle2"}," You haven't joined any Cashu mint yet. Add a mint URL in the settings or receive ecash from a new mint to get started. ")],-1),Ec={class:"row items-center justify-center q-pt-lg"},Ic={class:"row items-center justify-center q-pt-md"};function Rc(e,t,n,i,o,r){return $(),J("div",Mc,[h(St,null,{default:y(()=>[P("div",xc,[h(de,{class:"q-pb-md",name:"account_balance",size:"50px"})]),$c,Ac,P("div",Ec,[h(H,{rounded:"",color:"primary",class:"q-px-md",label:"Add mint",onClick:e.handleAddMintClick},null,8,["onClick"])]),P("div",Ic,[h(H,{outline:"",rounded:"",color:"primary",class:"q-px-md",label:"Receive Ecash",onClick:e.showReceiveTokensDialog},null,8,["onClick"])])]),_:1})])}var Lc=He(Tc,[["render",Rc]]);const Oc=Je({name:"WelcomeDialog",mixins:[windowMixin],props:{welcomeDialog:Object,triggerPwaInstall:Function,setTab:Function,getPwaDisplayMode:Function,setWelcomeDialogSeen:Function},data:function(){return{showWelcomeDialog:localStorage.getItem("cashu.welcomeDialogSeen")!="seen"}},watch:{},computed:{...Se(Ze,["mnemonic"])},methods:{...ye(xe,["restoreFromBackup"]),readFile(e){let t=new FileReader;t.onload=n=>{let i=n.target.result,o=JSON.parse(i);this.restoreFromBackup(o)},t.readAsText(e)},dragFile(e){e.preventDefault();let n=e.dataTransfer.files[0];this.readFile(n)},allowDrop(e){e.preventDefault()},onChangeFileUpload(){let e=this.$refs.fileUpload.files[0];this.readFile(e)},browseBackupFile(){this.$refs.fileUpload.click()}}}),li=e=>(or("data-v-31eb61ea"),e=e(),rr(),e),Uc=li(()=>P("span",{class:"text-weight-bold"},"Cashu",-1)),Nc=li(()=>P("p",null,"Please take a moment to read the following information.",-1)),Vc=li(()=>P("p",null,[P("strong",null,"Back up your seed phrase."),O(" This wallet stores ecash tokens in its database. If you delete your browser data without backing up, you will lose your tokens. Make sure to back up your wallet seed phrase in the settings. ")],-1)),Bc=li(()=>P("p",null,[P("strong",null,"This software is in BETA!"),O(" We hold no responsibility for people losing access to funds. Use at your own risk! This wallet is not affiliated with any mint. This code is open-source and licensed under the MIT license. ")],-1)),Fc={class:"row q-mt-lg"};function zc(e,t,n,i,o,r){return $(),Q(st,{class:"z-top",persistent:"",modelValue:e.showWelcomeDialog,"onUpdate:modelValue":t[4]||(t[4]=a=>e.showWelcomeDialog=a),position:"top",onDrop:e.dragFile,onDragover:e.allowDrop,"backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(dt,{class:"q-pa-lg z-top"},{default:y(()=>[h(as,null,{default:y(()=>[h(ss,null,{default:y(()=>[Uc,O(" ecash wallet")]),_:1})]),_:1}),h(St,null,{default:y(()=>[Nc,Vc,Bc,P("input",{type:"file",id:"fileUpload",ref:"fileUpload",onChange:t[0]||(t[0]=a=>e.onChangeFileUpload())},null,544),P("div",Fc,[e.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?($(),Q(H,{key:0,outline:"",class:"q-mx-sm",color:"primary",onClick:t[1]||(t[1]=a=>e.triggerPwaInstall())},{default:y(()=>[O("Install Cashu")]),_:1})):Z("",!0),h(H,{flat:"",size:"0.6rem",class:"q-mx-xs q-px-none",onClick:t[2]||(t[2]=a=>e.copyText(e.baseURL))},{default:y(()=>[O("Copy URL")]),_:1}),h(H,{flat:"",size:"0.6rem",class:"q-mx-xs q-px-none",color:"warning",icon:"upload_for_offline",onClick:e.browseBackupFile},{default:y(()=>[O("Restore"),h(at,null,{default:y(()=>[O("You can drag & drop the wallet backup here!")]),_:1})]),_:1},8,["onClick"]),ze(($(),Q(H,{outline:"",size:"0.8rem",class:"q-ml-auto",onClick:t[3]||(t[3]=a=>e.setWelcomeDialogSeen())},{default:y(()=>[O("Continue")]),_:1})),[[We]])])]),_:1})]),_:1})]),_:1},8,["modelValue","onDrop","onDragover"])}var jc=He(Oc,[["render",zc],["__scopeId","data-v-31eb61ea"]]);const Wc=[z("circle",{cx:"15",cy:"15",r:"15"},[z("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),z("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),z("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[z("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),z("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),z("circle",{cx:"105",cy:"15",r:"15"},[z("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),z("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var Pr=it({name:"QSpinnerDots",props:qa,setup(e){const{cSize:t,classes:n}=Ta(e);return()=>z("svg",{class:n.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},Wc)}});const Hc=Je({name:"TokenInformation",mixins:[windowMixin],props:{encodedToken:String,showAmount:Boolean,showMintCheck:Boolean,showP2PKCheck:Boolean},data:function(){return{}},watch:{},computed:{...Se(xe,["activeMintUrl","activeProofs","mints","proofs","activeUnit","addMintBlocking"]),proofsToShow:function(){return ke.getProofs(ke.decode(this.encodedToken))},sumProofs:function(){return ke.getProofs(ke.decode(this.encodedToken)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return ke.getUnit(ke.decode(this.encodedToken))},tokenMintUrl:function(){let e=ke.getMint(ke.decode(this.encodedToken));return Tt(e)},displayMemo:function(){return ke.getMemo(ke.decode(this.encodedToken))}},methods:{...ye(Gt,["isLocked","isLockedToUs"]),getProofsMint:function(e){let t=[...new Set(e.map(o=>o.id))],i=this.mints.filter(o=>o.keysets.some(r=>t.indexOf(r)>=0)).map(o=>[{url:o.url,ids:o.keysets}][0]);return i.length==0?"":Tt(i[0].url)},mintKnownToUs:function(e){let t=[...new Set(e.map(n=>n.id))];return this.mints.filter(n=>n.keysets.some(i=>t.indexOf(i.id)>=0)).length>0}}}),Qc={class:"row text-left q-py-none q-my-none"},Kc={class:"col-12 q-px-none"},Xc={key:2,class:"q-my-md"},Gc=P("div",{class:"row text-left q-py-none q-my-none"},[P("div",{class:"col-12 q-px-sm"})],-1);function Yc(e,t,n,i,o,r){return $(),J(ct,null,[P("div",Qc,[P("div",Kc,[e.showAmount?($(),Q(mn,{key:0,outline:"",class:"q-pa-md",style:{"border-width":"2px"}},{default:y(()=>[h(de,{name:"toll",size:"xs",class:"q-mr-sm"}),P("strong",null,me(e.displayUnit),1)]),_:1})):Z("",!0),h(mn,{outline:"",class:"q-pa-md"},{default:y(()=>[h(de,{name:"account_balance",size:"xs",class:"q-mr-xs"}),O(" "+me(e.tokenMintUrl)+" ",1),e.addMintBlocking?($(),Q(It,{key:0,size:"sm",class:"q-ml-sm"})):Z("",!0),e.showMintCheck&&e.mintKnownToUs(e.proofsToShow)&&!e.addMintBlocking?($(),Q(de,{key:1,name:"check",size:"sm",color:"green",class:"q-ml-xs"})):Z("",!0)]),_:1}),e.isLocked(e.proofsToShow)?($(),Q(mn,{key:1,outline:"",icon:"lock",class:"q-pa-md"},{default:y(()=>[O(" P2PK "),e.showP2PKCheck||e.isLockedToUs(e.proofsToShow)?($(),Q(de,{key:0,name:e.isLockedToUs(e.proofsToShow)?"check":"close",size:"sm",color:e.isLockedToUs(e.proofsToShow)?"green":"red",class:"q-ml-xs"},null,8,["name","color"])):Z("",!0)]),_:1})):Z("",!0),e.displayMemo?($(),J("div",Xc,[h(de,{name:"chat",size:"xs",color:"grey",class:"q-mr-sm"}),P("span",null,me(e.displayMemo),1)])):Z("",!0)])]),Gc],64)}var qr=He(Hc,[["render",Yc]]);const Zc=Je({name:"ChooseMint",mixins:[windowMixin],props:{tickerShort:String},data:function(){return{chosenMint:null}},mounted(){this.chosenMint={url:this.activeMintUrl,shorturl:Tt(this.activeMintUrl)}},watch:{chosenMint:async function(){console.log("Mint chosen ",this.chosenMint),await this.activateMintUrl(this.chosenMint.url)}},computed:{...Se(xe,["activeMintUrl","activeProofs","mints","proofs","activeUnit"]),balance:function(){return this.activeProofs.flat().reduce((e,t)=>e+=t.amount,0)},allMintKeysets:function(){return[].concat(...this.mints.map(e=>e.keysets))},getActiveMintUrlShort:function(){return Tt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.flat().reduce((t,n)=>t+=n.amount,0);return e}},methods:{...ye(xe,["activateMintUrl"]),chooseMintOptions:function(){let e=[];for(const[t,n]of Object.entries(this.mints)){const i=n.keysets.map(a=>a.unit),o=[...new Set(i)],r=new dr(n);e.push({nickname:n.nickname,url:n.url,shorturl:n.nickname||Tt(n.url),balances:r.allBalances,units:o})}return e}}}),Jc={class:"q-pb-md"},ed=P("div",{class:"row q-mb-none"},[P("div",{class:"col-12"},[P("span",{class:"text-caption"},"Select a mint")])],-1),td={key:0,class:"row q-mt-xs q-mb-none"},nd={class:"col-12 cursor-pointer"};function id(e,t,n,i,o,r){return $(),J("div",Jc,[ed,e.activeMintUrl?($(),J("div",td,[P("div",nd,[h(Ei,{outlined:"",class:"q-px-none",color:"white",modelValue:e.chosenMint,"onUpdate:modelValue":t[0]||(t[0]=a=>e.chosenMint=a),options:e.chooseMintOptions(),"option-value":"url","option-label":"shorturl"},{option:y(a=>[h(et,Ma(xa(a.itemProps)),{default:y(()=>[h(Be,{avatar:""},{default:y(()=>[h(de,{name:"account_balance",size:"1.2rem",color:"grey",class:"q-pl-md"})]),_:1}),h(Be,null,{default:y(()=>[h(we,{class:"text-body1 q-pa-md"},{default:y(()=>[O(me(a.opt.shorturl),1)]),_:2},1024)]),_:2},1024),h(Be,{side:""},{default:y(()=>[h(we,null,{default:y(()=>[($(!0),J(ct,null,Et(a.opt.units,s=>($(),J("div",{key:s},[h(Ft,{color:"primary",label:e.formatCurrency(a.opt.balances[s],s),class:"q-ma-xs q-pa-sm text-weight-bold",style:{float:"right"}},null,8,["label"])]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1040),h(zi)]),prepend:y(()=>[h(de,{name:"account_balance",size:"1.2rem",color:"grey",class:"q-mr-none q-mb-none"})]),append:y(()=>[h(Ft,{color:"primary",label:e.formatCurrency(e.getBalance,e.activeUnit),class:"q-ma-xs q-pa-sm text-weight-bold"},null,8,["label"])]),_:1},8,["modelValue","options"])])])):Z("",!0)])}var Wi=He(Zc,[["render",id]]),Ln=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Oo=function(e){Ln(t,e);function t(){var n=e.call(this,"Invalid Scheme")||this;return n.name="InvalidSchemeError",n}return t}(Error),Si=function(e){Ln(t,e);function t(){var n=e.call(this,"Invalid Path")||this;return n.name="InvalidPathLengthError",n}return t}(Error),Tr=function(e){Ln(t,e);function t(){var n=e.call(this,"Invalid Type")||this;return n.name="InvalidTypeError",n}return t}(Error),Uo=function(e){Ln(t,e);function t(){var n=e.call(this,"Invalid Sequence Component")||this;return n.name="InvalidSequenceComponentError",n}return t}(Error),od=function(e){Ln(t,e);function t(){var n=e.call(this,"Invalid Checksum")||this;return n.name="InvalidChecksumError",n}return t}(Error),rd=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}(),Mr=function(e){for(var t=-1,n=0;n<e.length;n++)t=t>>>8^rd[(t^e[n])&255];return(t^-1)>>>0},ad=function(e){return Oe.Buffer.from(fs(e))},sd=function(e,t){return e.match(new RegExp(".{1,"+t+"}","g"))||[e]},xr=function(e,t){return[e.slice(0,-t),e.slice(-t)]},$r=function(e){return Mr(e)},Ar=function(e){return Mr(e).toString(16).padStart(8,"0")},Ri=function(e){return e>>>0},No=function(e){var t=new ArrayBuffer(4),n=new DataView(t);return n.setUint32(0,e,!1),Oe.Buffer.from(t)},Zn=function(e){return e.split("").every(function(t,n){var i=e.charCodeAt(n);return"a".charCodeAt(0)<=i&&i<="z".charCodeAt(0)||"0".charCodeAt(0)<=i&&i<="9".charCodeAt(0)||i==="-".charCodeAt(0)})},Vo=function(e,t){return e.length!==t.length?!1:e.every(function(n){return t.includes(n)})},ld=function(e,t){return t.every(function(n){return e.includes(n)})},ud=function(e,t){return e.filter(function(n){return t.indexOf(n)<0})},Er=function(e,t){for(var n=Math.max(e.length,t.length),i=Oe.Buffer.allocUnsafe(n),o=0;o<n;++o)i[o]=e[o]^t[o];return i};const cd=["string","number","bigint","symbol"],dd=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function fd(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(cd.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(hd(e))return"Buffer";const n=md(e);return n||"Object"}function hd(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function md(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(dd.includes(t))return t}class V{constructor(t,n,i){this.major=t,this.majorEncoded=t<<5,this.name=n,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}V.uint=new V(0,"uint",!0);V.negint=new V(1,"negint",!0);V.bytes=new V(2,"bytes",!0);V.string=new V(3,"string",!0);V.array=new V(4,"array",!1);V.map=new V(5,"map",!1);V.tag=new V(6,"tag",!1);V.float=new V(7,"float",!0);V.false=new V(7,"false",!0);V.true=new V(7,"true",!0);V.null=new V(7,"null",!0);V.undefined=new V(7,"undefined",!0);V.break=new V(7,"break",!0);class le{constructor(t,n,i){this.type=t,this.value=n,this.encodedLength=i,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const _n=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",gd=new TextDecoder,vd=new TextEncoder;function ii(e){return _n&&globalThis.Buffer.isBuffer(e)}function Ir(e){return e instanceof Uint8Array?ii(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const pd=_n?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Fo(e,t,n):(e,t,n)=>n-t>64?gd.decode(e.subarray(t,n)):Fo(e,t,n),yd=_n?e=>e.length>64?globalThis.Buffer.from(e):Bo(e):e=>e.length>64?vd.encode(e):Bo(e),$t=e=>Uint8Array.from(e),Hi=_n?(e,t,n)=>ii(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),wd=_n?(e,t)=>(e=e.map(n=>n instanceof Uint8Array?n:globalThis.Buffer.from(n)),Ir(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let i=0;for(let o of e)i+o.length>n.length&&(o=o.subarray(0,n.length-i)),n.set(o,i),i+=o.length;return n},_d=_n?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function bd(e,t){if(ii(e)&&ii(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function Bo(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let o=e.charCodeAt(i);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128)}return t}function Fo(e,t,n){const i=[];for(;t<n;){const o=e[t];let r=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=n){let s,l,g,f;switch(a){case 1:o<128&&(r=o);break;case 2:s=e[t+1],(s&192)===128&&(f=(o&31)<<6|s&63,f>127&&(r=f));break;case 3:s=e[t+1],l=e[t+2],(s&192)===128&&(l&192)===128&&(f=(o&15)<<12|(s&63)<<6|l&63,f>2047&&(f<55296||f>57343)&&(r=f));break;case 4:s=e[t+1],l=e[t+2],g=e[t+3],(s&192)===128&&(l&192)===128&&(g&192)===128&&(f=(o&15)<<18|(s&63)<<12|(l&63)<<6|g&63,f>65535&&f<1114112&&(r=f))}}r===null?(r=65533,a=1):r>65535&&(r-=65536,i.push(r>>>10&1023|55296),r=56320|r&1023),i.push(r),t+=a}return kd(i)}const zo=4096;function kd(e){const t=e.length;if(t<=zo)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=zo));return n}const Dd=256;class Rr{constructor(t=Dd){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let n=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const o=n.length-(this.maxCursor-this.cursor)-1;n.set(t,o)}else{if(n){const o=n.length-(this.maxCursor-this.cursor)-1;o<n.length&&(this.chunks[this.chunks.length-1]=n.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(n=_d(this.chunkSize),this.chunks.push(n),this.maxCursor+=n.length,this._initReuseChunk===null&&(this._initReuseChunk=n),n.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let n;if(this.chunks.length===1){const i=this.chunks[0];t&&this.cursor>i.length/2?(n=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):n=Hi(i,0,this.cursor)}else n=wd(this.chunks,this.cursor);return t&&this.reset(),n}}const _e="CBOR decode error:",Lr="CBOR encode error:";function bn(e,t,n){if(e.length-t<n)throw new Error(`${_e} not enough data for type`)}const Ge=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Zt(e,t,n){bn(e,t,1);const i=e[t];if(n.strict===!0&&i<Ge[0])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);return i}function Jt(e,t,n){bn(e,t,2);const i=e[t]<<8|e[t+1];if(n.strict===!0&&i<Ge[1])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);return i}function en(e,t,n){bn(e,t,4);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(n.strict===!0&&i<Ge[2])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);return i}function tn(e,t,n){bn(e,t,8);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],r=(BigInt(i)<<BigInt(32))+BigInt(o);if(n.strict===!0&&r<Ge[3])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);if(r<=Number.MAX_SAFE_INTEGER)return Number(r);if(n.allowBigInt===!0)return r;throw new Error(`${_e} integers outside of the safe integer range are not supported`)}function Cd(e,t,n,i){return new le(V.uint,Zt(e,t+1,i),2)}function Sd(e,t,n,i){return new le(V.uint,Jt(e,t+1,i),3)}function Pd(e,t,n,i){return new le(V.uint,en(e,t+1,i),5)}function qd(e,t,n,i){return new le(V.uint,tn(e,t+1,i),9)}function nn(e,t){return wt(e,0,t.value)}function wt(e,t,n){if(n<Ge[0]){const i=Number(n);e.push([t|i])}else if(n<Ge[1]){const i=Number(n);e.push([t|24,i])}else if(n<Ge[2]){const i=Number(n);e.push([t|25,i>>>8,i&255])}else if(n<Ge[3]){const i=Number(n);e.push([t|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{const i=BigInt(n);if(i<Ge[4]){const o=[t|27,0,0,0,0,0,0,0];let r=Number(i&BigInt(4294967295)),a=Number(i>>BigInt(32)&BigInt(4294967295));o[8]=r&255,r=r>>8,o[7]=r&255,r=r>>8,o[6]=r&255,r=r>>8,o[5]=r&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${_e} encountered BigInt larger than allowable range`)}}nn.encodedSize=function(t){return wt.encodedSize(t.value)};wt.encodedSize=function(t){return t<Ge[0]?1:t<Ge[1]?2:t<Ge[2]?3:t<Ge[3]?5:9};nn.compareTokens=function(t,n){return t.value<n.value?-1:t.value>n.value?1:0};function Td(e,t,n,i){return new le(V.negint,-1-Zt(e,t+1,i),2)}function Md(e,t,n,i){return new le(V.negint,-1-Jt(e,t+1,i),3)}function xd(e,t,n,i){return new le(V.negint,-1-en(e,t+1,i),5)}const Qi=BigInt(-1),Or=BigInt(1);function $d(e,t,n,i){const o=tn(e,t+1,i);if(typeof o!="bigint"){const r=-1-o;if(r>=Number.MIN_SAFE_INTEGER)return new le(V.negint,r,9)}if(i.allowBigInt!==!0)throw new Error(`${_e} integers outside of the safe integer range are not supported`);return new le(V.negint,Qi-BigInt(o),9)}function Ki(e,t){const n=t.value,i=typeof n=="bigint"?n*Qi-Or:n*-1-1;wt(e,t.type.majorEncoded,i)}Ki.encodedSize=function(t){const n=t.value,i=typeof n=="bigint"?n*Qi-Or:n*-1-1;return i<Ge[0]?1:i<Ge[1]?2:i<Ge[2]?3:i<Ge[3]?5:9};Ki.compareTokens=function(t,n){return t.value<n.value?1:t.value>n.value?-1:0};function On(e,t,n,i){bn(e,t,n+i);const o=Hi(e,t+n,t+n+i);return new le(V.bytes,o,n+i)}function Ad(e,t,n,i){return On(e,t,1,n)}function Ed(e,t,n,i){return On(e,t,2,Zt(e,t+1,i))}function Id(e,t,n,i){return On(e,t,3,Jt(e,t+1,i))}function Rd(e,t,n,i){return On(e,t,5,en(e,t+1,i))}function Ld(e,t,n,i){const o=tn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer bytes lengths not supported`);return On(e,t,9,o)}function oi(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===V.string?yd(e.value):e.value),e.encodedBytes}function ui(e,t){const n=oi(t);wt(e,t.type.majorEncoded,n.length),e.push(n)}ui.encodedSize=function(t){const n=oi(t);return wt.encodedSize(n.length)+n.length};ui.compareTokens=function(t,n){return Od(oi(t),oi(n))};function Od(e,t){return e.length<t.length?-1:e.length>t.length?1:bd(e,t)}function Un(e,t,n,i,o){const r=n+i;bn(e,t,r);const a=new le(V.string,pd(e,t+n,t+r),r);return o.retainStringBytes===!0&&(a.byteValue=Hi(e,t+n,t+r)),a}function Ud(e,t,n,i){return Un(e,t,1,n,i)}function Nd(e,t,n,i){return Un(e,t,2,Zt(e,t+1,i),i)}function Vd(e,t,n,i){return Un(e,t,3,Jt(e,t+1,i),i)}function Bd(e,t,n,i){return Un(e,t,5,en(e,t+1,i),i)}function Fd(e,t,n,i){const o=tn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer string lengths not supported`);return Un(e,t,9,o,i)}const zd=ui;function kn(e,t,n,i){return new le(V.array,i,n)}function jd(e,t,n,i){return kn(e,t,1,n)}function Wd(e,t,n,i){return kn(e,t,2,Zt(e,t+1,i))}function Hd(e,t,n,i){return kn(e,t,3,Jt(e,t+1,i))}function Qd(e,t,n,i){return kn(e,t,5,en(e,t+1,i))}function Kd(e,t,n,i){const o=tn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer array lengths not supported`);return kn(e,t,9,o)}function Xd(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${_e} indefinite length items not allowed`);return kn(e,t,1,1/0)}function Xi(e,t){wt(e,V.array.majorEncoded,t.value)}Xi.compareTokens=nn.compareTokens;Xi.encodedSize=function(t){return wt.encodedSize(t.value)};function Dn(e,t,n,i){return new le(V.map,i,n)}function Gd(e,t,n,i){return Dn(e,t,1,n)}function Yd(e,t,n,i){return Dn(e,t,2,Zt(e,t+1,i))}function Zd(e,t,n,i){return Dn(e,t,3,Jt(e,t+1,i))}function Jd(e,t,n,i){return Dn(e,t,5,en(e,t+1,i))}function ef(e,t,n,i){const o=tn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer map lengths not supported`);return Dn(e,t,9,o)}function tf(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${_e} indefinite length items not allowed`);return Dn(e,t,1,1/0)}function Gi(e,t){wt(e,V.map.majorEncoded,t.value)}Gi.compareTokens=nn.compareTokens;Gi.encodedSize=function(t){return wt.encodedSize(t.value)};function nf(e,t,n,i){return new le(V.tag,n,1)}function of(e,t,n,i){return new le(V.tag,Zt(e,t+1,i),2)}function rf(e,t,n,i){return new le(V.tag,Jt(e,t+1,i),3)}function af(e,t,n,i){return new le(V.tag,en(e,t+1,i),5)}function sf(e,t,n,i){return new le(V.tag,tn(e,t+1,i),9)}function Yi(e,t){wt(e,V.tag.majorEncoded,t.value)}Yi.compareTokens=nn.compareTokens;Yi.encodedSize=function(t){return wt.encodedSize(t.value)};const lf=20,uf=21,cf=22,df=23;function ff(e,t,n,i){if(i.allowUndefined===!1)throw new Error(`${_e} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new le(V.null,null,1):new le(V.undefined,void 0,1)}function hf(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${_e} indefinite length items not allowed`);return new le(V.break,void 0,1)}function Zi(e,t,n){if(n){if(n.allowNaN===!1&&Number.isNaN(e))throw new Error(`${_e} NaN values are not supported`);if(n.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${_e} Infinity values are not supported`)}return new le(V.float,e,t)}function mf(e,t,n,i){return Zi(eo(e,t+1),3,i)}function gf(e,t,n,i){return Zi(to(e,t+1),5,i)}function vf(e,t,n,i){return Zi(Br(e,t+1),9,i)}function Ji(e,t,n){const i=t.value;if(i===!1)e.push([V.float.majorEncoded|lf]);else if(i===!0)e.push([V.float.majorEncoded|uf]);else if(i===null)e.push([V.float.majorEncoded|cf]);else if(i===void 0)e.push([V.float.majorEncoded|df]);else{let o,r=!1;(!n||n.float64!==!0)&&(Nr(i),o=eo(kt,1),i===o||Number.isNaN(i)?(kt[0]=249,e.push(kt.slice(0,3)),r=!0):(Vr(i),o=to(kt,1),i===o&&(kt[0]=250,e.push(kt.slice(0,5)),r=!0))),r||(pf(i),o=Br(kt,1),kt[0]=251,e.push(kt.slice(0,9)))}}Ji.encodedSize=function(t,n){const i=t.value;if(i===!1||i===!0||i===null||i===void 0)return 1;if(!n||n.float64!==!0){Nr(i);let o=eo(kt,1);if(i===o||Number.isNaN(i))return 3;if(Vr(i),o=to(kt,1),i===o)return 5}return 9};const Ur=new ArrayBuffer(9),pt=new DataView(Ur,1),kt=new Uint8Array(Ur,0);function Nr(e){if(e===1/0)pt.setUint16(0,31744,!1);else if(e===-1/0)pt.setUint16(0,64512,!1);else if(Number.isNaN(e))pt.setUint16(0,32256,!1);else{pt.setFloat32(0,e);const t=pt.getUint32(0),n=(t&2139095040)>>23,i=t&8388607;if(n===255)pt.setUint16(0,31744,!1);else if(n===0)pt.setUint16(0,(e&2147483648)>>16|i>>13,!1);else{const o=n-127;o<-24?pt.setUint16(0,0):o<-14?pt.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):pt.setUint16(0,(t&2147483648)>>16|o+15<<10|i>>13,!1)}}}function eo(e,t){if(e.length-t<2)throw new Error(`${_e} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;const i=n>>10&31,o=n&1023;let r;return i===0?r=o*2**-24:i!==31?r=(o+1024)*2**(i-25):r=o===0?1/0:NaN,n&32768?-r:r}function Vr(e){pt.setFloat32(0,e,!1)}function to(e,t){if(e.length-t<4)throw new Error(`${_e} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function pf(e){pt.setFloat64(0,e,!1)}function Br(e,t){if(e.length-t<8)throw new Error(`${_e} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}Ji.compareTokens=nn.compareTokens;function Pe(e,t,n){throw new Error(`${_e} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function ci(e){return()=>{throw new Error(`${_e} ${e}`)}}const X=[];for(let e=0;e<=23;e++)X[e]=Pe;X[24]=Cd;X[25]=Sd;X[26]=Pd;X[27]=qd;X[28]=Pe;X[29]=Pe;X[30]=Pe;X[31]=Pe;for(let e=32;e<=55;e++)X[e]=Pe;X[56]=Td;X[57]=Md;X[58]=xd;X[59]=$d;X[60]=Pe;X[61]=Pe;X[62]=Pe;X[63]=Pe;for(let e=64;e<=87;e++)X[e]=Ad;X[88]=Ed;X[89]=Id;X[90]=Rd;X[91]=Ld;X[92]=Pe;X[93]=Pe;X[94]=Pe;X[95]=ci("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)X[e]=Ud;X[120]=Nd;X[121]=Vd;X[122]=Bd;X[123]=Fd;X[124]=Pe;X[125]=Pe;X[126]=Pe;X[127]=ci("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)X[e]=jd;X[152]=Wd;X[153]=Hd;X[154]=Qd;X[155]=Kd;X[156]=Pe;X[157]=Pe;X[158]=Pe;X[159]=Xd;for(let e=160;e<=183;e++)X[e]=Gd;X[184]=Yd;X[185]=Zd;X[186]=Jd;X[187]=ef;X[188]=Pe;X[189]=Pe;X[190]=Pe;X[191]=tf;for(let e=192;e<=215;e++)X[e]=nf;X[216]=of;X[217]=rf;X[218]=af;X[219]=sf;X[220]=Pe;X[221]=Pe;X[222]=Pe;X[223]=Pe;for(let e=224;e<=243;e++)X[e]=ci("simple values are not supported");X[244]=Pe;X[245]=Pe;X[246]=Pe;X[247]=ff;X[248]=ci("simple values are not supported");X[249]=mf;X[250]=gf;X[251]=vf;X[252]=Pe;X[253]=Pe;X[254]=Pe;X[255]=hf;const Mt=[];for(let e=0;e<24;e++)Mt[e]=new le(V.uint,e,1);for(let e=-1;e>=-24;e--)Mt[31-e]=new le(V.negint,e,1);Mt[64]=new le(V.bytes,new Uint8Array(0),1);Mt[96]=new le(V.string,"",1);Mt[128]=new le(V.array,0,1);Mt[160]=new le(V.map,0,1);Mt[244]=new le(V.false,!1,1);Mt[245]=new le(V.true,!0,1);Mt[246]=new le(V.null,null,1);function yf(e){switch(e.type){case V.false:return $t([244]);case V.true:return $t([245]);case V.null:return $t([246]);case V.bytes:return e.value.length?void 0:$t([64]);case V.string:return e.value===""?$t([96]):void 0;case V.array:return e.value===0?$t([128]):void 0;case V.map:return e.value===0?$t([160]):void 0;case V.uint:return e.value<24?$t([Number(e.value)]):void 0;case V.negint:if(e.value>=-24)return $t([31-Number(e.value)])}}const wf={float64:!1,mapSorter:kf,quickEncodeToken:yf};function _f(){const e=[];return e[V.uint.major]=nn,e[V.negint.major]=Ki,e[V.bytes.major]=ui,e[V.string.major]=zd,e[V.array.major]=Xi,e[V.map.major]=Gi,e[V.tag.major]=Yi,e[V.float.major]=Ji,e}const Fr=_f(),Pi=new Rr;class ri{constructor(t,n){this.obj=t,this.parent=n}includes(t){let n=this;do if(n.obj===t)return!0;while(n=n.parent);return!1}static createCheck(t,n){if(t&&t.includes(n))throw new Error(`${Lr} object contains circular references`);return new ri(n,t)}}const Ut={null:new le(V.null,null),undefined:new le(V.undefined,void 0),true:new le(V.true,!0),false:new le(V.false,!1),emptyArray:new le(V.array,0),emptyMap:new le(V.map,0)},Wt={number(e,t,n,i){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new le(V.float,e):e>=0?new le(V.uint,e):new le(V.negint,e)},bigint(e,t,n,i){return e>=BigInt(0)?new le(V.uint,e):new le(V.negint,e)},Uint8Array(e,t,n,i){return new le(V.bytes,e)},string(e,t,n,i){return new le(V.string,e)},boolean(e,t,n,i){return e?Ut.true:Ut.false},null(e,t,n,i){return Ut.null},undefined(e,t,n,i){return Ut.undefined},ArrayBuffer(e,t,n,i){return new le(V.bytes,new Uint8Array(e))},DataView(e,t,n,i){return new le(V.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,i){if(!e.length)return n.addBreakTokens===!0?[Ut.emptyArray,new le(V.break)]:Ut.emptyArray;i=ri.createCheck(i,e);const o=[];let r=0;for(const a of e)o[r++]=Jn(a,n,i);return n.addBreakTokens?[new le(V.array,e.length),o,new le(V.break)]:[new le(V.array,e.length),o]},Object(e,t,n,i){const o=t!=="Object",r=o?e.keys():Object.keys(e),a=o?e.size:r.length;if(!a)return n.addBreakTokens===!0?[Ut.emptyMap,new le(V.break)]:Ut.emptyMap;i=ri.createCheck(i,e);const s=[];let l=0;for(const g of r)s[l++]=[Jn(g,n,i),Jn(o?e.get(g):e[g],n,i)];return bf(s,n),n.addBreakTokens?[new le(V.map,a),s,new le(V.break)]:[new le(V.map,a),s]}};Wt.Map=Wt.Object;Wt.Buffer=Wt.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Wt[`${e}Array`]=Wt.DataView;function Jn(e,t={},n){const i=fd(e),o=t&&t.typeEncoders&&t.typeEncoders[i]||Wt[i];if(typeof o=="function"){const a=o(e,i,t,n);if(a!=null)return a}const r=Wt[i];if(!r)throw new Error(`${Lr} unsupported type: ${i}`);return r(e,i,t,n)}function bf(e,t){t.mapSorter&&e.sort(t.mapSorter)}function kf(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],i=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==i.type)return n.type.compare(i.type);const o=n.type.major,r=Fr[o].compareTokens(n,i);return r===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),r}function zr(e,t,n,i){if(Array.isArray(t))for(const o of t)zr(e,o,n,i);else n[t.type.major](e,t,i)}function Df(e,t,n){const i=Jn(e,n);if(!Array.isArray(i)&&n.quickEncodeToken){const o=n.quickEncodeToken(i);if(o)return o;const r=t[i.type.major];if(r.encodedSize){const a=r.encodedSize(i,n),s=new Rr(a);if(r(s,i,n),s.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return Ir(s.chunks[0])}}return Pi.reset(),zr(Pi,i,t,n),Pi.toBytes(!0)}function Cf(e,t){return t=Object.assign({},wf,t),Df(e,Fr,t)}const Sf={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Pf{constructor(t,n={}){this._pos=0,this.data=t,this.options=n}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let n=Mt[t];if(n===void 0){const i=X[t];if(!i)throw new Error(`${_e} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const o=t&31;n=i(this.data,this._pos,o,this.options)}return this._pos+=n.encodedLength,n}}const In=Symbol.for("DONE"),di=Symbol.for("BREAK");function qf(e,t,n){const i=[];for(let o=0;o<e.value;o++){const r=Rn(t,n);if(r===di){if(e.value===1/0)break;throw new Error(`${_e} got unexpected break to lengthed array`)}if(r===In)throw new Error(`${_e} found array but not enough entries (got ${o}, expected ${e.value})`);i[o]=r}return i}function Tf(e,t,n){const i=n.useMaps===!0,o=i?void 0:{},r=i?new Map:void 0;for(let a=0;a<e.value;a++){const s=Rn(t,n);if(s===di){if(e.value===1/0)break;throw new Error(`${_e} got unexpected break to lengthed map`)}if(s===In)throw new Error(`${_e} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(i!==!0&&typeof s!="string")throw new Error(`${_e} non-string keys not supported (got ${typeof s})`);if(n.rejectDuplicateMapKeys===!0&&(i&&r.has(s)||!i&&s in o))throw new Error(`${_e} found repeat map key "${s}"`);const l=Rn(t,n);if(l===In)throw new Error(`${_e} found map but not enough entries (got ${a} [no value], expected ${e.value})`);i?r.set(s,l):o[s]=l}return i?r:o}function Rn(e,t){if(e.done())return In;const n=e.next();if(n.type===V.break)return di;if(n.type.terminal)return n.value;if(n.type===V.array)return qf(n,e,t);if(n.type===V.map)return Tf(n,e,t);if(n.type===V.tag){if(t.tags&&typeof t.tags[n.value]=="function"){const i=Rn(e,t);return t.tags[n.value](i)}throw new Error(`${_e} tag not supported (${n.value})`)}throw new Error("unsupported")}function Mf(e,t){if(!(e instanceof Uint8Array))throw new Error(`${_e} data to decode must be a Uint8Array`);t=Object.assign({},Sf,t);const n=t.tokenizer||new Pf(e,t),i=Rn(n,t);if(i===In)throw new Error(`${_e} did not find any content to decode`);if(i===di)throw new Error(`${_e} got unexpected break`);return[i,e.subarray(n.pos())]}function xf(e,t){const[n,i]=Mf(e,t);if(i.length>0)throw new Error(`${_e} too many terminals, data makes no sense`);return n}var jr=function(e){return Oe.Buffer.from(Cf(e))},Wr=function(e){return xf(Oe.Buffer.isBuffer(e)?e:Oe.Buffer.from(e,"hex"))},ei=function(){function e(t,n){if(n===void 0&&(n="bytes"),this._cborPayload=t,this._type=n,!Zn(this._type))throw new Tr}return e.fromBuffer=function(t){return new e(jr(t))},e.from=function(t){return e.fromBuffer(Oe.Buffer.from(t))},e.prototype.decodeCBOR=function(){return Wr(this._cborPayload)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this._cborPayload},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return this.type===t.type&&this.cbor.equals(t.cbor)},e}(),$f=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,qi=Math.ceil,gt=Math.floor,rt="[BigNumber Error] ",jo=rt+"Number primitive has more than 15 significant digits: ",bt=1e14,ve=14,Ti=9007199254740991,Mi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Nt=1e7,Qe=1e9;function Hr(e){var t,n,i,o=E.prototype={constructor:E,toString:null,valueOf:null},r=new E(1),a=20,s=4,l=-7,g=21,f=-1e7,k=1e7,w=!1,S=1,A=0,L={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},I="0123456789abcdefghijklmnopqrstuvwxyz",j=!0;function E(u,d){var v,q,p,m,b,_,C,x,T=this;if(!(T instanceof E))return new E(u,d);if(d==null){if(u&&u._isBigNumber===!0){T.s=u.s,!u.c||u.e>k?T.c=T.e=null:u.e<f?T.c=[T.e=0]:(T.e=u.e,T.c=u.c.slice());return}if((_=typeof u=="number")&&u*0==0){if(T.s=1/u<0?(u=-u,-1):1,u===~~u){for(m=0,b=u;b>=10;b/=10,m++);m>k?T.c=T.e=null:(T.e=m,T.c=[u]);return}x=String(u)}else{if(!$f.test(x=String(u)))return i(T,x,_);T.s=x.charCodeAt(0)==45?(x=x.slice(1),-1):1}(m=x.indexOf("."))>-1&&(x=x.replace(".","")),(b=x.search(/e/i))>0?(m<0&&(m=b),m+=+x.slice(b+1),x=x.substring(0,b)):m<0&&(m=x.length)}else{if(Ve(d,2,I.length,"Base"),d==10&&j)return T=new E(u),ne(T,a+T.e+1,s);if(x=String(u),_=typeof u=="number"){if(u*0!=0)return i(T,x,_,d);if(T.s=1/u<0?(x=x.slice(1),-1):1,E.DEBUG&&x.replace(/^0\.0*|\./,"").length>15)throw Error(jo+u)}else T.s=x.charCodeAt(0)===45?(x=x.slice(1),-1):1;for(v=I.slice(0,d),m=b=0,C=x.length;b<C;b++)if(v.indexOf(q=x.charAt(b))<0){if(q=="."){if(b>m){m=C;continue}}else if(!p&&(x==x.toUpperCase()&&(x=x.toLowerCase())||x==x.toLowerCase()&&(x=x.toUpperCase()))){p=!0,b=-1,m=0;continue}return i(T,String(u),_,d)}_=!1,x=n(x,d,10,T.s),(m=x.indexOf("."))>-1?x=x.replace(".",""):m=x.length}for(b=0;x.charCodeAt(b)===48;b++);for(C=x.length;x.charCodeAt(--C)===48;);if(x=x.slice(b,++C)){if(C-=b,_&&E.DEBUG&&C>15&&(u>Ti||u!==gt(u)))throw Error(jo+T.s*u);if((m=m-b-1)>k)T.c=T.e=null;else if(m<f)T.c=[T.e=0];else{if(T.e=m,T.c=[],b=(m+1)%ve,m<0&&(b+=ve),b<C){for(b&&T.c.push(+x.slice(0,b)),C-=ve;b<C;)T.c.push(+x.slice(b,b+=ve));b=ve-(x=x.slice(b)).length}else b-=C;for(;b--;x+="0");T.c.push(+x)}}else T.c=[T.e=0]}E.clone=Hr,E.ROUND_UP=0,E.ROUND_DOWN=1,E.ROUND_CEIL=2,E.ROUND_FLOOR=3,E.ROUND_HALF_UP=4,E.ROUND_HALF_DOWN=5,E.ROUND_HALF_EVEN=6,E.ROUND_HALF_CEIL=7,E.ROUND_HALF_FLOOR=8,E.EUCLID=9,E.config=E.set=function(u){var d,v;if(u!=null)if(typeof u=="object"){if(u.hasOwnProperty(d="DECIMAL_PLACES")&&(v=u[d],Ve(v,0,Qe,d),a=v),u.hasOwnProperty(d="ROUNDING_MODE")&&(v=u[d],Ve(v,0,8,d),s=v),u.hasOwnProperty(d="EXPONENTIAL_AT")&&(v=u[d],v&&v.pop?(Ve(v[0],-Qe,0,d),Ve(v[1],0,Qe,d),l=v[0],g=v[1]):(Ve(v,-Qe,Qe,d),l=-(g=v<0?-v:v))),u.hasOwnProperty(d="RANGE"))if(v=u[d],v&&v.pop)Ve(v[0],-Qe,-1,d),Ve(v[1],1,Qe,d),f=v[0],k=v[1];else if(Ve(v,-Qe,Qe,d),v)f=-(k=v<0?-v:v);else throw Error(rt+d+" cannot be zero: "+v);if(u.hasOwnProperty(d="CRYPTO"))if(v=u[d],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))w=v;else throw w=!v,Error(rt+"crypto unavailable");else w=v;else throw Error(rt+d+" not true or false: "+v);if(u.hasOwnProperty(d="MODULO_MODE")&&(v=u[d],Ve(v,0,9,d),S=v),u.hasOwnProperty(d="POW_PRECISION")&&(v=u[d],Ve(v,0,Qe,d),A=v),u.hasOwnProperty(d="FORMAT"))if(v=u[d],typeof v=="object")L=v;else throw Error(rt+d+" not an object: "+v);if(u.hasOwnProperty(d="ALPHABET"))if(v=u[d],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))j=v.slice(0,10)=="0123456789",I=v;else throw Error(rt+d+" invalid: "+v)}else throw Error(rt+"Object expected: "+u);return{DECIMAL_PLACES:a,ROUNDING_MODE:s,EXPONENTIAL_AT:[l,g],RANGE:[f,k],CRYPTO:w,MODULO_MODE:S,POW_PRECISION:A,FORMAT:L,ALPHABET:I}},E.isBigNumber=function(u){if(!u||u._isBigNumber!==!0)return!1;if(!E.DEBUG)return!0;var d,v,q=u.c,p=u.e,m=u.s;e:if({}.toString.call(q)=="[object Array]"){if((m===1||m===-1)&&p>=-Qe&&p<=Qe&&p===gt(p)){if(q[0]===0){if(p===0&&q.length===1)return!0;break e}if(d=(p+1)%ve,d<1&&(d+=ve),String(q[0]).length==d){for(d=0;d<q.length;d++)if(v=q[d],v<0||v>=bt||v!==gt(v))break e;if(v!==0)return!0}}}else if(q===null&&p===null&&(m===null||m===1||m===-1))return!0;throw Error(rt+"Invalid BigNumber: "+u)},E.maximum=E.max=function(){return F(arguments,-1)},E.minimum=E.min=function(){return F(arguments,1)},E.random=function(){var u=9007199254740992,d=Math.random()*u&2097151?function(){return gt(Math.random()*u)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var q,p,m,b,_,C=0,x=[],T=new E(r);if(v==null?v=a:Ve(v,0,Qe),b=qi(v/ve),w)if(crypto.getRandomValues){for(q=crypto.getRandomValues(new Uint32Array(b*=2));C<b;)_=q[C]*131072+(q[C+1]>>>11),_>=9e15?(p=crypto.getRandomValues(new Uint32Array(2)),q[C]=p[0],q[C+1]=p[1]):(x.push(_%1e14),C+=2);C=b/2}else if(crypto.randomBytes){for(q=crypto.randomBytes(b*=7);C<b;)_=(q[C]&31)*281474976710656+q[C+1]*1099511627776+q[C+2]*4294967296+q[C+3]*16777216+(q[C+4]<<16)+(q[C+5]<<8)+q[C+6],_>=9e15?crypto.randomBytes(7).copy(q,C):(x.push(_%1e14),C+=7);C=b/7}else throw w=!1,Error(rt+"crypto unavailable");if(!w)for(;C<b;)_=d(),_<9e15&&(x[C++]=_%1e14);for(b=x[--C],v%=ve,b&&v&&(_=Mi[ve-v],x[C]=gt(b/_)*_);x[C]===0;x.pop(),C--);if(C<0)x=[m=0];else{for(m=-1;x[0]===0;x.splice(0,1),m-=ve);for(C=1,_=x[0];_>=10;_/=10,C++);C<ve&&(m-=ve-C)}return T.e=m,T.c=x,T}}(),E.sum=function(){for(var u=1,d=arguments,v=new E(d[0]);u<d.length;)v=v.plus(d[u++]);return v},n=function(){var u="0123456789";function d(v,q,p,m){for(var b,_=[0],C,x=0,T=v.length;x<T;){for(C=_.length;C--;_[C]*=q);for(_[0]+=m.indexOf(v.charAt(x++)),b=0;b<_.length;b++)_[b]>p-1&&(_[b+1]==null&&(_[b+1]=0),_[b+1]+=_[b]/p|0,_[b]%=p)}return _.reverse()}return function(v,q,p,m,b){var _,C,x,T,R,ie,M,N,oe=v.indexOf("."),ue=a,ae=s;for(oe>=0&&(T=A,A=0,v=v.replace(".",""),N=new E(q),ie=N.pow(v.length-oe),A=T,N.c=d(At(mt(ie.c),ie.e,"0"),10,p,u),N.e=N.c.length),M=d(v,q,p,b?(_=I,u):(_=u,I)),x=T=M.length;M[--T]==0;M.pop());if(!M[0])return _.charAt(0);if(oe<0?--x:(ie.c=M,ie.e=x,ie.s=m,ie=t(ie,N,ue,ae,p),M=ie.c,R=ie.r,x=ie.e),C=x+ue+1,oe=M[C],T=p/2,R=R||C<0||M[C+1]!=null,R=ae<4?(oe!=null||R)&&(ae==0||ae==(ie.s<0?3:2)):oe>T||oe==T&&(ae==4||R||ae==6&&M[C-1]&1||ae==(ie.s<0?8:7)),C<1||!M[0])v=R?At(_.charAt(1),-ue,_.charAt(0)):_.charAt(0);else{if(M.length=C,R)for(--p;++M[--C]>p;)M[C]=0,C||(++x,M=[1].concat(M));for(T=M.length;!M[--T];);for(oe=0,v="";oe<=T;v+=_.charAt(M[oe++]));v=At(v,x,_.charAt(0))}return v}}(),t=function(){function u(q,p,m){var b,_,C,x,T=0,R=q.length,ie=p%Nt,M=p/Nt|0;for(q=q.slice();R--;)C=q[R]%Nt,x=q[R]/Nt|0,b=M*C+x*ie,_=ie*C+b%Nt*Nt+T,T=(_/m|0)+(b/Nt|0)+M*x,q[R]=_%m;return T&&(q=[T].concat(q)),q}function d(q,p,m,b){var _,C;if(m!=b)C=m>b?1:-1;else for(_=C=0;_<m;_++)if(q[_]!=p[_]){C=q[_]>p[_]?1:-1;break}return C}function v(q,p,m,b){for(var _=0;m--;)q[m]-=_,_=q[m]<p[m]?1:0,q[m]=_*b+q[m]-p[m];for(;!q[0]&&q.length>1;q.splice(0,1));}return function(q,p,m,b,_){var C,x,T,R,ie,M,N,oe,ue,ae,G,re,Te,K,Le,Ue,ot,Ie=q.s==p.s?1:-1,Re=q.c,Ce=p.c;if(!Re||!Re[0]||!Ce||!Ce[0])return new E(!q.s||!p.s||(Re?Ce&&Re[0]==Ce[0]:!Ce)?NaN:Re&&Re[0]==0||!Ce?Ie*0:Ie/0);for(oe=new E(Ie),ue=oe.c=[],x=q.e-p.e,Ie=m+x+1,_||(_=bt,x=vt(q.e/ve)-vt(p.e/ve),Ie=Ie/ve|0),T=0;Ce[T]==(Re[T]||0);T++);if(Ce[T]>(Re[T]||0)&&x--,Ie<0)ue.push(1),R=!0;else{for(K=Re.length,Ue=Ce.length,T=0,Ie+=2,ie=gt(_/(Ce[0]+1)),ie>1&&(Ce=u(Ce,ie,_),Re=u(Re,ie,_),Ue=Ce.length,K=Re.length),Te=Ue,ae=Re.slice(0,Ue),G=ae.length;G<Ue;ae[G++]=0);ot=Ce.slice(),ot=[0].concat(ot),Le=Ce[0],Ce[1]>=_/2&&Le++;do{if(ie=0,C=d(Ce,ae,Ue,G),C<0){if(re=ae[0],Ue!=G&&(re=re*_+(ae[1]||0)),ie=gt(re/Le),ie>1)for(ie>=_&&(ie=_-1),M=u(Ce,ie,_),N=M.length,G=ae.length;d(M,ae,N,G)==1;)ie--,v(M,Ue<N?ot:Ce,N,_),N=M.length,C=1;else ie==0&&(C=ie=1),M=Ce.slice(),N=M.length;if(N<G&&(M=[0].concat(M)),v(ae,M,G,_),G=ae.length,C==-1)for(;d(Ce,ae,Ue,G)<1;)ie++,v(ae,Ue<G?ot:Ce,G,_),G=ae.length}else C===0&&(ie++,ae=[0]);ue[T++]=ie,ae[0]?ae[G++]=Re[Te]||0:(ae=[Re[Te]],G=1)}while((Te++<K||ae[0]!=null)&&Ie--);R=ae[0]!=null,ue[0]||ue.splice(0,1)}if(_==bt){for(T=1,Ie=ue[0];Ie>=10;Ie/=10,T++);ne(oe,m+(oe.e=T+x*ve-1)+1,b,R)}else oe.e=x,oe.r=+R;return oe}}();function B(u,d,v,q){var p,m,b,_,C;if(v==null?v=s:Ve(v,0,8),!u.c)return u.toString();if(p=u.c[0],b=u.e,d==null)C=mt(u.c),C=q==1||q==2&&(b<=l||b>=g)?Hn(C,b):At(C,b,"0");else if(u=ne(new E(u),d,v),m=u.e,C=mt(u.c),_=C.length,q==1||q==2&&(d<=m||m<=l)){for(;_<d;C+="0",_++);C=Hn(C,m)}else if(d-=b,C=At(C,m,"0"),m+1>_){if(--d>0)for(C+=".";d--;C+="0");}else if(d+=m-_,d>0)for(m+1==_&&(C+=".");d--;C+="0");return u.s<0&&p?"-"+C:C}function F(u,d){for(var v,q,p=1,m=new E(u[0]);p<u.length;p++)q=new E(u[p]),(!q.s||(v=Xt(m,q))===d||v===0&&m.s===d)&&(m=q);return m}function ce(u,d,v){for(var q=1,p=d.length;!d[--p];d.pop());for(p=d[0];p>=10;p/=10,q++);return(v=q+v*ve-1)>k?u.c=u.e=null:v<f?u.c=[u.e=0]:(u.e=v,u.c=d),u}i=function(){var u=/^(-?)0([xbo])(?=\w[\w.]*$)/i,d=/^([^.]+)\.$/,v=/^\.([^.]+)$/,q=/^-?(Infinity|NaN)$/,p=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(m,b,_,C){var x,T=_?b:b.replace(p,"");if(q.test(T))m.s=isNaN(T)?null:T<0?-1:1;else{if(!_&&(T=T.replace(u,function(R,ie,M){return x=(M=M.toLowerCase())=="x"?16:M=="b"?2:8,!C||C==x?ie:R}),C&&(x=C,T=T.replace(d,"$1").replace(v,"0.$1")),b!=T))return new E(T,x);if(E.DEBUG)throw Error(rt+"Not a"+(C?" base "+C:"")+" number: "+b);m.s=null}m.c=m.e=null}}();function ne(u,d,v,q){var p,m,b,_,C,x,T,R=u.c,ie=Mi;if(R){e:{for(p=1,_=R[0];_>=10;_/=10,p++);if(m=d-p,m<0)m+=ve,b=d,C=R[x=0],T=gt(C/ie[p-b-1]%10);else if(x=qi((m+1)/ve),x>=R.length)if(q){for(;R.length<=x;R.push(0));C=T=0,p=1,m%=ve,b=m-ve+1}else break e;else{for(C=_=R[x],p=1;_>=10;_/=10,p++);m%=ve,b=m-ve+p,T=b<0?0:gt(C/ie[p-b-1]%10)}if(q=q||d<0||R[x+1]!=null||(b<0?C:C%ie[p-b-1]),q=v<4?(T||q)&&(v==0||v==(u.s<0?3:2)):T>5||T==5&&(v==4||q||v==6&&(m>0?b>0?C/ie[p-b]:0:R[x-1])%10&1||v==(u.s<0?8:7)),d<1||!R[0])return R.length=0,q?(d-=u.e+1,R[0]=ie[(ve-d%ve)%ve],u.e=-d||0):R[0]=u.e=0,u;if(m==0?(R.length=x,_=1,x--):(R.length=x+1,_=ie[ve-m],R[x]=b>0?gt(C/ie[p-b]%ie[b])*_:0),q)for(;;)if(x==0){for(m=1,b=R[0];b>=10;b/=10,m++);for(b=R[0]+=_,_=1;b>=10;b/=10,_++);m!=_&&(u.e++,R[0]==bt&&(R[0]=1));break}else{if(R[x]+=_,R[x]!=bt)break;R[x--]=0,_=1}for(m=R.length;R[--m]===0;R.pop());}u.e>k?u.c=u.e=null:u.e<f&&(u.c=[u.e=0])}return u}function se(u){var d,v=u.e;return v===null?u.toString():(d=mt(u.c),d=v<=l||v>=g?Hn(d,v):At(d,v,"0"),u.s<0?"-"+d:d)}return o.absoluteValue=o.abs=function(){var u=new E(this);return u.s<0&&(u.s=1),u},o.comparedTo=function(u,d){return Xt(this,new E(u,d))},o.decimalPlaces=o.dp=function(u,d){var v,q,p,m=this;if(u!=null)return Ve(u,0,Qe),d==null?d=s:Ve(d,0,8),ne(new E(m),u+m.e+1,d);if(!(v=m.c))return null;if(q=((p=v.length-1)-vt(this.e/ve))*ve,p=v[p])for(;p%10==0;p/=10,q--);return q<0&&(q=0),q},o.dividedBy=o.div=function(u,d){return t(this,new E(u,d),a,s)},o.dividedToIntegerBy=o.idiv=function(u,d){return t(this,new E(u,d),0,1)},o.exponentiatedBy=o.pow=function(u,d){var v,q,p,m,b,_,C,x,T,R=this;if(u=new E(u),u.c&&!u.isInteger())throw Error(rt+"Exponent not an integer: "+se(u));if(d!=null&&(d=new E(d)),_=u.e>14,!R.c||!R.c[0]||R.c[0]==1&&!R.e&&R.c.length==1||!u.c||!u.c[0])return T=new E(Math.pow(+se(R),_?u.s*(2-Wn(u)):+se(u))),d?T.mod(d):T;if(C=u.s<0,d){if(d.c?!d.c[0]:!d.s)return new E(NaN);q=!C&&R.isInteger()&&d.isInteger(),q&&(R=R.mod(d))}else{if(u.e>9&&(R.e>0||R.e<-1||(R.e==0?R.c[0]>1||_&&R.c[1]>=24e7:R.c[0]<8e13||_&&R.c[0]<=9999975e7)))return m=R.s<0&&Wn(u)?-0:0,R.e>-1&&(m=1/m),new E(C?1/m:m);A&&(m=qi(A/ve+2))}for(_?(v=new E(.5),C&&(u.s=1),x=Wn(u)):(p=Math.abs(+se(u)),x=p%2),T=new E(r);;){if(x){if(T=T.times(R),!T.c)break;m?T.c.length>m&&(T.c.length=m):q&&(T=T.mod(d))}if(p){if(p=gt(p/2),p===0)break;x=p%2}else if(u=u.times(v),ne(u,u.e+1,1),u.e>14)x=Wn(u);else{if(p=+se(u),p===0)break;x=p%2}R=R.times(R),m?R.c&&R.c.length>m&&(R.c.length=m):q&&(R=R.mod(d))}return q?T:(C&&(T=r.div(T)),d?T.mod(d):m?ne(T,A,s,b):T)},o.integerValue=function(u){var d=new E(this);return u==null?u=s:Ve(u,0,8),ne(d,d.e+1,u)},o.isEqualTo=o.eq=function(u,d){return Xt(this,new E(u,d))===0},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(u,d){return Xt(this,new E(u,d))>0},o.isGreaterThanOrEqualTo=o.gte=function(u,d){return(d=Xt(this,new E(u,d)))===1||d===0},o.isInteger=function(){return!!this.c&&vt(this.e/ve)>this.c.length-2},o.isLessThan=o.lt=function(u,d){return Xt(this,new E(u,d))<0},o.isLessThanOrEqualTo=o.lte=function(u,d){return(d=Xt(this,new E(u,d)))===-1||d===0},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&this.c[0]==0},o.minus=function(u,d){var v,q,p,m,b=this,_=b.s;if(u=new E(u,d),d=u.s,!_||!d)return new E(NaN);if(_!=d)return u.s=-d,b.plus(u);var C=b.e/ve,x=u.e/ve,T=b.c,R=u.c;if(!C||!x){if(!T||!R)return T?(u.s=-d,u):new E(R?b:NaN);if(!T[0]||!R[0])return R[0]?(u.s=-d,u):new E(T[0]?b:s==3?-0:0)}if(C=vt(C),x=vt(x),T=T.slice(),_=C-x){for((m=_<0)?(_=-_,p=T):(x=C,p=R),p.reverse(),d=_;d--;p.push(0));p.reverse()}else for(q=(m=(_=T.length)<(d=R.length))?_:d,_=d=0;d<q;d++)if(T[d]!=R[d]){m=T[d]<R[d];break}if(m&&(p=T,T=R,R=p,u.s=-u.s),d=(q=R.length)-(v=T.length),d>0)for(;d--;T[v++]=0);for(d=bt-1;q>_;){if(T[--q]<R[q]){for(v=q;v&&!T[--v];T[v]=d);--T[v],T[q]+=bt}T[q]-=R[q]}for(;T[0]==0;T.splice(0,1),--x);return T[0]?ce(u,T,x):(u.s=s==3?-1:1,u.c=[u.e=0],u)},o.modulo=o.mod=function(u,d){var v,q,p=this;return u=new E(u,d),!p.c||!u.s||u.c&&!u.c[0]?new E(NaN):!u.c||p.c&&!p.c[0]?new E(p):(S==9?(q=u.s,u.s=1,v=t(p,u,0,3),u.s=q,v.s*=q):v=t(p,u,0,S),u=p.minus(v.times(u)),!u.c[0]&&S==1&&(u.s=p.s),u)},o.multipliedBy=o.times=function(u,d){var v,q,p,m,b,_,C,x,T,R,ie,M,N,oe,ue,ae=this,G=ae.c,re=(u=new E(u,d)).c;if(!G||!re||!G[0]||!re[0])return!ae.s||!u.s||G&&!G[0]&&!re||re&&!re[0]&&!G?u.c=u.e=u.s=null:(u.s*=ae.s,!G||!re?u.c=u.e=null:(u.c=[0],u.e=0)),u;for(q=vt(ae.e/ve)+vt(u.e/ve),u.s*=ae.s,C=G.length,R=re.length,C<R&&(N=G,G=re,re=N,p=C,C=R,R=p),p=C+R,N=[];p--;N.push(0));for(oe=bt,ue=Nt,p=R;--p>=0;){for(v=0,ie=re[p]%ue,M=re[p]/ue|0,b=C,m=p+b;m>p;)x=G[--b]%ue,T=G[b]/ue|0,_=M*x+T*ie,x=ie*x+_%ue*ue+N[m]+v,v=(x/oe|0)+(_/ue|0)+M*T,N[m--]=x%oe;N[m]=v}return v?++q:N.splice(0,1),ce(u,N,q)},o.negated=function(){var u=new E(this);return u.s=-u.s||null,u},o.plus=function(u,d){var v,q=this,p=q.s;if(u=new E(u,d),d=u.s,!p||!d)return new E(NaN);if(p!=d)return u.s=-d,q.minus(u);var m=q.e/ve,b=u.e/ve,_=q.c,C=u.c;if(!m||!b){if(!_||!C)return new E(p/0);if(!_[0]||!C[0])return C[0]?u:new E(_[0]?q:p*0)}if(m=vt(m),b=vt(b),_=_.slice(),p=m-b){for(p>0?(b=m,v=C):(p=-p,v=_),v.reverse();p--;v.push(0));v.reverse()}for(p=_.length,d=C.length,p-d<0&&(v=C,C=_,_=v,d=p),p=0;d;)p=(_[--d]=_[d]+C[d]+p)/bt|0,_[d]=bt===_[d]?0:_[d]%bt;return p&&(_=[p].concat(_),++b),ce(u,_,b)},o.precision=o.sd=function(u,d){var v,q,p,m=this;if(u!=null&&u!==!!u)return Ve(u,1,Qe),d==null?d=s:Ve(d,0,8),ne(new E(m),u,d);if(!(v=m.c))return null;if(p=v.length-1,q=p*ve+1,p=v[p]){for(;p%10==0;p/=10,q--);for(p=v[0];p>=10;p/=10,q++);}return u&&m.e+1>q&&(q=m.e+1),q},o.shiftedBy=function(u){return Ve(u,-Ti,Ti),this.times("1e"+u)},o.squareRoot=o.sqrt=function(){var u,d,v,q,p,m=this,b=m.c,_=m.s,C=m.e,x=a+4,T=new E("0.5");if(_!==1||!b||!b[0])return new E(!_||_<0&&(!b||b[0])?NaN:b?m:1/0);if(_=Math.sqrt(+se(m)),_==0||_==1/0?(d=mt(b),(d.length+C)%2==0&&(d+="0"),_=Math.sqrt(+d),C=vt((C+1)/2)-(C<0||C%2),_==1/0?d="5e"+C:(d=_.toExponential(),d=d.slice(0,d.indexOf("e")+1)+C),v=new E(d)):v=new E(_+""),v.c[0]){for(C=v.e,_=C+x,_<3&&(_=0);;)if(p=v,v=T.times(p.plus(t(m,p,x,1))),mt(p.c).slice(0,_)===(d=mt(v.c)).slice(0,_))if(v.e<C&&--_,d=d.slice(_-3,_+1),d=="9999"||!q&&d=="4999"){if(!q&&(ne(p,p.e+a+2,0),p.times(p).eq(m))){v=p;break}x+=4,_+=4,q=1}else{(!+d||!+d.slice(1)&&d.charAt(0)=="5")&&(ne(v,v.e+a+2,1),u=!v.times(v).eq(m));break}}return ne(v,v.e+a+1,s,u)},o.toExponential=function(u,d){return u!=null&&(Ve(u,0,Qe),u++),B(this,u,d,1)},o.toFixed=function(u,d){return u!=null&&(Ve(u,0,Qe),u=u+this.e+1),B(this,u,d)},o.toFormat=function(u,d,v){var q,p=this;if(v==null)u!=null&&d&&typeof d=="object"?(v=d,d=null):u&&typeof u=="object"?(v=u,u=d=null):v=L;else if(typeof v!="object")throw Error(rt+"Argument not an object: "+v);if(q=p.toFixed(u,d),p.c){var m,b=q.split("."),_=+v.groupSize,C=+v.secondaryGroupSize,x=v.groupSeparator||"",T=b[0],R=b[1],ie=p.s<0,M=ie?T.slice(1):T,N=M.length;if(C&&(m=_,_=C,C=m,N-=m),_>0&&N>0){for(m=N%_||_,T=M.substr(0,m);m<N;m+=_)T+=x+M.substr(m,_);C>0&&(T+=x+M.slice(m)),ie&&(T="-"+T)}q=R?T+(v.decimalSeparator||"")+((C=+v.fractionGroupSize)?R.replace(new RegExp("\\d{"+C+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):R):T}return(v.prefix||"")+q+(v.suffix||"")},o.toFraction=function(u){var d,v,q,p,m,b,_,C,x,T,R,ie,M=this,N=M.c;if(u!=null&&(_=new E(u),!_.isInteger()&&(_.c||_.s!==1)||_.lt(r)))throw Error(rt+"Argument "+(_.isInteger()?"out of range: ":"not an integer: ")+se(_));if(!N)return new E(M);for(d=new E(r),x=v=new E(r),q=C=new E(r),ie=mt(N),m=d.e=ie.length-M.e-1,d.c[0]=Mi[(b=m%ve)<0?ve+b:b],u=!u||_.comparedTo(d)>0?m>0?d:x:_,b=k,k=1/0,_=new E(ie),C.c[0]=0;T=t(_,d,0,1),p=v.plus(T.times(q)),p.comparedTo(u)!=1;)v=q,q=p,x=C.plus(T.times(p=x)),C=p,d=_.minus(T.times(p=d)),_=p;return p=t(u.minus(v),q,0,1),C=C.plus(p.times(x)),v=v.plus(p.times(q)),C.s=x.s=M.s,m=m*2,R=t(x,q,m,s).minus(M).abs().comparedTo(t(C,v,m,s).minus(M).abs())<1?[x,q]:[C,v],k=b,R},o.toNumber=function(){return+se(this)},o.toPrecision=function(u,d){return u!=null&&Ve(u,1,Qe),B(this,u,d,2)},o.toString=function(u){var d,v=this,q=v.s,p=v.e;return p===null?q?(d="Infinity",q<0&&(d="-"+d)):d="NaN":(u==null?d=p<=l||p>=g?Hn(mt(v.c),p):At(mt(v.c),p,"0"):u===10&&j?(v=ne(new E(v),a+p+1,s),d=At(mt(v.c),v.e,"0")):(Ve(u,2,I.length,"Base"),d=n(At(mt(v.c),p,"0"),10,u,q,!0)),q<0&&v.c[0]&&(d="-"+d)),d},o.valueOf=o.toJSON=function(){return se(this)},o._isBigNumber=!0,o[Symbol.toStringTag]="BigNumber",o[Symbol.for("nodejs.util.inspect.custom")]=o.valueOf,e!=null&&E.set(e),E}function vt(e){var t=e|0;return e>0||e===t?t:t-1}function mt(e){for(var t,n,i=1,o=e.length,r=e[0]+"";i<o;){for(t=e[i++]+"",n=ve-t.length;n--;t="0"+t);r+=t}for(o=r.length;r.charCodeAt(--o)===48;);return r.slice(0,o+1||1)}function Xt(e,t){var n,i,o=e.c,r=t.c,a=e.s,s=t.s,l=e.e,g=t.e;if(!a||!s)return null;if(n=o&&!o[0],i=r&&!r[0],n||i)return n?i?0:-s:a;if(a!=s)return a;if(n=a<0,i=l==g,!o||!r)return i?0:!o^n?1:-1;if(!i)return l>g^n?1:-1;for(s=(l=o.length)<(g=r.length)?l:g,a=0;a<s;a++)if(o[a]!=r[a])return o[a]>r[a]^n?1:-1;return l==g?0:l>g^n?1:-1}function Ve(e,t,n,i){if(e<t||e>n||e!==gt(e))throw Error(rt+(i||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Wn(e){var t=e.c.length-1;return vt(e.e/ve)==t&&e.c[t]%2!=0}function Hn(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function At(e,t,n){var i,o;if(t<0){for(o=n+".";++t;o+=n);e=o+e}else if(i=e.length,++t>i){for(o=n,t-=i;--t;o+=n);e+=o}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}var Wo=Hr();class c extends Array{constructor(t,n){if(t>c.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");super(t),this.sign=n}static BigInt(t){var n=Math.floor,i=Number.isFinite;if(typeof t=="number"){if(t===0)return c.__zero();if((0|t)===t)return 0>t?c.__oneDigit(-t,!0):c.__oneDigit(t,!1);if(!i(t)||n(t)!==t)throw new RangeError("The number "+t+" cannot be converted to BigInt because it is not an integer");return c.__fromDouble(t)}if(typeof t=="string"){const o=c.__fromString(t);if(o===null)throw new SyntaxError("Cannot convert "+t+" to a BigInt");return o}if(typeof t=="boolean")return t===!0?c.__oneDigit(1,!1):c.__zero();if(typeof t=="object"){if(t.constructor===c)return t;const o=c.__toPrimitive(t);return c.BigInt(o)}throw new TypeError("Cannot convert "+t+" to a BigInt")}toDebugString(){const t=["BigInt["];for(const n of this)t.push((n&&(n>>>0).toString(16))+", ");return t.push("]"),t.join("")}toString(t=10){if(2>t||36<t)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(t&t-1)==0?c.__toStringBasePowerOfTwo(this,t):c.__toStringGeneric(this,t,!1)}static toNumber(t){const n=t.length;if(n===0)return 0;if(n===1){const I=t.__unsignedDigit(0);return t.sign?-I:I}const i=t.__digit(n-1),o=c.__clz32(i),r=32*n-o;if(1024<r)return t.sign?-1/0:1/0;let a=r-1,s=i,l=n-1;const g=o+1;let f=g===32?0:s<<g;f>>>=12;const k=g-12;let w=12<=g?0:s<<20+g,S=20+g;0<k&&0<l&&(l--,s=t.__digit(l),f|=s>>>32-k,w=s<<k,S=k),0<S&&0<l&&(l--,s=t.__digit(l),w|=s>>>32-S,S-=32);const A=c.__decideRounding(t,S,l,s);if((A===1||A===0&&(1&w)==1)&&(w=w+1>>>0,w===0&&(f++,f>>>20!=0&&(f=0,a++,1023<a))))return t.sign?-1/0:1/0;const L=t.sign?-2147483648:0;return a=a+1023<<20,c.__kBitConversionInts[1]=L|a|f,c.__kBitConversionInts[0]=w,c.__kBitConversionDouble[0]}static unaryMinus(t){if(t.length===0)return t;const n=t.__copy();return n.sign=!t.sign,n}static bitwiseNot(t){return t.sign?c.__absoluteSubOne(t).__trim():c.__absoluteAddOne(t,!0)}static exponentiate(t,n){if(n.sign)throw new RangeError("Exponent must be positive");if(n.length===0)return c.__oneDigit(1,!1);if(t.length===0)return t;if(t.length===1&&t.__digit(0)===1)return t.sign&&(1&n.__digit(0))==0?c.unaryMinus(t):t;if(1<n.length)throw new RangeError("BigInt too big");let i=n.__unsignedDigit(0);if(i===1)return t;if(i>=c.__kMaxLengthBits)throw new RangeError("BigInt too big");if(t.length===1&&t.__digit(0)===2){const a=1+(i>>>5),s=t.sign&&(1&i)!=0,l=new c(a,s);l.__initializeDigits();const g=1<<(31&i);return l.__setDigit(a-1,g),l}let o=null,r=t;for((1&i)!=0&&(o=t),i>>=1;i!==0;i>>=1)r=c.multiply(r,r),(1&i)!=0&&(o===null?o=r:o=c.multiply(o,r));return o}static multiply(t,n){if(t.length===0)return t;if(n.length===0)return n;let i=t.length+n.length;32<=t.__clzmsd()+n.__clzmsd()&&i--;const o=new c(i,t.sign!==n.sign);o.__initializeDigits();for(let r=0;r<t.length;r++)c.__multiplyAccumulate(n,t.__digit(r),o,r);return o.__trim()}static divide(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>c.__absoluteCompare(t,n))return c.__zero();const i=t.sign!==n.sign,o=n.__unsignedDigit(0);let r;if(n.length===1&&65535>=o){if(o===1)return i===t.sign?t:c.unaryMinus(t);r=c.__absoluteDivSmall(t,o,null)}else r=c.__absoluteDivLarge(t,n,!0,!1);return r.sign=i,r.__trim()}static remainder(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>c.__absoluteCompare(t,n))return t;const i=n.__unsignedDigit(0);if(n.length===1&&65535>=i){if(i===1)return c.__zero();const r=c.__absoluteModSmall(t,i);return r===0?c.__zero():c.__oneDigit(r,t.sign)}const o=c.__absoluteDivLarge(t,n,!1,!0);return o.sign=t.sign,o.__trim()}static add(t,n){const i=t.sign;return i===n.sign?c.__absoluteAdd(t,n,i):0<=c.__absoluteCompare(t,n)?c.__absoluteSub(t,n,i):c.__absoluteSub(n,t,!i)}static subtract(t,n){const i=t.sign;return i===n.sign?0<=c.__absoluteCompare(t,n)?c.__absoluteSub(t,n,i):c.__absoluteSub(n,t,!i):c.__absoluteAdd(t,n,i)}static leftShift(t,n){return n.length===0||t.length===0?t:n.sign?c.__rightShiftByAbsolute(t,n):c.__leftShiftByAbsolute(t,n)}static signedRightShift(t,n){return n.length===0||t.length===0?t:n.sign?c.__leftShiftByAbsolute(t,n):c.__rightShiftByAbsolute(t,n)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(t,n){return 0>c.__compareToBigInt(t,n)}static lessThanOrEqual(t,n){return 0>=c.__compareToBigInt(t,n)}static greaterThan(t,n){return 0<c.__compareToBigInt(t,n)}static greaterThanOrEqual(t,n){return 0<=c.__compareToBigInt(t,n)}static equal(t,n){if(t.sign!==n.sign||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t.__digit(i)!==n.__digit(i))return!1;return!0}static notEqual(t,n){return!c.equal(t,n)}static bitwiseAnd(t,n){var i=Math.max;if(!t.sign&&!n.sign)return c.__absoluteAnd(t,n).__trim();if(t.sign&&n.sign){const o=i(t.length,n.length)+1;let r=c.__absoluteSubOne(t,o);const a=c.__absoluteSubOne(n);return r=c.__absoluteOr(r,a,r),c.__absoluteAddOne(r,!0,r).__trim()}return t.sign&&([t,n]=[n,t]),c.__absoluteAndNot(t,c.__absoluteSubOne(n)).__trim()}static bitwiseXor(t,n){var i=Math.max;if(!t.sign&&!n.sign)return c.__absoluteXor(t,n).__trim();if(t.sign&&n.sign){const a=i(t.length,n.length),s=c.__absoluteSubOne(t,a),l=c.__absoluteSubOne(n);return c.__absoluteXor(s,l,s).__trim()}const o=i(t.length,n.length)+1;t.sign&&([t,n]=[n,t]);let r=c.__absoluteSubOne(n,o);return r=c.__absoluteXor(r,t,r),c.__absoluteAddOne(r,!0,r).__trim()}static bitwiseOr(t,n){var i=Math.max;const o=i(t.length,n.length);if(!t.sign&&!n.sign)return c.__absoluteOr(t,n).__trim();if(t.sign&&n.sign){let a=c.__absoluteSubOne(t,o);const s=c.__absoluteSubOne(n);return a=c.__absoluteAnd(a,s,a),c.__absoluteAddOne(a,!0,a).__trim()}t.sign&&([t,n]=[n,t]);let r=c.__absoluteSubOne(n,o);return r=c.__absoluteAndNot(r,t,r),c.__absoluteAddOne(r,!0,r).__trim()}static asIntN(t,n){if(n.length===0)return n;if(t===0)return c.__zero();if(t>=c.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=n.__unsignedDigit(i-1),r=1<<(31&t-1);if(n.length===i&&o<r)return n;if((o&r)!==r)return c.__truncateToNBits(t,n);if(!n.sign)return c.__truncateAndSubFromPowerOfTwo(t,n,!0);if((o&r-1)==0){for(let a=i-2;0<=a;a--)if(n.__digit(a)!==0)return c.__truncateAndSubFromPowerOfTwo(t,n,!1);return n.length===i&&o===r?n:c.__truncateToNBits(t,n)}return c.__truncateAndSubFromPowerOfTwo(t,n,!1)}static asUintN(t,n){if(n.length===0)return n;if(t===0)return c.__zero();if(n.sign){if(t>c.__kMaxLengthBits)throw new RangeError("BigInt too big");return c.__truncateAndSubFromPowerOfTwo(t,n,!1)}if(t>=c.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=31&t;return n.length==i&&(o===0||n.__digit(i-1)>>>o==0)?n:c.__truncateToNBits(t,n)}static ADD(t,n){if(t=c.__toPrimitive(t),n=c.__toPrimitive(n),typeof t=="string")return typeof n!="string"&&(n=n.toString()),t+n;if(typeof n=="string")return t.toString()+n;if(t=c.__toNumeric(t),n=c.__toNumeric(n),c.__isBigInt(t)&&c.__isBigInt(n))return c.add(t,n);if(typeof t=="number"&&typeof n=="number")return t+n;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(t,n){return c.__compare(t,n,0)}static LE(t,n){return c.__compare(t,n,1)}static GT(t,n){return c.__compare(t,n,2)}static GE(t,n){return c.__compare(t,n,3)}static EQ(t,n){for(;;){if(c.__isBigInt(t))return c.__isBigInt(n)?c.equal(t,n):c.EQ(n,t);if(typeof t=="number"){if(c.__isBigInt(n))return c.__equalToNumber(n,t);if(typeof n!="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="string"){if(c.__isBigInt(n))return t=c.__fromString(t),t!==null&&c.equal(t,n);if(typeof n!="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="boolean"){if(c.__isBigInt(n))return c.__equalToNumber(n,+t);if(typeof n!="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="symbol"){if(c.__isBigInt(n))return!1;if(typeof n!="object")return t==n;n=c.__toPrimitive(n)}else if(typeof t=="object"){if(typeof n=="object"&&n.constructor!==c)return t==n;t=c.__toPrimitive(t)}else return t==n}}static NE(t,n){return!c.EQ(t,n)}static __zero(){return new c(0,!1)}static __oneDigit(t,n){const i=new c(1,n);return i.__setDigit(0,t),i}__copy(){const t=new c(this.length,this.sign);for(let n=0;n<this.length;n++)t[n]=this[n];return t}__trim(){let t=this.length,n=this[t-1];for(;n===0;)t--,n=this[t-1],this.pop();return t===0&&(this.sign=!1),this}__initializeDigits(){for(let t=0;t<this.length;t++)this[t]=0}static __decideRounding(t,n,i,o){if(0<n)return-1;let r;if(0>n)r=-n-1;else{if(i===0)return-1;i--,o=t.__digit(i),r=31}let a=1<<r;if((o&a)==0)return-1;if(a-=1,(o&a)!=0)return 1;for(;0<i;)if(i--,t.__digit(i)!==0)return 1;return 0}static __fromDouble(t){c.__kBitConversionDouble[0]=t;const n=2047&c.__kBitConversionInts[1]>>>20,i=n-1023,o=(i>>>5)+1,r=new c(o,0>t);let a=1048575&c.__kBitConversionInts[1]|1048576,s=c.__kBitConversionInts[0];const l=20,g=31&i;let f,k=0;if(g<20){const w=l-g;k=w+32,f=a>>>w,a=a<<32-w|s>>>w,s<<=32-w}else if(g===20)k=32,f=a,a=s;else{const w=g-l;k=32-w,f=a<<w|s>>>32-w,a=s<<w}r.__setDigit(o-1,f);for(let w=o-2;0<=w;w--)0<k?(k-=32,f=a,a=s):f=0,r.__setDigit(w,f);return r.__trim()}static __isWhitespace(t){return 13>=t&&9<=t||(159>=t?t==32:131071>=t?t==160||t==5760:196607>=t?(t&=131071,10>=t||t==40||t==41||t==47||t==95||t==4096):t==65279)}static __fromString(t,n=0){let i=0;const o=t.length;let r=0;if(r===o)return c.__zero();let a=t.charCodeAt(r);for(;c.__isWhitespace(a);){if(++r===o)return c.__zero();a=t.charCodeAt(r)}if(a===43){if(++r===o)return null;a=t.charCodeAt(r),i=1}else if(a===45){if(++r===o)return null;a=t.charCodeAt(r),i=-1}if(n===0){if(n=10,a===48){if(++r===o)return c.__zero();if(a=t.charCodeAt(r),a===88||a===120){if(n=16,++r===o)return null;a=t.charCodeAt(r)}else if(a===79||a===111){if(n=8,++r===o)return null;a=t.charCodeAt(r)}else if(a===66||a===98){if(n=2,++r===o)return null;a=t.charCodeAt(r)}}}else if(n===16&&a===48){if(++r===o)return c.__zero();if(a=t.charCodeAt(r),a===88||a===120){if(++r===o)return null;a=t.charCodeAt(r)}}for(;a===48;){if(++r===o)return c.__zero();a=t.charCodeAt(r)}const s=o-r;let l=c.__kMaxBitsPerChar[n],g=c.__kBitsPerCharTableMultiplier-1;if(s>1073741824/l)return null;const f=l*s+g>>>c.__kBitsPerCharTableShift,k=new c(f+31>>>5,!1),w=10>n?n:10,S=10<n?n-10:0;if((n&n-1)==0){l>>=c.__kBitsPerCharTableShift;const A=[],L=[];let I=!1;do{let j=0,E=0;for(;;){let B;if(a-48>>>0<w)B=a-48;else if((32|a)-97>>>0<S)B=(32|a)-87;else{I=!0;break}if(E+=l,j=j<<l|B,++r===o){I=!0;break}if(a=t.charCodeAt(r),32<E+l)break}A.push(j),L.push(E)}while(!I);c.__fillFromParts(k,A,L)}else{k.__initializeDigits();let A=!1,L=0;do{let I=0,j=1;for(;;){let B;if(a-48>>>0<w)B=a-48;else if((32|a)-97>>>0<S)B=(32|a)-87;else{A=!0;break}const F=j*n;if(4294967295<F)break;if(j=F,I=I*n+B,L++,++r===o){A=!0;break}a=t.charCodeAt(r)}g=32*c.__kBitsPerCharTableMultiplier-1;const E=l*L+g>>>c.__kBitsPerCharTableShift+5;k.__inplaceMultiplyAdd(j,I,E)}while(!A)}if(r!==o){if(!c.__isWhitespace(a))return null;for(r++;r<o;r++)if(a=t.charCodeAt(r),!c.__isWhitespace(a))return null}return i!=0&&n!==10?null:(k.sign=i==-1,k.__trim())}static __fillFromParts(t,n,i){let o=0,r=0,a=0;for(let s=n.length-1;0<=s;s--){const l=n[s],g=i[s];r|=l<<a,a+=g,a===32?(t.__setDigit(o++,r),a=0,r=0):32<a&&(t.__setDigit(o++,r),a-=32,r=l>>>g-a)}if(r!==0){if(o>=t.length)throw new Error("implementation bug");t.__setDigit(o++,r)}for(;o<t.length;o++)t.__setDigit(o,0)}static __toStringBasePowerOfTwo(t,n){const i=t.length;let o=n-1;o=(85&o>>>1)+(85&o),o=(51&o>>>2)+(51&o),o=(15&o>>>4)+(15&o);const r=o,a=n-1,s=t.__digit(i-1),l=c.__clz32(s);let g=0|(32*i-l+r-1)/r;if(t.sign&&g++,268435456<g)throw new Error("string too long");const f=Array(g);let k=g-1,w=0,S=0;for(let L=0;L<i-1;L++){const I=t.__digit(L),j=(w|I<<S)&a;f[k--]=c.__kConversionChars[j];const E=r-S;for(w=I>>>E,S=32-E;S>=r;)f[k--]=c.__kConversionChars[w&a],w>>>=r,S-=r}const A=(w|s<<S)&a;for(f[k--]=c.__kConversionChars[A],w=s>>>r-S;w!==0;)f[k--]=c.__kConversionChars[w&a],w>>>=r;if(t.sign&&(f[k--]="-"),k!=-1)throw new Error("implementation bug");return f.join("")}static __toStringGeneric(t,n,i){const o=t.length;if(o===0)return"";if(o===1){let L=t.__unsignedDigit(0).toString(n);return i===!1&&t.sign&&(L="-"+L),L}const r=32*o-c.__clz32(t.__digit(o-1)),a=c.__kMaxBitsPerChar[n],s=a-1;let l=r*c.__kBitsPerCharTableMultiplier;l+=s-1,l=0|l/s;const g=l+1>>1,f=c.exponentiate(c.__oneDigit(n,!1),c.__oneDigit(g,!1));let k,w;const S=f.__unsignedDigit(0);if(f.length===1&&65535>=S){k=new c(t.length,!1),k.__initializeDigits();let L=0;for(let I=2*t.length-1;0<=I;I--){const j=L<<16|t.__halfDigit(I);k.__setHalfDigit(I,0|j/S),L=0|j%S}w=L.toString(n)}else{const L=c.__absoluteDivLarge(t,f,!0,!0);k=L.quotient;const I=L.remainder.__trim();w=c.__toStringGeneric(I,n,!0)}k.__trim();let A=c.__toStringGeneric(k,n,!0);for(;w.length<g;)w="0"+w;return i===!1&&t.sign&&(A="-"+A),A+w}static __unequalSign(t){return t?-1:1}static __absoluteGreater(t){return t?-1:1}static __absoluteLess(t){return t?1:-1}static __compareToBigInt(t,n){const i=t.sign;if(i!==n.sign)return c.__unequalSign(i);const o=c.__absoluteCompare(t,n);return 0<o?c.__absoluteGreater(i):0>o?c.__absoluteLess(i):0}static __compareToNumber(t,n){if(n|!0){const i=t.sign,o=0>n;if(i!==o)return c.__unequalSign(i);if(t.length===0){if(o)throw new Error("implementation bug");return n===0?0:-1}if(1<t.length)return c.__absoluteGreater(i);const r=Math.abs(n),a=t.__unsignedDigit(0);return a>r?c.__absoluteGreater(i):a<r?c.__absoluteLess(i):0}return c.__compareToDouble(t,n)}static __compareToDouble(t,n){if(n!==n)return n;if(n===1/0)return-1;if(n===-1/0)return 1;const i=t.sign;if(i!==0>n)return c.__unequalSign(i);if(n===0)throw new Error("implementation bug: should be handled elsewhere");if(t.length===0)return-1;c.__kBitConversionDouble[0]=n;const o=2047&c.__kBitConversionInts[1]>>>20;if(o==2047)throw new Error("implementation bug: handled elsewhere");const r=o-1023;if(0>r)return c.__absoluteGreater(i);const a=t.length;let s=t.__digit(a-1);const l=c.__clz32(s),g=32*a-l,f=r+1;if(g<f)return c.__absoluteLess(i);if(g>f)return c.__absoluteGreater(i);let k=1048576|1048575&c.__kBitConversionInts[1],w=c.__kBitConversionInts[0];const S=20,A=31-l;if(A!==(g-1)%31)throw new Error("implementation bug");let L,I=0;if(20>A){const j=S-A;I=j+32,L=k>>>j,k=k<<32-j|w>>>j,w<<=32-j}else if(A===20)I=32,L=k,k=w;else{const j=A-S;I=32-j,L=k<<j|w>>>32-j,k=w<<j}if(s>>>=0,L>>>=0,s>L)return c.__absoluteGreater(i);if(s<L)return c.__absoluteLess(i);for(let j=a-2;0<=j;j--){0<I?(I-=32,L=k>>>0,k=w,w=0):L=0;const E=t.__unsignedDigit(j);if(E>L)return c.__absoluteGreater(i);if(E<L)return c.__absoluteLess(i)}if(k!==0||w!==0){if(I===0)throw new Error("implementation bug");return c.__absoluteLess(i)}return 0}static __equalToNumber(t,n){var i=Math.abs;return n|n===0?n===0?t.length===0:t.length===1&&t.sign===0>n&&t.__unsignedDigit(0)===i(n):c.__compareToDouble(t,n)===0}static __comparisonResultToBool(t,n){switch(n){case 0:return 0>t;case 1:return 0>=t;case 2:return 0<t;case 3:return 0<=t}throw new Error("unreachable")}static __compare(t,n,i){if(t=c.__toPrimitive(t),n=c.__toPrimitive(n),typeof t=="string"&&typeof n=="string")switch(i){case 0:return t<n;case 1:return t<=n;case 2:return t>n;case 3:return t>=n}if(c.__isBigInt(t)&&typeof n=="string")return n=c.__fromString(n),n!==null&&c.__comparisonResultToBool(c.__compareToBigInt(t,n),i);if(typeof t=="string"&&c.__isBigInt(n))return t=c.__fromString(t),t!==null&&c.__comparisonResultToBool(c.__compareToBigInt(t,n),i);if(t=c.__toNumeric(t),n=c.__toNumeric(n),c.__isBigInt(t)){if(c.__isBigInt(n))return c.__comparisonResultToBool(c.__compareToBigInt(t,n),i);if(typeof n!="number")throw new Error("implementation bug");return c.__comparisonResultToBool(c.__compareToNumber(t,n),i)}if(typeof t!="number")throw new Error("implementation bug");if(c.__isBigInt(n))return c.__comparisonResultToBool(c.__compareToNumber(n,t),2^i);if(typeof n!="number")throw new Error("implementation bug");return i===0?t<n:i===1?t<=n:i===2?t>n:i===3?t>=n:void 0}__clzmsd(){return c.__clz32(this[this.length-1])}static __absoluteAdd(t,n,i){if(t.length<n.length)return c.__absoluteAdd(n,t,i);if(t.length===0)return t;if(n.length===0)return t.sign===i?t:c.unaryMinus(t);let o=t.length;(t.__clzmsd()===0||n.length===t.length&&n.__clzmsd()===0)&&o++;const r=new c(o,i);let a=0,s=0;for(;s<n.length;s++){const l=n.__digit(s),g=t.__digit(s),f=(65535&g)+(65535&l)+a,k=(g>>>16)+(l>>>16)+(f>>>16);a=k>>>16,r.__setDigit(s,65535&f|k<<16)}for(;s<t.length;s++){const l=t.__digit(s),g=(65535&l)+a,f=(l>>>16)+(g>>>16);a=f>>>16,r.__setDigit(s,65535&g|f<<16)}return s<r.length&&r.__setDigit(s,a),r.__trim()}static __absoluteSub(t,n,i){if(t.length===0)return t;if(n.length===0)return t.sign===i?t:c.unaryMinus(t);const o=new c(t.length,i);let r=0,a=0;for(;a<n.length;a++){const s=t.__digit(a),l=n.__digit(a),g=(65535&s)-(65535&l)-r;r=1&g>>>16;const f=(s>>>16)-(l>>>16)-r;r=1&f>>>16,o.__setDigit(a,65535&g|f<<16)}for(;a<t.length;a++){const s=t.__digit(a),l=(65535&s)-r;r=1&l>>>16;const g=(s>>>16)-r;r=1&g>>>16,o.__setDigit(a,65535&l|g<<16)}return o.__trim()}static __absoluteAddOne(t,n,i=null){const o=t.length;i===null?i=new c(o,n):i.sign=n;let r=!0;for(let a,s=0;s<o;s++){if(a=t.__digit(s),r){const l=a===-1;a=0|a+1,r=l}i.__setDigit(s,a)}return r&&i.__setDigitGrow(o,1),i}static __absoluteSubOne(t,n){const i=t.length;n=n||i;const o=new c(n,!1);let r=!0;for(let a,s=0;s<i;s++){if(a=t.__digit(s),r){const l=a===0;a=0|a-1,r=l}o.__setDigit(s,a)}if(r)throw new Error("implementation bug");for(let a=i;a<n;a++)o.__setDigit(a,0);return o}static __absoluteAnd(t,n,i=null){let o=t.length,r=n.length,a=r;if(o<r){a=o;const g=t,f=o;t=n,o=r,n=g,r=f}let s=a;i===null?i=new c(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&n.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteAndNot(t,n,i=null){const o=t.length,r=n.length;let a=r;o<r&&(a=o);let s=o;i===null?i=new c(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&~n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteOr(t,n,i=null){let o=t.length,r=n.length,a=r;if(o<r){a=o;const g=t,f=o;t=n,o=r,n=g,r=f}let s=o;i===null?i=new c(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)|n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteXor(t,n,i=null){let o=t.length,r=n.length,a=r;if(o<r){a=o;const g=t,f=o;t=n,o=r,n=g,r=f}let s=o;i===null?i=new c(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)^n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteCompare(t,n){const i=t.length-n.length;if(i!=0)return i;let o=t.length-1;for(;0<=o&&t.__digit(o)===n.__digit(o);)o--;return 0>o?0:t.__unsignedDigit(o)>n.__unsignedDigit(o)?1:-1}static __multiplyAccumulate(t,n,i,o){if(n===0)return;const r=65535&n,a=n>>>16;let s=0,l=0,g=0;for(let f=0;f<t.length;f++,o++){let k=i.__digit(o),w=65535&k,S=k>>>16;const A=t.__digit(f),L=65535&A,I=A>>>16,j=c.__imul(L,r),E=c.__imul(L,a),B=c.__imul(I,r),F=c.__imul(I,a);w+=l+(65535&j),S+=g+s+(w>>>16)+(j>>>16)+(65535&E)+(65535&B),s=S>>>16,l=(E>>>16)+(B>>>16)+(65535&F)+s,s=l>>>16,l&=65535,g=F>>>16,k=65535&w|S<<16,i.__setDigit(o,k)}for(;s!=0||l!==0||g!==0;o++){let f=i.__digit(o);const k=(65535&f)+l,w=(f>>>16)+(k>>>16)+g+s;l=0,g=0,s=w>>>16,f=65535&k|w<<16,i.__setDigit(o,f)}}static __internalMultiplyAdd(t,n,i,o,r){let a=i,s=0;for(let l=0;l<o;l++){const g=t.__digit(l),f=c.__imul(65535&g,n),k=(65535&f)+s+a;a=k>>>16;const w=c.__imul(g>>>16,n),S=(65535&w)+(f>>>16)+a;a=S>>>16,s=w>>>16,r.__setDigit(l,S<<16|65535&k)}if(r.length>o)for(r.__setDigit(o++,a+s);o<r.length;)r.__setDigit(o++,0);else if(a+s!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(t,n,i){i>this.length&&(i=this.length);const o=65535&t,r=t>>>16;let a=0,s=65535&n,l=n>>>16;for(let g=0;g<i;g++){const f=this.__digit(g),k=65535&f,w=f>>>16,S=c.__imul(k,o),A=c.__imul(k,r),L=c.__imul(w,o),I=c.__imul(w,r),j=s+(65535&S),E=l+a+(j>>>16)+(S>>>16)+(65535&A)+(65535&L);s=(A>>>16)+(L>>>16)+(65535&I)+(E>>>16),a=s>>>16,s&=65535,l=I>>>16,this.__setDigit(g,65535&j|E<<16)}if(a!=0||s!==0||l!==0)throw new Error("implementation bug")}static __absoluteDivSmall(t,n,i){i===null&&(i=new c(t.length,!1));let o=0;for(let r,a=2*t.length-1;0<=a;a-=2){r=(o<<16|t.__halfDigit(a))>>>0;const s=0|r/n;o=0|r%n,r=(o<<16|t.__halfDigit(a-1))>>>0;const l=0|r/n;o=0|r%n,i.__setDigit(a>>>1,s<<16|l)}return i}static __absoluteModSmall(t,n){let i=0;for(let o=2*t.length-1;0<=o;o--){const r=(i<<16|t.__halfDigit(o))>>>0;i=0|r%n}return i}static __absoluteDivLarge(t,n,i,o){const r=n.__halfDigitLength(),a=n.length,s=t.__halfDigitLength()-r;let l=null;i&&(l=new c(s+2>>>1,!1),l.__initializeDigits());const g=new c(r+2>>>1,!1);g.__initializeDigits();const f=c.__clz16(n.__halfDigit(r-1));0<f&&(n=c.__specialLeftShift(n,f,0));const k=c.__specialLeftShift(t,f,1),w=n.__halfDigit(r-1);let S=0;for(let A,L=s;0<=L;L--){A=65535;const I=k.__halfDigit(L+r);if(I!==w){const E=(I<<16|k.__halfDigit(L+r-1))>>>0;A=0|E/w;let B=0|E%w;const F=n.__halfDigit(r-2),ce=k.__halfDigit(L+r-2);for(;c.__imul(A,F)>>>0>(B<<16|ce)>>>0&&(A--,B+=w,!(65535<B)););}c.__internalMultiplyAdd(n,A,0,a,g);let j=k.__inplaceSub(g,L,r+1);j!==0&&(j=k.__inplaceAdd(n,L,r),k.__setHalfDigit(L+r,k.__halfDigit(L+r)+j),A--),i&&(1&L?S=A<<16:l.__setDigit(L>>>1,S|A))}return o?(k.__inplaceRightShift(f),i?{quotient:l,remainder:k}:k):i?l:void 0}static __clz16(t){return c.__clz32(t)-16}__inplaceAdd(t,n,i){let o=0;for(let r=0;r<i;r++){const a=this.__halfDigit(n+r)+t.__halfDigit(r)+o;o=a>>>16,this.__setHalfDigit(n+r,a)}return o}__inplaceSub(t,n,i){let o=0;if(1&n){n>>=1;let r=this.__digit(n),a=65535&r,s=0;for(;s<i-1>>>1;s++){const f=t.__digit(s),k=(r>>>16)-(65535&f)-o;o=1&k>>>16,this.__setDigit(n+s,k<<16|65535&a),r=this.__digit(n+s+1),a=(65535&r)-(f>>>16)-o,o=1&a>>>16}const l=t.__digit(s),g=(r>>>16)-(65535&l)-o;if(o=1&g>>>16,this.__setDigit(n+s,g<<16|65535&a),n+s+1>=this.length)throw new RangeError("out of bounds");(1&i)==0&&(r=this.__digit(n+s+1),a=(65535&r)-(l>>>16)-o,o=1&a>>>16,this.__setDigit(n+t.length,4294901760&r|65535&a))}else{n>>=1;let r=0;for(;r<t.length-1;r++){const f=this.__digit(n+r),k=t.__digit(r),w=(65535&f)-(65535&k)-o;o=1&w>>>16;const S=(f>>>16)-(k>>>16)-o;o=1&S>>>16,this.__setDigit(n+r,S<<16|65535&w)}const a=this.__digit(n+r),s=t.__digit(r),l=(65535&a)-(65535&s)-o;o=1&l>>>16;let g=0;(1&i)==0&&(g=(a>>>16)-(s>>>16)-o,o=1&g>>>16),this.__setDigit(n+r,g<<16|65535&l)}return o}__inplaceRightShift(t){if(t===0)return;let n=this.__digit(0)>>>t;const i=this.length-1;for(let o=0;o<i;o++){const r=this.__digit(o+1);this.__setDigit(o,r<<32-t|n),n=r>>>t}this.__setDigit(i,n)}static __specialLeftShift(t,n,i){const o=t.length,r=new c(o+i,!1);if(n===0){for(let s=0;s<o;s++)r.__setDigit(s,t.__digit(s));return 0<i&&r.__setDigit(o,0),r}let a=0;for(let s=0;s<o;s++){const l=t.__digit(s);r.__setDigit(s,l<<n|a),a=l>>>32-n}return 0<i&&r.__setDigit(o,a),r}static __leftShiftByAbsolute(t,n){const i=c.__toShiftAmount(n);if(0>i)throw new RangeError("BigInt too big");const o=i>>>5,r=31&i,a=t.length,s=r!==0&&t.__digit(a-1)>>>32-r!=0,l=a+o+(s?1:0),g=new c(l,t.sign);if(r===0){let f=0;for(;f<o;f++)g.__setDigit(f,0);for(;f<l;f++)g.__setDigit(f,t.__digit(f-o))}else{let f=0;for(let k=0;k<o;k++)g.__setDigit(k,0);for(let k=0;k<a;k++){const w=t.__digit(k);g.__setDigit(k+o,w<<r|f),f=w>>>32-r}if(s)g.__setDigit(a+o,f);else if(f!==0)throw new Error("implementation bug")}return g.__trim()}static __rightShiftByAbsolute(t,n){const i=t.length,o=t.sign,r=c.__toShiftAmount(n);if(0>r)return c.__rightShiftByMaximum(o);const a=r>>>5,s=31&r;let l=i-a;if(0>=l)return c.__rightShiftByMaximum(o);let g=!1;if(o){if((t.__digit(a)&(1<<s)-1)!=0)g=!0;else for(let k=0;k<a;k++)if(t.__digit(k)!==0){g=!0;break}}g&&s===0&&~t.__digit(i-1)==0&&l++;let f=new c(l,o);if(s===0)for(let k=a;k<i;k++)f.__setDigit(k-a,t.__digit(k));else{let k=t.__digit(a)>>>s;const w=i-a-1;for(let S=0;S<w;S++){const A=t.__digit(S+a+1);f.__setDigit(S,A<<32-s|k),k=A>>>s}f.__setDigit(w,k)}return g&&(f=c.__absoluteAddOne(f,!0,f)),f.__trim()}static __rightShiftByMaximum(t){return t?c.__oneDigit(1,!0):c.__zero()}static __toShiftAmount(t){if(1<t.length)return-1;const n=t.__unsignedDigit(0);return n>c.__kMaxLengthBits?-1:n}static __toPrimitive(t,n="default"){if(typeof t!="object"||t.constructor===c)return t;const i=t[Symbol.toPrimitive];if(i){const a=i(n);if(typeof a!="object")return a;throw new TypeError("Cannot convert object to primitive value")}const o=t.valueOf;if(o){const a=o.call(t);if(typeof a!="object")return a}const r=t.toString;if(r){const a=r.call(t);if(typeof a!="object")return a}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(t){return c.__isBigInt(t)?t:+t}static __isBigInt(t){return typeof t=="object"&&t!==null&&t.constructor===c}static __truncateToNBits(t,n){const i=t+31>>>5,o=new c(i,n.sign),r=i-1;for(let s=0;s<r;s++)o.__setDigit(s,n.__digit(s));let a=n.__digit(r);if((31&t)!=0){const s=32-(31&t);a=a<<s>>>s}return o.__setDigit(r,a),o.__trim()}static __truncateAndSubFromPowerOfTwo(t,n,i){var o=Math.min;const r=t+31>>>5,a=new c(r,i);let s=0;const l=r-1;let g=0;for(const S=o(l,n.length);s<S;s++){const A=n.__digit(s),L=0-(65535&A)-g;g=1&L>>>16;const I=0-(A>>>16)-g;g=1&I>>>16,a.__setDigit(s,65535&L|I<<16)}for(;s<l;s++)a.__setDigit(s,0|-g);let f=l<n.length?n.__digit(l):0;const k=31&t;let w;if(k==0){const S=0-(65535&f)-g;g=1&S>>>16;const A=0-(f>>>16)-g;w=65535&S|A<<16}else{const S=32-k;f=f<<S>>>S;const A=1<<32-S,L=(65535&A)-(65535&f)-g;g=1&L>>>16;const I=(A>>>16)-(f>>>16)-g;w=65535&L|I<<16,w&=A-1}return a.__setDigit(l,w),a.__trim()}__digit(t){return this[t]}__unsignedDigit(t){return this[t]>>>0}__setDigit(t,n){this[t]=0|n}__setDigitGrow(t,n){this[t]=0|n}__halfDigitLength(){const t=this.length;return 65535>=this.__unsignedDigit(t-1)?2*t-1:2*t}__halfDigit(t){return 65535&this[t>>>1]>>>((1&t)<<4)}__setHalfDigit(t,n){const i=t>>>1,o=this.__digit(i),r=1&t?65535&o|n<<16:4294901760&o|65535&n;this.__setDigit(i,r)}static __digitPow(t,n){let i=1;for(;0<n;)1&n&&(i*=t),n>>>=1,t*=t;return i}}c.__kMaxLength=33554432,c.__kMaxLengthBits=c.__kMaxLength<<5,c.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],c.__kBitsPerCharTableShift=5,c.__kBitsPerCharTableMultiplier=1<<c.__kBitsPerCharTableShift,c.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],c.__kBitConversionBuffer=new ArrayBuffer(8),c.__kBitConversionDouble=new Float64Array(c.__kBitConversionBuffer),c.__kBitConversionInts=new Int32Array(c.__kBitConversionBuffer),c.__clz32=Math.clz32||function(e){return e===0?32:0|31-(0|Math.log(e>>>0)/Math.LN2)},c.__imul=Math.imul||function(e,t){return 0|e*t};var Af=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Ef=18446744073709552e3,Ho=function(e,t){return c.bitwiseXor(c.asUintN(64,c.leftShift(e,c.BigInt(t))),c.BigInt(c.asUintN(64,c.signedRightShift(e,c.subtract(c.BigInt(64),c.BigInt(t))))))},If=function(){function e(t){var n=this;this.next=function(){return new Wo(n.roll().toString())},this.nextDouble=function(){return new Wo(n.roll().toString()).div(Ef+1)},this.nextInt=function(o,r){return Math.floor(n.nextDouble().toNumber()*(r-o+1)+o)},this.nextByte=function(){return n.nextInt(0,255)},this.nextData=function(o){return Af(new Array(o)).map(function(){return n.nextByte()})};var i=ad(t);this.s=[c.BigInt(0),c.BigInt(0),c.BigInt(0),c.BigInt(0)],this.setS(i)}return e.prototype.setS=function(t){for(var n=0;n<4;n++){for(var i=n*8,o=c.BigInt(0),r=0;r<8;r++)o=c.asUintN(64,c.leftShift(o,c.BigInt(8))),o=c.asUintN(64,c.bitwiseOr(o,c.BigInt(t[i+r])));this.s[n]=c.asUintN(64,o)}},e.prototype.roll=function(){var t=c.asUintN(64,c.multiply(Ho(c.asUintN(64,c.multiply(this.s[1],c.BigInt(5))),7),c.BigInt(9))),n=c.asUintN(64,c.leftShift(this.s[1],c.BigInt(17)));return this.s[2]=c.asUintN(64,c.bitwiseXor(this.s[2],c.BigInt(this.s[0]))),this.s[3]=c.asUintN(64,c.bitwiseXor(this.s[3],c.BigInt(this.s[1]))),this.s[1]=c.asUintN(64,c.bitwiseXor(this.s[1],c.BigInt(this.s[2]))),this.s[0]=c.asUintN(64,c.bitwiseXor(this.s[0],c.BigInt(this.s[3]))),this.s[2]=c.asUintN(64,c.bitwiseXor(this.s[2],c.BigInt(n))),this.s[3]=c.asUintN(64,Ho(this.s[3],45)),t},e}();function Nn(e,t,n){this.alias=[],this.prob=[],this.outcomes=t||this.indexedOutcomes(e.length),this.rng=n||Math.random,this.precomputeAlias(e)}Nn.prototype.next=function(e){var t=e||1,n=[],i=0;do{var o=Math.floor(this.rng()*this.prob.length);n[i]=this.outcomes[this.rng()<this.prob[o]?o:this.alias[o]]}while(++i<t);return t>1?n:n[0]};Nn.prototype.precomputeAlias=function(e){var t=e.length,n=0,i=0,o=0,r=[],a=[],s=[],l,g,f;for(g=0;g<t;++g){if(e[g]<0)throw"Probability must be a positive: p["+g+"]="+e[g];n+=e[g]}if(n===0)throw"Probability cannot be zero.";for(g=0;g<t;++g)r[g]=e[g]*t/n;for(g=t-1;g>=0;--g)r[g]<1?a[i++]=g:s[o++]=g;for(;i&&o;)f=a[--i],l=s[--o],this.prob[f]=r[f],this.alias[f]=l,r[l]=r[l]+r[f]-1,r[l]<1?a[i++]=l:s[o++]=l;for(;o;)this.prob[s[--o]]=1;for(;i;)this.prob[a[--i]]=1};Nn.prototype.indexedOutcomes=function(e){for(var t=[],n=0;n<e;n++)t[n]=n;return t};Nn.prototype.randomInt=function(e,t){return Math.floor(this.rng()*(t-e))+e};var Rf=function(e,t,n){return new Nn(e,t,n)},no=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Lf=function(e,t){var n=no(new Array(e)).map(function(o,r){return 1/(r+1)}),i=Rf(n,null,t.nextDouble);return i.next()+1},Of=function(e,t){for(var n=no(e),i=[];n.length>0;){var o=t.nextInt(0,n.length-1),r=n[o];n.splice(o,1),i.push(r)}return i},Qr=function(e,t,n){if(e<=t)return[e-1];var i=Oe.Buffer.concat([No(e),No(n)]),o=new If(i),r=Lf(t,o),a=no(new Array(t)).map(function(l,g){return g}),s=Of(a,o);return s.slice(0,r)},Kr=function(){function e(t,n,i,o,r){this._seqNum=t,this._seqLength=n,this._messageLength=i,this._checksum=o,this._fragment=r}return Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqNum",{get:function(){return this._seqNum},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqLength",{get:function(){return this._seqLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checksum",{get:function(){return this._checksum},enumerable:!1,configurable:!0}),e.prototype.cbor=function(){var t=jr([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return Oe.Buffer.from(t)},e.prototype.description=function(){return"seqNum:"+this._seqNum+", seqLen:"+this._seqLength+", messageLen:"+this._messageLength+", checksum:"+this._checksum+", data:"+this._fragment.toString("hex")},e.fromCBOR=function(t){var n=Wr(t),i=n[0],o=n[1],r=n[2],a=n[3],s=n[4];if(typeof i!="number"||typeof o!="number"||typeof r!="number"||typeof a!="number"||Oe.Buffer.isBuffer(s)&&s.length<=0)throw new Error("type error");return new e(i,o,r,a,Oe.Buffer.from(s))},e}(),Uf=function(){function e(t,n,i,o){n===void 0&&(n=100),i===void 0&&(i=0),o===void 0&&(o=10);var r=e.findNominalFragmentLength(t.length,o,n);this._messageLength=t.length,this._fragments=e.partitionMessage(t,r),this.fragmentLength=r,this.seqNum=Ri(i),this.checksum=$r(t)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this._fragments.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this._fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),e.prototype.isComplete=function(){return this.seqNum>=this._fragments.length},e.prototype.isSinglePart=function(){return this._fragments.length===1},e.prototype.seqLength=function(){return this._fragments.length},e.prototype.mix=function(t){var n=this;return t.reduce(function(i,o){return Er(n._fragments[o],i)},Oe.Buffer.alloc(this.fragmentLength,0))},e.prototype.nextPart=function(){this.seqNum=Ri(this.seqNum+1);var t=Qr(this.seqNum,this._fragments.length,this.checksum),n=this.mix(t);return new Kr(this.seqNum,this._fragments.length,this._messageLength,this.checksum,n)},e.findNominalFragmentLength=function(t,n,i){if(t<=0||n<=0||i<n)throw new Error("invalid fragment or message length");for(var o=Math.ceil(t/n),r=0,a=1;a<=o&&(r=Math.ceil(t/a),!(r<=i));a++);return r},e.partitionMessage=function(t,n){for(var i,o=Oe.Buffer.from(t),r,a=[];o.length>0;)i=xr(o,-n),r=i[0],o=i[1],r=Oe.Buffer.alloc(n,0).fill(r,0,r.length),a.push(r);return a},e}(),Xr=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Nf="ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom",Qn=[],Vf=256,jt=4,Bf=2,Pt;(function(e){e.STANDARD="standard",e.URI="uri",e.MINIMAL="minimal"})(Pt||(Pt={}));var ai=function(e){return Nf.slice(e*jt,e*jt+jt)},Ff=function(e){var t=ai(e);return""+t[0]+t[jt-1]},Gr=function(e){var t=Ar(Oe.Buffer.from(e,"hex"));return""+e+t},Qo=function(e,t){var n=Gr(e),i=Oe.Buffer.from(n,"hex"),o=i.reduce(function(r,a){return Xr(r,[ai(a)])},[]);return o.join(t)},zf=function(e){var t=Gr(e),n=Oe.Buffer.from(t,"hex"),i=n.reduce(function(o,r){return o+Ff(r)},"");return i},jf=function(e,t){if(e.length!==t)throw new Error("'Invalid Bytewords: word.length does not match wordLength provided'");var n=26;if(Qn.length===0){var i=n*n;Qn=Xr(new Array(i)).map(function(){return-1});for(var o=0;o<Vf;o++){var r=ai(o),a=r[0].charCodeAt(0)-"a".charCodeAt(0),s=r[3].charCodeAt(0)-"a".charCodeAt(0),l=s*n+a;Qn[l]=o}}var g=e[0].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),f=e[t==4?3:1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0);if(!(0<=g&&g<n&&0<=f&&f<n))throw new Error("Invalid Bytewords: invalid word");var k=f*n+g,w=Qn[k];if(w===-1)throw new Error("Invalid Bytewords: value not in lookup table");if(t==jt){var r=ai(w),S=e[1].toLowerCase(),A=e[2].toLowerCase();if(!(S===r[1]&&A===r[2]))throw new Error("Invalid Bytewords: invalid middle letters of word")}return Oe.Buffer.from([w]).toString("hex")},xi=function(e,t,n){var i=n==jt?e.split(t):sd(e,2),o=i.map(function(g){return jf(g,n)}).join("");if(o.length<5)throw new Error("Invalid Bytewords: invalid decoded string length");var r=xr(Oe.Buffer.from(o,"hex"),4),a=r[0],s=r[1],l=Ar(a);if(l!==s.toString("hex"))throw new Error("Invalid Checksum");return a.toString("hex")},Wf=function(e,t){switch(t===void 0&&(t=Pt.MINIMAL),t){case Pt.STANDARD:return xi(e," ",jt);case Pt.URI:return xi(e,"-",jt);case Pt.MINIMAL:return xi(e,"",Bf);default:throw new Error("Invalid style "+t)}},Hf=function(e,t){switch(t===void 0&&(t=Pt.MINIMAL),t){case Pt.STANDARD:return Qo(e," ");case Pt.URI:return Qo(e,"-");case Pt.MINIMAL:return zf(e);default:throw new Error("Invalid style "+t)}},Vt={decode:Wf,encode:Hf,STYLES:Pt},Qf=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Kf=function(){function e(t,n,i,o){this.ur=t,this.fountainEncoder=new Uf(t.cbor,n,i,o)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this.fountainEncoder.fragmentsLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this.fountainEncoder.fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this.fountainEncoder.messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this.ur.cbor},enumerable:!1,configurable:!0}),e.prototype.encodeWhole=function(){var t=this;return Qf(new Array(this.fragmentsLength)).map(function(){return t.nextPart()})},e.prototype.nextPart=function(){var t=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?e.encodeSinglePart(this.ur):e.encodePart(this.ur.type,t)},e.encodeUri=function(t,n){var i=n.join("/");return[t,i].join(":")},e.encodeUR=function(t){return e.encodeUri("ur",t)},e.encodePart=function(t,n){var i=n.seqNum+"-"+n.seqLength,o=Vt.encode(n.cbor().toString("hex"),Vt.STYLES.MINIMAL);return e.encodeUR([t,i,o])},e.encodeSinglePart=function(t){var n=Vt.encode(t.cbor.toString("hex"),Vt.STYLES.MINIMAL);return e.encodeUR([t.type,n])},e}(),Kn=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Ko=function(){function e(t,n){this._indexes=t,this._fragment=n}return Object.defineProperty(e.prototype,"indexes",{get:function(){return this._indexes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),e.fromEncoderPart=function(t){var n=Qr(t.seqNum,t.seqLength,t.checksum),i=t.fragment;return new e(n,i)},e.prototype.isSimple=function(){return this.indexes.length===1},e}(),Xf=function(){function e(){this.result=void 0,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}return e.prototype.validatePart=function(t){var n=this;if(this.expectedPartIndexes.length===0)Kn(new Array(t.seqLength)).forEach(function(i,o){return n.expectedPartIndexes.push(o)}),this.expectedMessageLength=t.messageLength,this.expectedChecksum=t.checksum,this.expectedFragmentLength=t.fragment.length;else if(this.expectedPartIndexes.length!==t.seqLength||this.expectedMessageLength!==t.messageLength||this.expectedChecksum!==t.checksum||this.expectedFragmentLength!==t.fragment.length)return!1;return!0},e.prototype.reducePartByPart=function(t,n){if(ld(t.indexes,n.indexes)){var i=ud(t.indexes,n.indexes),o=Er(t.fragment,n.fragment);return new Ko(i,o)}else return t},e.prototype.reduceMixedBy=function(t){var n=this,i=[];this.mixedParts.map(function(o){var r=o.value;return n.reducePartByPart(r,t)}).forEach(function(o){o.isSimple()?n.queuedParts.push(o):i.push({key:o.indexes,value:o})}),this.mixedParts=i},e.prototype.processSimplePart=function(t){var n=t.indexes[0];if(!this.receivedPartIndexes.includes(n))if(this.simpleParts.push({key:t.indexes,value:t}),this.receivedPartIndexes.push(n),Vo(this.receivedPartIndexes,this.expectedPartIndexes)){var i=this.simpleParts.map(function(a){var s=a.value;return s}).sort(function(a,s){return a.indexes[0]-s.indexes[0]}),o=e.joinFragments(i.map(function(a){return a.fragment}),this.expectedMessageLength),r=$r(o);r===this.expectedChecksum?this.result=o:this.error=new od}else this.reduceMixedBy(t)},e.prototype.processMixedPart=function(t){var n=this;if(!this.mixedParts.some(function(o){var r=o.key;return Vo(r,t.indexes)})){var i=this.simpleParts.reduce(function(o,r){var a=r.value;return n.reducePartByPart(o,a)},t);i=this.mixedParts.reduce(function(o,r){var a=r.value;return n.reducePartByPart(o,a)},i),i.isSimple()?this.queuedParts.push(i):(this.reduceMixedBy(i),this.mixedParts.push({key:i.indexes,value:i}))}},e.prototype.processQueuedItem=function(){if(this.queuedParts.length!==0){var t=this.queuedParts.shift();t.isSimple()?this.processSimplePart(t):this.processMixedPart(t)}},e.prototype.receivePart=function(t){if(this.isComplete()||!this.validatePart(t))return!1;var n=Ko.fromEncoderPart(t);for(this.lastPartIndexes=n.indexes,this.queuedParts.push(n);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0},e.prototype.isComplete=function(){return Boolean(this.result!==void 0&&this.result.length>0)},e.prototype.isSuccess=function(){return Boolean(this.error===void 0&&this.isComplete())},e.prototype.resultMessage=function(){return this.isSuccess()?this.result:Oe.Buffer.from([])},e.prototype.isFailure=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.expectedPartIndexes.length},e.prototype.getExpectedPartIndexes=function(){return Kn(this.expectedPartIndexes)},e.prototype.getReceivedPartIndexes=function(){return Kn(this.receivedPartIndexes)},e.prototype.getLastPartIndexes=function(){return Kn(this.lastPartIndexes)},e.prototype.estimatedPercentComplete=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:Math.min(.99,this.processedPartsCount/(t*1.75))},e.prototype.getProgress=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:this.receivedPartIndexes.length/t},e.joinFragments=function(t,n){return Oe.Buffer.concat(t).slice(0,n)},e}(),Gf=function(){function e(t,n){if(t===void 0&&(t=new Xf),n===void 0&&(n="bytes"),this.fountainDecoder=t,this.type=n,!Zn(n))throw new Error("Invalid UR type");this.expected_type=""}return e.decodeBody=function(t,n){var i=Vt.decode(n,Vt.STYLES.MINIMAL);return new ei(Oe.Buffer.from(i,"hex"),t)},e.prototype.validatePart=function(t){return this.expected_type?this.expected_type===t:Zn(t)?(this.expected_type=t,!0):!1},e.decode=function(t){var n=this.parse(t),i=n[0],o=n[1];if(o.length===0)throw new Si;var r=o[0];return e.decodeBody(i,r)},e.parse=function(t){var n=t.toLowerCase(),i=n.slice(0,3);if(i!=="ur:")throw new Oo;var o=n.slice(3).split("/"),r=o[0];if(o.length<2)throw new Si;if(!Zn(r))throw new Tr;return[r,o.slice(1)]},e.parseSequenceComponent=function(t){var n=t.split("-");if(n.length!==2)throw new Uo;var i=Ri(Number(n[0])),o=Number(n[1]);if(i<1||o<1)throw new Uo;return[i,o]},e.prototype.receivePart=function(t){if(this.result!==void 0)return!1;var n=e.parse(t),i=n[0],o=n[1];if(!this.validatePart(i))return!1;if(o.length===1)return this.result=e.decodeBody(i,o[0]),!0;if(o.length!==2)throw new Si;var r=o[0],a=o[1],s=e.parseSequenceComponent(r),l=s[0],g=s[1],f=Vt.decode(a,Vt.STYLES.MINIMAL),k=Kr.fromCBOR(f);return l!==k.seqNum||g!==k.seqLength||!this.fountainDecoder.receivePart(k)?!1:(this.fountainDecoder.isSuccess()?this.result=new ei(this.fountainDecoder.resultMessage(),i):this.fountainDecoder.isFailure()&&(this.error=new Oo),!0)},e.prototype.resultUR=function(){return this.result?this.result:new ei(Oe.Buffer.from([]))},e.prototype.isComplete=function(){return!!(this.result&&this.result.cbor.length>0)},e.prototype.isSuccess=function(){return!this.error&&this.isComplete()},e.prototype.isError=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.fountainDecoder.expectedPartCount()},e.prototype.expectedPartIndexes=function(){return this.fountainDecoder.getExpectedPartIndexes()},e.prototype.receivedPartIndexes=function(){return this.fountainDecoder.getReceivedPartIndexes()},e.prototype.lastPartIndexes=function(){return this.fountainDecoder.getLastPartIndexes()},e.prototype.estimatedPercentComplete=function(){return this.fountainDecoder.estimatedPercentComplete()},e.prototype.getProgress=function(){return this.fountainDecoder.getProgress()},e}();const Yf=Je({name:"SendTokenDialog",mixins:[windowMixin],components:{ChooseMint:Wi,TokenInformation:qr},props:{},data:function(){return{baseURL:location.protocol+"//"+location.host+location.pathname,showAnimatedQR:!1,qrCodeFragment:"",qrInterval:null,encoder:null,showDeleteDialog:!1,p2pkInput:"",currentFragmentLength:150,fragmentLengthMedium:100,fragmentLengthShort:50,fragmentLengthLong:150,fragmentLengthLabel:"L",currentFragmentInterval:150,fragmentIntervalMedium:250,fragmentIntervalFast:150,framentInervalSlow:500,fragmentSpeedLabel:"F",isV4Token:!1}},computed:{...De(ni,["showSendTokens","showLockInput"]),...De(ni,["sendData"]),...De(yt,["camera","hasCamera"]),...Se(lt,["tickerShort","canPasteFromClipboard","globalMutexLock"]),...Se(xe,["activeProofs","activeUnit","activeUnitLabel","activeMintUrl","activeMintBalance"]),...Se(ti,["checkSentTokens"]),...Se(Yt,["tokenWorkerRunning"]),sumProofs:function(){return ke.getProofs(ke.decode(this.sendData.tokensBase64)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return ke.getUnit(ke.decode(this.sendData.tokensBase64))},tokenMintUrl:function(){return ke.getMint(ke.decode(this.sendData.tokensBase64))},displayMemo:function(){return ke.getMemo(ke.decode(this.sendData.tokensBase64))},shortUrl:function(){return Tt(this.tokenMintUrl)},decodedToken:function(){return ke.decode(this.sendData.tokensBase64)},runnerActive:function(){return this.tokenWorkerRunning},canSpendOffline:function(){if(!this.sendData.amount)return!1;let e=this.spendableProofs(this.activeProofs);return this.coinSelect(e,this.sendData.amount).flat().reduce((i,o)=>i+=o.amount,0)==this.sendData.amount}},watch:{"sendData.tokensBase64":function(e){if(this.showAnimatedQR=!1,!e.length)return;const n=ke.decode(e).token[0].proofs;if(n.length)n.length<=2?this.qrCodeFragment=e:(this.showAnimatedQR=!0,this.qrCodeFragment="",this.startQrCodeLoop());else return;this.isV4Token=e.startsWith("cashuB")},showSendTokens:function(e){e||(clearInterval(this.qrInterval),this.sendData.data="",this.sendData.tokensBase64="")}},methods:{...ye(Yt,["checkTokenSpendableWorker","clearAllWorkers"]),...ye(Ze,["splitToSend","sendToLock","coinSelect","spendableProofs"]),...ye(fr,["serializeProofs"]),...ye(zt,["addPendingToken","setTokenPaid","deleteToken"]),...ye(Gt,["isValidPubkey"]),...ye(yt,["closeCamera","showCamera"]),...ye(xe,["toggleUnit"]),decodeToken:function(e){return ke.decode(e)},getProofs:function(e){return ke.getProofs(e)},getAmount:function(e){return ke.getAmount(e)},getUnit:function(e){return ke.getUnit(e)},getMint:function(e){return ke.getMint(e)},startQrCodeLoop:async function(){if(this.sendData.tokensBase64.length==0)return;const e=Oe.Buffer.from(this.sendData.tokensBase64),t=ei.fromBuffer(e),n=0;this.encoder=new Kf(t,this.currentFragmentLength,n),clearInterval(this.qrInterval),this.qrInterval=setInterval(()=>{this.qrCodeFragment=this.encoder.nextPart()},this.currentFragmentInterval)},updateQrCode:function(){this.qrCodeFragment=this.encoder.nextPart()},changeSpeed:function(){this.currentFragmentInterval==this.fragmentIntervalMedium?(this.currentFragmentInterval=this.framentInervalSlow,this.fragmentSpeedLabel="S"):this.currentFragmentInterval==this.framentInervalSlow?(this.currentFragmentInterval=this.fragmentIntervalFast,this.fragmentSpeedLabel="F"):(this.currentFragmentInterval=this.fragmentIntervalMedium,this.fragmentSpeedLabel="M"),console.log("### this.currentFragmentInterval",this.currentFragmentInterval),this.startQrCodeLoop()},changeSize:function(){this.currentFragmentLength==this.fragmentLengthMedium?(this.currentFragmentLength=this.fragmentLengthShort,this.fragmentLengthLabel="S"):this.currentFragmentLength==this.fragmentLengthShort?(this.currentFragmentLength=this.fragmentLengthLong,this.fragmentLengthLabel="L"):(this.currentFragmentLength=this.fragmentLengthMedium,this.fragmentLengthLabel="M"),console.log("### this.currentFragmentLength",this.currentFragmentLength),this.startQrCodeLoop()},toggleTokenEncoding:function(){const e=hs(this.sendData.tokensBase64);if(this.sendData.tokensBase64.startsWith("cashuA"))try{this.sendData.tokensBase64=ms(e)}catch{console.log("### Could not encode token to V4"),this.sendData.tokensBase64=To(e)}else this.sendData.tokensBase64=To(e)},deleteThisToken:function(){this.deleteToken(this.sendData.tokensBase64),this.showSendTokens=!1,this.showDeleteDialog=!1,this.clearAllWorkers()},lockTokens:async function(){let e=this.sendData.amount;(this.activeUnit==="usd"||this.activeUnit=="eur")&&(e=e*100);try{let{_:t,sendProofs:n}=await this.sendToLock(this.activeProofs,e,this.sendData.p2pkPubkey);this.sendData.tokens=n,console.log("### this.sendData.tokens",this.sendData.tokens),this.sendData.tokensBase64=this.serializeProofs(n),this.addPendingToken({amount:-this.sendData.amount,serializedProofs:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl}),this.g.offline||this.checkTokenSpendableWorker(this.sendData.tokensBase64)}catch(t){console.error(t)}},sendTokens:async function(){if(this.sendData.p2pkPubkey&&this.isValidPubkey(this.sendData.p2pkPubkey)){await this.lockTokens();return}try{let e=this.sendData.amount;(this.activeUnit==="usd"||this.activeUnit=="eur")&&(e=e*100);let{_:t,sendProofs:n}=await this.splitToSend(this.activeProofs,e,!0);this.sendData.tokens=n,console.log("### this.sendData.tokens",this.sendData.tokens),this.sendData.tokensBase64=this.serializeProofs(n),this.addPendingToken({amount:-this.sendData.amount,serializedProofs:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl}),this.g.offline||this.checkTokenSpendableWorker(this.sendData.tokensBase64)}catch(e){console.error(e)}},pasteToP2PKField:function(){console.log("pasteToParseDialog"),navigator.clipboard.readText().then(e=>{this.sendData.p2pkPubkey=e})}}}),Zf={key:0},Jf={class:"row items-center no-wrap q-mb-sm q-pr-md q-py-lg"},eh=P("div",{class:"col-9"},[P("span",{class:"text-h6"},"Send Ecash")],-1),th={class:"col-3",style:{height:"30px"}},nh=P("span",{class:"text-subtitle2 text-weight-medium"},"Offline",-1),ih={class:"row items-center no-wrap q-my-sm q-py-none"},oh={class:"col-12"},rh={key:0,class:"row items-center no-wrap"},ah={class:"col-4 q-mx-md"},sh={key:0,class:"row q-mt-lg"},lh={key:1,class:"row"},uh={key:1,class:"row q-mt-lg"},ch={key:1,class:"text-center q-mb-xs"},dh={key:0,class:"text-center q-mb-md"},fh={class:"q-pb-xs q-ba-none q-gutter-sm"},hh={class:"row justify-center"},mh={class:"row justify-center q-py-md"},gh={class:"row justify-center q-pt-sm"},vh={class:"row q-mt-lg"},ph=P("div",{class:"row items-center no-wrap q-mb-sm"},[P("div",{class:"col-12"},[P("span",{class:"text-h6"},"Delete Ecash")])],-1),yh={class:"row items-center no-wrap q-my-sm q-py-none"},wh={class:"col-12"},_h={class:"row q-mt-lg"};function bh(e,t,n,i,o,r){const a=Ee("ChooseMint"),s=Ee("vue-qrcode"),l=Ee("TokenInformation");return $(),J(ct,null,[h(st,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[8]||(t[8]=g=>e.showSendTokens=g),position:"top","backdrop-filter":"blur(2px) brightness(60%)","no-backdrop-dismiss":"","full-height":""},{default:y(()=>[h(dt,{class:"q-pa-none q-pt-none qcard"},{default:y(()=>[e.sendData.tokens?($(),J("div",ch,[h(St,{class:"q-pa-none q-pt-md"},{default:y(()=>[e.qrCodeFragment?($(),J("div",dh,[h(Fi,{ratio:1,class:"q-mx-none"},{default:y(()=>[h(s,{value:e.qrCodeFragment,options:{width:400},class:"rounded-borders",onClick:t[4]||(t[4]=g=>e.copyText(e.sendData.tokensBase64))},null,8,["value"])]),_:1})])):Z("",!0),P("div",fh,[e.showAnimatedQR?($(),Q(H,{key:0,flat:"",style:{"font-size":"12px"},color:"grey",class:"q-ma-none",onClick:e.changeSpeed},{default:y(()=>[h(de,{name:"speed",style:{"margin-right":"8px"}}),O(" Speed: "+me(e.fragmentSpeedLabel),1)]),_:1},8,["onClick"])):Z("",!0),e.showAnimatedQR?($(),Q(H,{key:1,flat:"",style:{"font-size":"12px"},class:"q-ma-none",color:"grey",onClick:e.changeSize},{default:y(()=>[h(de,{name:"zoom_in",style:{"margin-right":"8px"}}),O(" Size: "+me(e.fragmentLengthLabel),1)]),_:1},8,["onClick"])):Z("",!0),h(Ft,{color:e.isV4Token?"grey":"primary",label:e.isV4Token?"V4":"V3",class:"q-my-sm q-mx-md cursor-pointer",onClick:e.toggleTokenEncoding,outline:e.isV4Token},null,8,["color","label","onClick","outline"])]),h(St,{class:"q-pa-sm"},{default:y(()=>[P("div",hh,[h(we,{overline:"",class:"q-mb-sm text-white"},{default:y(()=>[O("Ecash")]),_:1})]),P("div",mh,[h(we,{style:{"font-size":"30px"},class:"text-weight-bold"},{default:y(()=>[e.runnerActive?($(),Q(Pr,{key:0,color:"primary",size:"0.8em",class:"q-mr-md"})):Z("",!0),P("strong",null,me(e.displayUnit),1)]),_:1})]),P("div",gh,[h(l,{encodedToken:e.sendData.tokensBase64,showAmount:!1,showP2PKCheck:!1},null,8,["encodedToken"])]),P("div",vh,[h(H,{class:"q-mx-xs",size:"md",flat:"",onClick:t[5]||(t[5]=g=>e.copyText(e.sendData.tokensBase64))},{default:y(()=>[O("Copy")]),_:1}),h(H,{class:"q-mx-none",color:"grey",size:"md",icon:"link",flat:"",onClick:t[6]||(t[6]=g=>e.copyText(e.baseURL+"?token="+e.sendData.tokensBase64))},{default:y(()=>[h(at,null,{default:y(()=>[O("Copy link")]),_:1})]),_:1}),h(H,{class:"q-mx-none",color:"grey",icon:"delete",size:"md",onClick:t[7]||(t[7]=g=>e.showDeleteDialog=!0),flat:""},{default:y(()=>[h(at,null,{default:y(()=>[O("Delete from history")]),_:1})]),_:1}),ze(($(),Q(H,{flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])]),_:1})]),_:1})])):($(),J("div",Zf,[h(St,{class:"q-pa-lg q-pt-md"},{default:y(()=>[P("div",Jf,[eh,P("div",th,[h(Ct,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:y(()=>[e.canSpendOffline&&!e.sendData.p2pkPubkey&&!e.showLockInput?($(),Q(Ft,{key:0,outline:"",rounded:"",color:"grey",class:"q-mr-auto q-pl-sm q-ml-md q-pr-sm q-my-xs q-mt-xs",size:"lg"},{default:y(()=>[h(de,{name:"check",color:"primary",class:"q-mr-sm",size:"sm"}),nh]),_:1})):Z("",!0)]),_:1})])]),P("div",ih,[P("div",oh,[h(a,{"ticker-short":e.tickerShort},null,8,["ticker-short"])])]),h(tt,{type:"number",modelValue:e.sendData.amount,"onUpdate:modelValue":t[1]||(t[1]=g=>e.sendData.amount=g),modelModifiers:{number:!0},label:"Amount ("+e.tickerShort+") *",mask:"#","fill-mask":"0","reverse-fill-mask":"",round:"",outlined:"",autofocus:"",class:"q-mb-lg",onKeyup:Bt(e.sendTokens,["enter"])},{default:y(()=>[h(H,{flat:"",color:"primary",onClick:t[0]||(t[0]=g=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup"]),h(Ct,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:y(()=>[e.showLockInput?($(),J("div",rh,[P("div",{class:Ai(e.sendData.p2pkPubkey?"col-12":"col-8")},[h(tt,{modelValue:e.sendData.p2pkPubkey,"onUpdate:modelValue":t[2]||(t[2]=g=>e.sendData.p2pkPubkey=g),label:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?"Invalid public key":"Receiver public key",outlined:"",clearable:"",color:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?"red":"",onKeyup:Bt(e.lockTokens,["enter"])},null,8,["modelValue","label","color","onKeyup"])],2),P("div",ah,[e.canPasteFromClipboard&&!e.sendData.p2pkPubkey?($(),Q(H,{key:0,unelevated:"",icon:"content_paste",onClick:e.pasteToP2PKField},{default:y(()=>[h(at,null,{default:y(()=>[O("Paste")]),_:1})]),_:1},8,["onClick"])):Z("",!0),e.sendData.p2pkPubkey?Z("",!0):($(),Q(H,{key:1,align:"center",icon:"qr_code_scanner",flat:"",outline:"",color:"primary",round:"",onClick:e.showCamera},null,8,["onClick"]))])])):Z("",!0)]),_:1}),e.activeMintBalance()>=e.sendData.amount?($(),J("div",sh,[e.sendData.tokens?Z("",!0):($(),Q(H,{key:0,disable:e.sendData.amount==null||e.sendData.amount<=0||e.sendData.p2pkPubkey!=""&&!e.isValidPubkey(e.sendData.p2pkPubkey),onClick:e.sendTokens,color:"primary",rounded:"",type:"submit",loading:e.globalMutexLock},{loading:y(()=>[h(It)]),default:y(()=>[O("Send ")]),_:1},8,["disable","onClick","loading"])),e.sendData.p2pkPubkey&&e.isValidPubkey(e.sendData.p2pkPubkey)?($(),J("div",lh,[h(Ct,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:y(()=>[h(mn,{outline:"",color:"primary",icon:"lock",class:"q-ml-md q-pa-md"},{default:y(()=>[O(" Locked ")]),_:1})]),_:1})])):Z("",!0),h(Ct,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:y(()=>[e.sendData.amount>0&&!e.showLockInput&&e.activeMintBalance()>=e.sendData.amount?($(),Q(H,{key:0,disable:e.sendData.p2pkPubkey==null||e.sendData.amount<=0,color:"primary",class:"q-ml-sm",rounded:"",flat:"",onClick:t[3]||(t[3]=g=>e.showLockInput=!0)},{default:y(()=>[O(" Lock")]),_:1},8,["disable"])):Z("",!0)]),_:1}),ze(($(),Q(H,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])):($(),J("div",uh,[h(H,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:y(()=>[O("Mint balance too low")]),_:1}),ze(($(),Q(H,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])]))]),_:1})]))]),_:1})]),_:1},8,["modelValue"]),h(st,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[9]||(t[9]=g=>e.showDeleteDialog=g)},{default:y(()=>[h(dt,{class:"q-pa-lg q-pt-md qcard"},{default:y(()=>[h(St,{class:"q-pa-none"},{default:y(()=>[ph,P("div",yh,[P("div",wh,[h(we,null,{default:y(()=>[O(" Are you sure you want to delete this transaction from your history? ")]),_:1}),h(we,{class:"q-pt-md text-weight-bold"},{default:y(()=>[O(" Warning: This action cannot be undone and there is no way to recover the token. ")]),_:1})])]),P("div",_h,[h(H,{onClick:e.deleteThisToken,color:"negative",rounded:"",class:"q-mr-sm"},{default:y(()=>[O("Delete")]),_:1},8,["onClick"]),ze(($(),Q(H,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Cancel")]),_:1})),[[We]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var kh=He(Yf,[["render",bh]]);const Dh=1.7778;var Ch=it({name:"QImg",props:{...ts,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:Dh},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:n}){const i=he(e.initialRatio),o=ns(e,i),r=ut(),{registerTimeout:a,removeTimeout:s}=An(),{registerTimeout:l,removeTimeout:g}=An(),f=U(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),k=U(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),w=[he(null),he(f.value)],S=he(0),A=he(!1),L=he(!1),I=U(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),j=U(()=>({width:e.width,height:e.height})),E=U(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),B=U(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function F(){if(g(),e.loadingShowDelay===0){A.value=!0;return}l(()=>{A.value=!0},e.loadingShowDelay)}function ce(){g(),A.value=!1}function ne({target:p}){Xn(r)===!1&&(s(),i.value=p.naturalHeight===0?.5:p.naturalWidth/p.naturalHeight,se(p,1))}function se(p,m){m===1e3||Xn(r)===!0||(p.complete===!0?u(p):a(()=>{se(p,m+1)},50))}function u(p){Xn(r)!==!0&&(S.value=S.value^1,w[S.value].value=null,ce(),p.getAttribute("__qerror")!=="true"&&(L.value=!1),n("load",p.currentSrc||p.src))}function d(p){s(),ce(),L.value=!0,w[S.value].value=k.value,w[S.value^1].value=f.value,n("error",p)}function v(p){const m=w[p].value,b={key:"img_"+p,class:E.value,style:B.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...m};return S.value===p?Object.assign(b,{class:b.class+"current",onLoad:ne,onError:d}):b.class+="loaded",z("div",{class:"q-img__container absolute-full",key:"img"+p},z("img",b))}function q(){return A.value===!1?z("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},Qt(t[L.value===!0?"error":"default"])):z("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[z(Aa,{color:e.spinnerColor,size:e.spinnerSize})])}{let p=function(){je(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,m=>{s(),L.value=!1,m===null?(ce(),w[S.value^1].value=f.value):F(),w[S.value].value=m},{immediate:!0})};$a.value===!0?pn(p):p()}return()=>{const p=[];return o.value!==null&&p.push(z("div",{key:"filler",style:o.value})),w[0].value!==null&&p.push(v(0)),w[1].value!==null&&p.push(v(1)),p.push(z(Ct,{name:"q-transition--fade"},q)),z("div",{key:"main",class:I.value,style:j.value,role:"img","aria-label":e.alt},p)}}}),Xo=it({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:t,emit:n}){const i=ut(),o=he(null);let r=0;const a=[];function s(S){const A=typeof S=="boolean"?S:e.noErrorFocus!==!0,L=++r,I=(B,F)=>{n(`validation${B===!0?"Success":"Error"}`,F)},j=B=>{const F=B.validate();return typeof F.then=="function"?F.then(ce=>({valid:ce,comp:B}),ce=>({valid:!1,comp:B,err:ce})):Promise.resolve({valid:F,comp:B})};return(e.greedy===!0?Promise.all(a.map(j)).then(B=>B.filter(F=>F.valid!==!0)):a.reduce((B,F)=>B.then(()=>j(F).then(ce=>{if(ce.valid===!1)return Promise.reject(ce)})),Promise.resolve()).catch(B=>[B])).then(B=>{if(B===void 0||B.length===0)return L===r&&I(!0),!0;if(L===r){const{comp:F,err:ce}=B[0];if(ce!==void 0&&console.error(ce),I(!1,F),A===!0){const ne=B.find(({comp:se})=>typeof se.focus=="function"&&Xn(se.$)===!1);ne!==void 0&&ne.comp.focus()}}return!1})}function l(){r++,a.forEach(S=>{typeof S.resetValidation=="function"&&S.resetValidation()})}function g(S){S!==void 0&&nt(S);const A=r+1;s().then(L=>{A===r&&L===!0&&(e.onSubmit!==void 0?n("submit",S):S!==void 0&&S.target!==void 0&&typeof S.target.submit=="function"&&S.target.submit())})}function f(S){S!==void 0&&nt(S),n("reset"),qt(()=>{l(),e.autofocus===!0&&e.noResetFocus!==!0&&k()})}function k(){ur(()=>{if(o.value===null)return;const S=o.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(o.value.querySelectorAll("[tabindex]"),A=>A.tabIndex!==-1);S?.focus({preventScroll:!0})})}Jo(Ea,{bindComponent(S){a.push(S)},unbindComponent(S){const A=a.indexOf(S);A!==-1&&a.splice(A,1)}});let w=!1;return Ui(()=>{w=!0}),Ni(()=>{w===!0&&e.autofocus===!0&&k()}),pn(()=>{e.autofocus===!0&&k()}),Object.assign(i.proxy,{validate:s,resetValidation:l,submit:g,reset:f,focus:k,getValidationComponents:()=>a}),()=>z("form",{class:"q-form",ref:o,onSubmit:g,onReset:f},Qt(t.default))}});const Sh=Je({name:"PayInvoiceDialog",mixins:[windowMixin],components:{ChooseMint:Wi,ToggleUnit:yr},props:{},data:function(){return{}},watch:{activeMintUrl:async function(){this.payInvoiceData.show&&await this.meltQuote()},activeUnit:async function(){this.payInvoiceData.show&&await this.meltQuote()}},computed:{...Se(lt,["tickerShort","globalMutexLock"]),...De(yt,["camera","hasCamera"]),...Se(Ze,["payInvoiceData"]),...Se(xe,["activeMintUrl","activeProofs","mints","proofs","activeUnit","activeBalance","activeMintBalance"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},enoughActiveBalance:function(){return this.activeMintBalance()>=this.payInvoiceData.meltQuote.response.amount}},methods:{...ye(Ze,["melt","meltQuote","decodeRequest","lnurlPaySecond"]),...ye(yt,["closeCamera","showCamera"]),canPay:function(){return this.payInvoiceData.invoice?payInvoiceData.meltQuote.response.amount<=this.activeBalance:!1},closeParseDialog:function(){setTimeout(()=>{clearInterval(this.payInvoiceData.paymentChecker)},1e4)},decodeAndQuote:async function(e){await this.decodeRequest(e)},pasteToParseDialog:function(){console.log("pasteToParseDialog"),navigator.clipboard.readText().then(e=>{this.payInvoiceData.input.request=e})}},created:function(){}}),Ph={key:0},qh={class:"row items-center no-wrap q-mb-sm"},Th={class:"col-10"},Mh={key:0,class:"q-my-none"},xh={key:1,class:"q-my-none"},$h={key:2,class:"q-my-none"},Ah={class:"col-2"},Eh={class:"text-wrap"},Ih={key:0},Rh=P("br",null,null,-1),Lh={class:"col-12"},Oh={key:0,class:"row q-mt-lg"},Uh={key:1,class:"row q-mt-lg"},Nh={key:1},Vh={key:0,class:"q-my-none text-h6 text-center"},Bh={key:1,class:"q-my-none text-h6 text-center"},Fh=P("br",null,null,-1),zh={key:2,class:"row"},jh={class:"col text-justify text-italic"},Wh={key:0,class:"col-4 q-pl-md"},Hh={class:"row"},Qh={class:"col"},Kh={key:0,class:"col-8 q-pl-md"},Xh={class:"row q-mt-lg"},Gh={key:2},Yh=P("div",{class:"row items-center no-wrap q-mb-xl"},[P("div",{class:"col-10"},[P("span",{class:"text-h6"},"Pay Lightning")])],-1),Zh={class:"row q-mt-lg"};function Jh(e,t,n,i,o,r){const a=Ee("ToggleUnit"),s=Ee("ChooseMint");return e.camera.show?Z("",!0):($(),Q(st,{key:0,modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[5]||(t[5]=l=>e.payInvoiceData.show=l),onHide:e.closeParseDialog,position:"top","backdrop-filter":"blur(2px) brightness(60%)","no-backdrop-dismiss":""},{default:y(()=>[h(dt,{class:"q-pa-lg q-pt-xl qcard"},{default:y(()=>[e.payInvoiceData.invoice?($(),J("div",Ph,[P("div",qh,[P("div",Th,[e.payInvoiceData.meltQuote.response&&e.payInvoiceData.meltQuote.response.amount>0?($(),J("h6",Mh," Pay "+me(e.formatCurrency(e.payInvoiceData.meltQuote.response.amount,e.activeUnit,!0)),1)):e.payInvoiceData.meltQuote.error!=""?($(),J("h6",xh,me(e.payInvoiceData.meltQuote.error),1)):($(),J("h6",$h,"Processing..."))]),P("div",Ah,[h(a,{class:"q-mt-md"})])]),P("p",Eh,[e.payInvoiceData.invoice.description?($(),J("strong",Ih,"Memo:")):Z("",!0),O(" "+me(e.payInvoiceData.invoice.description),1),Rh]),P("div",Lh,[h(s,{"ticker-short":e.tickerShort},null,8,["ticker-short"])]),e.enoughActiveBalance?($(),J("div",Oh,[h(H,{unelevated:"",rounded:"",color:"primary",disabled:e.payInvoiceData.blocking||e.payInvoiceData.meltQuote.error!="",onClick:e.melt,label:e.payInvoiceData.meltQuote.error!=""?"Error":e.payInvoiceData.blocking?"Processing...":"Pay",loading:e.globalMutexLock&&!e.payInvoiceData.blocking,class:"q-px-lg"},{loading:y(()=>[h(It)]),_:1},8,["disabled","onClick","label","loading"]),ze(($(),Q(H,{flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])):($(),J("div",Uh,[h(H,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:y(()=>[O("Mint balance too low")]),_:1}),ze(($(),Q(H,{flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])]))])):e.payInvoiceData.lnurlpay?($(),J("div",Nh,[h(Xo,{onSubmit:e.lnurlPaySecond,class:"q-gutter-md"},{default:y(()=>[e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable?($(),J("p",Vh,[P("b",null,me(e.payInvoiceData.lnurlpay.domain),1),O(" is requesting "+me(e.payInvoiceData.lnurlpay.maxSendable/1e3)+" "+me(e.tickerShort),1)])):($(),J("p",Bh,[P("b",null,me(e.payInvoiceData.lnurlpay.targetUser||e.payInvoiceData.lnurlpay.domain),1),O(" is requesting "),Fh,O(" between "),P("b",null,me(e.payInvoiceData.lnurlpay.minSendable/1e3),1),O(" and "),P("b",null,me(e.payInvoiceData.lnurlpay.maxSendable/1e3),1),O(" "+me(e.tickerShort),1)])),h(zi,{class:"q-my-sm"}),e.payInvoiceData.lnurlpay.description?($(),J("div",zh,[P("p",jh,me(e.payInvoiceData.lnurlpay.description),1),e.payInvoiceData.lnurlpay.image?($(),J("p",Wh,[h(Ch,{src:e.payInvoiceData.lnurlpay.image},null,8,["src"])])):Z("",!0)])):Z("",!0),P("div",Hh,[P("div",Qh,[h(tt,{filled:"",dense:"",autofocus:"",modelValue:e.payInvoiceData.input.amount,"onUpdate:modelValue":t[0]||(t[0]=l=>e.payInvoiceData.input.amount=l),modelModifiers:{number:!0},type:"number",label:"Amount ("+e.tickerShort+") *",min:e.payInvoiceData.lnurlpay.minSendable/1e3,max:e.payInvoiceData.lnurlpay.maxSendable/1e3,readonly:e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable},null,8,["modelValue","label","min","max","readonly"])]),e.payInvoiceData.lnurlpay.commentAllowed>0?($(),J("div",Kh,[h(tt,{filled:"",dense:"",modelValue:e.payInvoiceData.input.comment,"onUpdate:modelValue":t[1]||(t[1]=l=>e.payInvoiceData.input.comment=l),_type:"payInvoiceData.lnurlpay.commentAllowed > 64 ? 'textarea' : 'text'",label:"Comment (optional)",maxlength:e.payInvoiceData.lnurlpay.commentAllowed},null,8,["modelValue","maxlength"])])):Z("",!0)]),P("div",Xh,[h(H,{unelevated:"",color:"primary",type:"submit"},{default:y(()=>[O("Send")]),_:1}),ze(($(),Q(H,{flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])]),_:1},8,["onSubmit"])])):($(),J("div",Gh,[Yh,e.camera.show?Z("",!0):($(),Q(Xo,{key:0,onSubmit:t[4]||(t[4]=l=>e.decodeAndQuote(e.payInvoiceData.input.request)),class:"q-gutter-md"},{default:y(()=>[h(tt,{ref:"parseDialogInput",round:"",outlined:"",modelValue:e.payInvoiceData.input.request,"onUpdate:modelValue":t[2]||(t[2]=l=>e.payInvoiceData.input.request=l),modelModifiers:{trim:!0},type:"textarea",label:"Lightning invoice or address",autofocus:"",onKeyup:t[3]||(t[3]=Bt(l=>e.decodeAndQuote(e.payInvoiceData.input.request),["enter"]))},null,8,["modelValue"]),P("div",Zh,[e.payInvoiceData.input.request!=""?($(),Q(H,{key:0,rounded:"",color:"primary",class:"q-mr-sm",type:"submit"},{default:y(()=>[O("Enter")]),_:1})):Z("",!0),e.canPasteFromClipboard&&e.payInvoiceData.input.request==""?($(),Q(H,{key:1,unelevated:"",dense:"",onClick:e.pasteToParseDialog},{default:y(()=>[h(de,{name:"content_paste",class:"q-pr-sm"}),O("Paste")]),_:1},8,["onClick"])):Z("",!0),e.hasCamera&&e.payInvoiceData.input.request==""?($(),Q(H,{key:2,unelevated:"",icon:"qr_code_scanner",class:"q-mx-0",onClick:e.showCamera},null,8,["onClick"])):Z("",!0),ze(($(),Q(H,{flat:"",rounded:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])]),_:1}))]))]),_:1})]),_:1},8,["modelValue","onHide"]))}var em=He(Sh,[["render",Jh]]);const tm=Je({name:"InvoiceDetailDialog",mixins:[windowMixin],components:{ChooseMint:Wi,VueQrcode:hr},props:{invoiceCheckWorker:Function},data:function(){return{createInvoiceButtonBlocked:!1}},computed:{...Se(Ze,["invoiceData"]),...Se(xe,["activeUnit","activeUnitLabel"]),...Se(Yt,["invoiceWorkerRunning"]),...De(lt,["showInvoiceDetails","tickerShort","globalMutexLock"]),displayUnit:function(){return this.formatCurrency(this.invoiceData.amount,this.invoiceData.unit,!0)},shortUrl:function(){return Tt(this.invoiceData.mint)},runnerActive:function(){return this.invoiceWorkerRunning}},methods:{...ye(Ze,["requestMint","lnurlPaySecond"]),...ye(xe,["toggleUnit"]),requestMintButton:async function(){try{xe().activeUnit==="usd"&&(this.invoiceData.amount=this.invoiceData.amount*100),this.createInvoiceButtonBlocked=!0,await this.requestMint(),await this.invoiceCheckWorker()}catch(e){console.log("#### requestMintButton",e)}finally{this.createInvoiceButtonBlocked=!1}}}}),nm={key:0},im=P("div",{class:"row items-center no-wrap q-mb-sm"},[P("div",{class:"col-10"},[P("span",{class:"text-h6"},"Create Invoice")])],-1),om={class:"row items-center no-wrap q-my-sm q-py-none"},rm={class:"col-12"},am={class:"row items-center no-wrap q-my-sm q-py-none"},sm={key:1,class:"text-center q-mb-md q-mt-none q-pt-none"},lm=["href"],um={class:"row justify-center"},cm={class:"row justify-center"},dm={class:"row justify-center q-py-md"},fm={key:0,class:"row justify-center q-pt-sm"},hm={class:"row q-mt-lg"};function mm(e,t,n,i,o,r){const a=Ee("ChooseMint"),s=Ee("vue-qrcode");return $(),Q(st,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[3]||(t[3]=l=>e.showInvoiceDetails=l),position:"top","backdrop-filter":"blur(2px) brightness(60%)","no-backdrop-dismiss":"","full-height":""},{default:y(()=>[h(dt,{class:"q-px-lg q-pt-md q-pb-md qcard"},{default:y(()=>[e.invoiceData.bolt11?($(),J("div",sm,[P("a",{class:"text-secondary",href:"lightning:"+e.invoiceData.bolt11},[h(Fi,{ratio:1,class:"q-mx-md q-mt-none q-pt-none"},{default:y(()=>[h(s,{value:"lightning:"+e.invoiceData.bolt11.toUpperCase(),options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1})],8,lm),P("div",um,[h(St,{class:"q-pa-sm"},{default:y(()=>[P("div",cm,[h(we,{overline:"",class:"q-mb-sm q-pt-md text-white"},{default:y(()=>[O(" Lightning invoice")]),_:1})]),P("div",dm,[h(we,{style:{"font-size":"28px"},class:"text-weight-bold"},{default:y(()=>[e.runnerActive?($(),Q(Pr,{key:0,color:"primary",size:"0.8em",class:"q-mr-md"})):Z("",!0),h(de,{name:e.invoiceData.amount>=0?"call_received":"call_made",color:e.invoiceData.status==="paid"?e.invoiceData.amount>=0?"green":"red":"",class:"q-mr-sm",size:"sm"},null,8,["name","color"]),P("strong",null,me(e.displayUnit),1)]),_:1})]),this.invoiceData.mint!=null?($(),J("div",fm,[h(de,{name:"account_balance",size:"0.95rem",color:"grey",class:"q-mr-sm"}),h(we,{caption:"",class:"text-weight-light text-white",style:{"font-size":"14px"}},{default:y(()=>[P("strong",null,me(e.shortUrl),1)]),_:1})])):Z("",!0)]),_:1})]),P("div",hm,[e.invoiceData.bolt11?($(),Q(H,{key:0,class:"q-mx-xs",size:"md",flat:"",onClick:t[2]||(t[2]=l=>e.copyText(e.invoiceData.bolt11))},{default:y(()=>[O("Copy")]),_:1})):Z("",!0),ze(($(),Q(H,{flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])])):($(),J("div",nm,[im,P("div",om,[P("div",rm,[h(a,{"ticker-short":e.tickerShort},null,8,["ticker-short"])])]),h(tt,{round:"",outlined:"",type:"number",modelValue:e.invoiceData.amount,"onUpdate:modelValue":t[1]||(t[1]=l=>e.invoiceData.amount=l),modelModifiers:{number:!0},label:"Amount ("+e.tickerShort+") *",mask:"#","fill-mask":"0","reverse-fill-mask":"",autofocus:"",class:"q-mb-lg",onKeyup:Bt(e.requestMintButton,["enter"])},{default:y(()=>[h(H,{flat:"",color:"primary",onClick:t[0]||(t[0]=l=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup"]),P("div",am,[h(H,{color:"primary",rounded:"",onClick:e.requestMintButton,disable:!(e.invoiceData.amount>0)||e.createInvoiceButtonBlocked,label:e.createInvoiceButtonBlocked?"Creating invoice...":"Create Invoice",loading:e.globalMutexLock},{loading:y(()=>[h(It),O(" Creating ")]),_:1},8,["onClick","disable","label","loading"]),ze(($(),Q(H,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])]))]),_:1})]),_:1},8,["modelValue"])}var gm=He(tm,[["render",mm]]);const vm=Je({name:"SendDialog",mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...De(lt,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...De(Ze,["invoiceHistory","invoiceData","payInvoiceData"]),...De(yt,["camera"]),...De(ni,["showSendTokens","sendData","showLockInput"])},methods:{showParseDialog:function(){this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.payInvoiceData.input.paymentChecker=null,this.camera.show=!1,this.showSendDialog=!1},showSendTokensDialog:function(){console.log("##### showSendTokensDialog"),this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.sendData.p2pkPubkey="",this.showSendDialog=!1,this.showSendTokens=!0,this.showLockInput=!1}},created:function(){}}),pm={class:"row items-center no-wrap q-mb-sm"},ym={class:"col-12 text-center text-primary"},wm=P("span",{class:"text-h5"},"Send",-1),_m={class:"row items-center text-center no-wrap q-mb-md"},bm={class:"col-12"},km={class:"row items-center text-center no-wrap q-mb-md"},Dm={class:"col-12"};function Cm(e,t,n,i,o,r){return $(),Q(st,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=a=>e.showReceiveDialog=a),position:"bottom","backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(dt,{class:"q-pb-lg q-pt-sm",style:{width:"100%"}},{default:y(()=>[h(St,{class:""},{default:y(()=>[P("div",pm,[P("div",ym,[h(de,{name:"north_east",size:"1.3rem",class:"q-mb-sm q-pr-sm"}),wm])])]),_:1}),P("div",_m,[P("div",bm,[h(H,{outline:"",color:"primary",rounded:"",class:"q-py-md q-px-xl",style:{width:"85%"},onClick:e.showSendTokensDialog},{default:y(()=>[O("Ecash")]),_:1},8,["onClick"])])]),P("div",km,[P("div",Dm,[h(H,{outline:"",color:"primary",rounded:"",push:"",class:"q-py-md q-px-xl",style:{width:"85%"},onClick:e.showParseDialog},{default:y(()=>[O("Lightning")]),_:1},8,["onClick"])])])]),_:1})]),_:1},8,["modelValue"])}var Sm=He(vm,[["render",Cm]]);const Pm=Je({name:"ReceiveDialog",mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...De(lt,["showInvoiceDetails","showReceiveDialog"]),...De(vn,["showReceiveTokens","receiveData"]),...De(Ze,["invoiceData"])},methods:{showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveDialog=!1},showInvoiceCreateDialog:async function(){console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0,this.showReceiveDialog=!1}},created:function(){}}),qm={class:"row items-center no-wrap q-mb-sm"},Tm={class:"col-12 text-center text-primary"},Mm=P("span",{class:"text-h5"},"Receive",-1),xm={class:"row items-center text-center no-wrap q-mb-md"},$m={class:"col-12"},Am={class:"row items-center text-center no-wrap q-mb-md"},Em={class:"col-12"};function Im(e,t,n,i,o,r){return $(),Q(st,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=a=>e.showReceiveDialog=a),position:"bottom","backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(dt,{class:"q-pb-lg q-pt-sm",style:{width:"100%"}},{default:y(()=>[h(St,{class:""},{default:y(()=>[P("div",qm,[P("div",Tm,[h(de,{name:"south_west",size:"1.3rem",class:"q-mb-sm q-pr-sm"}),Mm])])]),_:1}),P("div",xm,[P("div",$m,[h(H,{outline:"",color:"primary",rounded:"",class:"q-py-md q-px-xl",style:{width:"85%"},onClick:e.showReceiveTokensDialog},{default:y(()=>[O("Ecash")]),_:1},8,["onClick"])])]),P("div",Am,[P("div",Em,[h(H,{outline:"",color:"primary",rounded:"",class:"q-py-md q-px-xl",style:{width:"85%"},onClick:e.showInvoiceCreateDialog},{default:y(()=>[O("Lightning")]),_:1},8,["onClick"])])])]),_:1})]),_:1},8,["modelValue"])}var Rm=He(Pm,[["render",Im]]);const Lm={xs:2,sm:4,md:6,lg:10,xl:14};function Go(e,t,n){return{transform:t===!0?`translateX(${n.lang.rtl===!0?"-":""}100%) scale3d(${-e},1,1)`:`scale3d(${e},1,1)`}}var Om=it({name:"QLinearProgress",props:{...yn,...nr,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(e,{slots:t}){const{proxy:n}=ut(),i=wn(e,n.$q),o=ir(e,Lm),r=U(()=>e.indeterminate===!0||e.query===!0),a=U(()=>e.reverse!==e.query),s=U(()=>({...o.value!==null?o.value:{},"--q-linear-progress-speed":`${e.animationSpeed}ms`})),l=U(()=>"q-linear-progress"+(e.color!==void 0?` text-${e.color}`:"")+(e.reverse===!0||e.query===!0?" q-linear-progress--reverse":"")+(e.rounded===!0?" rounded-borders":"")),g=U(()=>Go(e.buffer!==void 0?e.buffer:1,a.value,n.$q)),f=U(()=>`with${e.instantFeedback===!0?"out":""}-transition`),k=U(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${f.value} q-linear-progress__track--${i.value===!0?"dark":"light"}`+(e.trackColor!==void 0?` bg-${e.trackColor}`:"")),w=U(()=>Go(r.value===!0?1:e.value,a.value,n.$q)),S=U(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${f.value} q-linear-progress__model--${r.value===!0?"in":""}determinate`),A=U(()=>({width:`${e.value*100}%`})),L=U(()=>`q-linear-progress__stripe absolute-${e.reverse===!0?"right":"left"} q-linear-progress__stripe--${f.value}`);return()=>{const I=[z("div",{class:k.value,style:g.value}),z("div",{class:S.value,style:w.value})];return e.stripe===!0&&r.value===!1&&I.push(z("div",{class:L.value,style:A.value})),z("div",{class:l.value,style:s.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":e.indeterminate===!0?void 0:e.value},si(t.default,I))}}});class pe{constructor(t,n,i,o,r){this._legacyCanvasSize=pe.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),i&&typeof i=="object"?this._onDecode=n:(console.warn(i||o||r?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=n),n=typeof i=="object"?i:{},this._onDecodeError=n.onDecodeError||(typeof i=="function"?i:this._onDecodeError),this._calculateScanRegion=n.calculateScanRegion||(typeof o=="function"?o:this._calculateScanRegion),this._preferredCamera=n.preferredCamera||r||this._preferredCamera,this._legacyCanvasSize=typeof i=="number"?i:typeof o=="number"?o:this._legacyCanvasSize,this._maxScansPerSecond=n.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;let a=!1;if(t.hidden&&(t.hidden=!1,a=!0),document.body.contains(t)||(document.body.appendChild(t),a=!0),i=t.parentElement,n.highlightScanRegion||n.highlightCodeOutline){if(o=!!n.overlay,this.$overlay=n.overlay||document.createElement("div"),r=this.$overlay.style,r.position="absolute",r.display="none",r.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!o&&n.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}i.insertBefore(this.$overlay,this.$video.nextSibling)}n.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame(()=>{let s=window.getComputedStyle(t);s.display==="none"&&(t.style.setProperty("display","block","important"),a=!0),s.visibility!=="visible"&&(t.style.setProperty("visibility","visible","important"),a=!0),a&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=pe.createQrEngine()}static set WORKER_PATH(t){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await pe.listCameras(!1)).length}catch{return!1}}static async listCameras(t=!1){if(!navigator.mediaDevices)return[];let n=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(o=>o.kind==="videoinput"),i;try{t&&(await n()).every(o=>!o.label)&&(i=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await n()).map((o,r)=>({id:o.deviceId,label:o.label||(r===0?"Default Camera":`Camera ${r+1}`)}))}finally{i&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),pe._stopVideoStream(i))}}async hasFlash(){let t;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;t=this.$video.srcObject}else t=(await this._getCameraStream()).stream;return"torch"in t.getVideoTracks()[0].getSettings()}catch{return!1}finally{t&&t!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),pe._stopVideoStream(t))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(t){throw this._flashOn=!1,t}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),pe._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:t,facingMode:n}=await this._getCameraStream();!this._active||this._paused?pe._stopVideoStream(t):(this._setVideoMirror(n),this.$video.srcObject=t,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(t){if(!this._paused)throw this._active=!1,t}}stop(){this.pause(),this._active=!1}async pause(t=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let n=()=>{this.$video.srcObject instanceof MediaStream&&(pe._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return t?(n(),!0):(await new Promise(i=>setTimeout(i,300)),this._paused?(n(),!0):!1)}async setCamera(t){t!==this._preferredCamera&&(this._preferredCamera=t,await this._restartVideoStream())}static async scanImage(t,n,i,o,r=!1,a=!1){let s,l=!1;n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(s=n.scanRegion,i=n.qrEngine,o=n.canvas,r=n.disallowCanvasResizing||!1,a=n.alsoTryWithoutScanRegion||!1,l=!0):console.warn(n||i||o||r||a?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!i;try{let g,f;[i,g]=await Promise.all([i||pe.createQrEngine(),pe._loadImage(t)]),[o,f]=pe._drawToCanvas(g,s,o,r);let k;if(i instanceof Worker){let w=i;n||pe._postWorkerMessageSync(w,"inversionMode","both"),k=await new Promise((S,A)=>{let L,I,j,E=-1;I=F=>{F.data.id===E&&(w.removeEventListener("message",I),w.removeEventListener("error",j),clearTimeout(L),F.data.data!==null?S({data:F.data.data,cornerPoints:pe._convertPoints(F.data.cornerPoints,s)}):A(pe.NO_QR_CODE_FOUND))},j=F=>{w.removeEventListener("message",I),w.removeEventListener("error",j),clearTimeout(L),A("Scanner error: "+(F?F.message||F:"Unknown Error"))},w.addEventListener("message",I),w.addEventListener("error",j),L=setTimeout(()=>j("timeout"),1e4);let B=f.getImageData(0,0,o.width,o.height);E=pe._postWorkerMessageSync(w,"decode",B,[B.data.buffer])})}else k=await Promise.race([new Promise((w,S)=>window.setTimeout(()=>S("Scanner error: timeout"),1e4)),(async()=>{try{var[w]=await i.detect(o);if(!w)throw pe.NO_QR_CODE_FOUND;return{data:w.rawValue,cornerPoints:pe._convertPoints(w.cornerPoints,s)}}catch(S){if(w=S.message||S,/not implemented|service unavailable/.test(w))return pe._disableBarcodeDetector=!0,pe.scanImage(t,{scanRegion:s,canvas:o,disallowCanvasResizing:r,alsoTryWithoutScanRegion:a});throw`Scanner error: ${w}`}})()]);return l?k:k.data}catch(g){if(!s||!a)throw g;let f=await pe.scanImage(t,{qrEngine:i,canvas:o,disallowCanvasResizing:r});return l?f:f.data}finally{n||pe._postWorkerMessage(i,"close")}}setGrayscaleWeights(t,n,i,o=!0){pe._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:n,blue:i,useIntegerApproximation:o})}setInversionMode(t){pe._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}static async createQrEngine(t){if(t&&console.warn("Specifying a worker path is not required and not supported anymore."),t=()=>Ia(()=>import("./qr-scanner-worker.min.56d417f3.js"),[]).then(i=>i.createWorker()),!(!pe._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return t();let n=navigator.userAgentData;return n&&n.brands.some(({brand:i})=>/Chromium/i.test(i))&&/mac ?OS/i.test(n.platform)&&await n.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:i,platformVersion:o})=>/arm/i.test(i||"arm")&&13<=parseInt(o||"13")).catch(()=>!0)?t():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(t){let n=Math.round(.6666666666666666*Math.min(t.videoWidth,t.videoHeight));return{x:Math.round((t.videoWidth-n)/2),y:Math.round((t.videoHeight-n)/2),width:n,height:n,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var t=this.$video,n=t.videoWidth,i=t.videoHeight,o=t.offsetWidth,r=t.offsetHeight,a=t.offsetLeft,s=t.offsetTop,l=window.getComputedStyle(t),g=l.objectFit,f=n/i,k=o/r;switch(g){case"none":var w=n,S=i;break;case"fill":w=o,S=r;break;default:(g==="cover"?f>k:f<k)?(S=r,w=S*f):(w=o,S=w/f),g==="scale-down"&&(w=Math.min(w,n),S=Math.min(S,i))}var[A,L]=l.objectPosition.split(" ").map((j,E)=>{const B=parseFloat(j);return j.endsWith("%")?(E?r-S:o-w)*B/100:B});l=this._scanRegion.width||n,k=this._scanRegion.height||i,g=this._scanRegion.x||0;var I=this._scanRegion.y||0;f=this.$overlay.style,f.width=`${l/n*w}px`,f.height=`${k/i*S}px`,f.top=`${s+L+I/i*S}px`,i=/scaleX\(-1\)/.test(t.style.transform),f.left=`${a+(i?o-A-w:A)+(i?n-g-l:g)/n*w}px`,f.transform=t.style.transform}})}static _convertPoints(t,n){if(!n)return t;let i=n.x||0,o=n.y||0,r=n.width&&n.downScaledWidth?n.width/n.downScaledWidth:1;n=n.height&&n.downScaledHeight?n.height/n.downScaledHeight:1;for(let a of t)a.x=a.x*r+i,a.y=a.y*n+o;return t}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var t=Date.now()-this._lastScanTimestamp,n=1e3/this._maxScansPerSecond;t<n&&await new Promise(o=>setTimeout(o,n-t)),this._lastScanTimestamp=Date.now();try{var i=await pe.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(o){if(!this._active)return;this._onDecodeError(o)}!pe._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=pe.createQrEngine()),i?(this._onDecode?this._onDecode(i):this._legacyOnDecode&&this._legacyOnDecode(i.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",i.cornerPoints.map(({x:o,y:r})=>`${o},${r}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(t){t!==pe.NO_QR_CODE_FOUND&&console.log(t)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",n=[{width:{min:1024}},{width:{min:768}},{}],i=n.map(o=>Object.assign({},o,{[t]:{exact:this._preferredCamera}}));for(let o of[...i,...n])try{let r=await navigator.mediaDevices.getUserMedia({video:o,audio:!1}),a=this._getFacingMode(r)||(o.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:r,facingMode:a}}catch{}throw"Camera not found."}async _restartVideoStream(){let t=this._paused;await this.pause(!0)&&!t&&this._active&&await this.start()}static _stopVideoStream(t){for(let n of t.getTracks())n.stop(),t.removeTrack(n)}_setVideoMirror(t){this.$video.style.transform="scaleX("+(t==="user"?-1:1)+")"}_getFacingMode(t){return(t=t.getVideoTracks()[0])?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(t,n,i,o=!1){i=i||document.createElement("canvas");let r=n&&n.x?n.x:0,a=n&&n.y?n.y:0,s=n&&n.width?n.width:t.videoWidth||t.width,l=n&&n.height?n.height:t.videoHeight||t.height;return o||(o=n&&n.downScaledWidth?n.downScaledWidth:s,n=n&&n.downScaledHeight?n.downScaledHeight:l,i.width!==o&&(i.width=o),i.height!==n&&(i.height=n)),n=i.getContext("2d",{alpha:!1}),n.imageSmoothingEnabled=!1,n.drawImage(t,r,a,s,l,0,0,i.width,i.height),[i,n]}static async _loadImage(t){if(t instanceof Image)return await pe._awaitImageLoad(t),t;if(t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement||t instanceof SVGImageElement||"OffscreenCanvas"in window&&t instanceof OffscreenCanvas||"ImageBitmap"in window&&t instanceof ImageBitmap)return t;if(t instanceof File||t instanceof Blob||t instanceof URL||typeof t=="string"){let n=new Image;n.src=t instanceof File||t instanceof Blob?URL.createObjectURL(t):t.toString();try{return await pe._awaitImageLoad(n),n}finally{(t instanceof File||t instanceof Blob)&&URL.revokeObjectURL(n.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(t){t.complete&&t.naturalWidth!==0||await new Promise((n,i)=>{let o=r=>{t.removeEventListener("load",o),t.removeEventListener("error",o),r instanceof ErrorEvent?i("Image load error"):n()};t.addEventListener("load",o),t.addEventListener("error",o)})}static async _postWorkerMessage(t,n,i,o){return pe._postWorkerMessageSync(await t,n,i,o)}static _postWorkerMessageSync(t,n,i,o){if(!(t instanceof Worker))return-1;let r=pe._workerMessageId++;return t.postMessage({id:r,type:n,data:i},o),r}}pe.DEFAULT_CANVAS_SIZE=400;pe.NO_QR_CODE_FOUND="No QR code found";pe._disableBarcodeDetector=!1;pe._workerMessageId=0;const Um={emits:["decode"],data(){return{qrScanner:null,urDecoder:null,urDecoderProgress:0}},mounted(){this.qrScanner=new pe(this.$refs.cameraEl,e=>{this.handleResult(e)},{returnDetailedScanResult:!0,highlightScanRegion:!0,highlightCodeOutline:!0,onDecodeError:()=>{}}),this.qrScanner.start(),this.urDecoder=new Gf},computed:{...Se(yt,["camera","hasCamera"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText}},methods:{...ye(yt,["closeCamera","showCamera"]),handleResult(e){if(e.data.toLowerCase().startsWith("ur:")){if(this.urDecoder?.receivePart(e.data),this.urDecoderProgress=this.urDecoder?.estimatedPercentComplete()||0,this.urDecoder?.isComplete()&&this.urDecoder?.isSuccess()){const n=(this.urDecoder?.resultUR()).decodeCBOR();this.$emit("decode",n.toString()),this.qrScanner?.stop(),this.urDecoderProgress=0}}else this.$emit("decode",e.data),this.qrScanner?.stop()},pasteToParseDialog:function(){console.log("pasteToParseDialog"),navigator.clipboard.readText().then(e=>{this.$emit("decode",e)})}},unmounted(){this.qrScanner?.destroy()}},Nm={class:"text-center"},Vm={ref:"cameraEl",style:{width:"100%"}},Bm={class:"row q-justify-center"},Fm={class:"absolute-full flex flex-center"},zm={class:"row q-my-sm"};function jm(e,t,n,i,o,r){return $(),Q(dt,null,{default:y(()=>[P("div",Nm,[P("div",null,[P("video",Vm,null,512)]),P("div",null,[P("div",Bm,[o.urDecoderProgress>0?($(),Q(Om,{key:0,rounded:"",size:"30px",value:o.urDecoderProgress,indeterminate:o.urDecoderProgress===0,class:"q-mt-none",color:"secondary"},{default:y(()=>[P("div",Fm,[h(Ft,{color:"white","text-color":"secondary",style:{"font-size":"1rem",padding:"5px"},class:"text-weight-bold",label:Math.round(o.urDecoderProgress*100)+"%"+(o.urDecoderProgress>.9?" - Keep scanning":"")},null,8,["label"])])]),_:1},8,["value","indeterminate"])):Z("",!0)])])]),P("div",zm,[r.canPasteFromClipboard?($(),Q(H,{key:0,unelevated:"",icon:"content_paste",onClick:r.pasteToParseDialog},{default:y(()=>[h(at,null,{default:y(()=>[O("Paste")]),_:1})]),_:1},8,["onClick"])):Z("",!0),h(H,{onClick:e.closeCamera,flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1},8,["onClick"])])]),_:1})}var Wm=He(Um,[["render",jm]]);const Hm=Je({name:"iOSPWAPrompt",mixins:[windowMixin],props:{},data:function(){return{showIosPWAPromptLocal:localStorage.getItem("cashu.showIosPWAPrompt")!="seen",showIosPWAPrompt:!1}},mounted(){this.showIosPWAPromptLocal&&this.isiOsSafari()&&!this.isInStandaloneMode()&&(this.showIosPWAPrompt=!0)},watch:{},computed:{},methods:{closePrompt(){localStorage.setItem("cashu.showIosPWAPrompt","seen"),this.showIosPWAPrompt=!1},isiOsSafari(){const e=window.navigator.userAgent.toLowerCase();return/iphone|ipad|ipod/.test(e)&&/safari/.test(e)},isInStandaloneMode(){return"standalone"in window.navigator&&window.navigator.standalone}}}),Yr=e=>(or("data-v-3504c157"),e=e(),rr(),e),Qm={key:0,class:"pwa-prompt q-pa-md q-mx-auto text-center"},Km={class:"pwa-prompt-content"},Xm=Yr(()=>P("strong",null,"Add to Home Screen",-1)),Gm=Yr(()=>P("div",{class:"pwa-prompt-arrow"},null,-1));function Ym(e,t,n,i,o,r){return $(),Q(Ct,{appear:"","enter-active-class":"animated fadeInUp","leave-active-class":"animated fadeInDown",mode:"out-in"},{default:y(()=>[e.showIosPWAPrompt?($(),J("div",Qm,[P("div",Km,[P("span",null,[O("Tap "),h(de,{name:"ios_share",size:"sm"}),O(" and "),Xm]),h(H,{flat:"",icon:"close",onClick:e.closePrompt,size:"sm",class:"close-btn q-px-sm"},null,8,["onClick"])]),Gm])):Z("",!0)]),_:1})}var Zm=He(Hm,[["render",Ym],["__scopeId","data-v-3504c157"]]);const Jm=Je({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{TokenInformation:qr,P2PKDialog:is},props:{},data:function(){return{showP2PKDialog:!1}},computed:{...De(vn,["showReceiveTokens","receiveData"]),...Se(lt,["tickerShort"]),...Se(xe,["activeProofs","activeUnit","addMintBlocking"]),...De(xe,["addMintData","showAddMintDialog"]),...Se(yt,["hasCamera"]),...Se(Gt,["p2pkKeys"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},tokenDecodesCorrectly:function(){return this.decodeToken(this.receiveData.tokensBase64)!==void 0},knowThisMint:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return e==null?!1:this.knowThisMintOfTokenJson(e)}},methods:{...ye(Ze,["redeem"]),...ye(yt,["closeCamera","showCamera"]),...ye(zt,["addPendingToken"]),...ye(Gt,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...ye(xe,["addMint"]),knowThisMintOfTokenJson:function(e){const t=xe();for(var n=0;n<e.token.length;n++)if(!t.mints.map(i=>i.url).includes(ke.getMint(e)))return!1;return!0},receiveToken:async function(e){xe();const t=vn();if(lt(),t.showReceiveTokens=!1,console.log("### receive tokens",t.receiveData.tokensBase64),t.receiveData.tokensBase64.length==0)throw new Error("no tokens provided.");t.receiveData.p2pkPrivateKey=this.getPrivateKeyForP2PKEncodedToken(t.receiveData.tokensBase64);const n=ke.decode(t.receiveData.tokensBase64);if(n==null)throw new Error("no tokens provided.");this.knowThisMintOfTokenJson(n)||await this.addMint({url:ke.getMint(n)}),await this.redeem(t.receiveData.tokensBase64)},decodeToken:function(e){let t;try{t=ke.decode(e)}catch{}return t},getProofs:function(e){return ke.getProofs(e)},getMint:function(e){return ke.getMint(e)},handleLockBtn:function(){this.showP2PKDialog=!this.showP2PKDialog,(!this.p2pkKeys.length||!this.showP2PKDialog)&&this.generateKeypair(),this.showLastKey()},receiveIfDecodes:function(){try{this.decodeToken(this.receiveData.tokensBase64)&&this.receiveToken(this.receiveData.tokensBase64)}catch(e){console.error(e)}},tokenAlreadyInHistory:function(e){return zt().historyTokens.find(n=>n.token===e)!==void 0},addPendingTokenToHistory:function(e){if(this.tokenAlreadyInHistory(e)){this.notifySuccess("Ecash already in history"),this.showReceiveTokens=!1;return}const t=zt(),n=this.decodeToken(e),i=this.getProofs(n).reduce((o,r)=>o+=r.amount,0);t.addPendingToken({amount:i,serializedProofs:e}),this.showReceiveTokens=!1,this.notifySuccess("Ecash added to history.")},pasteToParseDialog:function(){console.log("pasteToParseDialog"),navigator.clipboard.readText().then(e=>{this.receiveData.tokensBase64=e})}},created:function(){}}),eg=P("div",{class:"row items-center no-wrap q-mb-sm"},[P("div",{class:"col-10"},[P("span",{class:"text-h6"},"Receive Ecash")])],-1),tg={key:0,class:"row"},ng={class:"col-12"},ig={class:"row q-mt-lg"};function og(e,t,n,i,o,r){const a=Ee("P2PKDialog"),s=Ee("TokenInformation");return $(),Q(st,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[4]||(t[4]=l=>e.showReceiveTokens=l),position:"top","backdrop-filter":"blur(2px) brightness(60%)","no-backdrop-dismiss":""},{default:y(()=>[h(dt,{class:"q-pa-lg q-pt-md qcard"},{default:y(()=>[P("div",null,[eg,P("div",null,[h(a,{modelValue:e.showP2PKDialog,"onUpdate:modelValue":t[0]||(t[0]=l=>e.showP2PKDialog=l)},null,8,["modelValue"])]),h(tt,{round:"",outlined:"",modelValue:e.receiveData.tokensBase64,"onUpdate:modelValue":t[2]||(t[2]=l=>e.receiveData.tokensBase64=l),label:"Paste Cashu token",type:"textarea",autofocus:"",class:"q-mb-lg",onKeyup:Bt(e.receiveIfDecodes,["enter"])},Ra({_:2},[e.receiveData.tokensBase64?{name:"append",fn:y(()=>[h(de,{name:"close",class:"cursor-pointer",onClick:t[1]||(t[1]=l=>e.receiveData.tokensBase64="")})]),key:"0"}:void 0]),1032,["modelValue","onKeyup"])]),e.receiveData.tokensBase64.length&&e.tokenDecodesCorrectly?($(),J("div",tg,[P("div",ng,[h(s,{encodedToken:e.receiveData.tokensBase64,showAmount:!0,showMintCheck:!0,showP2PKCheck:!0},null,8,["encodedToken"])])])):Z("",!0),P("div",ig,[e.receiveData.tokensBase64.length&&!e.tokenDecodesCorrectly?($(),Q(H,{key:0,disabled:"",color:"yellow","text-color":"black",rounded:"",unelevated:"",class:"q-mr-sm",label:"Invalid token"})):Z("",!0),e.tokenDecodesCorrectly?($(),Q(H,{key:1,onClick:e.receiveIfDecodes,color:"primary",rounded:"",class:"q-mr-sm",disabled:e.addMintBlocking,label:e.knowThisMint&&e.addMintBlocking?"Adding mint ...":"Receive"},null,8,["onClick","disabled","label"])):Z("",!0),e.tokenDecodesCorrectly?($(),Q(H,{key:2,onClick:t[3]||(t[3]=l=>e.addPendingTokenToHistory(e.receiveData.tokensBase64)),color:"primary",rounded:"",flat:"",class:"q-mr-sm"},{default:y(()=>[O("Later "),h(at,null,{default:y(()=>[O("Add to history to receive later")]),_:1})]),_:1})):Z("",!0),e.canPasteFromClipboard&&!e.receiveData.tokensBase64.length?($(),Q(H,{key:3,unelevated:"",dense:"",onClick:e.pasteToParseDialog},{default:y(()=>[h(de,{name:"content_paste",class:"q-pr-sm"}),O("Paste")]),_:1},8,["onClick"])):Z("",!0),e.hasCamera&&!e.receiveData.tokensBase64.length?($(),Q(H,{key:4,unelevated:"",class:"q-mx-none",onClick:e.showCamera},{default:y(()=>[h(de,{name:"qr_code_scanner"})]),_:1},8,["onClick"])):Z("",!0),e.receiveData.tokensBase64.length?Z("",!0):($(),Q(H,{key:5,unelevated:"",class:"q-mx-none",onClick:e.handleLockBtn},{default:y(()=>[h(de,{name:"lock_outline"})]),_:1},8,["onClick"])),ze(($(),Q(H,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:y(()=>[O("Close")]),_:1})),[[We]])])]),_:1})]),_:1},8,["modelValue"])}var rg=He(Jm,[["render",og]]);const ag={mixins:[windowMixin],components:{BalanceView:nl,MintSettings:iu,InvoicesTable:wc,HistoryTable:qc,NoMintWarnBanner:Lc,WelcomeDialog:jc,SendTokenDialog:kh,ReceiveTokenDialog:rg,PayInvoiceDialog:em,InvoiceDetailDialog:gm,QrcodeReader:Wm,SendDialog:Sm,ReceiveDialog:Rm,iOSPWAPrompt:Zm},data:function(){return{name:"",mintId:"",mintName:"",deferredPWAInstallPrompt:null,action:"main",parse:{show:!1,invoice:null,lnurlpay:null,lnurlauth:null,data:{request:"",amount:0,comment:""},paymentChecker:null,camera:{show:!1,camera:"auto"}},payments:[],paymentsChart:{show:!1},welcomeDialog:{show:!1},baseHost:location.protocol+"//"+location.host,baseURL:location.protocol+"//"+location.host+location.pathname,credit:0,newName:""}},computed:{...De(lt,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...Se(lt,["tickerShort"]),...De(lt,["expandHistory"]),...De(vn,["showReceiveTokens","receiveData"]),...De(ni,["showSendTokens","sendData"]),...Se(xe,["activeMintUrl","activeProofs","keys","mints","proofs","activeMint"]),...De(Ze,["invoiceHistory","invoiceData","payInvoiceData"]),...De(xe,["addMintData","showAddMintDialog"]),...De(Yt,["invoiceCheckListener","tokensCheckSpendableListener"]),...Se(zt,["historyTokens"]),...De(yt,["camera","hasCamera"]),...De(Gt,["showP2PKDialog"]),...De(Co,["showNWCDialog","nwcEnabled"]),pendingPaymentsExist:function(){return this.payments.findIndex(e=>e.pending)!==-1},balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)}},filters:{},methods:{...ye(fr,["serializeProofs","getProofsMint","serializeProofsV2","sumProofs","deleteProofs"]),...ye(xe,["activateMintUrl","addMint","assertMintError","getBalance","setActiveProofs","setProofs","getKeysForKeyset"]),...ye(Yt,["clearAllWorkers","invoiceCheckWorker","checkTokenSpendableWorker"]),...ye(zt,["setTokenPaid"]),...ye(Ze,["requestMint","setInvoicePaid","mint","melt","checkProofsSpendable","checkTokenSpendable","checkInvoice","checkPendingInvoices","checkPendingTokens","decodeRequest","generateNewMnemonic"]),...ye(yt,["closeCamera","showCamera"]),...ye(Co,["listenToNWCCommands"]),...ye(os,["generateNPCConnection","claimAllTokens"]),decodeToken:function(e){try{return ke.decode(e)}catch{return null}},getProofs:function(e){return ke.getProofs(e)},getMint:function(e){return ke.getMint(e)},shortenString:function(e){return ji(e,20,10)},getTokenList:function(){const e=this.activeProofs.map(n=>n.amount),t={};for(const n of e)t[n]=t[n]?t[n]+1:1;return Object.keys(t).map(n=>({value:parseInt(n),count:parseInt(t[n]),sum:n*t[n]}))},paymentTableRowKey:function(e){return e.payment_hash+e.amount},showChart:function(){this.paymentsChart.show=!0,this.$nextTick(()=>{generateChart(this.$refs.canvas,this.payments)})},focusInput(e){},showParseDialog:function(){this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.payInvoiceData.input.paymentChecker=null,this.camera.show=!1,this.focusInput("parseDialogInput")},showWelcomeDialog:function(){localStorage.getItem("cashu.welcomeDialogSeen")!="seen"&&(this.welcomeDialog.show=!0)},setWelcomeDialogSeen:function(){localStorage.setItem("cashu.welcomeDialogSeen","seen"),this.welcomeDialog.show=!1,this.setTab("mints"),localStorage.getItem("cashu.activeMintUrl")&&window.location.reload()},setTab:function(e){this.tab=e},decodeQR:function(e){this.camera.data=e,this.camera.show=!1,this.decodeRequest(e)},showInvoiceCreateDialog:async function(){console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0},showInvoicInfoDialog:function(e){console.log("##### showInvoicInfoDialog"),this.invoiceData=Mo(e),this.showInvoiceDetails=!0,this.invoiceCheckWorker()},showTokenDialog:function(e){console.log("##### showTokenDialog"),this.sendData.tokens=this.getProofs(this.decodeToken(e)),this.sendData.tokensBase64=Mo(e),this.showSendTokens=!0},showSendTokensDialog:function(){console.log("##### showSendTokensDialog"),this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.showSendTokens=!0},hideSendTokensDialog:function(){this.showSendTokens=!1},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0},registerPWAEventHook:function(){window.addEventListener("beforeinstallprompt",e=>{this.deferredPWAInstallPrompt=e,console.log("'beforeinstallprompt' event was fired.",this.getPwaDisplayMode())})},getPwaDisplayMode:function(){const e=window.matchMedia("(display-mode: standalone)").matches;return document.referrer.startsWith("android-app://")?"twa":navigator.standalone||e?"standalone":"browser"},triggerPwaInstall:function(){this.deferredPWAInstallPrompt.prompt(),this.deferredPWAInstallPrompt.userChoice.then(e=>{e.outcome==="accepted"?(console.log("User accepted the install prompt"),this.setWelcomeDialogSeen()):console.log("User dismissed the install prompt")})},registerBroadcastChannel:async function(){sessionStorage.getItem("tabId")||sessionStorage.setItem("tabId",Math.random().toString(36).substring(2)+new Date().getTime().toString(36));const e=sessionStorage.getItem("tabId"),t=new BroadcastChannel("app_channel");t.postMessage({type:"new_tab_opened",senderId:e}),t.onmessage=async n=>{n.data.senderId!==e&&(n.data.type=="new_tab_opened"?t.postMessage({type:"already_running",senderId:e}):n.data.type=="already_running"&&(window.location.href="/#/already-running"))}}},watch:{},mounted:function(){this.generateNPCConnection(),this.claimAllTokens()},created:async function(){this.registerBroadcastChannel();let e=new URL(document.location).searchParams;if(e.get("mint")){let i=e.get("mint");await this.setTab("mints"),this.showAddMintDialog=!0,this.addMintData={url:i}}if(localStorage.getItem("cashu.activeMintUrl")||this.setTab("mints"),console.log("Mint URL "+this.activeMintUrl),console.log("Wallet URL "+this.baseURL),e.get("token")){let i=e.get("token"),o=!1;for(var t=0;t<this.historyTokens.length;t++){var n=this.historyTokens[t].token;n==i&&this.historyTokens[t].amount>0&&(o=!0)}o||(this.receiveData.tokensBase64=e.get("token"),this.showReceiveTokens=!0)}e.get("lightning")&&(this.showParseDialog(),this.payInvoiceData.input.request=e.get("lightning")),window.history.pushState({},document.title,window.location.href.split("?")[0].split("#")[0]),this.registerPWAEventHook(),this.generateNewMnemonic(),this.showWelcomeDialog(),this.nwcEnabled&&this.listenToNWCCommands()}},sg={class:"row q-col-gutter-y-md justify-center q-pt-sm q-pb-md"},lg={class:"col-12 col-sm-11 col-md-8 text-center q-gutter-y-md"},ug={class:"row items-center justify-center no-wrap q-mb-none q-mx-none q-px-none q-pt-lg q-pb-md"},cg={class:"col-5 q-mb-md"},dg={class:"col-2 q-mb-md q-mx-none"},fg={class:"col-5 q-mb-md"},hg={style:{"margin-bottom":"0rem"}},mg={class:"row q-pt-sm"},gg={class:"col-12 q-pt-xs"},vg=P("b",null,"Install",-1);function pg(e,t,n,i,o,r){const a=Ee("NoMintWarnBanner"),s=Ee("BalanceView"),l=Ee("ReceiveDialog"),g=Ee("SendDialog"),f=Ee("HistoryTable"),k=Ee("InvoicesTable"),w=Ee("MintSettings"),S=Ee("iOSPWAPrompt"),A=Ee("PayInvoiceDialog"),L=Ee("QrcodeReader"),I=Ee("WelcomeDialog"),j=Ee("InvoiceDetailDialog"),E=Ee("SendTokenDialog"),B=Ee("ReceiveTokenDialog");return $(),J("div",sg,[P("div",lg,[e.mints.length==0?($(),Q(a,{key:0})):($(),Q(s,{key:1,"set-tab":r.setTab},null,8,["set-tab"])),P("div",ug,[P("div",cg,[h(H,{rounded:"",dense:"",class:"q-px-md",color:"primary",style:{width:"140px"},onClick:t[0]||(t[0]=F=>e.showReceiveDialog=!0),size:"1.2rem"},{default:y(()=>[h(de,{name:"south_west",size:"1.2rem",class:"q-mr-xs"}),O(" Receive")]),_:1})]),P("div",dg,[h(H,{align:"center",size:"lg",icon:"qr_code_scanner",outline:"",color:"primary",flat:"",onClick:e.showCamera},null,8,["onClick"])]),P("div",fg,[h(H,{rounded:"",dense:"",class:"q-px-md",style:{width:"140px"},color:"primary",onClick:t[1]||(t[1]=F=>e.showSendDialog=!0),size:"1.2rem"},{default:y(()=>[h(de,{name:"north_east",size:"1.2rem",class:"q-mr-xs"}),O(" Send")]),_:1})]),h(l,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[2]||(t[2]=F=>e.showReceiveDialog=F)},null,8,["modelValue"]),h(g,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[3]||(t[3]=F=>e.showSendDialog=F)},null,8,["modelValue"])]),h(cr,{"expand-icon-class":"hidden",modelValue:e.expandHistory,"onUpdate:modelValue":t[6]||(t[6]=F=>e.expandHistory=F)},{header:y(({expanded:F})=>[h(Be,{class:"item-center text-center"},{default:y(()=>[P("span",null,[h(de,{color:"primary",name:F?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])])]),_:2},1024)]),default:y(()=>[h(Cs,{modelValue:e.tab,"onUpdate:modelValue":t[4]||(t[4]=F=>e.tab=F),"no-caps":"",class:Ai(e.$q.dark.isActive?"bg-dark":"bg-white")},{default:y(()=>[h(_i,{name:"history",class:"text-secondary",label:"History"}),h(_i,{name:"invoices",class:"text-secondary",label:"Invoices"}),h(_i,{name:"mints",class:"text-secondary",label:"Mints"})]),_:1},8,["modelValue","class"]),h(Ts,{class:Ai(e.$q.dark.isActive?"bg-dark":"bg-white"),modelValue:e.tab,"onUpdate:modelValue":t[5]||(t[5]=F=>e.tab=F),animated:""},{default:y(()=>[h(bi,{name:"history"},{default:y(()=>[h(f,{"show-token-dialog":r.showTokenDialog},null,8,["show-token-dialog"])]),_:1}),h(bi,{name:"invoices"},{default:y(()=>[h(k)]),_:1}),h(bi,{name:"mints",class:"q-px-sm"},{default:y(()=>[h(w)]),_:1})]),_:1},8,["class","modelValue"])]),_:1},8,["modelValue"]),P("div",hg,[P("div",mg,[P("div",gg,[r.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?($(),Q(H,{key:0,class:"q-mx-xs q-px-sm q-my-sm",outline:"",size:"0.6rem",color:"primary",onClick:t[7]||(t[7]=F=>r.triggerPwaInstall())},{default:y(()=>[vg,h(at,null,{default:y(()=>[O("Install Cashu")]),_:1})]),_:1})):Z("",!0)])])]),h(S)]),h(A,{modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[8]||(t[8]=F=>e.payInvoiceData.show=F)},null,8,["modelValue"]),h(st,{modelValue:e.camera.show,"onUpdate:modelValue":t[9]||(t[9]=F=>e.camera.show=F),"backdrop-filter":"blur(2px) brightness(60%)"},{default:y(()=>[h(L,{onDecode:r.decodeQR},null,8,["onDecode"])]),_:1},8,["modelValue"]),h(I,{"welcome-dialog":e.welcomeDialog,"trigger-pwa-install":r.triggerPwaInstall,"set-tab":r.setTab,"get-pwa-display-mode":r.getPwaDisplayMode,"set-welcome-dialog-seen":r.setWelcomeDialogSeen},null,8,["welcome-dialog","trigger-pwa-install","set-tab","get-pwa-display-mode","set-welcome-dialog-seen"]),h(j,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[10]||(t[10]=F=>e.showInvoiceDetails=F),"invoice-check-worker":e.invoiceCheckWorker},null,8,["modelValue","invoice-check-worker"]),h(E,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[11]||(t[11]=F=>e.showSendTokens=F)},null,8,["modelValue"]),h(B,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[12]||(t[12]=F=>e.showReceiveTokens=F)},null,8,["modelValue"])])}var qg=He(ag,[["render",pg]]);export{qg as default};
