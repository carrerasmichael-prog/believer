import{C as ls,D as Xi,r as ye,E as H,F as En,o as Ri,ap as Ur,G as Fe,aq as yo,k as Y,A as Dt,ai as wo,ar as Nr,R as me,ac as Or,f as Vt,as as qn,B as Ct,w as rt,a6 as Lr,am as _o,at as bo,I as ti,H as Br,j as Oe,au as de,av as ce,K as Ee,L as M,M as W,X as L,W as V,U as ae,aw as ve,V as J,a5 as f,Q as u,O as m,Y as Je,a0 as at,a1 as Ot,T as I,S as z,a9 as us,$ as Ui,an as _i,ax as cs,ay as ds,az as fs,y as hs,aA as ms,m as gs,aB as vs,aC as ps,n as Qt,aD as ys,aE as ws,v as Gi,x as Sn,a as Vr,a3 as Ft,a4 as zt,aF as Fr,aG as Et,aa as _s,aH as Wn,aI as qi,aJ as bs,aK as Ti,aL as ks,aM as or,aN as Ds,aO as Cs,aP as Ms,aQ as Ss,aR as qs,aS as Ts,_ as Ps}from"./index.916cb52e.js";import{u as Ni,a as Oi,Q as dt,b as Ie,c as gt}from"./QItem.18ca9374.js";import{u as $s,a as zr,b as xs,c as Es,Q as jr}from"./private.use-form.be065f06.js";import{Q as As}from"./QResizeObserver.d45b2ee0.js";import{u as bi,a as Is,b as Rs,c as Us,r as rr,d as Ns,e as Os,Q as ut,f as ct,g as Wr,h as Yi}from"./welcome.62644ccc.js";import{b as Qn,u as Ls,a as Bs,c as Vs}from"./use-timeout.c52bf43b.js";import{u as Fs,a as zs,b as js,c as Ws,Q as Hs,d as Ks,i as Qs,A as Xs}from"./AndroidPWAPrompt.302a1c60.js";import{g as Lt,Q as Ze,u as Gs,a as Ys,b as Zs,v as ar,c as Js,d as el,e as tl,r as sr,s as nl,p as lr,f as il,C as He,h as st,i as ko,P as ol,j as ur,k as rl}from"./npubcash.daddea67.js";import{a as De,c as Gt,u as $e,d as Xn,e as Xe,n as cr,M as Gn,f as Tn,g as An,h as Bt,i as uo,j as dn,k as Hn,b as al,l as Hr,t as Se,m as sl,o as At,p as ni,q as Kr,s as Ne,v as ll,P as di,w as It,x as dr,y as ul,z as cl,A as dl,N as fl,B as hl,D as ml,E as fr,F as Qr,G as co,H as gl,I as vl}from"./ui.b6121134.js";import{Q as Rt}from"./QSpinnerHourglass.12e6d1e7.js";import{Q as $t,a as Kn}from"./QList.1f08d45c.js";import{u as Do,a as Xr,b as Gr,c as Yr,f as hr,d as pl,Q as lt}from"./QInput.265349d8.js";import{s as yl,g as wl}from"./scroll.b2adc88e.js";import{a as _l,r as bl}from"./focusout.be8db32e.js";import{i as Co}from"./vue-qrcode.esm.c5e039a4.js";import{Q as kl}from"./QToolbarTitle.7349d924.js";import{Q as Dl}from"./QToolbar.4ef97f48.js";import{Q as Cl}from"./QLinearProgress.00741bf9.js";import{u as Ml}from"./index.42f06193.js";import"./touch.9135741d.js";import"./selection.7b8f2356.js";let Sl=0;const ql=["click","keydown"],Tl={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${Sl++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function Pl(e,t,n,i){const o=ls(Ur,Xi);if(o===Xi)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Xi;const{proxy:r}=Vt(),a=ye(null),s=ye(null),l=ye(null),h=H(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),g=H(()=>o.currentModel.value===e.name),w=H(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(g.value===!0?" q-tab--active"+(o.tabProps.value.activeClass?" "+o.tabProps.value.activeClass:"")+(o.tabProps.value.activeColor?` text-${o.tabProps.value.activeColor}`:"")+(o.tabProps.value.activeBgColor?` bg-${o.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&o.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||o.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(i!==void 0?i.linkClass.value:"")),_=H(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(o.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),C=H(()=>e.disable===!0||o.hasFocus.value===!0||g.value===!1&&o.hasActiveTab.value===!0?-1:e.tabindex||0);function E(F,X){if(X!==!0&&a.value!==null&&a.value.focus(),e.disable===!0){i!==void 0&&i.hasRouterLink.value===!0&&Dt(F);return}if(i===void 0){o.updateModel({name:e.name}),n("click",F);return}if(i.hasRouterLink.value===!0){const pe=(se={})=>{let j;const c=se.to===void 0||qn(se.to,e.to)===!0?o.avoidRouteWatcher=$s():null;return i.navigateToRouterLink(F,{...se,returnRouterError:!0}).catch(v=>{j=v}).then(v=>{if(c===o.avoidRouteWatcher&&(o.avoidRouteWatcher=!1,j===void 0&&(v===void 0||v.message!==void 0&&v.message.startsWith("Avoided redundant navigation")===!0)&&o.updateModel({name:e.name})),se.returnRouterError===!0)return j!==void 0?Promise.reject(j):v})};n("click",F,pe),F.defaultPrevented!==!0&&pe();return}n("click",F)}function N(F){wo(F,[13,32])?E(F,!0):Nr(F)!==!0&&F.keyCode>=35&&F.keyCode<=40&&F.altKey!==!0&&F.metaKey!==!0&&o.onKbdNavigate(F.keyCode,r.$el)===!0&&Dt(F),n("keydown",F)}function U(){const F=o.tabProps.value.narrowIndicator,X=[],pe=Y("div",{ref:l,class:["q-tab__indicator",o.tabProps.value.indicatorClass]});e.icon!==void 0&&X.push(Y(me,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&X.push(Y("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&X.push(e.alertIcon!==void 0?Y(me,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):Y("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),F===!0&&X.push(pe);const se=[Y("div",{class:"q-focus-helper",tabindex:-1,ref:a}),Y("div",{class:_.value},Or(t.default,X))];return F===!1&&se.push(pe),se}const K={name:H(()=>e.name),rootRef:s,tabIndicatorRef:l,routeData:i};En(()=>{o.unregisterTab(K)}),Ri(()=>{o.registerTab(K)});function A(F,X){const pe={ref:s,class:w.value,tabindex:C.value,role:"tab","aria-selected":g.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:E,onKeydown:N,...X};return Fe(Y(F,pe,U()),[[yo,h.value]])}return{renderTab:A,$tabs:o}}var Zi=Ct({name:"QTab",props:Tl,emits:ql,setup(e,{slots:t,emit:n}){const{renderTab:i}=Pl(e,t,n);return()=>i("div")}});let Yn=!1;{const e=document.createElement("div");e.setAttribute("dir","rtl"),Object.assign(e.style,{width:"1px",height:"1px",overflow:"auto"});const t=document.createElement("div");Object.assign(t.style,{width:"1000px",height:"1px"}),document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,Yn=e.scrollLeft>=0,e.remove()}function $l(e,t,n){const i=n===!0?["left","right"]:["top","bottom"];return`absolute-${t===!0?i[0]:i[1]}${e?` text-${e}`:""}`}const xl=["left","center","right","justify"];var El=Ct({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>xl.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:n}){const{proxy:i}=Vt(),{$q:o}=i,{registerTick:r}=bi(),{registerTick:a}=bi(),{registerTick:s}=bi(),{registerTimeout:l,removeTimeout:h}=Qn(),{registerTimeout:g,removeTimeout:w}=Qn(),_=ye(null),C=ye(null),E=ye(e.modelValue),N=ye(!1),U=ye(!0),K=ye(!1),A=ye(!1),F=[],X=ye(0),pe=ye(!1);let se=null,j=null,c;const v=H(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:$l(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),p=H(()=>{const Q=X.value,ie=E.value;for(let we=0;we<Q;we++)if(F[we].name.value===ie)return!0;return!1}),$=H(()=>`q-tabs__content--align-${N.value===!0?"left":A.value===!0?"justify":e.align}`),y=H(()=>`q-tabs row no-wrap items-center q-tabs--${N.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),b=H(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+$.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),q=H(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),D=H(()=>e.vertical!==!0&&o.lang.rtl===!0),S=H(()=>Yn===!1&&D.value===!0);rt(D,O),rt(()=>e.modelValue,Q=>{x({name:Q,setCurrent:!0,skipEmit:!0})}),rt(()=>e.outsideArrows,T);function x({name:Q,setCurrent:ie,skipEmit:we}){E.value!==Q&&(we!==!0&&e["onUpdate:modelValue"]!==void 0&&n("update:modelValue",Q),(ie===!0||e["onUpdate:modelValue"]===void 0)&&(oe(E.value,Q),E.value=Q))}function T(){r(()=>{R({width:_.value.offsetWidth,height:_.value.offsetHeight})})}function R(Q){if(q.value===void 0||C.value===null)return;const ie=Q[q.value.container],we=Math.min(C.value[q.value.scroll],Array.prototype.reduce.call(C.value.children,(je,Pe)=>je+(Pe[q.value.content]||0),0)),Re=ie>0&&we>ie;N.value=Re,Re===!0&&a(O),A.value=ie<parseInt(e.breakpoint,10)}function oe(Q,ie){const we=Q!=null&&Q!==""?F.find(je=>je.name.value===Q):null,Re=ie!=null&&ie!==""?F.find(je=>je.name.value===ie):null;if(we&&Re){const je=we.tabIndicatorRef.value,Pe=Re.tabIndicatorRef.value;se!==null&&(clearTimeout(se),se=null),je.style.transition="none",je.style.transform="none",Pe.style.transition="none",Pe.style.transform="none";const Me=je.getBoundingClientRect(),tt=Pe.getBoundingClientRect();Pe.style.transform=e.vertical===!0?`translate3d(0,${Me.top-tt.top}px,0) scale3d(1,${tt.height?Me.height/tt.height:1},1)`:`translate3d(${Me.left-tt.left}px,0,0) scale3d(${tt.width?Me.width/tt.width:1},1,1)`,s(()=>{se=setTimeout(()=>{se=null,Pe.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",Pe.style.transform="none"},70)})}Re&&N.value===!0&&P(Re.rootRef.value)}function P(Q){const{left:ie,width:we,top:Re,height:je}=C.value.getBoundingClientRect(),Pe=Q.getBoundingClientRect();let Me=e.vertical===!0?Pe.top-Re:Pe.left-ie;if(Me<0){C.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(Me),O();return}Me+=e.vertical===!0?Pe.height-je:Pe.width-we,Me>0&&(C.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(Me),O())}function O(){const Q=C.value;if(Q===null)return;const ie=Q.getBoundingClientRect(),we=e.vertical===!0?Q.scrollTop:Math.abs(Q.scrollLeft);D.value===!0?(U.value=Math.ceil(we+ie.width)<Q.scrollWidth-1,K.value=we>0):(U.value=we>0,K.value=e.vertical===!0?Math.ceil(we+ie.height)<Q.scrollHeight:Math.ceil(we+ie.width)<Q.scrollWidth)}function re(Q){j!==null&&clearInterval(j),j=setInterval(()=>{G(Q)===!0&&ee()},5)}function ge(){re(S.value===!0?Number.MAX_SAFE_INTEGER:0)}function ue(){re(S.value===!0?0:Number.MAX_SAFE_INTEGER)}function ee(){j!==null&&(clearInterval(j),j=null)}function le(Q,ie){const we=Array.prototype.filter.call(C.value.children,tt=>tt===ie||tt.matches&&tt.matches(".q-tab.q-focusable")===!0),Re=we.length;if(Re===0)return;if(Q===36)return P(we[0]),we[0].focus(),!0;if(Q===35)return P(we[Re-1]),we[Re-1].focus(),!0;const je=Q===(e.vertical===!0?38:37),Pe=Q===(e.vertical===!0?40:39),Me=je===!0?-1:Pe===!0?1:void 0;if(Me!==void 0){const tt=D.value===!0?-1:1,pt=we.indexOf(ie)+Me*tt;return pt>=0&&pt<Re&&(P(we[pt]),we[pt].focus({preventScroll:!0})),!0}}const xe=H(()=>S.value===!0?{get:Q=>Math.abs(Q.scrollLeft),set:(Q,ie)=>{Q.scrollLeft=-ie}}:e.vertical===!0?{get:Q=>Q.scrollTop,set:(Q,ie)=>{Q.scrollTop=ie}}:{get:Q=>Q.scrollLeft,set:(Q,ie)=>{Q.scrollLeft=ie}});function G(Q){const ie=C.value,{get:we,set:Re}=xe.value;let je=!1,Pe=we(ie);const Me=Q<Pe?-1:1;return Pe+=Me*5,Pe<0?(je=!0,Pe=0):(Me===-1&&Pe<=Q||Me===1&&Pe>=Q)&&(je=!0,Pe=Q),Re(ie,Pe),O(),je}function Ve(Q,ie){for(const we in Q)if(Q[we]!==ie[we])return!1;return!0}function ze(){let Q=null,ie={matchedLen:0,queryDiff:9999,hrefLen:0};const we=F.filter(Me=>Me.routeData!==void 0&&Me.routeData.hasRouterLink.value===!0),{hash:Re,query:je}=i.$route,Pe=Object.keys(je).length;for(const Me of we){const tt=Me.routeData.exact.value===!0;if(Me.routeData[tt===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:pt,query:St,matched:en,href:bn}=Me.routeData.resolvedLink.value,Ln=Object.keys(St).length;if(tt===!0){if(pt!==Re||Ln!==Pe||Ve(je,St)===!1)continue;Q=Me.name.value;break}if(pt!==""&&pt!==Re||Ln!==0&&Ve(St,je)===!1)continue;const yt={matchedLen:en.length,queryDiff:Pe-Ln,hrefLen:bn.length-pt.length};if(yt.matchedLen>ie.matchedLen){Q=Me.name.value,ie=yt;continue}else if(yt.matchedLen!==ie.matchedLen)continue;if(yt.queryDiff<ie.queryDiff)Q=Me.name.value,ie=yt;else if(yt.queryDiff!==ie.queryDiff)continue;yt.hrefLen>ie.hrefLen&&(Q=Me.name.value,ie=yt)}Q===null&&F.some(Me=>Me.routeData===void 0&&Me.name.value===E.value)===!0||x({name:Q,setCurrent:!0})}function ft(Q){if(h(),pe.value!==!0&&_.value!==null&&Q.target&&typeof Q.target.closest=="function"){const ie=Q.target.closest(".q-tab");ie&&_.value.contains(ie)===!0&&(pe.value=!0,N.value===!0&&P(ie))}}function Le(){l(()=>{pe.value=!1},30)}function Be(){Zt.avoidRouteWatcher===!1?g(ze):w()}function qe(){if(c===void 0){const Q=rt(()=>i.$route.fullPath,Be);c=()=>{Q(),c=void 0}}}function Wt(Q){F.push(Q),X.value++,T(),Q.routeData===void 0||i.$route===void 0?g(()=>{if(N.value===!0){const ie=E.value,we=ie!=null&&ie!==""?F.find(Re=>Re.name.value===ie):null;we&&P(we.rootRef.value)}}):(qe(),Q.routeData.hasRouterLink.value===!0&&Be())}function wn(Q){F.splice(F.indexOf(Q),1),X.value--,T(),c!==void 0&&Q.routeData!==void 0&&(F.every(ie=>ie.routeData===void 0)===!0&&c(),Be())}const Zt={currentModel:E,tabProps:v,hasFocus:pe,hasActiveTab:p,registerTab:Wt,unregisterTab:wn,verifyRouteModel:Be,updateModel:x,onKbdNavigate:le,avoidRouteWatcher:!1};Lr(Ur,Zt);function _n(){se!==null&&clearTimeout(se),ee(),c!==void 0&&c()}let Jt;return En(_n),_o(()=>{Jt=c!==void 0,_n()}),bo(()=>{Jt===!0&&qe(),T()}),()=>Y("div",{ref:_,class:y.value,role:"tablist",onFocusin:ft,onFocusout:Le},[Y(As,{onResize:R}),Y("div",{ref:C,class:b.value,onScroll:O},ti(t.default)),Y(me,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(U.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||o.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:ge,onTouchstartPassive:ge,onMouseupPassive:ee,onMouseleavePassive:ee,onTouchendPassive:ee}),Y(me,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(K.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||o.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:ue,onTouchstartPassive:ue,onMouseupPassive:ee,onMouseleavePassive:ee,onTouchendPassive:ee})])}}),Ji=Ct({name:"QTabPanel",props:Fs,setup(e,{slots:t}){return()=>Y("div",{class:"q-tab-panel",role:"tabpanel"},ti(t.default))}}),Al=Ct({name:"QTabPanels",props:{...zs,...Ni},emits:js,setup(e,{slots:t}){const n=Vt(),i=Oi(e,n.proxy.$q),{updatePanelsList:o,getPanelContent:r,panelDirectives:a}=Ws(),s=H(()=>"q-tab-panels q-panel-parent"+(i.value===!0?" q-tab-panels--dark q-dark":""));return()=>(o(t),Br("div",{class:s.value},r(),"pan",e.swipeable,()=>a.value))}});function Mo(e,t=20,n=5){if(e.length>t+n)return e.substring(0,t)+"..."+e.substring(e.length-n,e.length)}const Il=Oe({name:"ToggleUnit",mixins:[windowMixin],props:{balanceView:{type:Boolean,required:!1},color:{type:String,default:"primary"}},data:function(){return{chosenMint:null}},mounted(){},watch:{},computed:{...de(De,["activeUnit","activeUnitLabel"]),activeUnitLabelAdopted:function(){return this.balanceView?this.activeUnitLabel==="SAT"?"BTC":this.activeUnitLabel:this.activeUnitLabel}},methods:{...ce(De,["toggleUnit"])}});function Rl(e,t,n,i,o,r){return M(),W(L,{rounded:"",outline:"",color:e.color,onClick:t[0]||(t[0]=a=>e.toggleUnit()),label:e.activeUnitLabelAdopted},null,8,["color","label"])}var So=Ee(Il,[["render",Rl]]);const Ul=Oe({name:"AnimatedNumber",props:{value:{type:Number,required:!0},duration:{type:Number,default:1e3},format:{type:Function,required:!0}},setup(e){const t=ye(e.value),n=ye(!1);return rt(()=>e.value,(o,r)=>{if(!n.value){t.value=o,o>0&&(n.value=!0);return}const a=performance.now(),s=r!==void 0?r:o,l=o,h=g=>{const w=g-a,_=Math.max(Math.min(w/e.duration,1),0),C=s+(l-s)*_;t.value=C,_<1&&requestAnimationFrame(h)};requestAnimationFrame(h)},{immediate:!0}),{formattedValue:H(()=>e.format(t.value))}}});function Nl(e,t,n,i,o,r){return M(),V("span",{onClick:t[0]||(t[0]=a=>e.$emit("click"))},ae(e.formattedValue),1)}var Ol=Ee(Ul,[["render",Nl]]);const Ll=Oe({name:"BalanceView",mixins:[windowMixin],components:{ToggleUnit:So,AnimatedNumber:Ol},props:{setTab:Function},computed:{...de(De,["activeMintUrl","activeProofs","activeBalance","mints","totalUnitBalance","activeUnit","activeMint"]),...de(Gt,["historyTokens"]),...de($e,["globalMutexLock"]),...de(Xn,["bitcoinPrice"]),...ve(De,["activeUnit"]),...ve($e,["hideBalance","lastBalanceCached"]),pendingBalance:function(){return-this.historyTokens.filter(e=>e.status=="pending").filter(e=>e.unit==this.activeUnit).reduce((e,t)=>e+=t.amount,0)},balancesOptions:function(){const e=this.activeMint();return Object.entries(e.allBalances).map(([t,n])=>({label:t,value:t}))},allMintKeysets:function(){return[].concat(...this.mints.map(e=>e.keysets))},getTotalBalance:function(){return this.totalUnitBalance},getActiveBalance:function(){return this.activeBalance},activeMintLabel:function(){const e=this.activeMint();return e.mint.nickname||e.mint.info?.name||Lt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.flat().reduce((t,n)=>t+=n.amount,0);return e}},data(){return{priceLabel:null}},mounted(){this.fetchBitcoinPriceUSD()},methods:{...ce(Xe,["checkPendingTokens"]),...ce(Xn,["fetchBitcoinPriceUSD"]),toggleUnit:function(){const e=this.activeMint().units;return this.activeUnit=e[(e.indexOf(this.activeUnit)+1)%e.length],this.activeUnit},toggleHideBalance(){this.hideBalance=!this.hideBalance}}}),Bl={class:"q-pt-xl q-pb-md"},Vl={class:"row justify-center q-pb-lg",style:{height:"80px"}},Fl={key:0},zl={key:1},jl={class:"row"},Wl={class:"col-12"},Hl={key:0},Kl={key:0},Ql={key:1},Xl={key:0,class:"row q-mt-md q-mb-none text-secondary"},Gl={class:"col-12"},Yl={key:1,class:"row q-mt-md q-mb-none text-secondary"},Zl={class:"col-12 cursor-pointer"},Jl={key:2,class:"row q-mb-none text-secondary"},eu={class:"col-12"},tu={class:"q-my-none q-py-none text-weight-regular"},nu={key:0,class:"row q-mt-xs q-mb-none"},iu={class:"col-12"};function ou(e,t,n,i,o,r){const a=J("ToggleUnit"),s=J("AnimatedNumber");return M(),V(at,null,[f("div",Bl,[f("div",Vl,[e.globalMutexLock?(M(),V("div",Fl,[u(Je,{appear:"","enter-active-class":"animated pulse","leave-active-class":"animated fadeOut"},{default:m(()=>[u(Rt,{class:"q-mt-lg q-mb-none",size:"lg",color:"primary"})]),_:1})])):(M(),V("div",zl,[u(Je,{appear:"","enter-active-class":"animated pulse","leave-active-class":"animated fadeOut"},{default:m(()=>[u(a,{class:"q-mt-lg q-mb-none",balanceView:!0})]),_:1})]))]),u(Je,{appear:"","enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeInDown",mode:"out-in"},{default:m(()=>[u(Hs,{modelValue:this.activeUnit,"onUpdate:modelValue":t[1]||(t[1]=l=>this.activeUnit=l),"transition-prev":"jump-up","transition-next":"jump-up",swipeable:"",animated:"",height:e.$q.screen.width<390?"130px":"80px","control-color":"primary",class:"bg-transparent rounded-borders q-mb-xl q-mt-xl text-primary"},{default:m(()=>[(M(!0),V(at,null,Ot(e.balancesOptions,l=>(M(),W(Ks,{key:l.value,name:l.value,class:"q-pt-none"},{default:m(()=>[f("div",jl,[f("div",Wl,[f("h3",{class:"q-my-none q-py-none cursor-pointer",onClick:t[0]||(t[0]=(...h)=>e.toggleHideBalance&&e.toggleHideBalance(...h))},[f("strong",null,[u(s,{value:e.getTotalBalance,format:h=>e.formatCurrency(h,e.activeUnit),class:"q-my-none q-py-none cursor-pointer"},null,8,["value","format"])])]),e.bitcoinPrice?(M(),V("div",Hl,[this.activeUnit=="sat"?(M(),V("strong",Kl,[u(s,{value:e.bitcoinPrice/1e8*e.getTotalBalance,format:h=>e.formatCurrency(h,"USD")},null,8,["value","format"])])):z("",!0),this.activeUnit=="usd"||this.activeUnit=="eur"?(M(),V("strong",Ql,[u(s,{value:e.getTotalBalance/100/e.bitcoinPrice*1e8,format:h=>e.formatCurrency(h,"sat")},null,8,["value","format"])])):z("",!0),u(Ze,null,{default:m(()=>[I(ae(e.formatCurrency(e.bitcoinPrice,"USD").slice(1))+" USD/BTC",1)]),_:1})])):z("",!0)])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","height"])]),_:1}),e.activeMint().mint.errored?(M(),V("div",Xl,[f("div",Gl,[u($t,{outline:"",color:"red",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:m(()=>[I(" Mint error "),u(me,{name:"error",class:"q-ml-xs"})]),_:1})])])):z("",!0),e.activeMintUrl?(M(),V("div",Yl,[f("div",Zl,[f("span",{class:"text-weight-light",onClick:t[2]||(t[2]=l=>e.setTab("mints"))},[I(" Mint: "),f("b",null,ae(e.activeMintLabel),1)])])])):z("",!0),e.mints.length>1?(M(),V("div",Jl,[f("div",eu,[f("span",tu,[I(" Balance: "),f("b",null,[u(s,{value:e.getActiveBalance,format:l=>e.formatCurrency(l,e.activeUnit),class:"q-my-none q-py-none cursor-pointer"},null,8,["value","format"])])])])])):z("",!0)]),e.pendingBalance>0?(M(),V("div",nu,[f("div",iu,[u(L,{name:"history",size:"sm",align:"between",color:"secondary",dense:"",outline:"",class:"q-mx-none q-mt-xs q-pr-sm cursor-pointer",onClick:t[3]||(t[3]=l=>e.checkPendingTokens())},{default:m(()=>[u(me,{name:"history",size:"1rem",class:"q-mx-xs"}),I(" Pending: "+ae(e.formatCurrency(e.pendingBalance,this.activeUnit))+" ",1),u(Ze,null,{default:m(()=>[I("Check all pending tokens")]),_:1})]),_:1})])])):z("",!0)],64)}var ru=Ee(Ll,[["render",ou],["__scopeId","data-v-3ea3437b"]]);const au=1.7778;var Zr=Ct({name:"QImg",props:{...Gs,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},loadingShowDelay:{type:[Number,String],default:0},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:au},placeholderSrc:String,errorSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:t,emit:n}){const i=ye(e.initialRatio),o=Ys(e,i),r=Vt(),{registerTimeout:a,removeTimeout:s}=Qn(),{registerTimeout:l,removeTimeout:h}=Qn(),g=H(()=>e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null),w=H(()=>e.errorSrc!==void 0?{src:e.errorSrc,__qerror:!0}:null),_=[ye(null),ye(g.value)],C=ye(0),E=ye(!1),N=ye(!1),U=H(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),K=H(()=>({width:e.width,height:e.height})),A=H(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition q-img__image--`),F=H(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));function X(){if(h(),e.loadingShowDelay===0){E.value=!0;return}l(()=>{E.value=!0},e.loadingShowDelay)}function pe(){h(),E.value=!1}function se({target:y}){_i(r)===!1&&(s(),i.value=y.naturalHeight===0?.5:y.naturalWidth/y.naturalHeight,j(y,1))}function j(y,b){b===1e3||_i(r)===!0||(y.complete===!0?c(y):a(()=>{j(y,b+1)},50))}function c(y){_i(r)!==!0&&(C.value=C.value^1,_[C.value].value=null,pe(),y.getAttribute("__qerror")!=="true"&&(N.value=!1),n("load",y.currentSrc||y.src))}function v(y){s(),pe(),N.value=!0,_[C.value].value=w.value,_[C.value^1].value=g.value,n("error",y)}function p(y){const b=_[y].value,q={key:"img_"+y,class:A.value,style:F.value,alt:e.alt,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...b};return C.value===y?Object.assign(q,{class:q.class+"current",onLoad:se,onError:v}):q.class+="loaded",Y("div",{class:"q-img__container absolute-full",key:"img"+y},Y("img",q))}function $(){return E.value===!1?Y("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},ti(t[N.value===!0?"error":"default"])):Y("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},t.loading!==void 0?t.loading():e.noSpinner===!0?void 0:[Y(Ui,{color:e.spinnerColor,size:e.spinnerSize})])}{let y=function(){rt(()=>e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null,b=>{s(),N.value=!1,b===null?(pe(),_[C.value^1].value=g.value):X(),_[C.value].value=b},{immediate:!0})};us.value===!0?Ri(y):y()}return()=>{const y=[];return o.value!==null&&y.push(Y("div",{key:"filler",style:o.value})),_[0].value!==null&&y.push(p(0)),_[1].value!==null&&y.push(p(1)),y.push(Y(Je,{name:"q-transition--fade"},$)),Y("div",{key:"main",class:U.value,style:K.value,role:"img","aria-label":e.alt},y)}}}),su=Ct({name:"QField",inheritAttrs:!1,props:{...Do,tag:{type:String,default:"label"}},emits:Xr,setup(){return Gr(Yr({tagProp:!0}))}});const lu={xs:8,sm:10,md:14,lg:20,xl:24};var cn=Ct({name:"QChip",props:{...Ni,...cs,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:t,emit:n}){const{proxy:{$q:i}}=Vt(),o=Oi(e,i),r=ds(e,lu),a=H(()=>e.selected===!0||e.icon!==void 0),s=H(()=>e.selected===!0?e.iconSelected||i.iconSet.chip.selected:e.icon),l=H(()=>e.iconRemove||i.iconSet.chip.remove),h=H(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),g=H(()=>{const U=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(U?` text-${U} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(h.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(o.value===!0?" q-chip--dark q-dark":"")}),w=H(()=>{const U=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},K={...U,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||i.lang.label.remove};return{chip:U,remove:K}});function _(U){U.keyCode===13&&C(U)}function C(U){e.disable||(n("update:selected",!e.selected),n("click",U))}function E(U){(U.keyCode===void 0||U.keyCode===13)&&(Dt(U),e.disable===!1&&(n("update:modelValue",!1),n("remove")))}function N(){const U=[];h.value===!0&&U.push(Y("div",{class:"q-focus-helper"})),a.value===!0&&U.push(Y(me,{class:"q-chip__icon q-chip__icon--left",name:s.value}));const K=e.label!==void 0?[Y("div",{class:"ellipsis"},[e.label])]:void 0;return U.push(Y("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},fs(t.default,K))),e.iconRight&&U.push(Y(me,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&U.push(Y(me,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:l.value,...w.value.remove,onClick:E,onKeyup:E})),U}return()=>{if(e.modelValue===!1)return;const U={class:g.value,style:r.value};return h.value===!0&&Object.assign(U,w.value.chip,{onClick:C,onKeyup:_}),Br("div",U,N(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[yo,e.ripple]])}}}),uu=Ct({name:"QMenu",inheritAttrs:!1,props:{...Zs,...Ls,...Ni,...Is,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:ar},self:{type:String,validator:ar},offset:{type:Array,validator:Js},scrollTarget:yl,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Bs,"click","escapeKey"],setup(e,{slots:t,emit:n,attrs:i}){let o=null,r,a,s;const l=Vt(),{proxy:h}=l,{$q:g}=h,w=ye(null),_=ye(!1),C=H(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),E=Oi(e,g),{registerTick:N,removeTick:U}=bi(),{registerTimeout:K}=Qn(),{transitionProps:A,transitionStyle:F}=Rs(e),{localScrollTarget:X,changeScrollEvent:pe,unconfigureScrollTarget:se}=el(e,re),{anchorEl:j,canShow:c}=tl({showing:_}),{hide:v}=Vs({showing:_,canShow:c,handleShow:oe,handleHide:P,hideOnRouteChange:C,processOnMount:!0}),{showPortal:p,hidePortal:$,renderPortal:y}=Us(l,w,xe,"menu"),b={anchorEl:j,innerRef:w,onClickOutside(G){if(e.persistent!==!0&&_.value===!0)return v(G),(G.type==="touchstart"||G.target.classList.contains("q-dialog__backdrop"))&&Dt(G),!0}},q=H(()=>lr(e.anchor||(e.cover===!0?"center middle":"bottom start"),g.lang.rtl)),D=H(()=>e.cover===!0?q.value:lr(e.self||"top start",g.lang.rtl)),S=H(()=>(e.square===!0?" q-menu--square":"")+(E.value===!0?" q-menu--dark q-dark":"")),x=H(()=>e.autoClose===!0?{onClick:ge}:{}),T=H(()=>_.value===!0&&e.persistent!==!0);rt(T,G=>{G===!0?(Os(ee),il(b)):(rr(ee),sr(b))});function R(){zr(()=>{let G=w.value;G&&G.contains(document.activeElement)!==!0&&(G=G.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||G.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||G.querySelector("[autofocus], [data-autofocus]")||G,G.focus({preventScroll:!0}))})}function oe(G){if(o=e.noRefocus===!1?document.activeElement:null,_l(ue),p(),re(),r=void 0,G!==void 0&&(e.touchPosition||e.contextMenu)){const Ve=hs(G);if(Ve.left!==void 0){const{top:ze,left:ft}=j.value.getBoundingClientRect();r={left:Ve.left-ft,top:Ve.top-ze}}}a===void 0&&(a=rt(()=>g.screen.width+"|"+g.screen.height+"|"+e.self+"|"+e.anchor+"|"+g.lang.rtl,le)),e.noFocus!==!0&&document.activeElement.blur(),N(()=>{le(),e.noFocus!==!0&&R()}),K(()=>{g.platform.is.ios===!0&&(s=e.autoClose,w.value.click()),le(),p(!0),n("show",G)},e.transitionDuration)}function P(G){U(),$(),O(!0),o!==null&&(G===void 0||G.qClickOutside!==!0)&&(((G&&G.type.indexOf("key")===0?o.closest('[tabindex]:not([tabindex^="-"])'):void 0)||o).focus(),o=null),K(()=>{$(!0),n("hide",G)},e.transitionDuration)}function O(G){r=void 0,a!==void 0&&(a(),a=void 0),(G===!0||_.value===!0)&&(bl(ue),se(),sr(b),rr(ee)),G!==!0&&(o=null)}function re(){(j.value!==null||e.scrollTarget!==void 0)&&(X.value=wl(j.value,e.scrollTarget),pe(X.value,le))}function ge(G){s!==!0?(Ns(h,G),n("click",G)):s=!1}function ue(G){T.value===!0&&e.noFocus!==!0&&ms(w.value,G.target)!==!0&&R()}function ee(G){n("escapeKey"),v(G)}function le(){nl({targetEl:w.value,offset:e.offset,anchorEl:j.value,anchorOrigin:q.value,selfOrigin:D.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function xe(){return Y(Je,A.value,()=>_.value===!0?Y("div",{role:"menu",...i,ref:w,tabindex:-1,class:["q-menu q-position-engine scroll"+S.value,i.class],style:[i.style,F.value],...x.value},ti(t.default)):null)}return En(O),Object.assign(h,{focus:R,updatePosition:le}),y}});const Pt=1e3,cu=["start","center","end","start-force","center-force","end-force"],Jr=Array.prototype.filter,du=window.getComputedStyle(document.body).overflowAnchor===void 0?gs:function(e,t){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const n=e.children||[];Jr.call(n,o=>o.dataset&&o.dataset.qVsAnchor!==void 0).forEach(o=>{delete o.dataset.qVsAnchor});const i=n[t];i&&i.dataset&&(i.dataset.qVsAnchor="")}))};function Pn(e,t){return e+t}function eo(e,t,n,i,o,r,a,s){const l=e===window?document.scrollingElement||document.documentElement:e,h=o===!0?"offsetWidth":"offsetHeight",g={scrollStart:0,scrollViewSize:-a-s,scrollMaxSize:0,offsetStart:-a,offsetEnd:-s};if(o===!0?(e===window?(g.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,g.scrollViewSize+=document.documentElement.clientWidth):(g.scrollStart=l.scrollLeft,g.scrollViewSize+=l.clientWidth),g.scrollMaxSize=l.scrollWidth,r===!0&&(g.scrollStart=(Yn===!0?g.scrollMaxSize-g.scrollViewSize:0)-g.scrollStart)):(e===window?(g.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,g.scrollViewSize+=document.documentElement.clientHeight):(g.scrollStart=l.scrollTop,g.scrollViewSize+=l.clientHeight),g.scrollMaxSize=l.scrollHeight),n!==null)for(let w=n.previousElementSibling;w!==null;w=w.previousElementSibling)w.classList.contains("q-virtual-scroll--skip")===!1&&(g.offsetStart+=w[h]);if(i!==null)for(let w=i.nextElementSibling;w!==null;w=w.nextElementSibling)w.classList.contains("q-virtual-scroll--skip")===!1&&(g.offsetEnd+=w[h]);if(t!==e){const w=l.getBoundingClientRect(),_=t.getBoundingClientRect();o===!0?(g.offsetStart+=_.left-w.left,g.offsetEnd-=_.width):(g.offsetStart+=_.top-w.top,g.offsetEnd-=_.height),e!==window&&(g.offsetStart+=g.scrollStart),g.offsetEnd+=g.scrollMaxSize-g.offsetStart}return g}function mr(e,t,n,i){t==="end"&&(t=(e===window?document.body:e)[n===!0?"scrollWidth":"scrollHeight"]),e===window?n===!0?(i===!0&&(t=(Yn===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-t),window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t):n===!0?(i===!0&&(t=(Yn===!0?e.scrollWidth-e.offsetWidth:0)-t),e.scrollLeft=t):e.scrollTop=t}function Vn(e,t,n,i){if(n>=i)return 0;const o=t.length,r=Math.floor(n/Pt),a=Math.floor((i-1)/Pt)+1;let s=e.slice(r,a).reduce(Pn,0);return n%Pt!==0&&(s-=t.slice(r*Pt,n).reduce(Pn,0)),i%Pt!==0&&i!==o&&(s-=t.slice(i,a*Pt).reduce(Pn,0)),s}const fu={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},gr={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...fu};function hu({virtualScrollLength:e,getVirtualScrollTarget:t,getVirtualScrollEl:n,virtualScrollItemSizeComputed:i}){const o=Vt(),{props:r,emit:a,proxy:s}=o,{$q:l}=s;let h,g,w,_=[],C;const E=ye(0),N=ye(0),U=ye({}),K=ye(null),A=ye(null),F=ye(null),X=ye({from:0,to:0}),pe=H(()=>r.tableColspan!==void 0?r.tableColspan:100);i===void 0&&(i=H(()=>r.virtualScrollItemSize));const se=H(()=>i.value+";"+r.virtualScrollHorizontal),j=H(()=>se.value+";"+r.virtualScrollSliceRatioBefore+";"+r.virtualScrollSliceRatioAfter);rt(j,()=>{S()}),rt(se,c);function c(){D(g,!0)}function v(P){D(P===void 0?g:P)}function p(P,O){const re=t();if(re==null||re.nodeType===8)return;const ge=eo(re,n(),K.value,A.value,r.virtualScrollHorizontal,l.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd);w!==ge.scrollViewSize&&S(ge.scrollViewSize),y(re,ge,Math.min(e.value-1,Math.max(0,parseInt(P,10)||0)),0,cu.indexOf(O)!==-1?O:g!==-1&&P>g?"end":"start")}function $(){const P=t();if(P==null||P.nodeType===8)return;const O=eo(P,n(),K.value,A.value,r.virtualScrollHorizontal,l.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd),re=e.value-1,ge=O.scrollMaxSize-O.offsetStart-O.offsetEnd-N.value;if(h===O.scrollStart)return;if(O.scrollMaxSize<=0){y(P,O,0,0);return}w!==O.scrollViewSize&&S(O.scrollViewSize),b(X.value.from);const ue=Math.floor(O.scrollMaxSize-Math.max(O.scrollViewSize,O.offsetEnd)-Math.min(C[re],O.scrollViewSize/2));if(ue>0&&Math.ceil(O.scrollStart)>=ue){y(P,O,re,O.scrollMaxSize-O.offsetEnd-_.reduce(Pn,0));return}let ee=0,le=O.scrollStart-O.offsetStart,xe=le;if(le<=ge&&le+O.scrollViewSize>=E.value)le-=E.value,ee=X.value.from,xe=le;else for(let G=0;le>=_[G]&&ee<re;G++)le-=_[G],ee+=Pt;for(;le>0&&ee<re;)le-=C[ee],le>-O.scrollViewSize?(ee++,xe=le):xe=C[ee]+le;y(P,O,ee,xe)}function y(P,O,re,ge,ue){const ee=typeof ue=="string"&&ue.indexOf("-force")!==-1,le=ee===!0?ue.replace("-force",""):ue,xe=le!==void 0?le:"start";let G=Math.max(0,re-U.value[xe]),Ve=G+U.value.total;Ve>e.value&&(Ve=e.value,G=Math.max(0,Ve-U.value.total)),h=O.scrollStart;const ze=G!==X.value.from||Ve!==X.value.to;if(ze===!1&&le===void 0){T(re);return}const{activeElement:ft}=document,Le=F.value;ze===!0&&Le!==null&&Le!==ft&&Le.contains(ft)===!0&&(Le.addEventListener("focusout",q),setTimeout(()=>{Le!==null&&Le.removeEventListener("focusout",q)})),du(Le,re-G);const Be=le!==void 0?C.slice(G,re).reduce(Pn,0):0;if(ze===!0){const qe=Ve>=X.value.from&&G<=X.value.to?X.value.to:Ve;X.value={from:G,to:qe},E.value=Vn(_,C,0,G),N.value=Vn(_,C,Ve,e.value),requestAnimationFrame(()=>{X.value.to!==Ve&&h===O.scrollStart&&(X.value={from:X.value.from,to:Ve},N.value=Vn(_,C,Ve,e.value))})}requestAnimationFrame(()=>{if(h!==O.scrollStart)return;ze===!0&&b(G);const qe=C.slice(G,re).reduce(Pn,0),Wt=qe+O.offsetStart+E.value,wn=Wt+C[re];let Zt=Wt+ge;if(le!==void 0){const _n=qe-Be,Jt=O.scrollStart+_n;Zt=ee!==!0&&Jt<Wt&&wn<Jt+O.scrollViewSize?Jt:le==="end"?wn-O.scrollViewSize:Wt-(le==="start"?0:Math.round((O.scrollViewSize-C[re])/2))}h=Zt,mr(P,Zt,r.virtualScrollHorizontal,l.lang.rtl),T(re)})}function b(P){const O=F.value;if(O){const re=Jr.call(O.children,G=>G.classList&&G.classList.contains("q-virtual-scroll--skip")===!1),ge=re.length,ue=r.virtualScrollHorizontal===!0?G=>G.getBoundingClientRect().width:G=>G.offsetHeight;let ee=P,le,xe;for(let G=0;G<ge;){for(le=ue(re[G]),G++;G<ge&&re[G].classList.contains("q-virtual-scroll--with-prev")===!0;)le+=ue(re[G]),G++;xe=le-C[ee],xe!==0&&(C[ee]+=xe,_[Math.floor(ee/Pt)]+=xe),ee++}}}function q(){F.value!==null&&F.value!==void 0&&F.value.focus()}function D(P,O){const re=1*i.value;(O===!0||Array.isArray(C)===!1)&&(C=[]);const ge=C.length;C.length=e.value;for(let ee=e.value-1;ee>=ge;ee--)C[ee]=re;const ue=Math.floor((e.value-1)/Pt);_=[];for(let ee=0;ee<=ue;ee++){let le=0;const xe=Math.min((ee+1)*Pt,e.value);for(let G=ee*Pt;G<xe;G++)le+=C[G];_.push(le)}g=-1,h=void 0,E.value=Vn(_,C,0,X.value.from),N.value=Vn(_,C,X.value.to,e.value),P>=0?(b(X.value.from),Qt(()=>{p(P)})):R()}function S(P){if(P===void 0&&typeof window<"u"){const le=t();le!=null&&le.nodeType!==8&&(P=eo(le,n(),K.value,A.value,r.virtualScrollHorizontal,l.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd).scrollViewSize)}w=P;const O=parseFloat(r.virtualScrollSliceRatioBefore)||0,re=parseFloat(r.virtualScrollSliceRatioAfter)||0,ge=1+O+re,ue=P===void 0||P<=0?1:Math.ceil(P/i.value),ee=Math.max(1,ue,Math.ceil((r.virtualScrollSliceSize>0?r.virtualScrollSliceSize:10)/ge));U.value={total:Math.ceil(ee*ge),start:Math.ceil(ee*O),center:Math.ceil(ee*(.5+O)),end:Math.ceil(ee*(1+O)),view:ue}}function x(P,O){const re=r.virtualScrollHorizontal===!0?"width":"height",ge={["--q-virtual-scroll-item-"+re]:i.value+"px"};return[P==="tbody"?Y(P,{class:"q-virtual-scroll__padding",key:"before",ref:K},[Y("tr",[Y("td",{style:{[re]:`${E.value}px`,...ge},colspan:pe.value})])]):Y(P,{class:"q-virtual-scroll__padding",key:"before",ref:K,style:{[re]:`${E.value}px`,...ge}}),Y(P,{class:"q-virtual-scroll__content",key:"content",ref:F,tabindex:-1},O.flat()),P==="tbody"?Y(P,{class:"q-virtual-scroll__padding",key:"after",ref:A},[Y("tr",[Y("td",{style:{[re]:`${N.value}px`,...ge},colspan:pe.value})])]):Y(P,{class:"q-virtual-scroll__padding",key:"after",ref:A,style:{[re]:`${N.value}px`,...ge}})]}function T(P){g!==P&&(r.onVirtualScroll!==void 0&&a("virtualScroll",{index:P,from:X.value.from,to:X.value.to-1,direction:P<g?"decrease":"increase",ref:s}),g=P)}S();const R=vs($,l.platform.is.ios===!0?120:35);ps(()=>{S()});let oe=!1;return _o(()=>{oe=!0}),bo(()=>{if(oe!==!0)return;const P=t();h!==void 0&&P!==void 0&&P!==null&&P.nodeType!==8?mr(P,h,r.virtualScrollHorizontal,l.lang.rtl):p(g)}),En(()=>{R.cancel()}),Object.assign(s,{scrollTo:p,reset:c,refresh:v}),{virtualScrollSliceRange:X,virtualScrollSliceSizeComputed:U,setVirtualScrollSize:S,onVirtualScrollEvt:R,localResetVirtualScroll:D,padVirtualScroll:x,scrollTo:p,reset:c,refresh:v}}const vr=e=>["add","add-unique","toggle"].includes(e),mu=".*+?^${}()|[]\\",gu=Object.keys(Do);var fo=Ct({name:"QSelect",inheritAttrs:!1,props:{...gr,...xs,...Do,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:vr},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:gr.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...Xr,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:t,emit:n}){const{proxy:i}=Vt(),{$q:o}=i,r=ye(!1),a=ye(!1),s=ye(-1),l=ye(""),h=ye(!1),g=ye(!1);let w=null,_=null,C,E,N,U=null,K,A,F,X;const pe=ye(null),se=ye(null),j=ye(null),c=ye(null),v=ye(null),p=Es(e),$=pl(Jo),y=H(()=>Array.isArray(e.options)?e.options.length:0),b=H(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:q,virtualScrollSliceSizeComputed:D,localResetVirtualScroll:S,padVirtualScroll:x,onVirtualScrollEvt:T,scrollTo:R,setVirtualScrollSize:oe}=hu({virtualScrollLength:y,getVirtualScrollTarget:Xa,getVirtualScrollEl:Yo,virtualScrollItemSizeComputed:b}),P=Yr(),O=H(()=>{const k=e.mapOptions===!0&&e.multiple!==!0,ne=e.modelValue!==void 0&&(e.modelValue!==null||k===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const te=e.mapOptions===!0&&C!==void 0?C:[],_e=ne.map(Ue=>Ln(Ue,te));return e.modelValue===null&&k===!0?_e.filter(Ue=>Ue!==null):_e}return ne}),re=H(()=>{const k={};return gu.forEach(ne=>{const te=e[ne];te!==void 0&&(k[ne]=te)}),k}),ge=H(()=>e.optionsDark===null?P.isDark.value:e.optionsDark),ue=H(()=>hr(O.value)),ee=H(()=>{let k="q-field__input q-placeholder col";return e.hideSelected===!0||O.value.length===0?[k,e.inputClass]:(k+=" q-field__input--padding",e.inputClass===void 0?k:[k,e.inputClass])}),le=H(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),xe=H(()=>y.value===0),G=H(()=>O.value.map(k=>ie.value(k)).join(", ")),Ve=H(()=>e.displayValue!==void 0?e.displayValue:G.value),ze=H(()=>e.optionsHtml===!0?()=>!0:k=>k!=null&&k.html===!0),ft=H(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||O.value.some(ze.value))),Le=H(()=>P.focused.value===!0?e.tabindex:-1),Be=H(()=>{const k={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":r.value===!0?"true":"false","aria-controls":`${P.targetUid.value}_lb`};return s.value>=0&&(k["aria-activedescendant"]=`${P.targetUid.value}_${s.value}`),k}),qe=H(()=>({id:`${P.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),Wt=H(()=>O.value.map((k,ne)=>({index:ne,opt:k,html:ze.value(k),selected:!0,removeAtIndex:tt,toggleOption:St,tabindex:Le.value}))),wn=H(()=>{if(y.value===0)return[];const{from:k,to:ne}=q.value;return e.options.slice(k,ne).map((te,_e)=>{const Ue=we.value(te)===!0,Ae=Hi(te)===!0,nt=k+_e,Ke={clickable:!0,active:Ae,activeClass:Jt.value,manualFocus:!0,focused:!1,disable:Ue,tabindex:-1,dense:e.optionsDense,dark:ge.value,role:"option","aria-selected":Ae===!0?"true":"false",id:`${P.targetUid.value}_${nt}`,onClick:()=>{St(te)}};return Ue!==!0&&(s.value===nt&&(Ke.focused=!0),o.platform.is.desktop===!0&&(Ke.onMousemove=()=>{r.value===!0&&en(nt)})),{index:nt,opt:te,html:ze.value(te),label:ie.value(te),selected:Ke.active,focused:Ke.focused,toggleOption:St,setOptionIndex:en,itemProps:Ke}})}),Zt=H(()=>e.dropdownIcon!==void 0?e.dropdownIcon:o.iconSet.arrow.dropdown),_n=H(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Jt=H(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),Q=H(()=>yt(e.optionValue,"value")),ie=H(()=>yt(e.optionLabel,"label")),we=H(()=>yt(e.optionDisable,"disable")),Re=H(()=>O.value.map(k=>Q.value(k))),je=H(()=>{const k={onInput:Jo,onChange:$,onKeydown:Go,onKeyup:Qo,onKeypress:Xo,onFocus:Ho,onClick(ne){E===!0&&Sn(ne)}};return k.onCompositionstart=k.onCompositionupdate=k.onCompositionend=$,k});rt(O,k=>{C=k,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&P.innerLoading.value!==!0&&(a.value!==!0&&r.value!==!0||ue.value!==!0)&&(N!==!0&&Mn(),(a.value===!0||r.value===!0)&&kn(""))},{immediate:!0}),rt(()=>e.fillInput,Mn),rt(r,Ki),rt(y,ss);function Pe(k){return e.emitValue===!0?Q.value(k):k}function Me(k){if(k!==-1&&k<O.value.length)if(e.multiple===!0){const ne=e.modelValue.slice();n("remove",{index:k,value:ne.splice(k,1)[0]}),n("update:modelValue",ne)}else n("update:modelValue",null)}function tt(k){Me(k),P.focus()}function pt(k,ne){const te=Pe(k);if(e.multiple!==!0){e.fillInput===!0&&Bn(ie.value(k),!0,!0),n("update:modelValue",te);return}if(O.value.length===0){n("add",{index:0,value:te}),n("update:modelValue",e.multiple===!0?[te]:te);return}if(ne===!0&&Hi(k)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const _e=e.modelValue.slice();n("add",{index:_e.length,value:te}),_e.push(te),n("update:modelValue",_e)}function St(k,ne){if(P.editable.value!==!0||k===void 0||we.value(k)===!0)return;const te=Q.value(k);if(e.multiple!==!0){ne!==!0&&(Bn(e.fillInput===!0?ie.value(k):"",!0,!0),sn()),se.value!==null&&se.value.focus(),(O.value.length===0||qn(Q.value(O.value[0]),te)!==!0)&&n("update:modelValue",e.emitValue===!0?te:k);return}if((E!==!0||h.value===!0)&&P.focus(),Ho(),O.value.length===0){const Ae=e.emitValue===!0?te:k;n("add",{index:0,value:Ae}),n("update:modelValue",e.multiple===!0?[Ae]:Ae);return}const _e=e.modelValue.slice(),Ue=Re.value.findIndex(Ae=>qn(Ae,te));if(Ue!==-1)n("remove",{index:Ue,value:_e.splice(Ue,1)[0]});else{if(e.maxValues!==void 0&&_e.length>=e.maxValues)return;const Ae=e.emitValue===!0?te:k;n("add",{index:_e.length,value:Ae}),_e.push(Ae)}n("update:modelValue",_e)}function en(k){if(o.platform.is.desktop!==!0)return;const ne=k!==-1&&k<y.value?k:-1;s.value!==ne&&(s.value=ne)}function bn(k=1,ne){if(r.value===!0){let te=s.value;do te=cr(te+k,-1,y.value-1);while(te!==-1&&te!==s.value&&we.value(e.options[te])===!0);s.value!==te&&(en(te),R(te),ne!==!0&&e.useInput===!0&&e.fillInput===!0&&ci(te>=0?ie.value(e.options[te]):K,!0))}}function Ln(k,ne){const te=_e=>qn(Q.value(_e),k);return e.options.find(te)||ne.find(te)||k}function yt(k,ne){const te=k!==void 0?k:ne;return typeof te=="function"?te:_e=>_e!==null&&typeof _e=="object"&&te in _e?_e[te]:_e}function Hi(k){const ne=Q.value(k);return Re.value.find(te=>qn(te,ne))!==void 0}function Ho(k){e.useInput===!0&&se.value!==null&&(k===void 0||se.value===k.target&&k.target.value===G.value)&&se.value.select()}function Ko(k){wo(k,27)===!0&&r.value===!0&&(Sn(k),sn(),Mn()),n("keyup",k)}function Qo(k){const{value:ne}=k.target;if(k.keyCode!==void 0){Ko(k);return}if(k.target.value="",w!==null&&(clearTimeout(w),w=null),_!==null&&(clearTimeout(_),_=null),Mn(),typeof ne=="string"&&ne.length!==0){const te=ne.toLocaleLowerCase(),_e=Ae=>{const nt=e.options.find(Ke=>Ae.value(Ke).toLocaleLowerCase()===te);return nt===void 0?!1:(O.value.indexOf(nt)===-1?St(nt):sn(),!0)},Ue=Ae=>{_e(Q)!==!0&&(_e(ie)===!0||Ae===!0||kn(ne,!0,()=>Ue(!0)))};Ue()}else P.clearValue(k)}function Xo(k){n("keypress",k)}function Go(k){if(n("keydown",k),Nr(k)===!0)return;const ne=l.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),te=k.shiftKey!==!0&&e.multiple!==!0&&(s.value!==-1||ne===!0);if(k.keyCode===27){Gi(k);return}if(k.keyCode===9&&te===!1){Dn();return}if(k.target===void 0||k.target.id!==P.targetUid.value||P.editable.value!==!0)return;if(k.keyCode===40&&P.innerLoading.value!==!0&&r.value===!1){Dt(k),Cn();return}if(k.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&l.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?Me(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&n("update:modelValue",null);return}(k.keyCode===35||k.keyCode===36)&&(typeof l.value!="string"||l.value.length===0)&&(Dt(k),s.value=-1,bn(k.keyCode===36?1:-1,e.multiple)),(k.keyCode===33||k.keyCode===34)&&D.value!==void 0&&(Dt(k),s.value=Math.max(-1,Math.min(y.value,s.value+(k.keyCode===33?-1:1)*D.value.view)),bn(k.keyCode===33?1:-1,e.multiple)),(k.keyCode===38||k.keyCode===40)&&(Dt(k),bn(k.keyCode===38?-1:1,e.multiple));const _e=y.value;if((F===void 0||X<Date.now())&&(F=""),_e>0&&e.useInput!==!0&&k.key!==void 0&&k.key.length===1&&k.altKey===!1&&k.ctrlKey===!1&&k.metaKey===!1&&(k.keyCode!==32||F.length!==0)){r.value!==!0&&Cn(k);const Ue=k.key.toLocaleLowerCase(),Ae=F.length===1&&F[0]===Ue;X=Date.now()+1500,Ae===!1&&(Dt(k),F+=Ue);const nt=new RegExp("^"+F.split("").map(Qi=>mu.indexOf(Qi)!==-1?"\\"+Qi:Qi).join(".*"),"i");let Ke=s.value;if(Ae===!0||Ke<0||nt.test(ie.value(e.options[Ke]))!==!0)do Ke=cr(Ke+1,-1,_e-1);while(Ke!==s.value&&(we.value(e.options[Ke])===!0||nt.test(ie.value(e.options[Ke]))!==!0));s.value!==Ke&&Qt(()=>{en(Ke),R(Ke),Ke>=0&&e.useInput===!0&&e.fillInput===!0&&ci(ie.value(e.options[Ke]),!0)});return}if(!(k.keyCode!==13&&(k.keyCode!==32||e.useInput===!0||F!=="")&&(k.keyCode!==9||te===!1))){if(k.keyCode!==9&&Dt(k),s.value!==-1&&s.value<_e){St(e.options[s.value]);return}if(ne===!0){const Ue=(Ae,nt)=>{if(nt){if(vr(nt)!==!0)return}else nt=e.newValueMode;if(Bn("",e.multiple!==!0,!0),Ae==null)return;(nt==="toggle"?St:pt)(Ae,nt==="add-unique"),e.multiple!==!0&&(se.value!==null&&se.value.focus(),sn())};if(e.onNewValue!==void 0?n("newValue",l.value,Ue):Ue(l.value),e.multiple!==!0)return}r.value===!0?Dn():P.innerLoading.value!==!0&&Cn()}}function Yo(){return E===!0?v.value:j.value!==null&&j.value.contentEl!==null?j.value.contentEl:void 0}function Xa(){return Yo()}function Ga(){return e.hideSelected===!0?[]:t["selected-item"]!==void 0?Wt.value.map(k=>t["selected-item"](k)).slice():t.selected!==void 0?[].concat(t.selected()):e.useChips===!0?Wt.value.map((k,ne)=>Y(cn,{key:"option-"+ne,removable:P.editable.value===!0&&we.value(k.opt)!==!0,dense:!0,textColor:e.color,tabindex:Le.value,onRemove(){k.removeAtIndex(ne)}},()=>Y("span",{class:"ellipsis",[k.html===!0?"innerHTML":"textContent"]:ie.value(k.opt)}))):[Y("span",{[ft.value===!0?"innerHTML":"textContent"]:Ve.value})]}function Zo(){if(xe.value===!0)return t["no-option"]!==void 0?t["no-option"]({inputValue:l.value}):void 0;const k=t.option!==void 0?t.option:te=>Y(gt,{key:te.index,...te.itemProps},()=>Y(dt,()=>Y(Ie,()=>Y("span",{[te.html===!0?"innerHTML":"textContent"]:te.label}))));let ne=x("div",wn.value.map(k));return t["before-options"]!==void 0&&(ne=t["before-options"]().concat(ne)),Or(t["after-options"],ne)}function Ya(k,ne){const te=ne===!0?{...Be.value,...P.splitAttrs.attributes.value}:void 0,_e={ref:ne===!0?se:void 0,key:"i_t",class:ee.value,style:e.inputStyle,value:l.value!==void 0?l.value:"",type:"search",...te,id:ne===!0?P.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":k===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...je.value};return k!==!0&&E===!0&&(Array.isArray(_e.class)===!0?_e.class=[..._e.class,"no-pointer-events"]:_e.class+=" no-pointer-events"),Y("input",_e)}function Jo(k){w!==null&&(clearTimeout(w),w=null),_!==null&&(clearTimeout(_),_=null),!(k&&k.target&&k.target.qComposing===!0)&&(ci(k.target.value||""),N=!0,K=l.value,P.focused.value!==!0&&(E!==!0||h.value===!0)&&P.focus(),e.onFilter!==void 0&&(w=setTimeout(()=>{w=null,kn(l.value)},e.inputDebounce)))}function ci(k,ne){l.value!==k&&(l.value=k,ne===!0||e.inputDebounce===0||e.inputDebounce==="0"?n("inputValue",k):_=setTimeout(()=>{_=null,n("inputValue",k)},e.inputDebounce))}function Bn(k,ne,te){N=te!==!0,e.useInput===!0&&(ci(k,!0),(ne===!0||te!==!0)&&(K=k),ne!==!0&&kn(k))}function kn(k,ne,te){if(e.onFilter===void 0||ne!==!0&&P.focused.value!==!0)return;P.innerLoading.value===!0?n("filterAbort"):(P.innerLoading.value=!0,g.value=!0),k!==""&&e.multiple!==!0&&O.value.length!==0&&N!==!0&&k===ie.value(O.value[0])&&(k="");const _e=setTimeout(()=>{r.value===!0&&(r.value=!1)},10);U!==null&&clearTimeout(U),U=_e,n("filter",k,(Ue,Ae)=>{(ne===!0||P.focused.value===!0)&&U===_e&&(clearTimeout(U),typeof Ue=="function"&&Ue(),g.value=!1,Qt(()=>{P.innerLoading.value=!1,P.editable.value===!0&&(ne===!0?r.value===!0&&sn():r.value===!0?Ki(!0):r.value=!0),typeof Ae=="function"&&Qt(()=>{Ae(i)}),typeof te=="function"&&Qt(()=>{te(i)})}))},()=>{P.focused.value===!0&&U===_e&&(clearTimeout(U),P.innerLoading.value=!1,g.value=!1),r.value===!0&&(r.value=!1)})}function Za(){return Y(uu,{ref:j,class:le.value,style:e.popupContentStyle,modelValue:r.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&xe.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:ge.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:_n.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...qe.value,onScrollPassive:T,onBeforeShow:tr,onBeforeHide:Ja,onShow:es},Zo)}function Ja(k){nr(k),Dn()}function es(){oe()}function ts(k){Sn(k),se.value!==null&&se.value.focus(),h.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function ns(k){Sn(k),Qt(()=>{h.value=!1})}function is(){const k=[Y(su,{class:`col-auto ${P.fieldClass.value}`,...re.value,for:P.targetUid.value,dark:ge.value,square:!0,loading:g.value,itemAligned:!1,filled:!0,stackLabel:l.value.length!==0,...P.splitAttrs.listeners.value,onFocus:ts,onBlur:ns},{...t,rawControl:()=>P.getControl(!0),before:void 0,after:void 0})];return r.value===!0&&k.push(Y("div",{ref:v,class:le.value+" scroll",style:e.popupContentStyle,...qe.value,onClick:Gi,onScrollPassive:T},Zo())),Y(ut,{ref:c,modelValue:a.value,position:e.useInput===!0?"top":void 0,transitionShow:A,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:tr,onBeforeHide:os,onHide:rs,onShow:as},()=>Y("div",{class:"q-select__dialog"+(ge.value===!0?" q-select__dialog--dark q-dark":"")+(h.value===!0?" q-select__dialog--focused":"")},k))}function os(k){nr(k),c.value!==null&&c.value.__updateRefocusTarget(P.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),P.focused.value=!1}function rs(k){sn(),P.focused.value===!1&&n("blur",k),Mn()}function as(){const k=document.activeElement;(k===null||k.id!==P.targetUid.value)&&se.value!==null&&se.value!==k&&se.value.focus(),oe()}function Dn(){a.value!==!0&&(s.value=-1,r.value===!0&&(r.value=!1),P.focused.value===!1&&(U!==null&&(clearTimeout(U),U=null),P.innerLoading.value===!0&&(n("filterAbort"),P.innerLoading.value=!1,g.value=!1)))}function Cn(k){P.editable.value===!0&&(E===!0?(P.onControlFocusin(k),a.value=!0,Qt(()=>{P.focus()})):P.focus(),e.onFilter!==void 0?kn(l.value):(xe.value!==!0||t["no-option"]!==void 0)&&(r.value=!0))}function sn(){a.value=!1,Dn()}function Mn(){e.useInput===!0&&Bn(e.multiple!==!0&&e.fillInput===!0&&O.value.length!==0&&ie.value(O.value[0])||"",!0,!0)}function Ki(k){let ne=-1;if(k===!0){if(O.value.length!==0){const te=Q.value(O.value[0]);ne=e.options.findIndex(_e=>qn(Q.value(_e),te))}S(ne)}en(ne)}function ss(k,ne){r.value===!0&&P.innerLoading.value===!1&&(S(-1,!0),Qt(()=>{r.value===!0&&P.innerLoading.value===!1&&(k>ne?S():Ki(!0))}))}function er(){a.value===!1&&j.value!==null&&j.value.updatePosition()}function tr(k){k!==void 0&&Sn(k),n("popupShow",k),P.hasPopupOpen=!0,P.onControlFocusin(k)}function nr(k){k!==void 0&&Sn(k),n("popupHide",k),P.hasPopupOpen=!1,P.onControlFocusout(k)}function ir(){E=o.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?t["no-option"]!==void 0||e.onFilter!==void 0||xe.value===!1:!0),A=o.platform.is.ios===!0&&E===!0&&e.useInput===!0?"fade":e.transitionShow}return ys(ir),ws(er),ir(),En(()=>{w!==null&&clearTimeout(w),_!==null&&clearTimeout(_)}),Object.assign(i,{showPopup:Cn,hidePopup:sn,removeAtIndex:Me,add:pt,toggleOption:St,getOptionIndex:()=>s.value,setOptionIndex:en,moveOptionSelection:bn,filter:kn,updateMenuPosition:er,updateInputValue:Bn,isOptionSelected:Hi,getEmittingOptionValue:Pe,isOptionDisabled:(...k)=>we.value.apply(null,k)===!0,getOptionValue:(...k)=>Q.value.apply(null,k),getOptionLabel:(...k)=>ie.value.apply(null,k)}),Object.assign(P,{innerValue:O,fieldClass:H(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:pe,targetRef:se,hasValue:ue,showPopup:Cn,floatingLabel:H(()=>e.hideSelected!==!0&&ue.value===!0||typeof l.value=="number"||l.value.length!==0||hr(e.displayValue)),getControlChild:()=>{if(P.editable.value!==!1&&(a.value===!0||xe.value!==!0||t["no-option"]!==void 0))return E===!0?is():Za();P.hasPopupOpen===!0&&(P.hasPopupOpen=!1)},controlEvents:{onFocusin(k){P.onControlFocusin(k)},onFocusout(k){P.onControlFocusout(k,()=>{Mn(),Dn()})},onClick(k){if(Gi(k),E!==!0&&r.value===!0){Dn(),se.value!==null&&se.value.focus();return}Cn(k)}},getControl:k=>{const ne=Ga(),te=k===!0||a.value!==!0||E!==!0;if(e.useInput===!0)ne.push(Ya(k,te));else if(P.editable.value===!0){const Ue=te===!0?Be.value:void 0;ne.push(Y("input",{ref:te===!0?se:void 0,key:"d_t",class:"q-select__focus-target",id:te===!0?P.targetUid.value:void 0,value:Ve.value,readonly:!0,"data-autofocus":k===!0||e.autofocus===!0||void 0,...Ue,onKeydown:Go,onKeyup:Ko,onKeypress:Xo})),te===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&ne.push(Y("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:Qo}))}if(p.value!==void 0&&e.disable!==!0&&Re.value.length!==0){const Ue=Re.value.map(Ae=>Y("option",{value:Ae,selected:!0}));ne.push(Y("select",{class:"hidden",name:p.value,multiple:e.multiple},Ue))}const _e=e.useInput===!0||te!==!0?void 0:P.splitAttrs.attributes.value;return Y("div",{class:"q-field__native row items-center",..._e,...P.splitAttrs.listeners.value},ne)},getInnerAppend:()=>e.loading!==!0&&g.value!==!0&&e.hideDropdownIcon!==!0?[Y(me,{class:"q-select__dropdown-icon"+(r.value===!0?" rotate-180":""),name:Zt.value})]:null}),Gr(P)}});const et=Vr("camera",{state:()=>({camera:{data:null,show:!1,camera:"auto"},hasCamera:function(){navigator.permissions.query({name:"camera"}).then(e=>e.state=="granted")}}),actions:{closeCamera:function(){this.camera.show=!1},showCamera:function(){this.camera.show=!0}}}),vu=Oe({name:"EditMintDialog",props:{mint:{type:Object,required:!0},showEditMintDialog:{type:Boolean,required:!0}},setup(e,{emit:t}){const n=ye({url:"",nickname:""}),i=ye({}),o=H({get:()=>e.showEditMintDialog,set:a=>t("update:showEditMintDialog",a)});return rt(()=>e.mint,a=>{i.value={...a},n.value={...a}},{immediate:!0}),{editMintData:n,mintToEdit:i,updateMintLocal:()=>{const a=De();a.updateMint(i.value,n.value),a.showMintInfoData={...n.value},o.value=!1},showEditMintDialogLocal:o}}}),pu=f("h6",{class:"q-mt-none q-mb-md"},"Edit mint",-1),yu={class:"row q-mt-lg"};function wu(e,t,n,i,o,r){return M(),W(ut,{modelValue:e.showEditMintDialogLocal,"onUpdate:modelValue":t[2]||(t[2]=a=>e.showEditMintDialogLocal=a),"backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"q-pa-lg",style:{"max-width":"500px",width:"100%"}},{default:m(()=>[pu,u(lt,{outlined:"",modelValue:e.editMintData.url,"onUpdate:modelValue":t[0]||(t[0]=a=>e.editMintData.url=a),label:"Mint URL",type:"textarea",autogrow:"",class:"q-mb-xs",style:{"font-family":"monospace","font-size":"0.9em"}},null,8,["modelValue"]),u(lt,{outlined:"",modelValue:e.editMintData.nickname,"onUpdate:modelValue":t[1]||(t[1]=a=>e.editMintData.nickname=a),label:"Nickname",type:"textarea",autogrow:"",class:"q-mb-xs"},null,8,["modelValue"]),f("div",yu,[Fe((M(),W(L,{class:"float-left",rounded:"",color:"primary",onClick:e.updateMintLocal},{default:m(()=>[I("Update")]),_:1},8,["onClick"])),[[He]]),Fe((M(),W(L,{flat:"",class:"q-ml-auto",color:"grey"},{default:m(()=>[I("Cancel")]),_:1})),[[He]])])]),_:1})]),_:1},8,["modelValue"])}var _u=Ee(vu,[["render",wu]]);const bu=Oe({name:"RemoveMintDialog",props:{mintToRemove:{type:Object,required:!0},showRemoveMintDialog:{type:Boolean,required:!0}},emits:["remove","update:showRemoveMintDialog"],setup(e,{emit:t}){const n=De(),i=H({get:()=>e.showRemoveMintDialog,set:s=>t("update:showRemoveMintDialog",s)});return{removeMintLocal:()=>{t("remove",e.mintToRemove.url),n.showMintInfoDialog=!1,n.showEditMintDialog=!1},showRemoveMintDialogLocal:i,mintClass:s=>new Gn(s),formatCurrency:(s,l)=>$e().formatCurrency(s,l)}}}),ku=f("h6",{class:"q-my-md"},"Are you sure you want to delete this mint?",-1),Du={key:0},Cu=f("span",{class:"text-weight-bold"}," Nickname: ",-1),Mu={class:"text-weight-light"},Su={class:"row q-my-md"},qu={class:"col"},Tu=f("span",{class:"text-weight-bold"},"Balances:",-1),Pu=f("div",{class:"row q-my-md"},[f("div",{class:"col"},[f("span",{class:"text-caption"},"Note: Because this wallet is paranoid, your ecash from this mint will not be actually deleted but will remain stored on your device. You will see it reappear if you re-add this mint later again.")])],-1),$u={class:"row q-mt-lg"},xu={class:"col"},Eu={class:"col"};function Au(e,t,n,i,o,r){return M(),W(ut,{modelValue:e.showRemoveMintDialogLocal,"onUpdate:modelValue":t[0]||(t[0]=a=>e.showRemoveMintDialogLocal=a),"backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"q-pa-lg"},{default:m(()=>[ku,e.mintToRemove.nickname?(M(),V("div",Du,[Cu,f("span",Mu,ae(e.mintToRemove.nickname),1)])):z("",!0),f("div",Su,[f("div",qu,[Tu,(M(!0),V(at,null,Ot(e.mintClass(e.mintToRemove).units,a=>(M(),W($t,{key:a,color:"primary",label:e.formatCurrency(e.mintClass(e.mintToRemove).unitBalance(a),a),class:"q-mx-xs"},null,8,["label"]))),128))])]),u(lt,{outlined:"",readonly:"","model-value":e.mintToRemove.url,label:"Mint URL",type:"textarea",autogrow:"",class:"q-mb-xs"},null,8,["model-value"]),Pu,f("div",$u,[f("div",xu,[Fe((M(),W(L,{class:"float-left",color:"primary",rounded:"",onClick:e.removeMintLocal},{default:m(()=>[I("Remove mint")]),_:1},8,["onClick"])),[[He]])]),f("div",Eu,[Fe((M(),W(L,{flat:"",color:"grey",class:"float-right"},{default:m(()=>[I("Cancel")]),_:1})),[[He]])])])]),_:1})]),_:1},8,["modelValue"])}var Iu=Ee(bu,[["render",Au]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var fi={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uu=({size:e,strokeWidth:t=2,absoluteStrokeWidth:n,color:i,iconNode:o,name:r,class:a,...s},{slots:l})=>Y("svg",{...fi,width:e||fi.width,height:e||fi.height,stroke:i||fi.stroke,"stroke-width":n?Number(t)*24/Number(e):t,class:["lucide",`lucide-${Ru(r??"icon")}`],...s},[...o.map(h=>Y(...h)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=(e,t)=>(n,{slots:i})=>Y(Uu,{...n,iconNode:t,name:e},i);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=Ge("BanknoteIcon",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ou=Ge("BuildingIcon",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lu=Ge("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=Ge("ClipboardIcon",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=Ge("CoinsIcon",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=Ge("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fu=Ge("DollarSignIcon",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=Ge("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=Ge("InfoIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=Ge("LinkIcon",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=Ge("LockIcon",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Ge("MailIcon",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=Ge("NfcIcon",[["path",{d:"M6 8.32a7.43 7.43 0 0 1 0 7.36",key:"9iaqei"}],["path",{d:"M9.46 6.21a11.76 11.76 0 0 1 0 11.58",key:"1yha7l"}],["path",{d:"M12.91 4.1a15.91 15.91 0 0 1 .01 15.8",key:"4iu2gk"}],["path",{d:"M16.37 2a20.16 20.16 0 0 1 0 20",key:"sap9u2"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=Ge("NutIcon",[["path",{d:"M12 4V2",key:"1k5q1u"}],["path",{d:"M5 10v4a7.004 7.004 0 0 0 5.277 6.787c.412.104.802.292 1.102.592L12 22l.621-.621c.3-.3.69-.488 1.102-.592A7.003 7.003 0 0 0 19 14v-4",key:"1tgyif"}],["path",{d:"M12 4C8 4 4.5 6 4 8c-.243.97-.919 1.952-2 3 1.31-.082 1.972-.29 3-1 .54.92.982 1.356 2 2 1.452-.647 1.954-1.098 2.5-2 .595.995 1.151 1.427 2.5 2 1.31-.621 1.862-1.058 2.5-2 .629.977 1.162 1.423 2.5 2 1.209-.548 1.68-.967 2-2 1.032.916 1.683 1.157 3 1-1.297-1.036-1.758-2.03-2-3-.5-2-4-4-8-4Z",key:"tnsqj"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qu=Ge("PencilIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Ge("QrCodeIcon",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Ge("ScanIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Ge("TrashIcon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=Ge("XIcon",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=Ge("ZapIcon",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const Yu=Oe({name:"MintMotdMessage",components:{XIcon:Li,InfoIcon:ta},props:{message:{type:String,default:""},mintUrl:{type:String,required:!0},dismissed:{type:Boolean,default:!1}},emits:["dismiss"],setup(e,{emit:t}){const n=De();return{dismissMessage:()=>{n.setMintMotdViewed(e.mintUrl),t("dismiss")}}}}),ia=e=>(Ft("data-v-7e9550f9"),e=e(),zt(),e),Zu={key:0,class:"motd-container"},Ju={class:"motd-content"},ec={class:"motd-text-container"},tc={class:"motd-header"},nc=ia(()=>f("div",{class:"motd-title"},"Mint Message",-1)),ic={class:"motd-message"},oc={key:1,class:"motd-dismissed q-mt-md"},rc={class:"motd-dismissed-message"},ac={class:"motd-text-container"},sc=ia(()=>f("div",{class:"motd-title"},"Mint Message",-1)),lc={class:"motd-message"};function uc(e,t,n,i,o,r){const a=J("info-icon"),s=J("x-icon");return e.message&&!e.dismissed?(M(),V("div",Zu,[f("div",Ju,[u(a,{size:"24",class:"motd-icon"}),f("div",ec,[f("div",tc,[nc,u(s,{size:"18",class:"motd-close-icon cursor-pointer",onClick:e.dismissMessage},null,8,["onClick"])]),f("div",ic,ae(e.message),1)])])])):e.message&&e.dismissed?(M(),V("div",oc,[f("div",rc,[u(a,{size:"24",class:"motd-dismissed-icon q-mr-md"}),f("div",ac,[sc,f("div",lc,ae(e.message),1)])])])):z("",!0)}var cc=Ee(Yu,[["render",uc],["__scopeId","data-v-7e9550f9"]]);const dc=Oe({name:"MintInfoDialog",components:{VueQrcode:Co,CloseIcon:Li,QrCodeIcon:Xu,LinkIcon:ju,NutIcon:Ku,CurrencyIcon:Fu,InfoIcon:ta,MailIcon:Hu,CopyIcon:Vu,PencilIcon:Qu,TrashIcon:Gu,BuildingIcon:Ou,BanknoteIcon:Nu,EditMintDialog:_u,RemoveMintDialog:Iu,MintMotdMessage:cc},data:function(){return{contactIcons:{email:"mail"},contactMethods:{twitter:"X",nostr:"Nostr"},showQrCode:!1,showAllNuts:!1,nutNames:{7:"Token state check",8:"Overpaid Lightning fees",9:"Signature restore",10:"Spending conditions",11:"Pay-To-Pubkey (P2PK)",12:"DLEQ proofs",13:"Deterministic secrets",14:"Hashed Timelock Contracts",15:"Partial multi-path payments",16:"Animated QR codes",17:"WebSocket subscriptions",18:"Payment requests",19:"Cached Responses",20:"Signature on Mint Quote",21:"Clear authentication",22:"Blind authentication"},motdDismissed:!1}},computed:{...de(De,["showMintInfoData"]),...ve(De,["showMintInfoDialog","showEditMintDialog","showRemoveMintDialog"]),filteredNutNames(){const e={};return Object.keys(this.nutNames).forEach(t=>{parseInt(t)>=7&&(e[t]=this.nutNames[t])}),e},visibleNuts(){const e={};return this.showMintInfoData&&this.showMintInfoData.info&&this.showMintInfoData.info.nuts&&Object.keys(this.filteredNutNames).forEach(t=>{this.showMintInfoData.info.nuts[t]&&(e[t]=this.filteredNutNames[t])}),e},mintUnits(){return this.showMintInfoData?new Gn(this.showMintInfoData).units:[]}},methods:{...ce(De,["removeMint"]),shortenText:function(e,t){return e.length>t?e.substring(0,t)+"...":e},copyText(e){navigator.clipboard.writeText(e),this.$q.notify({message:"Copied to clipboard",color:"positive",position:"top",timeout:1e3})},openEditMintDialog(){this.mintToEdit=Object.assign({},this.showMintInfoData),this.editMintData=Object.assign({},this.showMintInfoData),this.showEditMintDialog=!0},openRemoveMintDialog(){this.mintToRemove=Object.assign({},this.showMintInfoData),this.showRemoveMintDialog=!0}}}),fc={class:"fullscreen bg-dark"},hc={class:"mint-content-container q-pa-md"},mc={class:"top-icons q-pt-md q-mb-lg"},gc={class:"qr-code-container"},vc={class:"qr-code-section q-mb-md",key:"qr-code"},pc={class:"mint-header-container q-mb-lg"},yc={class:"mint-header q-pa-md q-py-lg"},wc=["src"],_c={class:"mint-name q-mb-xs"},bc={key:0,class:"mint-balance"},kc={class:"mint-descriptions q-mt-lg"},Dc={key:0,class:"mint-description"},Cc={key:1,class:"mint-description-long q-mt-md"},Mc={key:0,class:"section-divider q-mb-md"},Sc=f("div",{class:"divider-line"},null,-1),qc=f("div",{class:"divider-text"},"CONTACT",-1),Tc=f("div",{class:"divider-line"},null,-1),Pc=[Sc,qc,Tc],$c={class:"contact-section q-mb-lg"},xc={class:"contact-icon-container"},Ec={key:1,src:"nostr-icon.svg",class:"contact-icon",alt:""},Ac={key:2,src:"/x-logo.svg",class:"contact-icon",alt:""},Ic={class:"contact-text"},Rc=f("div",{class:"section-divider q-mb-md"},[f("div",{class:"divider-line"}),f("div",{class:"divider-text"},"MINT DETAILS"),f("div",{class:"divider-line"})],-1),Uc={class:"mint-details-section q-mb-lg"},Nc={class:"detail-item q-mb-md"},Oc={class:"detail-label"},Lc=f("div",{class:"detail-name"},"URL",-1),Bc={key:0,class:"detail-item q-mb-md"},Vc={class:"detail-label"},Fc=f("div",{class:"detail-name"},"Nuts",-1),zc={key:1,class:"nuts-expanded-section"},jc={class:"nuts-grid"},Wc={class:"nut-content"},Hc={class:"nut-number"},Kc={key:2,class:"detail-item q-mb-md"},Qc={class:"detail-label"},Xc=f("div",{class:"detail-name"},"Currency",-1),Gc={class:"detail-value"},Yc={key:3,class:"detail-item q-mb-md"},Zc={class:"detail-label"},Jc=f("div",{class:"detail-name"},"Currency",-1),ed={class:"detail-value"},td={key:4,class:"detail-item"},nd={class:"detail-label"},id=f("div",{class:"detail-name"},"Version",-1),od={class:"detail-value"},rd=f("div",{class:"section-divider q-mb-md"},[f("div",{class:"divider-line"}),f("div",{class:"divider-text"},"ACTIONS"),f("div",{class:"divider-line"})],-1),ad={class:"action-buttons-section"},sd={class:"action-buttons-container"},ld=f("div",{class:"action-label"},"Edit mint",-1),ud=f("div",{class:"action-label"},"Copy mint URL",-1),cd=f("div",{class:"action-label"},"Delete mint",-1);function dd(e,t,n,i,o,r){const a=J("EditMintDialog"),s=J("RemoveMintDialog"),l=J("close-icon"),h=J("qr-code-icon"),g=J("vue-qrcode"),w=J("building-icon"),_=J("mint-motd-message"),C=J("MintMotdMessage"),E=J("mail-icon"),N=J("copy-icon"),U=J("link-icon"),K=J("nut-icon"),A=J("currency-icon"),F=J("banknote-icon"),X=J("info-icon"),pe=J("pencil-icon"),se=J("trash-icon");return M(),V(at,null,[u(a,{mint:e.mintToEdit,showEditMintDialog:e.showEditMintDialog,"onUpdate:showEditMintDialog":t[0]||(t[0]=j=>e.showEditMintDialog=j)},null,8,["mint","showEditMintDialog"]),u(s,{mintToRemove:e.mintToRemove,showRemoveMintDialog:e.showRemoveMintDialog,"onUpdate:showRemoveMintDialog":t[1]||(t[1]=j=>e.showRemoveMintDialog=j),onRemove:e.removeMint},null,8,["mintToRemove","showRemoveMintDialog","onRemove"]),u(ut,{modelValue:e.showMintInfoDialog,"onUpdate:modelValue":t[10]||(t[10]=j=>e.showMintInfoDialog=j),position:"top",maximized:!0,"transition-show":"fade","transition-hide":"fade","full-width":"","full-height":"",seamless:"",onKeyup:t[11]||(t[11]=Et(j=>e.showMintInfoDialog=!1,["esc"]))},{default:m(()=>[f("div",fc,[f("div",hc,[f("div",mc,[Fe(u(l,{size:"24",class:"close-icon cursor-pointer text-white"},null,512),[[He]]),u(h,{size:"24",class:"qr-icon cursor-pointer text-white",onClick:t[2]||(t[2]=j=>e.showQrCode=!e.showQrCode)})]),f("div",gc,[u(Je,{appear:"",name:"smooth-slide"},{default:m(()=>[e.showQrCode?(M(),V("div",vc,[u(g,{value:e.showMintInfoData.url,options:{width:300},class:"rounded-borders"},null,8,["value"])])):z("",!0)]),_:1})]),f("div",pc,[f("div",yc,[u(Fr,{size:"56px",class:"mint-profile-icon q-mb-sm"},{default:m(()=>[e.showMintInfoData.info.icon_url?(M(),V("img",{key:0,src:e.showMintInfoData.info.icon_url,alt:"Mint Profile"},null,8,wc)):(M(),W(w,{key:1,size:"36"}))]),_:1}),f("div",_c,ae(e.showMintInfoData.info.name||"Mint"),1),e.showMintInfoData.info.balance?(M(),V("div",bc,ae(e.showMintInfoData.info.balance),1)):z("",!0)]),f("div",kc,[u(Je,{appear:"","enter-active-class":"animated pulse",name:"smooth-slide"},{default:m(()=>[e.showMintInfoData.info.motd&&!e.showMintInfoData.motd_viewed?(M(),W(_,{key:0,message:e.showMintInfoData.info.motd,"mint-url":e.showMintInfoData.url,dismissed:e.showMintInfoData.motd_viewed,onDismiss:t[3]||(t[3]=j=>e.motdDismissed=!0)},null,8,["message","mint-url","dismissed"])):z("",!0)]),_:1}),e.showMintInfoData.info.description?(M(),V("div",Dc,ae(e.showMintInfoData.info.description),1)):z("",!0),e.showMintInfoData.info.description_long?(M(),V("div",Cc,ae(e.showMintInfoData.info.description_long),1)):z("",!0)]),u(Je,{name:"smooth-slide"},{default:m(()=>[e.showMintInfoData.info.motd&&e.showMintInfoData.motd_viewed?(M(),W(C,{key:0,message:e.showMintInfoData.info.motd,mintUrl:e.showMintInfoData.url,dismissed:e.showMintInfoData.motd_viewed,onDismiss:e.dismissMotd},null,8,["message","mintUrl","dismissed","onDismiss"])):z("",!0)]),_:1})]),e.showMintInfoData.info.contact?.length>0?(M(),V("div",Mc,Pc)):z("",!0),f("div",$c,[(M(!0),V(at,null,Ot(e.showMintInfoData.info.contact,j=>(M(),V("div",{key:j.method,class:"contact-item q-mb-md"},[f("div",xc,[j.method==="email"?(M(),W(E,{key:0,size:"20",color:"#9E9E9E",class:"contact-icon"})):j.method==="nostr"?(M(),V("img",Ec)):j.method==="twitter"?(M(),V("img",Ac)):z("",!0)]),f("div",Ic,ae(j.info),1),u(N,{onClick:c=>e.copyText(j.info),size:"20",color:"#9E9E9E",class:"copy-icon cursor-pointer"},null,8,["onClick"])]))),128))]),Rc,f("div",Uc,[f("div",Nc,[f("div",Oc,[u(U,{size:"20",color:"#9E9E9E",class:"detail-icon"}),Lc]),f("div",{class:"detail-value items-center",onClick:t[4]||(t[4]=j=>e.copyText(e.showMintInfoData.url))},ae(e.showMintInfoData.url),1)]),e.showMintInfoData.info.nuts?(M(),V("div",Bc,[f("div",Vc,[u(K,{size:"20",color:"#9E9E9E",class:"detail-icon"}),Fc]),e.showAllNuts?(M(),V("div",{key:1,class:"detail-value",onClick:t[6]||(t[6]=j=>e.showAllNuts=!1)}," Hide ")):(M(),V("div",{key:0,class:"detail-value",onClick:t[5]||(t[5]=j=>e.showAllNuts=!0)}," View all "))])):z("",!0),e.showAllNuts&&e.showMintInfoData.info.nuts?(M(),V("div",zc,[f("div",jc,[(M(!0),V(at,null,Ot(e.visibleNuts,(j,c)=>(M(),V("div",{key:c,class:"nut-pill"},[f("div",Wc,[f("span",Hc,ae(c)+":",1),I(" "+ae(j),1)])]))),128))])])):z("",!0),e.showMintInfoData.info.currencies?(M(),V("div",Kc,[f("div",Qc,[u(A,{size:"20",color:"#9E9E9E",class:"detail-icon"}),Xc]),f("div",Gc,ae(e.showMintInfoData.info.currencies),1)])):z("",!0),e.mintUnits&&e.mintUnits.length>0?(M(),V("div",Yc,[f("div",Zc,[u(F,{size:"20",color:"#9E9E9E",class:"detail-icon"}),Jc]),f("div",ed,ae(e.mintUnits.map(j=>j.toUpperCase()).join(", ")),1)])):z("",!0),e.showMintInfoData.info.version?(M(),V("div",td,[f("div",nd,[u(X,{size:"20",color:"#9E9E9E",class:"detail-icon"}),id]),f("div",od,ae(e.showMintInfoData.info.version),1)])):z("",!0)]),rd,f("div",ad,[f("div",sd,[f("div",{class:"action-button cursor-pointer",onClick:t[7]||(t[7]=(...j)=>e.openEditMintDialog&&e.openEditMintDialog(...j))},[u(pe,{size:"20",color:"#9E9E9E",class:"action-icon"}),ld]),f("div",{class:"action-button cursor-pointer",onClick:t[8]||(t[8]=j=>e.copyText(e.showMintInfoData.url))},[u(N,{size:"20",color:"#9E9E9E",class:"action-icon"}),ud]),f("div",{class:"action-button delete-button cursor-pointer",onClick:t[9]||(t[9]=(...j)=>e.openRemoveMintDialog&&e.openRemoveMintDialog(...j))},[u(se,{size:"20",color:"#FF453A",class:"action-icon"}),cd])])])])])]),_:1},8,["modelValue"])],64)}var fd=Ee(dc,[["render",dd]]);const ho=_s({events:{},on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},off(e,t){!this.events[e]||(this.events[e]=this.events[e].filter(n=>n!==t))},emit(e,t){console.log("eventBus emit",e,t),this.events[e]&&this.events[e].forEach(n=>n(t))}}),hd=Oe({name:"AddMintDialog",props:{addMintData:{type:Object,required:!0},showAddMintDialog:{type:Boolean,required:!0},addMintBlocking:{type:Boolean,required:!0}},emits:["add","update:showAddMintDialog"],setup(e,{emit:t}){const n=H({get:()=>e.showAddMintDialog,set:r=>t("update:showAddMintDialog",r)}),i=()=>{t("add",e.addMintData,!0)},o=H(()=>e.addMintData.url);return{addMintLocal:i,showAddMintDialogLocal:n,mintUrl:o}}}),md=f("h6",{class:"q-mt-none q-mb-md"},"Do you trust this mint?",-1),gd=f("p",null," Before using this mint, make sure you trust it. Mints could become malicious or cease operation at any time. ",-1),vd={class:"row q-mt-lg"},pd={class:"col"},yd={class:"col"};function wd(e,t,n,i,o,r){return M(),W(ut,{modelValue:e.showAddMintDialogLocal,"onUpdate:modelValue":t[1]||(t[1]=a=>e.showAddMintDialogLocal=a),onKeydown:Et(Wn(e.addMintLocal,["prevent"]),["enter"]),"backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"q-pa-lg"},{default:m(()=>[md,gd,u(lt,{outlined:"",readonly:"",modelValue:e.mintUrl,"onUpdate:modelValue":t[0]||(t[0]=a=>e.mintUrl=a),label:"Mint URL",type:"textarea",autogrow:"",class:"q-mb-xs",style:{"font-family":"monospace","font-size":"0.9em"}},null,8,["modelValue"]),f("div",vd,[f("div",pd,[Fe((M(),W(L,{class:"float-left",rounded:"",color:"primary",icon:"check",loading:e.addMintBlocking,onClick:e.addMintLocal},{loading:m(()=>[u(Rt),I(" Adding mint ")]),default:m(()=>[I("Add mint ")]),_:1},8,["loading","onClick"])),[[He]])]),f("div",yd,[Fe((M(),W(L,{flat:"",class:"float-right",color:"grey"},{default:m(()=>[I("Cancel")]),_:1})),[[He]])])])]),_:1})]),_:1},8,["modelValue","onKeydown"])}var _d=Ee(hd,[["render",wd]]);const bd=Oe({name:"MintSettings",mixins:[windowMixin],components:{MintDetailsDialog:fd,AddMintDialog:_d},props:{},setup(){const e=ye(null),t=()=>{if(e.value){const n=e.value.getBoundingClientRect();window.scrollTo({top:window.scrollY+n.top,behavior:"smooth"})}};return Ri(()=>{ho.on("scrollToAddMintDiv",t)}),En(()=>{ho.off("scrollToAddMintDiv",t)}),{addMintDiv:e}},data:function(){return{discoveringMints:!1,addingMint:!1,swapData:{fromUrl:{url:"",optionLabel:""},toUrl:{url:"",optionLabel:""},amount:void 0},activatingMintUrl:""}},computed:{...ve(An,["getBitcoinPrice"]),...de(Bt,["p2pkKeys"]),...de(De,["activeMintUrl","activeUnit","mints","activeProofs","addMintBlocking"]),...de(uo,["pubkey","mintRecommendations"]),...de(dn,["invoiceWorkerRunning"]),...ve(De,["addMintData","showAddMintDialog","showMintInfoDialog","showMintInfoData"]),...de($e,["tickerShort"]),...de(Hn,["swapAmountData"]),...ve(Hn,["swapBlocking"])},watch:{invoiceWorkerRunning:function(e){this.swapBlocking&&!e&&(this.swapBlocking=!1)}},methods:{...ce(uo,["init","initNdkReadOnly","getUserPubkey","fetchEventsFromUser","fetchMints"]),...ce(Bt,["generateKeypair","showKeyDetails"]),...ce(De,["addMint","removeMint","activateMintUrl","updateMint","triggerMintInfoMotdChanged","fetchMintInfo"]),...ce(Xe,["decodeRequest","mintOnPaid"]),...ce(dn,["clearAllWorkers"]),...ce(et,["closeCamera","showCamera"]),...ce(Hn,["mintAmountSwap"]),activateMintUrlInternal:async function(e){this.activatingMintUrl=e,console.log(`Activating mint ${this.activatingMintUrl}`);try{await this.activateMintUrl(e,!1,!0)}catch(t){console.log("#### Error activating mint:",t)}finally{this.activatingMintUrl=""}},validateMintUrl:function(e){try{return new URL(e),!0}catch{return!1}},sanitizeMintUrlAndShowAddDialog:function(){if(this.addMintData.url.match(/^[a-zA-Z]+:\/\//)||(this.addMintData.url="https://"+this.addMintData.url),!this.validateMintUrl(this.addMintData.url)){Tn("Invalid URL");return}let e=new URL(this.addMintData.url);e.hostname=e.hostname.toLowerCase(),this.addMintData.url=e.toString(),this.addMintData.url=this.addMintData.url.replace(/\/$/,""),this.showAddMintDialog=!0},addMintInternal:function(e,t){this.addingMint=!0;try{this.addMint(e,t),this.addMintData={url:"",nickname:""}}finally{this.addingMint=!1}},mintClass(e){return new Gn(e)},swapAmountDataOptions:function(){let e=[];for(const[t,n]of Object.entries(this.mints)){const i="sat",o=this.mintClass(n).unitBalance(i),r=$e().formatCurrency(o,i);e.push({url:n.url,optionLabel:(n.nickname||Lt(n.url))+" ("+r+")"})}return e},clearSwapData:function(){this.swapData.fromUrl="",this.swapData.toUrl="",this.swapData.amount=void 0},extractAndMintAmountSwap:async function(e){e.fromUrl=this.swapData.fromUrl.url,e.toUrl=this.swapData.toUrl.url,e.amount=this.swapData.amount,await this.mintAmountSwap(e),this.clearSwapData()},fetchMintsFromNdk:async function(){this.discoveringMints=!0,await this.initNdkReadOnly(),console.log("### fetch mints");let e=5,t=0,n=[];for(;n.length==0&&t<e;){try{n=await this.fetchMints()}catch(i){console.log("Error fetching mints",i)}t++}n.length==0?this.notifyError("No mints found"):this.notifySuccess("Found "+n.length+" mints"),console.log(n),this.discoveringMints=!1},showMintInfo:async function(e){this.showMintInfoData=e,this.showMintInfoDialog=!0,this.fetchMintInfo(e).then(t=>{this.triggerMintInfoMotdChanged(t,e),this.mints.filter(n=>n.url===e.url)[0].info=t,this.showMintInfoData=e})},getMintIconUrl:function(e){if(e.info)return e.info.icon_url?e.info.icon_url:void 0}},created:function(){}}),kd={style:{"max-width":"800px",margin:"0 auto"}},Dd={class:"q-py-md q-px-xs text-left","on-left":""},Cd={key:0,class:"error-badge"},Md={class:"full-width",style:{position:"relative"}},Sd={class:"row items-center q-pa-md"},qd={class:"col"},Td={class:"row items-center"},Pd={class:"column q-gutter-y-sm"},$d={key:0,style:{"font-size":"16px","font-weight":"600","line-height":"16px"}},xd={class:"text-grey-6",style:{"font-size":"12px","line-height":"16px","font-family":"monospace","margin-top":"4px"}},Ed={class:"row justify-between q-pb-md q-px-md"},Ad={class:"col"},Id={class:"row q-gutter-x-sm"},Rd={style:{color:"white","font-size":"14px","font-weight":"500"}},Ud={class:"col-auto"},Nd={class:"q-pt-xs q-px-md",ref:"addMintDiv"},Od={class:"add-mint-container"},Ld=bs('<div class="section-divider q-mb-md"><div class="divider-line"></div><div class="divider-text">ADD MINT</div><div class="divider-line"></div></div><div class="add-mint-description q-mb-lg text-left" style="color:rgba(255, 255, 255, 0.7);"> Enter the URL of a Cashu mint to connect to it. This wallet is not affiliated with any mint. </div>',2),Bd={class:"add-mint-inputs"},Vd={class:"add-mint-actions"},Fd={class:"row justify-between items-center q-mt-xs"},zd=f("span",null,"Add Mint",-1),jd=f("span",null,"Scan QR Code",-1),Wd=f("div",{class:"section-divider q-mb-md"},[f("div",{class:"divider-line"}),f("div",{class:"divider-text"},"DISCOVER MINTS"),f("div",{class:"divider-line"})],-1),Hd={class:"q-px-xs text-left","on-left":""},Kd={key:0},Qd=f("a",{href:"https://bitcoinmints.com",target:"_blank",class:"text-primary"},"bitcoinmints.com",-1),Xd=f("div",{class:"section-divider q-mb-md"},[f("div",{class:"divider-line"}),f("div",{class:"divider-text"},"SWAP"),f("div",{class:"divider-line"})],-1),Gd={class:"q-px-xs text-left","on-left":""};function Yd(e,t,n,i,o,r){const a=J("MintDetailsDialog"),s=J("AddMintDialog");return M(),V(at,null,[u(a,{"onUpdate:mintToRemove":t[0]||(t[0]=l=>e.mintToRemove=l)}),u(s,{addMintData:e.addMintData,showAddMintDialog:e.showAddMintDialog,"onUpdate:showAddMintDialog":t[1]||(t[1]=l=>e.showAddMintDialog=l),addMintBlocking:e.addMintBlocking,onAdd:e.addMintInternal},null,8,["addMintData","showAddMintDialog","addMintBlocking","onAdd"]),f("div",kd,[f("div",Dd,[u(Kn,{padding:""},{default:m(()=>[(M(!0),V(at,null,Ot(e.mints,l=>(M(),V("div",{key:l.url,class:"q-px-md"},[u(gt,{active:l.url==e.activeMintUrl,"active-class":"text-weight-bold text-primary",clickable:"",onClick:h=>e.activateMintUrlInternal(l.url),class:"mint-card q-mb-md cursor-pointer",style:Ti({"border-radius":"10px",border:l.url==e.activeMintUrl?"1px solid var(--q-primary)":"1px solid rgba(128, 128, 128, 0.2)",padding:"0px",position:"relative"}),loading:l.url==e.activatingMintUrl},{default:m(()=>[u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",name:"fade"},{default:m(()=>[l.url==e.activatingMintUrl?(M(),W(Rt,{key:0,color:"white",size:"1.3rem",class:"mint-loading-spinner"})):z("",!0)]),_:2},1024),u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",name:"fade"},{default:m(()=>[l.url!=e.activatingMintUrl&&l.errored?(M(),V("div",Cd,[u($t,{color:"red",outline:"",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:m(()=>[I(" Error "),u(me,{name:"error",class:"q-ml-xs",size:"xs"})]),_:1})])):z("",!0)]),_:2},1024),f("div",Md,[f("div",Sd,[f("div",qd,[f("div",Td,[e.getMintIconUrl(l)?(M(),W(Fr,{key:0,size:"34px",class:"q-mr-sm"},{default:m(()=>[u(Zr,{"spinner-color":"white","spinner-size":"xs",src:e.getMintIconUrl(l),alt:"Mint Icon",style:{height:"34px","max-width":"34px","font-size":"12px"}},null,8,["src"])]),_:2},1024)):z("",!0),f("div",Pd,[l.nickname||l.info?.name?(M(),V("div",$d,ae(l.nickname||l.info?.name),1)):z("",!0),f("div",xd,ae(l.url),1)])])])]),f("div",Ed,[f("div",Ad,[f("div",Id,[(M(!0),V(at,null,Ot(e.mintClass(l).units,h=>(M(),V("div",{key:h,class:"q-py-xs q-px-sm",style:{"border-radius":"4px","background-color":"#1d1d1d",display:"inline-block"}},[f("span",Rd,ae(e.formatCurrency(e.mintClass(l).unitBalance(h),h)),1)]))),128))])]),f("div",Ud,[u(me,{name:"more_vert",onClick:Wn(h=>e.showMintInfo(l),["stop"]),color:"white",class:"cursor-pointer q-mr-sm",size:"1.3rem"},null,8,["onClick"])])])])]),_:2},1032,["active","onClick","style","loading"])]))),128))]),_:1})]),f("div",Nd,[f("div",Od,[Ld,f("div",Bd,[u(lt,{rounded:"",outlined:"",modelValue:e.addMintData.url,"onUpdate:modelValue":t[2]||(t[2]=l=>e.addMintData.url=l),placeholder:"https://",onKeydown:Et(Wn(e.sanitizeMintUrlAndShowAddDialog,["prevent"]),["enter"]),ref:"mintInput",class:"q-mb-md mint-input url-input"},null,8,["modelValue","onKeydown"]),u(lt,{rounded:"",outlined:"",modelValue:e.addMintData.nickname,"onUpdate:modelValue":t[3]||(t[3]=l=>e.addMintData.nickname=l),placeholder:"Nickname (e.g. Testnet)",onKeydown:Et(Wn(e.sanitizeMintUrlAndShowAddDialog,["prevent"]),["enter"]),ref:"mintNicknameInput",class:"mint-input"},null,8,["modelValue","onKeydown"])]),f("div",Vd,[f("div",Fd,[u(L,{flat:"",disable:e.addMintData.url.length===0,onClick:t[4]||(t[4]=l=>e.addMintData.url.length>0?e.sanitizeMintUrlAndShowAddDialog():null),class:qi(["text-white",{"text-grey-7":e.addMintData.url.length===0}])},{default:m(()=>[u(me,{name:"add",size:"20px",class:"q-mr-sm"}),zd]),_:1},8,["disable","class"]),u(L,{flat:"",onClick:e.showCamera,class:"text-white"},{default:m(()=>[u(me,{name:"qr_code",size:"20px",class:"q-mr-sm"}),jd]),_:1},8,["onClick"])])])])],512),Wd,f("div",Hd,[u(Kn,{padding:""},{default:m(()=>[u(gt,null,{default:m(()=>[u(dt,null,{default:m(()=>[u(Ie,{overline:""},{default:m(()=>[I("Discover")]),_:1}),u(Ie,{caption:""},{default:m(()=>[I("Discover mints other users have recommended on nostr.")]),_:1})]),_:1})]),_:1}),u(gt,{class:"q-pt-sm"},{default:m(()=>[u(L,{class:"q-ml-sm q-px-md",color:"primary",rounded:"",outline:"",loading:e.discoveringMints,onClick:e.fetchMintsFromNdk},{loading:m(()=>[u(Rt,{class:"on-left"}),I(" Loading... ")]),default:m(()=>[I("Discover mints ")]),_:1},8,["loading","onClick"])]),_:1}),e.mintRecommendations.length>0?(M(),V("div",Kd,[u(gt,null,{default:m(()=>[u(dt,null,{default:m(()=>[u(Ie,{overline:""},{default:m(()=>[I("Found "+ae(e.mintRecommendations.length)+" mints",1)]),_:1}),u(Ie,{caption:""},{default:m(()=>[I("These mints were recommended by other Nostr users. Read reviews at "),Qd,I(". Be careful and do your own research before using a mint. ")]),_:1})]),_:1})]),_:1}),u(Wr,{dense:"","dense-toggle":"",class:"text-left",label:"Click to browse mints"},{default:m(()=>[(M(!0),V(at,null,Ot(e.mintRecommendations,l=>(M(),W(gt,{key:l.url},{default:m(()=>[u(dt,{class:"q-mx-none q-pl-none",style:{"max-width":"1.05em"}},{default:m(()=>[u(me,{name:"content_copy",onClick:h=>e.copyText(l.url),size:"1em",color:"grey",class:"q-mr-xs cursor-pointer"},null,8,["onClick"])]),_:2},1024),u(dt,null,{default:m(()=>[u(Ie,{caption:"",style:{"word-break":"break-word"}},{default:m(()=>[I(ae(l.url),1)]),_:2},1024)]),_:2},1024),u(dt,{side:""},{default:m(()=>[u($t,{label:l.count,color:"primary"},null,8,["label"])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):z("",!0)]),_:1})]),Xd,f("div",Gd,[u(Kn,{padding:""},{default:m(()=>[u(gt,null,{default:m(()=>[u(dt,null,{default:m(()=>[u(Ie,{overline:""},{default:m(()=>[I("Multimint Swaps")]),_:1}),u(Ie,{caption:""},{default:m(()=>[I("Swap funds between mints via Lightning. Note: Leave room for potential Lightning fees. If the incoming payment does not succeed, check the invoice manually. ")]),_:1})]),_:1})]),_:1}),u(gt,{class:"q-pt-sm"},{default:m(()=>[u(fo,{clearable:"",rounded:"",outlined:"",dense:"",color:"primary",modelValue:e.swapData.fromUrl,"onUpdate:modelValue":t[5]||(t[5]=l=>e.swapData.fromUrl=l),options:e.swapAmountDataOptions(),"option-value":"url","option-label":"optionLabel",label:"From",style:{"min-width":"200px",width:"100%","font-family":"monospace","font-size":"0.9em"},disable:e.swapBlocking},null,8,["modelValue","options","disable"])]),_:1}),u(gt,null,{default:m(()=>[u(fo,{clearable:"",rounded:"",outlined:"",dense:"",color:"primary",modelValue:e.swapData.toUrl,"onUpdate:modelValue":t[6]||(t[6]=l=>e.swapData.toUrl=l),options:e.swapAmountDataOptions(),"option-value":"url","option-label":"optionLabel",label:"To",style:{"min-width":"200px",width:"100%","font-family":"monospace","font-size":"0.9em"},disable:e.swapBlocking},null,8,["modelValue","options","disable"])]),_:1}),u(gt,null,{default:m(()=>[u(lt,{rounded:"",outlined:"",dense:"",modelValue:e.swapData.amount,"onUpdate:modelValue":t[7]||(t[7]=l=>e.swapData.amount=l),modelModifiers:{number:!0},type:"number",label:"Amount ("+e.tickerShort+")",style:{"min-width":"200px"},onKeydown:t[8]||(t[8]=Et(Wn(l=>e.extractAndMintAmountSwap(e.swapAmountData),["prevent"]),["enter"])),disable:!e.swapData.fromUrl||!e.swapData.toUrl||e.swapData.fromUrl==e.swapData.toUrl||e.swapBlocking},null,8,["modelValue","label","disable"]),u(L,{class:"q-ml-sm q-px-md",color:"primary",rounded:"",onClick:t[9]||(t[9]=l=>e.extractAndMintAmountSwap(e.swapAmountData)),disable:!e.swapData.fromUrl||!e.swapData.toUrl||!(e.swapData.amount>0)||e.swapData.fromUrl==e.swapData.toUrl,loading:e.swapBlocking},{loading:m(()=>[u(Rt,{size:"xs"}),I(" Swap ")]),default:m(()=>[u(me,{size:"xs",name:"swap_horiz",class:"q-pr-xs"}),I(" Swap ")]),_:1},8,["disable","loading"])]),_:1})]),_:1})])])],64)}var Zd=Ee(bd,[["render",Yd]]);function hi(e,t){return[!0,!1].includes(e)?e:t}var oa=Ct({name:"QPagination",props:{...Ni,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>(typeof e=="string"?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>e===""||ks.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:t}){const{proxy:n}=Vt(),{$q:i}=n,o=Oi(e,i),r=H(()=>parseInt(e.min,10)),a=H(()=>parseInt(e.max,10)),s=H(()=>parseInt(e.maxPages,10)),l=H(()=>E.value+" / "+a.value),h=H(()=>hi(e.boundaryLinks,e.input)),g=H(()=>hi(e.boundaryNumbers,!e.input)),w=H(()=>hi(e.directionLinks,e.input)),_=H(()=>hi(e.ellipses,!e.input)),C=ye(null),E=H({get:()=>e.modelValue,set:b=>{if(b=parseInt(b,10),e.disable||isNaN(b))return;const q=al(b,r.value,a.value);e.modelValue!==q&&t("update:modelValue",q)}});rt(()=>`${r.value}|${a.value}`,()=>{E.value=e.modelValue});const N=H(()=>"q-pagination row no-wrap items-center"+(e.disable===!0?" disabled":"")),U=H(()=>e.gutter in or?`${or[e.gutter]}px`:e.gutter||null),K=H(()=>U.value!==null?`--q-pagination-gutter-parent:-${U.value};--q-pagination-gutter-child:${U.value}`:null),A=H(()=>{const b=[e.iconFirst||i.iconSet.pagination.first,e.iconPrev||i.iconSet.pagination.prev,e.iconNext||i.iconSet.pagination.next,e.iconLast||i.iconSet.pagination.last];return i.lang.rtl===!0?b.reverse():b}),F=H(()=>({"aria-disabled":e.disable===!0?"true":"false",role:"navigation"})),X=H(()=>Ds(e,"flat")),pe=H(()=>({[X.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:e.ripple!==null?e.ripple:!0})),se=H(()=>{const b={[X.value]:!1};return e.activeDesign!==""&&(b[e.activeDesign]=!0),b}),j=H(()=>({...se.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor})),c=H(()=>{let b=Math.max(s.value,1+(_.value?2:0)+(g.value?2:0));const q={pgFrom:r.value,pgTo:a.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(a.value).length)}em`}};return s.value&&b<a.value-r.value+1&&(b=1+Math.floor(b/2)*2,q.pgFrom=Math.max(r.value,Math.min(a.value-b+1,e.modelValue-Math.floor(b/2))),q.pgTo=Math.min(a.value,q.pgFrom+b-1),g.value&&(q.boundaryStart=!0,q.pgFrom++),_.value&&q.pgFrom>r.value+(g.value?1:0)&&(q.ellipsesStart=!0,q.pgFrom++),g.value&&(q.boundaryEnd=!0,q.pgTo--),_.value&&q.pgTo<a.value-(g.value?1:0)&&(q.ellipsesEnd=!0,q.pgTo--)),q});function v(b){E.value=b}function p(b){E.value=E.value+b}const $=H(()=>{function b(){E.value=C.value,C.value=null}return{"onUpdate:modelValue":q=>{C.value=q},onKeyup:q=>{wo(q,13)===!0&&b()},onBlur:b}});function y(b,q,D){const S={"aria-label":q,"aria-current":"false",...pe.value,...b};return D===!0&&Object.assign(S,{"aria-current":"true",...j.value}),q!==void 0&&(e.toFn!==void 0?S.to=e.toFn(q):S.onClick=()=>{v(q)}),Y(L,S)}return Object.assign(n,{set:v,setByOffset:p}),()=>{const b=[],q=[];let D;if(h.value===!0&&(b.push(y({key:"bls",disable:e.disable||e.modelValue<=r.value,icon:A.value[0]},r.value)),q.unshift(y({key:"ble",disable:e.disable||e.modelValue>=a.value,icon:A.value[3]},a.value))),w.value===!0&&(b.push(y({key:"bdp",disable:e.disable||e.modelValue<=r.value,icon:A.value[1]},e.modelValue-1)),q.unshift(y({key:"bdn",disable:e.disable||e.modelValue>=a.value,icon:A.value[2]},e.modelValue+1))),e.input!==!0){D=[];const{pgFrom:S,pgTo:x,marginalStyle:T}=c.value;if(c.value.boundaryStart===!0){const R=r.value===e.modelValue;b.push(y({key:"bns",style:T,disable:e.disable,label:r.value},r.value,R))}if(c.value.boundaryEnd===!0){const R=a.value===e.modelValue;q.unshift(y({key:"bne",style:T,disable:e.disable,label:a.value},a.value,R))}c.value.ellipsesStart===!0&&b.push(y({key:"bes",style:T,disable:e.disable,label:"\u2026",ripple:!1},S-1)),c.value.ellipsesEnd===!0&&q.unshift(y({key:"bee",style:T,disable:e.disable,label:"\u2026",ripple:!1},x+1));for(let R=S;R<=x;R++)D.push(y({key:`bpg${R}`,style:T,disable:e.disable,label:R},R,R===e.modelValue))}return Y("div",{class:N.value,...F.value},[Y("div",{class:"q-pagination__content row no-wrap items-center",style:K.value},[...b,e.input===!0?Y(lt,{class:"inline",style:{width:`${l.value.length/1.5}em`},type:"number",dense:!0,value:C.value,disable:e.disable,dark:o.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:l.value,min:r.value,max:a.value,...$.value}):Y("div",{class:"q-pagination__middle row justify-center"},D),...q])])}}});function ot(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Jd(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const ra=6e4,aa=36e5,mi=43200,pr=1440;let ef={};function tf(){return ef}function yr(e){const t=ot(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function ki(e,t){const n=ot(e),i=ot(t),o=n.getTime()-i.getTime();return o<0?-1:o>0?1:o}function nf(e){return Jd(e,Date.now())}function of(e,t){const n=ot(e),i=ot(t),o=n.getFullYear()-i.getFullYear(),r=n.getMonth()-i.getMonth();return o*12+r}function rf(e){return t=>{const i=(e?Math[e]:Math.trunc)(t);return i===0?0:i}}function af(e,t){return+ot(e)-+ot(t)}function sf(e){const t=ot(e);return t.setHours(23,59,59,999),t}function lf(e){const t=ot(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function uf(e){const t=ot(e);return+sf(t)==+lf(t)}function cf(e,t){const n=ot(e),i=ot(t),o=ki(n,i),r=Math.abs(of(n,i));let a;if(r<1)a=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-o*r);let s=ki(n,i)===-o;uf(ot(e))&&r===1&&ki(e,i)===1&&(s=!1),a=o*(r-Number(s))}return a===0?0:a}function df(e,t,n){const i=af(e,t)/1e3;return rf(n?.roundingMethod)(i)}const ff={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},hf=(e,t,n)=>{let i;const o=ff[e];return typeof o=="string"?i=o:t===1?i=o.one:i=o.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function to(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const mf={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},gf={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},vf={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},pf={date:to({formats:mf,defaultWidth:"full"}),time:to({formats:gf,defaultWidth:"full"}),dateTime:to({formats:vf,defaultWidth:"full"})},yf={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},wf=(e,t,n,i)=>yf[e];function Fn(e){return(t,n)=>{const i=n?.context?String(n.context):"standalone";let o;if(i==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,s=n?.width?String(n.width):a;o=e.formattingValues[s]||e.formattingValues[a]}else{const a=e.defaultWidth,s=n?.width?String(n.width):e.defaultWidth;o=e.values[s]||e.values[a]}const r=e.argumentCallback?e.argumentCallback(t):t;return o[r]}}const _f={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bf={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kf={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Df={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Cf={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Mf={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Sf=(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},qf={ordinalNumber:Sf,era:Fn({values:_f,defaultWidth:"wide"}),quarter:Fn({values:bf,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Fn({values:kf,defaultWidth:"wide"}),day:Fn({values:Df,defaultWidth:"wide"}),dayPeriod:Fn({values:Cf,defaultWidth:"wide",formattingValues:Mf,defaultFormattingWidth:"wide"})};function zn(e){return(t,n={})=>{const i=n.width,o=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],r=t.match(o);if(!r)return null;const a=r[0],s=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(s)?Pf(s,w=>w.test(a)):Tf(s,w=>w.test(a));let h;h=e.valueCallback?e.valueCallback(l):l,h=n.valueCallback?n.valueCallback(h):h;const g=t.slice(a.length);return{value:h,rest:g}}}function Tf(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function Pf(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function $f(e){return(t,n={})=>{const i=t.match(e.matchPattern);if(!i)return null;const o=i[0],r=t.match(e.parsePattern);if(!r)return null;let a=e.valueCallback?e.valueCallback(r[0]):r[0];a=n.valueCallback?n.valueCallback(a):a;const s=t.slice(o.length);return{value:a,rest:s}}}const xf=/^(\d+)(th|st|nd|rd)?/i,Ef=/\d+/i,Af={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},If={any:[/^b/i,/^(a|c)/i]},Rf={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Uf={any:[/1/i,/2/i,/3/i,/4/i]},Nf={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Of={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Lf={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Bf={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Vf={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ff={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},zf={ordinalNumber:$f({matchPattern:xf,parsePattern:Ef,valueCallback:e=>parseInt(e,10)}),era:zn({matchPatterns:Af,defaultMatchWidth:"wide",parsePatterns:If,defaultParseWidth:"any"}),quarter:zn({matchPatterns:Rf,defaultMatchWidth:"wide",parsePatterns:Uf,defaultParseWidth:"any",valueCallback:e=>e+1}),month:zn({matchPatterns:Nf,defaultMatchWidth:"wide",parsePatterns:Of,defaultParseWidth:"any"}),day:zn({matchPatterns:Lf,defaultMatchWidth:"wide",parsePatterns:Bf,defaultParseWidth:"any"}),dayPeriod:zn({matchPatterns:Vf,defaultMatchWidth:"any",parsePatterns:Ff,defaultParseWidth:"any"})},jf={code:"en-US",formatDistance:hf,formatLong:pf,formatRelative:wf,localize:qf,match:zf,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Wf(e,t,n){const i=tf(),o=n?.locale??i.locale??jf,r=2520,a=ki(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const s=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:a});let l,h;a>0?(l=ot(t),h=ot(e)):(l=ot(e),h=ot(t));const g=df(h,l),w=(yr(h)-yr(l))/1e3,_=Math.round((g-w)/60);let C;if(_<2)return n?.includeSeconds?g<5?o.formatDistance("lessThanXSeconds",5,s):g<10?o.formatDistance("lessThanXSeconds",10,s):g<20?o.formatDistance("lessThanXSeconds",20,s):g<40?o.formatDistance("halfAMinute",0,s):g<60?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",1,s):_===0?o.formatDistance("lessThanXMinutes",1,s):o.formatDistance("xMinutes",_,s);if(_<45)return o.formatDistance("xMinutes",_,s);if(_<90)return o.formatDistance("aboutXHours",1,s);if(_<pr){const E=Math.round(_/60);return o.formatDistance("aboutXHours",E,s)}else{if(_<r)return o.formatDistance("xDays",1,s);if(_<mi){const E=Math.round(_/pr);return o.formatDistance("xDays",E,s)}else if(_<mi*2)return C=Math.round(_/mi),o.formatDistance("aboutXMonths",C,s)}if(C=cf(h,l),C<12){const E=Math.round(_/mi);return o.formatDistance("xMonths",E,s)}else{const E=C%12,N=Math.trunc(C/12);return E<3?o.formatDistance("aboutXYears",N,s):E<9?o.formatDistance("overXYears",N,s):o.formatDistance("almostXYears",N+1,s)}}function sa(e,t){return Wf(e,nf(e),t)}function la(e,t){const n=t?.additionalDigits??2,i=Xf(e);let o;if(i.date){const l=Gf(i.date,n);o=Yf(l.restDateString,l.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);const r=o.getTime();let a=0,s;if(i.time&&(a=Zf(i.time),isNaN(a)))return new Date(NaN);if(i.timezone){if(s=Jf(i.timezone),isNaN(s))return new Date(NaN)}else{const l=new Date(r+a),h=new Date(0);return h.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),h.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),h}return new Date(r+a+s)}const gi={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Hf=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Kf=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Qf=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Xf(e){const t={},n=e.split(gi.dateTimeDelimiter);let i;if(n.length>2)return t;if(/:/.test(n[0])?i=n[0]:(t.date=n[0],i=n[1],gi.timeZoneDelimiter.test(t.date)&&(t.date=e.split(gi.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const o=gi.timezone.exec(i);o?(t.time=i.replace(o[1],""),t.timezone=o[1]):t.time=i}return t}function Gf(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(n);if(!i)return{year:NaN,restDateString:""};const o=i[1]?parseInt(i[1]):null,r=i[2]?parseInt(i[2]):null;return{year:r===null?o:r*100,restDateString:e.slice((i[1]||i[2]).length)}}function Yf(e,t){if(t===null)return new Date(NaN);const n=e.match(Hf);if(!n)return new Date(NaN);const i=!!n[4],o=jn(n[1]),r=jn(n[2])-1,a=jn(n[3]),s=jn(n[4]),l=jn(n[5])-1;if(i)return oh(t,s,l)?eh(t,s,l):new Date(NaN);{const h=new Date(0);return!nh(t,r,a)||!ih(t,o)?new Date(NaN):(h.setUTCFullYear(t,r,Math.max(o,a)),h)}}function jn(e){return e?parseInt(e):1}function Zf(e){const t=e.match(Kf);if(!t)return NaN;const n=no(t[1]),i=no(t[2]),o=no(t[3]);return rh(n,i,o)?n*aa+i*ra+o*1e3:NaN}function no(e){return e&&parseFloat(e.replace(",","."))||0}function Jf(e){if(e==="Z")return 0;const t=e.match(Qf);if(!t)return 0;const n=t[1]==="+"?-1:1,i=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return ah(i,o)?n*(i*aa+o*ra):NaN}function eh(e,t,n){const i=new Date(0);i.setUTCFullYear(e,0,4);const o=i.getUTCDay()||7,r=(t-1)*7+n+1-o;return i.setUTCDate(i.getUTCDate()+r),i}const th=[31,null,31,30,31,30,31,31,30,31,30,31];function ua(e){return e%400===0||e%4===0&&e%100!==0}function nh(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(th[t]||(ua(e)?29:28))}function ih(e,t){return t>=1&&t<=(ua(e)?366:365)}function oh(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function rh(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function ah(e,t){return t>=0&&t<=59}const sh=Oe({name:"InvoicesTable",mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5,filterPending:!1}},watch:{filterPending:function(){this.currentPage=1}},computed:{...ve($e,["showInvoiceDetails"]),...ve(Xe,["invoiceHistory","invoiceData","payInvoiceData"]),maxPages(){return Math.ceil(this.invoiceHistory.length/this.pageSize)},paginatedInvoices(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filterPending?this.invoiceHistory.filter(n=>n.status==="pending").slice(e,t):this.invoiceHistory.slice().reverse().slice(e,t)}},methods:{...ce(Xe,["checkInvoice","mintOnPaid","checkOutgoingInvoice"]),shortenString:function(e){return Mo(e,20,10)},handlePageChange(e){this.currentPage=e},showInvoiceDialog:async function(e){if(this.invoiceData=e,this.showInvoiceDetails=!0,e.status==="pending")try{await this.checkInvoice(e.quote,!1,!1)}catch{this.mintOnPaid(e.quote,!1,!0,!1)}},formattedDate(e){const t=la(e);return sa(t,{addSuffix:!1})}},created:function(){}}),lh={style:{"max-width":"1000px",margin:"0 auto"}},uh={class:"q-pa-xs",style:{"max-width":"500px",margin:"0 auto"}},ch={class:"text-center q-mt-lg"},dh={key:0,class:"text-center q-mt-lg"},fh={key:1,class:"text-center q-mt-lg"},hh={style:{display:"flex","justify-content":"center"}};function mh(e,t,n,i,o,r){return M(),V("div",lh,[f("div",uh,[u(Kn,null,{default:m(()=>[(M(!0),V(at,null,Ot(e.paginatedInvoices,a=>(M(),W(gt,{key:a.id},{default:m(()=>[u(dt,{side:"",onClick:s=>e.showInvoiceDialog(a),style:{width:"140px"},class:"q-pr-none items-center"},{default:m(()=>[u(Ie,{class:"text-weight-bold"},{default:m(()=>[u(me,{name:a.amount>=0?"call_received":"call_made",color:a.status==="paid"?a.amount>=0?"green":"red":"",class:"q-mr-xs",size:"xs"},null,8,["name","color"]),I(" "+ae(e.formatCurrency(a.amount,a.unit)),1)]),_:2},1024)]),_:2},1032,["onClick"]),u(dt,null,{default:m(()=>[u(Ie,{onClick:s=>e.showInvoiceDialog(a)},{default:m(()=>[I(" Lightning "),u(Ze,null,{default:m(()=>[I("Click to copy")]),_:1})]),_:2},1032,["onClick"]),u(Ie,{caption:""},{default:m(()=>[I(ae(e.formattedDate(a.date))+" ago",1)]),_:2},1024)]),_:2},1024),u(dt,{side:"",top:""},{default:m(()=>[a.status==="pending"?(M(),W(L,{key:0,flat:"",dense:"",icon:"sync",onClick:s=>a.amount>0?e.checkInvoice(a.quote,!0):e.checkOutgoingInvoice(a.quote,!0),class:"cursor-pointer",style:{position:"absolute",right:"0"}},{default:m(()=>[u(Ze,null,{default:m(()=>[I("Check status")]),_:1})]),_:2},1032,["onClick"])):z("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),f("div",ch,[u(L,{rounded:"",outline:"",dense:"",onClick:t[0]||(t[0]=a=>e.filterPending=!e.filterPending),color:e.filterPending?"primary":"grey",label:e.filterPending?"Show all":"Filter pending",class:"q-ml-sm q-px-md",size:"sm"},null,8,["color","label"])]),e.paginatedInvoices.length===0?(M(),V("div",dh,[u(Ie,{caption:"",class:"text-primary"},{default:m(()=>[I("No invoices yet")]),_:1})])):e.maxPages>1?(M(),V("div",fh,[f("div",hh,[u(oa,{modelValue:e.currentPage,"onUpdate:modelValue":t[1]||(t[1]=a=>e.currentPage=a),max:e.maxPages,"max-pages":5,"direction-links":"","boundary-links":"",onInput:e.handlePageChange},null,8,["modelValue","max","onInput"])])])):z("",!0)])])}var gh=Ee(sh,[["render",mh]]);const vh=Oe({name:"HistoryTable",mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5,filterPending:!1}},watch:{filterPending:function(){this.currentPage=1}},computed:{...de(Gt,["historyTokens"]),...ve(At,["showReceiveTokens","receiveData"]),...ve(ni,["showSendTokens","sendData","showLockInput"]),maxPages(){return Math.ceil(this.historyTokens.length/this.pageSize)},paginatedTokens(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filterPending?this.historyTokens.filter(n=>n.status==="pending").slice().reverse().slice(e,t):this.historyTokens.slice().reverse().slice(e,t)}},methods:{...ce(Xe,["checkTokenSpendable"]),formattedDate(e){const t=la(e);return sa(t,{addSuffix:!1})},shortenString:function(e){return Mo(e,20,10)},handlePageChange(e){this.currentPage=e},receiveToken(e){this.receiveData.tokensBase64=e,this.showReceiveTokens=!0},showTokenDialog:function(e){if(e.token===void 0){Hr("Old token not found");return}const t=e.token;console.log("##### showTokenDialog");const n=Se.decode(t);this.sendData.tokens=Se.getProofs(n),this.sendData.tokensBase64=sl(t),this.sendData.paymentRequest=e.paymentRequest,this.sendData.historyAmount=e.amount,this.showSendTokens=!0}},created:function(){}}),ph={class:"q-pa-xs",style:{"max-width":"500px",margin:"0 auto"}},yh={class:"text-center q-mt-lg"},wh={key:0,class:"text-center q-mt-lg"},_h={key:1,class:"text-center q-mt-lg"},bh={style:{display:"flex","justify-content":"center"}};function kh(e,t,n,i,o,r){return M(),V("div",ph,[u(Kn,null,{default:m(()=>[(M(!0),V(at,null,Ot(e.paginatedTokens,a=>Fe((M(),W(gt,{key:a.id,clickable:"",class:"q-px-md"},{default:m(()=>[u(dt,{side:"",onClick:s=>e.showTokenDialog(a),style:{width:"140px"},class:"q-pr-none items-center"},{default:m(()=>[u(Ie,{class:"text-weight-bold"},{default:m(()=>[u(me,{name:a.amount>=0?"call_received":"call_made",color:a.status==="paid"?a.amount>=0?"green":"red":"",class:"q-mr-xs",size:"xs"},null,8,["name","color"]),f("span",null,ae(e.formatCurrency(a.amount,a.unit)),1)]),_:2},1024)]),_:2},1032,["onClick"]),u(dt,{class:"items-center q-pl-lg",onClick:s=>e.showTokenDialog(a),style:{width:"300px"}},{default:m(()=>[u(Ie,null,{default:m(()=>[I(" Ecash ")]),_:1}),u(Ie,{caption:""},{default:m(()=>[I(ae(e.formattedDate(a.date))+" ago",1)]),_:2},1024)]),_:2},1032,["onClick"]),u(dt,{side:"",top:""},{default:m(()=>[a.status==="pending"&&a.amount<0?(M(),W(L,{key:0,flat:"",dense:"",icon:"sync",onClick:s=>e.checkTokenSpendable(a),class:"cursor-pointer",style:{position:"absolute",right:"0"}},{default:m(()=>[u(Ze,null,{default:m(()=>[I("Check status")]),_:1})]),_:2},1032,["onClick"])):z("",!0),a.status==="pending"&&a.amount>0?(M(),W(L,{key:1,flat:"",dense:"",icon:"arrow_circle_down",onClick:s=>e.receiveToken(a.token),class:"cursor-pointer",style:{position:"absolute",right:"0"}},{default:m(()=>[u(Ze,null,{default:m(()=>[I("Receive")]),_:1})]),_:2},1032,["onClick"])):z("",!0)]),_:2},1024)]),_:2},1024)),[[yo]])),128))]),_:1}),f("div",yh,[u(L,{rounded:"",outline:"",dense:"",onClick:t[0]||(t[0]=a=>e.filterPending=!e.filterPending),color:e.filterPending?"primary":"grey",label:e.filterPending?"Show all":"Filter pending",class:"q-ml-sm q-px-md",size:"sm"},null,8,["color","label"])]),e.paginatedTokens.length===0?(M(),V("div",wh,[u(Ie,{caption:"",class:"text-primary"},{default:m(()=>[I("No history yet")]),_:1})])):e.maxPages>1?(M(),V("div",_h,[f("div",bh,[u(oa,{modelValue:e.currentPage,"onUpdate:modelValue":t[1]||(t[1]=a=>e.currentPage=a),max:e.maxPages,"max-pages":5,"direction-links":"","boundary-links":"",onInput:e.handlePageChange},null,8,["modelValue","max","onInput"])])])):z("",!0)])}var Dh=Ee(vh,[["render",kh]]);const Ch=Oe({name:"NoMintWarnBanner",mixins:[windowMixin],props:{proofs:Array,activeProofs:Array,mints:Array,tickerShort:String,activeMintUrl:String},computed:{...ve($e,["tab","expandHistory","showReceiveEcashDrawer"]),...ve(At,["showReceiveTokens","receiveData"]),balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)},getActiveMintUrlShort:function(){return Lt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.map(t=>t).flat().reduce((t,n)=>t+=n.amount,0);return e}},methods:{handleReceiveEcash:function(){this.showReceiveEcashDrawer=!0},handleAddMintClick:function(){this.expandHistory=!0,this.tab="mints",ho.emit("scrollToAddMintDiv")}}}),ca=e=>(Ft("data-v-4782cc90"),e=e(),zt(),e),Mh={class:"row items-center justify-center"},Sh=ca(()=>f("div",{class:"row items-center justify-center"},[f("div",{class:"text-h6"},"Join a mint")],-1)),qh=ca(()=>f("div",{class:"row items-center justify-center"},[f("div",{class:"text-subtitle2"}," You haven't joined any Cashu mint yet. Add a mint URL in the settings or receive ecash from a new mint to get started. ")],-1)),Th={class:"row items-center justify-center q-pt-lg"},Ph={class:"row items-center justify-center q-pt-md"};function $h(e,t,n,i,o,r){return M(),W(ct,{class:"q-ma-lg bg-dark q-pa-md"},{default:m(()=>[u(st,null,{default:m(()=>[f("div",Mh,[u(me,{color:"primary",class:"q-pb-md",name:"account_balance",size:"50px"})]),Sh,qh,f("div",Th,[u(L,{rounded:"",color:"primary",class:"q-px-md",label:"Add mint",onClick:e.handleAddMintClick},null,8,["onClick"])]),f("div",Ph,[u(L,{outline:"",rounded:"",color:"primary",class:"q-px-md",label:"Receive Ecash",onClick:e.handleReceiveEcash},null,8,["onClick"])])]),_:1})]),_:1})}var xh=Ee(Ch,[["render",$h],["__scopeId","data-v-4782cc90"]]);const Eh=Oe({name:"WelcomeDialog",mixins:[windowMixin],props:{welcomeDialog:Object,triggerPwaInstall:Function,setTab:Function,getPwaDisplayMode:Function,setWelcomeDialogSeen:Function},data:function(){return{}},watch:{},computed:{...de(Xe,["mnemonic"])},methods:{...ce(Kr,["restoreFromBackup"]),readFile(e){let t=new FileReader;t.onload=n=>{let i=n.target.result,o=JSON.parse(i);this.restoreFromBackup(o)},t.readAsText(e)},dragFile(e){e.preventDefault();let n=e.dataTransfer.files[0];this.readFile(n)},allowDrop(e){e.preventDefault()},onChangeFileUpload(){let e=this.$refs.fileUpload.files[0];this.readFile(e)},browseBackupFile(){this.$refs.fileUpload.click()}}}),ii=e=>(Ft("data-v-23b95ce0"),e=e(),zt(),e),Ah=ii(()=>f("span",{class:"text-weight-bold"},"Cashu",-1)),Ih=ii(()=>f("p",null,"Please take a moment to read the following information.",-1)),Rh=ii(()=>f("p",null,[f("strong",null,"Install and add to home screen."),I(" For the best experience, use this wallet with your device's native web browser (Safari on iOS, Chrome on Android). In Chrome click the hamburger menu at the upper right. In Safari click the share button and press the Add to Home screen button. ")],-1)),Uh=ii(()=>f("p",null,[f("strong",null,"Back up your seed phrase."),I(" This wallet stores ecash tokens in its database. If you delete your browser data without backing up, you will lose your tokens. Make sure to back up your wallet seed phrase in the settings. ")],-1)),Nh=ii(()=>f("p",null,[f("strong",null,"This software is in BETA!"),I(" We hold no responsibility for people losing access to funds. Use at your own risk! This wallet is not affiliated with any mint. This code is open-source and licensed under the MIT license. ")],-1)),Oh={class:"row q-mt-lg"};function Lh(e,t,n,i,o,r){return M(),W(ut,{class:"z-top",persistent:"",position:"top",onDrop:e.dragFile,onDragover:e.allowDrop,"backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"q-pa-lg z-top"},{default:m(()=>[u(Dl,null,{default:m(()=>[u(kl,null,{default:m(()=>[Ah,I(" ecash wallet")]),_:1})]),_:1}),u(st,null,{default:m(()=>[Ih,Rh,Uh,Nh,f("input",{type:"file",id:"fileUpload",ref:"fileUpload",onChange:t[0]||(t[0]=a=>e.onChangeFileUpload())},null,544),f("div",Oh,[e.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?(M(),W(L,{key:0,outline:"",class:"q-mx-sm",color:"primary",onClick:t[1]||(t[1]=a=>e.triggerPwaInstall())},{default:m(()=>[I("Install Cashu")]),_:1})):z("",!0),u(L,{flat:"",size:"0.6rem",class:"q-mx-xs q-px-none",onClick:t[2]||(t[2]=a=>e.copyText(e.baseURL))},{default:m(()=>[I("Copy URL")]),_:1}),u(L,{flat:"",size:"0.6rem",class:"q-mx-xs q-px-none",color:"warning",icon:"upload_for_offline",onClick:e.browseBackupFile},{default:m(()=>[I("Restore"),u(Ze,null,{default:m(()=>[I("You can drag & drop the wallet backup here!")]),_:1})]),_:1},8,["onClick"]),Fe((M(),W(L,{outline:"",size:"0.8rem",class:"q-ml-auto",onClick:t[3]||(t[3]=a=>e.setWelcomeDialogSeen())},{default:m(()=>[I("Continue")]),_:1})),[[He]])])]),_:1})]),_:1})]),_:1},8,["onDrop","onDragover"])}var Bh=Ee(Eh,[["render",Lh],["__scopeId","data-v-23b95ce0"]]);const Vh=[Y("circle",{cx:"15",cy:"15",r:"15"},[Y("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Y("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})]),Y("circle",{cx:"60",cy:"15",r:"9","fill-opacity":".3"},[Y("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),Y("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})]),Y("circle",{cx:"105",cy:"15",r:"15"},[Y("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),Y("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})])];var Fh=Ct({name:"QSpinnerDots",props:Cs,setup(e){const{cSize:t,classes:n}=Ms(e);return()=>Y("svg",{class:n.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"},Vh)}});const zh=Oe({name:"TokenInformation",mixins:[windowMixin],props:{encodedToken:String,showAmount:Boolean,showMintCheck:Boolean,showP2PKCheck:Boolean},data:function(){return{}},watch:{},computed:{...de(De,["activeMintUrl","activeProofs","mints","activeUnit","addMintBlocking"]),proofsToShow:function(){return Se.getProofs(Se.decode(this.encodedToken))},sumProofs:function(){return Se.getProofs(Se.decode(this.encodedToken)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return Se.getUnit(Se.decode(this.encodedToken))},tokenMintUrl:function(){let e=Se.getMint(Se.decode(this.encodedToken));return Lt(e)},displayMemo:function(){return Se.getMemo(Se.decode(this.encodedToken))}},methods:{...ce(Bt,["isLocked","isLockedToUs"]),getProofsMint:function(e){let t=[...new Set(e.map(o=>o.id))],i=this.mints.filter(o=>o.keysets.some(r=>t.indexOf(r)>=0)).map(o=>[{url:o.url,ids:o.keysets}][0]);return i.length==0?"":Lt(i[0].url)},mintKnownToUs:function(e){let t=[...new Set(e.map(n=>n.id))];return this.mints.filter(n=>n.keysets.some(i=>t.indexOf(i.id)>=0)).length>0}}}),jh={class:"row text-left q-py-none q-my-none"},Wh={class:"col-12 q-px-none"},Hh={key:2,class:"q-my-md"};function Kh(e,t,n,i,o,r){return M(),V("div",jh,[f("div",Wh,[e.showAmount?(M(),W(cn,{key:0,outline:"",class:"q-pa-md",style:{"border-width":"2px"}},{default:m(()=>[u(me,{name:"toll",size:"xs",class:"q-mr-sm"}),f("strong",null,ae(e.displayUnit),1)]),_:1})):z("",!0),u(cn,{outline:"",class:"q-pa-md",style:{height:"36px","font-family":"monospace"}},{default:m(()=>[u(me,{name:"account_balance",size:"xs",class:"q-mr-xs"}),I(" "+ae(e.tokenMintUrl)+" ",1),e.addMintBlocking?(M(),W(Rt,{key:0,size:"sm",class:"q-ml-sm"})):z("",!0),e.showMintCheck&&e.mintKnownToUs(e.proofsToShow)&&!e.addMintBlocking?(M(),W(me,{key:1,name:"check",size:"sm",color:"green",class:"q-ml-xs"})):z("",!0)]),_:1}),e.isLocked(e.proofsToShow)?(M(),W(cn,{key:1,outline:"",icon:"lock",class:"q-pa-md"},{default:m(()=>[I(" P2PK "),e.showP2PKCheck||e.isLockedToUs(e.proofsToShow)?(M(),W(me,{key:0,name:e.isLockedToUs(e.proofsToShow)?"check":"close",size:"sm",color:e.isLockedToUs(e.proofsToShow)?"green":"red",class:"q-ml-xs"},null,8,["name","color"])):z("",!0)]),_:1})):z("",!0),e.displayMemo?(M(),V("div",Hh,[u(me,{name:"chat",size:"xs",color:"grey",class:"q-mr-sm"}),f("span",null,ae(e.displayMemo),1)])):z("",!0)])])}var da=Ee(zh,[["render",Kh]]),Qe={},Ut,Nt;function mo(){throw new Error("setTimeout has not been defined")}function go(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ut=setTimeout:Ut=mo}catch{Ut=mo}try{typeof clearTimeout=="function"?Nt=clearTimeout:Nt=go}catch{Nt=go}})();function fa(e){if(Ut===setTimeout)return setTimeout(e,0);if((Ut===mo||!Ut)&&setTimeout)return Ut=setTimeout,setTimeout(e,0);try{return Ut(e,0)}catch{try{return Ut.call(null,e,0)}catch{return Ut.call(this,e,0)}}}function Qh(e){if(Nt===clearTimeout)return clearTimeout(e);if((Nt===go||!Nt)&&clearTimeout)return Nt=clearTimeout,clearTimeout(e);try{return Nt(e)}catch{try{return Nt.call(null,e)}catch{return Nt.call(this,e)}}}var Xt=[],$n=!1,un,Di=-1;function Xh(){!$n||!un||($n=!1,un.length?Xt=un.concat(Xt):Di=-1,Xt.length&&ha())}function ha(){if(!$n){var e=fa(Xh);$n=!0;for(var t=Xt.length;t;){for(un=Xt,Xt=[];++Di<t;)un&&un[Di].run();Di=-1,t=Xt.length}un=null,$n=!1,Qh(e)}}Qe.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Xt.push(new ma(e,t)),Xt.length===1&&!$n&&fa(ha)};function ma(e,t){this.fun=e,this.array=t}ma.prototype.run=function(){this.fun.apply(null,this.array)};Qe.title="browser";Qe.browser=!0;Qe.env={};Qe.argv=[];Qe.version="";Qe.versions={};function Yt(){}Qe.on=Yt;Qe.addListener=Yt;Qe.once=Yt;Qe.off=Yt;Qe.removeListener=Yt;Qe.removeAllListeners=Yt;Qe.emit=Yt;Qe.prependListener=Yt;Qe.prependOnceListener=Yt;Qe.listeners=function(e){return[]};Qe.binding=function(e){throw new Error("process.binding is not supported")};Qe.cwd=function(){return"/"};Qe.chdir=function(e){throw new Error("process.chdir is not supported")};Qe.umask=function(){return 0};const Gh=Oe({name:"ChooseMint",mixins:[windowMixin],props:{rounded:{type:Boolean,default:!1},title:{type:String,default:"Select a mint"},style:{type:String,default:""}},data:function(){return{chosenMint:null}},mounted(){const e=this.mints.find(n=>n.url===this.activeMintUrl),t=new Gn(e);this.chosenMint={url:this.activeMintUrl,nickname:t.mint.nickname||t.mint.info?.name,shorturl:Lt(this.activeMintUrl),errored:t.mint.errored}},watch:{chosenMint:async function(){this.activeMintUrl=this.chosenMint.url}},computed:{...de(De,["activeMintUrl","activeProofs","mints","activeUnit"]),...ve(De,["activeMintUrl"]),getBalance:function(){return this.activeProofs.flat().reduce((e,t)=>e+=t.amount,0)}},methods:{...ce(De,["activateMintUrl"]),chooseMintOptions:function(){let e=[];for(const[t,n]of Object.entries(this.mints)){const i=n.keysets.map(a=>a.unit),o=[...new Set(i)],r=new Gn(n);e.push({nickname:r.mint.nickname||r.mint.info?.name,url:r.mint.url,shorturl:Lt(n.url),balances:r.allBalances,errored:r.mint.errored,units:o})}return e}}}),Yh={class:"q-pb-md"},Zh={key:0,class:"row q-mb-none"},Jh={class:"col-12"},em={class:"text-caption"},tm={key:1,class:"row q-mt-xs q-mb-none"},nm={class:"col-12 cursor-pointer"},im={key:0,class:"error-badge"},om={class:"row items-center"};function rm(e,t,n,i,o,r){return M(),V("div",Yh,[e.title.length?(M(),V("div",Zh,[f("div",Jh,[f("span",em,ae(e.title),1)])])):z("",!0),e.activeMintUrl?(M(),V("div",tm,[f("div",nm,[u(fo,{outlined:"",class:"q-px-none",color:"white",modelValue:e.chosenMint,"onUpdate:modelValue":t[0]||(t[0]=a=>e.chosenMint=a),options:e.chooseMintOptions(),"option-value":"url","option-label":"nickname",rounded:e.rounded,style:Ti(e.style)},{option:m(a=>[u(gt,Ss(qs(a.itemProps)),{default:m(()=>[u(dt,null,{default:m(()=>[u(Ie,{class:"text-body1 q-pt-xs",style:Ti(e.activeMintUrl===a.opt.url?"font-weight: bold":"")},{default:m(()=>[I(ae(a.opt.nickname||a.opt.shorturl),1)]),_:2},1032,["style"]),u(Ie,{class:"text-caption q-pb-xs",style:{"font-family":"monospace","font-size":"11px"}},{default:m(()=>[I(ae(a.opt.url),1)]),_:2},1024),f("div",null,[(M(!0),V(at,null,Ot(a.opt.units,s=>(M(),W($t,{key:s,color:a.opt.url===e.activeMintUrl?"primary":"grey",label:e.formatCurrency(a.opt.balances[s],s),class:"q-mr-xs q-mb-xs"},null,8,["color","label"]))),128)),a.opt.errored?(M(),V("div",im,[u($t,{color:"red",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:m(()=>[I(" Error "),u(me,{name:"error",class:"q-ml-xs"})]),_:1})])):z("",!0)])]),_:2},1024)]),_:2},1040),u(jr)]),prepend:m(()=>[u(me,{name:"account_balance",size:"1.2rem",color:"grey",class:"q-mr-none q-mb-none"})]),append:m(()=>[f("div",om,[e.chosenMint?.errored?(M(),W($t,{key:0,color:"red",class:"q-mr-xs text-weight-bold"},{default:m(()=>[I(" Error "),u(me,{name:"error",class:"q-ml-xs"})]),_:1})):z("",!0),u($t,{color:"primary",label:e.formatCurrency(e.getBalance,e.activeUnit),class:"q-ma-xs q-pa-sm text-weight-bold"},null,8,["label"])])]),_:1},8,["modelValue","options","rounded","style"])])])):z("",!0)])}var Bi=Ee(Gh,[["render",rm]]),oi=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(i[r]=o[r])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),wr=function(e){oi(t,e);function t(){var n=e.call(this,"Invalid Scheme")||this;return n.name="InvalidSchemeError",n}return t}(Error),io=function(e){oi(t,e);function t(){var n=e.call(this,"Invalid Path")||this;return n.name="InvalidPathLengthError",n}return t}(Error),ga=function(e){oi(t,e);function t(){var n=e.call(this,"Invalid Type")||this;return n.name="InvalidTypeError",n}return t}(Error),_r=function(e){oi(t,e);function t(){var n=e.call(this,"Invalid Sequence Component")||this;return n.name="InvalidSequenceComponentError",n}return t}(Error),am=function(e){oi(t,e);function t(){var n=e.call(this,"Invalid Checksum")||this;return n.name="InvalidChecksumError",n}return t}(Error),sm=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}(),va=function(e){for(var t=-1,n=0;n<e.length;n++)t=t>>>8^sm[(t^e[n])&255];return(t^-1)>>>0},lm=function(e){return Ne.Buffer.from(ll(e))},um=function(e,t){return e.match(new RegExp(".{1,"+t+"}","g"))||[e]},pa=function(e,t){return[e.slice(0,-t),e.slice(-t)]},ya=function(e){return va(e)},wa=function(e){return va(e).toString(16).padStart(8,"0")},vo=function(e){return e>>>0},br=function(e){var t=new ArrayBuffer(4),n=new DataView(t);return n.setUint32(0,e,!1),Ne.Buffer.from(t)},Ci=function(e){return e.split("").every(function(t,n){var i=e.charCodeAt(n);return"a".charCodeAt(0)<=i&&i<="z".charCodeAt(0)||"0".charCodeAt(0)<=i&&i<="9".charCodeAt(0)||i==="-".charCodeAt(0)})},kr=function(e,t){return e.length!==t.length?!1:e.every(function(n){return t.includes(n)})},cm=function(e,t){return t.every(function(n){return e.includes(n)})},dm=function(e,t){return e.filter(function(n){return t.indexOf(n)<0})},_a=function(e,t){for(var n=Math.max(e.length,t.length),i=Ne.Buffer.allocUnsafe(n),o=0;o<n;++o)i[o]=e[o]^t[o];return i};const fm=["string","number","bigint","symbol"],hm=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function mm(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(fm.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(gm(e))return"Buffer";const n=vm(e);return n||"Object"}function gm(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function vm(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(hm.includes(t))return t}class B{constructor(t,n,i){this.major=t,this.majorEncoded=t<<5,this.name=n,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}B.uint=new B(0,"uint",!0);B.negint=new B(1,"negint",!0);B.bytes=new B(2,"bytes",!0);B.string=new B(3,"string",!0);B.array=new B(4,"array",!1);B.map=new B(5,"map",!1);B.tag=new B(6,"tag",!1);B.float=new B(7,"float",!0);B.false=new B(7,"false",!0);B.true=new B(7,"true",!0);B.null=new B(7,"null",!0);B.undefined=new B(7,"undefined",!0);B.break=new B(7,"break",!0);class he{constructor(t,n,i){this.type=t,this.value=n,this.encodedLength=i,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const In=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",pm=new TextDecoder,ym=new TextEncoder;function Pi(e){return In&&globalThis.Buffer.isBuffer(e)}function ba(e){return e instanceof Uint8Array?Pi(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const wm=In?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Cr(e,t,n):(e,t,n)=>n-t>64?pm.decode(e.subarray(t,n)):Cr(e,t,n),_m=In?e=>e.length>64?globalThis.Buffer.from(e):Dr(e):e=>e.length>64?ym.encode(e):Dr(e),Ht=e=>Uint8Array.from(e),To=In?(e,t,n)=>Pi(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),bm=In?(e,t)=>(e=e.map(n=>n instanceof Uint8Array?n:globalThis.Buffer.from(n)),ba(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let i=0;for(let o of e)i+o.length>n.length&&(o=o.subarray(0,n.length-i)),n.set(o,i),i+=o.length;return n},km=In?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Dm(e,t){if(Pi(e)&&Pi(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function Dr(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let o=e.charCodeAt(i);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128)}return t}function Cr(e,t,n){const i=[];for(;t<n;){const o=e[t];let r=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=n){let s,l,h,g;switch(a){case 1:o<128&&(r=o);break;case 2:s=e[t+1],(s&192)===128&&(g=(o&31)<<6|s&63,g>127&&(r=g));break;case 3:s=e[t+1],l=e[t+2],(s&192)===128&&(l&192)===128&&(g=(o&15)<<12|(s&63)<<6|l&63,g>2047&&(g<55296||g>57343)&&(r=g));break;case 4:s=e[t+1],l=e[t+2],h=e[t+3],(s&192)===128&&(l&192)===128&&(h&192)===128&&(g=(o&15)<<18|(s&63)<<12|(l&63)<<6|h&63,g>65535&&g<1114112&&(r=g))}}r===null?(r=65533,a=1):r>65535&&(r-=65536,i.push(r>>>10&1023|55296),r=56320|r&1023),i.push(r),t+=a}return Cm(i)}const Mr=4096;function Cm(e){const t=e.length;if(t<=Mr)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=Mr));return n}const Mm=256;class ka{constructor(t=Mm){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let n=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const o=n.length-(this.maxCursor-this.cursor)-1;n.set(t,o)}else{if(n){const o=n.length-(this.maxCursor-this.cursor)-1;o<n.length&&(this.chunks[this.chunks.length-1]=n.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(n=km(this.chunkSize),this.chunks.push(n),this.maxCursor+=n.length,this._initReuseChunk===null&&(this._initReuseChunk=n),n.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let n;if(this.chunks.length===1){const i=this.chunks[0];t&&this.cursor>i.length/2?(n=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):n=To(i,0,this.cursor)}else n=bm(this.chunks,this.cursor);return t&&this.reset(),n}}const Ce="CBOR decode error:",Da="CBOR encode error:";function Rn(e,t,n){if(e.length-t<n)throw new Error(`${Ce} not enough data for type`)}const it=[24,256,65536,4294967296,BigInt("18446744073709551616")];function mn(e,t,n){Rn(e,t,1);const i=e[t];if(n.strict===!0&&i<it[0])throw new Error(`${Ce} integer encoded in more bytes than necessary (strict decode)`);return i}function gn(e,t,n){Rn(e,t,2);const i=e[t]<<8|e[t+1];if(n.strict===!0&&i<it[1])throw new Error(`${Ce} integer encoded in more bytes than necessary (strict decode)`);return i}function vn(e,t,n){Rn(e,t,4);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(n.strict===!0&&i<it[2])throw new Error(`${Ce} integer encoded in more bytes than necessary (strict decode)`);return i}function pn(e,t,n){Rn(e,t,8);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],r=(BigInt(i)<<BigInt(32))+BigInt(o);if(n.strict===!0&&r<it[3])throw new Error(`${Ce} integer encoded in more bytes than necessary (strict decode)`);if(r<=Number.MAX_SAFE_INTEGER)return Number(r);if(n.allowBigInt===!0)return r;throw new Error(`${Ce} integers outside of the safe integer range are not supported`)}function Sm(e,t,n,i){return new he(B.uint,mn(e,t+1,i),2)}function qm(e,t,n,i){return new he(B.uint,gn(e,t+1,i),3)}function Tm(e,t,n,i){return new he(B.uint,vn(e,t+1,i),5)}function Pm(e,t,n,i){return new he(B.uint,pn(e,t+1,i),9)}function yn(e,t){return Mt(e,0,t.value)}function Mt(e,t,n){if(n<it[0]){const i=Number(n);e.push([t|i])}else if(n<it[1]){const i=Number(n);e.push([t|24,i])}else if(n<it[2]){const i=Number(n);e.push([t|25,i>>>8,i&255])}else if(n<it[3]){const i=Number(n);e.push([t|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{const i=BigInt(n);if(i<it[4]){const o=[t|27,0,0,0,0,0,0,0];let r=Number(i&BigInt(4294967295)),a=Number(i>>BigInt(32)&BigInt(4294967295));o[8]=r&255,r=r>>8,o[7]=r&255,r=r>>8,o[6]=r&255,r=r>>8,o[5]=r&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${Ce} encountered BigInt larger than allowable range`)}}yn.encodedSize=function(t){return Mt.encodedSize(t.value)};Mt.encodedSize=function(t){return t<it[0]?1:t<it[1]?2:t<it[2]?3:t<it[3]?5:9};yn.compareTokens=function(t,n){return t.value<n.value?-1:t.value>n.value?1:0};function $m(e,t,n,i){return new he(B.negint,-1-mn(e,t+1,i),2)}function xm(e,t,n,i){return new he(B.negint,-1-gn(e,t+1,i),3)}function Em(e,t,n,i){return new he(B.negint,-1-vn(e,t+1,i),5)}const Po=BigInt(-1),Ca=BigInt(1);function Am(e,t,n,i){const o=pn(e,t+1,i);if(typeof o!="bigint"){const r=-1-o;if(r>=Number.MIN_SAFE_INTEGER)return new he(B.negint,r,9)}if(i.allowBigInt!==!0)throw new Error(`${Ce} integers outside of the safe integer range are not supported`);return new he(B.negint,Po-BigInt(o),9)}function $o(e,t){const n=t.value,i=typeof n=="bigint"?n*Po-Ca:n*-1-1;Mt(e,t.type.majorEncoded,i)}$o.encodedSize=function(t){const n=t.value,i=typeof n=="bigint"?n*Po-Ca:n*-1-1;return i<it[0]?1:i<it[1]?2:i<it[2]?3:i<it[3]?5:9};$o.compareTokens=function(t,n){return t.value<n.value?1:t.value>n.value?-1:0};function ri(e,t,n,i){Rn(e,t,n+i);const o=To(e,t+n,t+n+i);return new he(B.bytes,o,n+i)}function Im(e,t,n,i){return ri(e,t,1,n)}function Rm(e,t,n,i){return ri(e,t,2,mn(e,t+1,i))}function Um(e,t,n,i){return ri(e,t,3,gn(e,t+1,i))}function Nm(e,t,n,i){return ri(e,t,5,vn(e,t+1,i))}function Om(e,t,n,i){const o=pn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${Ce} 64-bit integer bytes lengths not supported`);return ri(e,t,9,o)}function $i(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===B.string?_m(e.value):e.value),e.encodedBytes}function Vi(e,t){const n=$i(t);Mt(e,t.type.majorEncoded,n.length),e.push(n)}Vi.encodedSize=function(t){const n=$i(t);return Mt.encodedSize(n.length)+n.length};Vi.compareTokens=function(t,n){return Lm($i(t),$i(n))};function Lm(e,t){return e.length<t.length?-1:e.length>t.length?1:Dm(e,t)}function ai(e,t,n,i,o){const r=n+i;Rn(e,t,r);const a=new he(B.string,wm(e,t+n,t+r),r);return o.retainStringBytes===!0&&(a.byteValue=To(e,t+n,t+r)),a}function Bm(e,t,n,i){return ai(e,t,1,n,i)}function Vm(e,t,n,i){return ai(e,t,2,mn(e,t+1,i),i)}function Fm(e,t,n,i){return ai(e,t,3,gn(e,t+1,i),i)}function zm(e,t,n,i){return ai(e,t,5,vn(e,t+1,i),i)}function jm(e,t,n,i){const o=pn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${Ce} 64-bit integer string lengths not supported`);return ai(e,t,9,o,i)}const Wm=Vi;function Un(e,t,n,i){return new he(B.array,i,n)}function Hm(e,t,n,i){return Un(e,t,1,n)}function Km(e,t,n,i){return Un(e,t,2,mn(e,t+1,i))}function Qm(e,t,n,i){return Un(e,t,3,gn(e,t+1,i))}function Xm(e,t,n,i){return Un(e,t,5,vn(e,t+1,i))}function Gm(e,t,n,i){const o=pn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${Ce} 64-bit integer array lengths not supported`);return Un(e,t,9,o)}function Ym(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${Ce} indefinite length items not allowed`);return Un(e,t,1,1/0)}function xo(e,t){Mt(e,B.array.majorEncoded,t.value)}xo.compareTokens=yn.compareTokens;xo.encodedSize=function(t){return Mt.encodedSize(t.value)};function Nn(e,t,n,i){return new he(B.map,i,n)}function Zm(e,t,n,i){return Nn(e,t,1,n)}function Jm(e,t,n,i){return Nn(e,t,2,mn(e,t+1,i))}function eg(e,t,n,i){return Nn(e,t,3,gn(e,t+1,i))}function tg(e,t,n,i){return Nn(e,t,5,vn(e,t+1,i))}function ng(e,t,n,i){const o=pn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${Ce} 64-bit integer map lengths not supported`);return Nn(e,t,9,o)}function ig(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${Ce} indefinite length items not allowed`);return Nn(e,t,1,1/0)}function Eo(e,t){Mt(e,B.map.majorEncoded,t.value)}Eo.compareTokens=yn.compareTokens;Eo.encodedSize=function(t){return Mt.encodedSize(t.value)};function og(e,t,n,i){return new he(B.tag,n,1)}function rg(e,t,n,i){return new he(B.tag,mn(e,t+1,i),2)}function ag(e,t,n,i){return new he(B.tag,gn(e,t+1,i),3)}function sg(e,t,n,i){return new he(B.tag,vn(e,t+1,i),5)}function lg(e,t,n,i){return new he(B.tag,pn(e,t+1,i),9)}function Ao(e,t){Mt(e,B.tag.majorEncoded,t.value)}Ao.compareTokens=yn.compareTokens;Ao.encodedSize=function(t){return Mt.encodedSize(t.value)};const ug=20,cg=21,dg=22,fg=23;function hg(e,t,n,i){if(i.allowUndefined===!1)throw new Error(`${Ce} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new he(B.null,null,1):new he(B.undefined,void 0,1)}function mg(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${Ce} indefinite length items not allowed`);return new he(B.break,void 0,1)}function Io(e,t,n){if(n){if(n.allowNaN===!1&&Number.isNaN(e))throw new Error(`${Ce} NaN values are not supported`);if(n.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${Ce} Infinity values are not supported`)}return new he(B.float,e,t)}function gg(e,t,n,i){return Io(Uo(e,t+1),3,i)}function vg(e,t,n,i){return Io(No(e,t+1),5,i)}function pg(e,t,n,i){return Io(Ta(e,t+1),9,i)}function Ro(e,t,n){const i=t.value;if(i===!1)e.push([B.float.majorEncoded|ug]);else if(i===!0)e.push([B.float.majorEncoded|cg]);else if(i===null)e.push([B.float.majorEncoded|dg]);else if(i===void 0)e.push([B.float.majorEncoded|fg]);else{let o,r=!1;(!n||n.float64!==!0)&&(Sa(i),o=Uo(Tt,1),i===o||Number.isNaN(i)?(Tt[0]=249,e.push(Tt.slice(0,3)),r=!0):(qa(i),o=No(Tt,1),i===o&&(Tt[0]=250,e.push(Tt.slice(0,5)),r=!0))),r||(yg(i),o=Ta(Tt,1),Tt[0]=251,e.push(Tt.slice(0,9)))}}Ro.encodedSize=function(t,n){const i=t.value;if(i===!1||i===!0||i===null||i===void 0)return 1;if(!n||n.float64!==!0){Sa(i);let o=Uo(Tt,1);if(i===o||Number.isNaN(i))return 3;if(qa(i),o=No(Tt,1),i===o)return 5}return 9};const Ma=new ArrayBuffer(9),kt=new DataView(Ma,1),Tt=new Uint8Array(Ma,0);function Sa(e){if(e===1/0)kt.setUint16(0,31744,!1);else if(e===-1/0)kt.setUint16(0,64512,!1);else if(Number.isNaN(e))kt.setUint16(0,32256,!1);else{kt.setFloat32(0,e);const t=kt.getUint32(0),n=(t&2139095040)>>23,i=t&8388607;if(n===255)kt.setUint16(0,31744,!1);else if(n===0)kt.setUint16(0,(e&2147483648)>>16|i>>13,!1);else{const o=n-127;o<-24?kt.setUint16(0,0):o<-14?kt.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):kt.setUint16(0,(t&2147483648)>>16|o+15<<10|i>>13,!1)}}}function Uo(e,t){if(e.length-t<2)throw new Error(`${Ce} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;const i=n>>10&31,o=n&1023;let r;return i===0?r=o*2**-24:i!==31?r=(o+1024)*2**(i-25):r=o===0?1/0:NaN,n&32768?-r:r}function qa(e){kt.setFloat32(0,e,!1)}function No(e,t){if(e.length-t<4)throw new Error(`${Ce} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function yg(e){kt.setFloat64(0,e,!1)}function Ta(e,t){if(e.length-t<8)throw new Error(`${Ce} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}Ro.compareTokens=yn.compareTokens;function Te(e,t,n){throw new Error(`${Ce} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function Fi(e){return()=>{throw new Error(`${Ce} ${e}`)}}const Z=[];for(let e=0;e<=23;e++)Z[e]=Te;Z[24]=Sm;Z[25]=qm;Z[26]=Tm;Z[27]=Pm;Z[28]=Te;Z[29]=Te;Z[30]=Te;Z[31]=Te;for(let e=32;e<=55;e++)Z[e]=Te;Z[56]=$m;Z[57]=xm;Z[58]=Em;Z[59]=Am;Z[60]=Te;Z[61]=Te;Z[62]=Te;Z[63]=Te;for(let e=64;e<=87;e++)Z[e]=Im;Z[88]=Rm;Z[89]=Um;Z[90]=Nm;Z[91]=Om;Z[92]=Te;Z[93]=Te;Z[94]=Te;Z[95]=Fi("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)Z[e]=Bm;Z[120]=Vm;Z[121]=Fm;Z[122]=zm;Z[123]=jm;Z[124]=Te;Z[125]=Te;Z[126]=Te;Z[127]=Fi("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)Z[e]=Hm;Z[152]=Km;Z[153]=Qm;Z[154]=Xm;Z[155]=Gm;Z[156]=Te;Z[157]=Te;Z[158]=Te;Z[159]=Ym;for(let e=160;e<=183;e++)Z[e]=Zm;Z[184]=Jm;Z[185]=eg;Z[186]=tg;Z[187]=ng;Z[188]=Te;Z[189]=Te;Z[190]=Te;Z[191]=ig;for(let e=192;e<=215;e++)Z[e]=og;Z[216]=rg;Z[217]=ag;Z[218]=sg;Z[219]=lg;Z[220]=Te;Z[221]=Te;Z[222]=Te;Z[223]=Te;for(let e=224;e<=243;e++)Z[e]=Fi("simple values are not supported");Z[244]=Te;Z[245]=Te;Z[246]=Te;Z[247]=hg;Z[248]=Fi("simple values are not supported");Z[249]=gg;Z[250]=vg;Z[251]=pg;Z[252]=Te;Z[253]=Te;Z[254]=Te;Z[255]=mg;const jt=[];for(let e=0;e<24;e++)jt[e]=new he(B.uint,e,1);for(let e=-1;e>=-24;e--)jt[31-e]=new he(B.negint,e,1);jt[64]=new he(B.bytes,new Uint8Array(0),1);jt[96]=new he(B.string,"",1);jt[128]=new he(B.array,0,1);jt[160]=new he(B.map,0,1);jt[244]=new he(B.false,!1,1);jt[245]=new he(B.true,!0,1);jt[246]=new he(B.null,null,1);function wg(e){switch(e.type){case B.false:return Ht([244]);case B.true:return Ht([245]);case B.null:return Ht([246]);case B.bytes:return e.value.length?void 0:Ht([64]);case B.string:return e.value===""?Ht([96]):void 0;case B.array:return e.value===0?Ht([128]):void 0;case B.map:return e.value===0?Ht([160]):void 0;case B.uint:return e.value<24?Ht([Number(e.value)]):void 0;case B.negint:if(e.value>=-24)return Ht([31-Number(e.value)])}}const _g={float64:!1,mapSorter:Dg,quickEncodeToken:wg};function bg(){const e=[];return e[B.uint.major]=yn,e[B.negint.major]=$o,e[B.bytes.major]=Vi,e[B.string.major]=Wm,e[B.array.major]=xo,e[B.map.major]=Eo,e[B.tag.major]=Ao,e[B.float.major]=Ro,e}const Pa=bg(),oo=new ka;class xi{constructor(t,n){this.obj=t,this.parent=n}includes(t){let n=this;do if(n.obj===t)return!0;while(n=n.parent);return!1}static createCheck(t,n){if(t&&t.includes(n))throw new Error(`${Da} object contains circular references`);return new xi(n,t)}}const tn={null:new he(B.null,null),undefined:new he(B.undefined,void 0),true:new he(B.true,!0),false:new he(B.false,!1),emptyArray:new he(B.array,0),emptyMap:new he(B.map,0)},an={number(e,t,n,i){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new he(B.float,e):e>=0?new he(B.uint,e):new he(B.negint,e)},bigint(e,t,n,i){return e>=BigInt(0)?new he(B.uint,e):new he(B.negint,e)},Uint8Array(e,t,n,i){return new he(B.bytes,e)},string(e,t,n,i){return new he(B.string,e)},boolean(e,t,n,i){return e?tn.true:tn.false},null(e,t,n,i){return tn.null},undefined(e,t,n,i){return tn.undefined},ArrayBuffer(e,t,n,i){return new he(B.bytes,new Uint8Array(e))},DataView(e,t,n,i){return new he(B.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,i){if(!e.length)return n.addBreakTokens===!0?[tn.emptyArray,new he(B.break)]:tn.emptyArray;i=xi.createCheck(i,e);const o=[];let r=0;for(const a of e)o[r++]=Mi(a,n,i);return n.addBreakTokens?[new he(B.array,e.length),o,new he(B.break)]:[new he(B.array,e.length),o]},Object(e,t,n,i){const o=t!=="Object",r=o?e.keys():Object.keys(e),a=o?e.size:r.length;if(!a)return n.addBreakTokens===!0?[tn.emptyMap,new he(B.break)]:tn.emptyMap;i=xi.createCheck(i,e);const s=[];let l=0;for(const h of r)s[l++]=[Mi(h,n,i),Mi(o?e.get(h):e[h],n,i)];return kg(s,n),n.addBreakTokens?[new he(B.map,a),s,new he(B.break)]:[new he(B.map,a),s]}};an.Map=an.Object;an.Buffer=an.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))an[`${e}Array`]=an.DataView;function Mi(e,t={},n){const i=mm(e),o=t&&t.typeEncoders&&t.typeEncoders[i]||an[i];if(typeof o=="function"){const a=o(e,i,t,n);if(a!=null)return a}const r=an[i];if(!r)throw new Error(`${Da} unsupported type: ${i}`);return r(e,i,t,n)}function kg(e,t){t.mapSorter&&e.sort(t.mapSorter)}function Dg(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],i=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==i.type)return n.type.compare(i.type);const o=n.type.major,r=Pa[o].compareTokens(n,i);return r===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),r}function $a(e,t,n,i){if(Array.isArray(t))for(const o of t)$a(e,o,n,i);else n[t.type.major](e,t,i)}function Cg(e,t,n){const i=Mi(e,n);if(!Array.isArray(i)&&n.quickEncodeToken){const o=n.quickEncodeToken(i);if(o)return o;const r=t[i.type.major];if(r.encodedSize){const a=r.encodedSize(i,n),s=new ka(a);if(r(s,i,n),s.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return ba(s.chunks[0])}}return oo.reset(),$a(oo,i,t,n),oo.toBytes(!0)}function Mg(e,t){return t=Object.assign({},_g,t),Cg(e,Pa,t)}const Sg={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class qg{constructor(t,n={}){this._pos=0,this.data=t,this.options=n}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let n=jt[t];if(n===void 0){const i=Z[t];if(!i)throw new Error(`${Ce} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const o=t&31;n=i(this.data,this._pos,o,this.options)}return this._pos+=n.encodedLength,n}}const Zn=Symbol.for("DONE"),zi=Symbol.for("BREAK");function Tg(e,t,n){const i=[];for(let o=0;o<e.value;o++){const r=Jn(t,n);if(r===zi){if(e.value===1/0)break;throw new Error(`${Ce} got unexpected break to lengthed array`)}if(r===Zn)throw new Error(`${Ce} found array but not enough entries (got ${o}, expected ${e.value})`);i[o]=r}return i}function Pg(e,t,n){const i=n.useMaps===!0,o=i?void 0:{},r=i?new Map:void 0;for(let a=0;a<e.value;a++){const s=Jn(t,n);if(s===zi){if(e.value===1/0)break;throw new Error(`${Ce} got unexpected break to lengthed map`)}if(s===Zn)throw new Error(`${Ce} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(i!==!0&&typeof s!="string")throw new Error(`${Ce} non-string keys not supported (got ${typeof s})`);if(n.rejectDuplicateMapKeys===!0&&(i&&r.has(s)||!i&&s in o))throw new Error(`${Ce} found repeat map key "${s}"`);const l=Jn(t,n);if(l===Zn)throw new Error(`${Ce} found map but not enough entries (got ${a} [no value], expected ${e.value})`);i?r.set(s,l):o[s]=l}return i?r:o}function Jn(e,t){if(e.done())return Zn;const n=e.next();if(n.type===B.break)return zi;if(n.type.terminal)return n.value;if(n.type===B.array)return Tg(n,e,t);if(n.type===B.map)return Pg(n,e,t);if(n.type===B.tag){if(t.tags&&typeof t.tags[n.value]=="function"){const i=Jn(e,t);return t.tags[n.value](i)}throw new Error(`${Ce} tag not supported (${n.value})`)}throw new Error("unsupported")}function $g(e,t){if(!(e instanceof Uint8Array))throw new Error(`${Ce} data to decode must be a Uint8Array`);t=Object.assign({},Sg,t);const n=t.tokenizer||new qg(e,t),i=Jn(n,t);if(i===Zn)throw new Error(`${Ce} did not find any content to decode`);if(i===zi)throw new Error(`${Ce} got unexpected break`);return[i,e.subarray(n.pos())]}function xg(e,t){const[n,i]=$g(e,t);if(i.length>0)throw new Error(`${Ce} too many terminals, data makes no sense`);return n}var xa=function(e){return Ne.Buffer.from(Mg(e))},Ea=function(e){return xg(Ne.Buffer.isBuffer(e)?e:Ne.Buffer.from(e,"hex"))},Si=function(){function e(t,n){if(n===void 0&&(n="bytes"),this._cborPayload=t,this._type=n,!Ci(this._type))throw new ga}return e.fromBuffer=function(t){return new e(xa(t))},e.from=function(t){return e.fromBuffer(Ne.Buffer.from(t))},e.prototype.decodeCBOR=function(){return Ea(this._cborPayload)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this._cborPayload},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return this.type===t.type&&this.cbor.equals(t.cbor)},e}(),Eg=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ro=Math.ceil,_t=Math.floor,ht="[BigNumber Error] ",Sr=ht+"Number primitive has more than 15 significant digits: ",qt=1e14,be=14,ao=9007199254740991,so=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],nn=1e7,Ye=1e9;function Aa(e){var t,n,i,o=A.prototype={constructor:A,toString:null,valueOf:null},r=new A(1),a=20,s=4,l=-7,h=21,g=-1e7,w=1e7,_=!1,C=1,E=0,N={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},U="0123456789abcdefghijklmnopqrstuvwxyz",K=!0;function A(c,v){var p,$,y,b,q,D,S,x,T=this;if(!(T instanceof A))return new A(c,v);if(v==null){if(c&&c._isBigNumber===!0){T.s=c.s,!c.c||c.e>w?T.c=T.e=null:c.e<g?T.c=[T.e=0]:(T.e=c.e,T.c=c.c.slice());return}if((D=typeof c=="number")&&c*0==0){if(T.s=1/c<0?(c=-c,-1):1,c===~~c){for(b=0,q=c;q>=10;q/=10,b++);b>w?T.c=T.e=null:(T.e=b,T.c=[c]);return}x=String(c)}else{if(!Eg.test(x=String(c)))return i(T,x,D);T.s=x.charCodeAt(0)==45?(x=x.slice(1),-1):1}(b=x.indexOf("."))>-1&&(x=x.replace(".","")),(q=x.search(/e/i))>0?(b<0&&(b=q),b+=+x.slice(q+1),x=x.substring(0,q)):b<0&&(b=x.length)}else{if(We(v,2,U.length,"Base"),v==10&&K)return T=new A(c),se(T,a+T.e+1,s);if(x=String(c),D=typeof c=="number"){if(c*0!=0)return i(T,x,D,v);if(T.s=1/c<0?(x=x.slice(1),-1):1,A.DEBUG&&x.replace(/^0\.0*|\./,"").length>15)throw Error(Sr+c)}else T.s=x.charCodeAt(0)===45?(x=x.slice(1),-1):1;for(p=U.slice(0,v),b=q=0,S=x.length;q<S;q++)if(p.indexOf($=x.charAt(q))<0){if($=="."){if(q>b){b=S;continue}}else if(!y&&(x==x.toUpperCase()&&(x=x.toLowerCase())||x==x.toLowerCase()&&(x=x.toUpperCase()))){y=!0,q=-1,b=0;continue}return i(T,String(c),D,v)}D=!1,x=n(x,v,10,T.s),(b=x.indexOf("."))>-1?x=x.replace(".",""):b=x.length}for(q=0;x.charCodeAt(q)===48;q++);for(S=x.length;x.charCodeAt(--S)===48;);if(x=x.slice(q,++S)){if(S-=q,D&&A.DEBUG&&S>15&&(c>ao||c!==_t(c)))throw Error(Sr+T.s*c);if((b=b-q-1)>w)T.c=T.e=null;else if(b<g)T.c=[T.e=0];else{if(T.e=b,T.c=[],q=(b+1)%be,b<0&&(q+=be),q<S){for(q&&T.c.push(+x.slice(0,q)),S-=be;q<S;)T.c.push(+x.slice(q,q+=be));q=be-(x=x.slice(q)).length}else q-=S;for(;q--;x+="0");T.c.push(+x)}}else T.c=[T.e=0]}A.clone=Aa,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(c){var v,p;if(c!=null)if(typeof c=="object"){if(c.hasOwnProperty(v="DECIMAL_PLACES")&&(p=c[v],We(p,0,Ye,v),a=p),c.hasOwnProperty(v="ROUNDING_MODE")&&(p=c[v],We(p,0,8,v),s=p),c.hasOwnProperty(v="EXPONENTIAL_AT")&&(p=c[v],p&&p.pop?(We(p[0],-Ye,0,v),We(p[1],0,Ye,v),l=p[0],h=p[1]):(We(p,-Ye,Ye,v),l=-(h=p<0?-p:p))),c.hasOwnProperty(v="RANGE"))if(p=c[v],p&&p.pop)We(p[0],-Ye,-1,v),We(p[1],1,Ye,v),g=p[0],w=p[1];else if(We(p,-Ye,Ye,v),p)g=-(w=p<0?-p:p);else throw Error(ht+v+" cannot be zero: "+p);if(c.hasOwnProperty(v="CRYPTO"))if(p=c[v],p===!!p)if(p)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))_=p;else throw _=!p,Error(ht+"crypto unavailable");else _=p;else throw Error(ht+v+" not true or false: "+p);if(c.hasOwnProperty(v="MODULO_MODE")&&(p=c[v],We(p,0,9,v),C=p),c.hasOwnProperty(v="POW_PRECISION")&&(p=c[v],We(p,0,Ye,v),E=p),c.hasOwnProperty(v="FORMAT"))if(p=c[v],typeof p=="object")N=p;else throw Error(ht+v+" not an object: "+p);if(c.hasOwnProperty(v="ALPHABET"))if(p=c[v],typeof p=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(p))K=p.slice(0,10)=="0123456789",U=p;else throw Error(ht+v+" invalid: "+p)}else throw Error(ht+"Object expected: "+c);return{DECIMAL_PLACES:a,ROUNDING_MODE:s,EXPONENTIAL_AT:[l,h],RANGE:[g,w],CRYPTO:_,MODULO_MODE:C,POW_PRECISION:E,FORMAT:N,ALPHABET:U}},A.isBigNumber=function(c){if(!c||c._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var v,p,$=c.c,y=c.e,b=c.s;e:if({}.toString.call($)=="[object Array]"){if((b===1||b===-1)&&y>=-Ye&&y<=Ye&&y===_t(y)){if($[0]===0){if(y===0&&$.length===1)return!0;break e}if(v=(y+1)%be,v<1&&(v+=be),String($[0]).length==v){for(v=0;v<$.length;v++)if(p=$[v],p<0||p>=qt||p!==_t(p))break e;if(p!==0)return!0}}}else if($===null&&y===null&&(b===null||b===1||b===-1))return!0;throw Error(ht+"Invalid BigNumber: "+c)},A.maximum=A.max=function(){return X(arguments,-1)},A.minimum=A.min=function(){return X(arguments,1)},A.random=function(){var c=9007199254740992,v=Math.random()*c&2097151?function(){return _t(Math.random()*c)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(p){var $,y,b,q,D,S=0,x=[],T=new A(r);if(p==null?p=a:We(p,0,Ye),q=ro(p/be),_)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(q*=2));S<q;)D=$[S]*131072+($[S+1]>>>11),D>=9e15?(y=crypto.getRandomValues(new Uint32Array(2)),$[S]=y[0],$[S+1]=y[1]):(x.push(D%1e14),S+=2);S=q/2}else if(crypto.randomBytes){for($=crypto.randomBytes(q*=7);S<q;)D=($[S]&31)*281474976710656+$[S+1]*1099511627776+$[S+2]*4294967296+$[S+3]*16777216+($[S+4]<<16)+($[S+5]<<8)+$[S+6],D>=9e15?crypto.randomBytes(7).copy($,S):(x.push(D%1e14),S+=7);S=q/7}else throw _=!1,Error(ht+"crypto unavailable");if(!_)for(;S<q;)D=v(),D<9e15&&(x[S++]=D%1e14);for(q=x[--S],p%=be,q&&p&&(D=so[be-p],x[S]=_t(q/D)*D);x[S]===0;x.pop(),S--);if(S<0)x=[b=0];else{for(b=-1;x[0]===0;x.splice(0,1),b-=be);for(S=1,D=x[0];D>=10;D/=10,S++);S<be&&(b-=be-S)}return T.e=b,T.c=x,T}}(),A.sum=function(){for(var c=1,v=arguments,p=new A(v[0]);c<v.length;)p=p.plus(v[c++]);return p},n=function(){var c="0123456789";function v(p,$,y,b){for(var q,D=[0],S,x=0,T=p.length;x<T;){for(S=D.length;S--;D[S]*=$);for(D[0]+=b.indexOf(p.charAt(x++)),q=0;q<D.length;q++)D[q]>y-1&&(D[q+1]==null&&(D[q+1]=0),D[q+1]+=D[q]/y|0,D[q]%=y)}return D.reverse()}return function(p,$,y,b,q){var D,S,x,T,R,oe,P,O,re=p.indexOf("."),ge=a,ue=s;for(re>=0&&(T=E,E=0,p=p.replace(".",""),O=new A($),oe=O.pow(p.length-re),E=T,O.c=v(Kt(wt(oe.c),oe.e,"0"),10,y,c),O.e=O.c.length),P=v(p,$,y,q?(D=U,c):(D=c,U)),x=T=P.length;P[--T]==0;P.pop());if(!P[0])return D.charAt(0);if(re<0?--x:(oe.c=P,oe.e=x,oe.s=b,oe=t(oe,O,ge,ue,y),P=oe.c,R=oe.r,x=oe.e),S=x+ge+1,re=P[S],T=y/2,R=R||S<0||P[S+1]!=null,R=ue<4?(re!=null||R)&&(ue==0||ue==(oe.s<0?3:2)):re>T||re==T&&(ue==4||R||ue==6&&P[S-1]&1||ue==(oe.s<0?8:7)),S<1||!P[0])p=R?Kt(D.charAt(1),-ge,D.charAt(0)):D.charAt(0);else{if(P.length=S,R)for(--y;++P[--S]>y;)P[S]=0,S||(++x,P=[1].concat(P));for(T=P.length;!P[--T];);for(re=0,p="";re<=T;p+=D.charAt(P[re++]));p=Kt(p,x,D.charAt(0))}return p}}(),t=function(){function c($,y,b){var q,D,S,x,T=0,R=$.length,oe=y%nn,P=y/nn|0;for($=$.slice();R--;)S=$[R]%nn,x=$[R]/nn|0,q=P*S+x*oe,D=oe*S+q%nn*nn+T,T=(D/b|0)+(q/nn|0)+P*x,$[R]=D%b;return T&&($=[T].concat($)),$}function v($,y,b,q){var D,S;if(b!=q)S=b>q?1:-1;else for(D=S=0;D<b;D++)if($[D]!=y[D]){S=$[D]>y[D]?1:-1;break}return S}function p($,y,b,q){for(var D=0;b--;)$[b]-=D,D=$[b]<y[b]?1:0,$[b]=D*q+$[b]-y[b];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,y,b,q,D){var S,x,T,R,oe,P,O,re,ge,ue,ee,le,xe,G,Ve,ze,ft,Le=$.s==y.s?1:-1,Be=$.c,qe=y.c;if(!Be||!Be[0]||!qe||!qe[0])return new A(!$.s||!y.s||(Be?qe&&Be[0]==qe[0]:!qe)?NaN:Be&&Be[0]==0||!qe?Le*0:Le/0);for(re=new A(Le),ge=re.c=[],x=$.e-y.e,Le=b+x+1,D||(D=qt,x=bt($.e/be)-bt(y.e/be),Le=Le/be|0),T=0;qe[T]==(Be[T]||0);T++);if(qe[T]>(Be[T]||0)&&x--,Le<0)ge.push(1),R=!0;else{for(G=Be.length,ze=qe.length,T=0,Le+=2,oe=_t(D/(qe[0]+1)),oe>1&&(qe=c(qe,oe,D),Be=c(Be,oe,D),ze=qe.length,G=Be.length),xe=ze,ue=Be.slice(0,ze),ee=ue.length;ee<ze;ue[ee++]=0);ft=qe.slice(),ft=[0].concat(ft),Ve=qe[0],qe[1]>=D/2&&Ve++;do{if(oe=0,S=v(qe,ue,ze,ee),S<0){if(le=ue[0],ze!=ee&&(le=le*D+(ue[1]||0)),oe=_t(le/Ve),oe>1)for(oe>=D&&(oe=D-1),P=c(qe,oe,D),O=P.length,ee=ue.length;v(P,ue,O,ee)==1;)oe--,p(P,ze<O?ft:qe,O,D),O=P.length,S=1;else oe==0&&(S=oe=1),P=qe.slice(),O=P.length;if(O<ee&&(P=[0].concat(P)),p(ue,P,ee,D),ee=ue.length,S==-1)for(;v(qe,ue,ze,ee)<1;)oe++,p(ue,ze<ee?ft:qe,ee,D),ee=ue.length}else S===0&&(oe++,ue=[0]);ge[T++]=oe,ue[0]?ue[ee++]=Be[xe]||0:(ue=[Be[xe]],ee=1)}while((xe++<G||ue[0]!=null)&&Le--);R=ue[0]!=null,ge[0]||ge.splice(0,1)}if(D==qt){for(T=1,Le=ge[0];Le>=10;Le/=10,T++);se(re,b+(re.e=T+x*be-1)+1,q,R)}else re.e=x,re.r=+R;return re}}();function F(c,v,p,$){var y,b,q,D,S;if(p==null?p=s:We(p,0,8),!c.c)return c.toString();if(y=c.c[0],q=c.e,v==null)S=wt(c.c),S=$==1||$==2&&(q<=l||q>=h)?pi(S,q):Kt(S,q,"0");else if(c=se(new A(c),v,p),b=c.e,S=wt(c.c),D=S.length,$==1||$==2&&(v<=b||b<=l)){for(;D<v;S+="0",D++);S=pi(S,b)}else if(v-=q,S=Kt(S,b,"0"),b+1>D){if(--v>0)for(S+=".";v--;S+="0");}else if(v+=b-D,v>0)for(b+1==D&&(S+=".");v--;S+="0");return c.s<0&&y?"-"+S:S}function X(c,v){for(var p,$,y=1,b=new A(c[0]);y<c.length;y++)$=new A(c[y]),(!$.s||(p=ln(b,$))===v||p===0&&b.s===v)&&(b=$);return b}function pe(c,v,p){for(var $=1,y=v.length;!v[--y];v.pop());for(y=v[0];y>=10;y/=10,$++);return(p=$+p*be-1)>w?c.c=c.e=null:p<g?c.c=[c.e=0]:(c.e=p,c.c=v),c}i=function(){var c=/^(-?)0([xbo])(?=\w[\w.]*$)/i,v=/^([^.]+)\.$/,p=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,y=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(b,q,D,S){var x,T=D?q:q.replace(y,"");if($.test(T))b.s=isNaN(T)?null:T<0?-1:1;else{if(!D&&(T=T.replace(c,function(R,oe,P){return x=(P=P.toLowerCase())=="x"?16:P=="b"?2:8,!S||S==x?oe:R}),S&&(x=S,T=T.replace(v,"$1").replace(p,"0.$1")),q!=T))return new A(T,x);if(A.DEBUG)throw Error(ht+"Not a"+(S?" base "+S:"")+" number: "+q);b.s=null}b.c=b.e=null}}();function se(c,v,p,$){var y,b,q,D,S,x,T,R=c.c,oe=so;if(R){e:{for(y=1,D=R[0];D>=10;D/=10,y++);if(b=v-y,b<0)b+=be,q=v,S=R[x=0],T=_t(S/oe[y-q-1]%10);else if(x=ro((b+1)/be),x>=R.length)if($){for(;R.length<=x;R.push(0));S=T=0,y=1,b%=be,q=b-be+1}else break e;else{for(S=D=R[x],y=1;D>=10;D/=10,y++);b%=be,q=b-be+y,T=q<0?0:_t(S/oe[y-q-1]%10)}if($=$||v<0||R[x+1]!=null||(q<0?S:S%oe[y-q-1]),$=p<4?(T||$)&&(p==0||p==(c.s<0?3:2)):T>5||T==5&&(p==4||$||p==6&&(b>0?q>0?S/oe[y-q]:0:R[x-1])%10&1||p==(c.s<0?8:7)),v<1||!R[0])return R.length=0,$?(v-=c.e+1,R[0]=oe[(be-v%be)%be],c.e=-v||0):R[0]=c.e=0,c;if(b==0?(R.length=x,D=1,x--):(R.length=x+1,D=oe[be-b],R[x]=q>0?_t(S/oe[y-q]%oe[q])*D:0),$)for(;;)if(x==0){for(b=1,q=R[0];q>=10;q/=10,b++);for(q=R[0]+=D,D=1;q>=10;q/=10,D++);b!=D&&(c.e++,R[0]==qt&&(R[0]=1));break}else{if(R[x]+=D,R[x]!=qt)break;R[x--]=0,D=1}for(b=R.length;R[--b]===0;R.pop());}c.e>w?c.c=c.e=null:c.e<g&&(c.c=[c.e=0])}return c}function j(c){var v,p=c.e;return p===null?c.toString():(v=wt(c.c),v=p<=l||p>=h?pi(v,p):Kt(v,p,"0"),c.s<0?"-"+v:v)}return o.absoluteValue=o.abs=function(){var c=new A(this);return c.s<0&&(c.s=1),c},o.comparedTo=function(c,v){return ln(this,new A(c,v))},o.decimalPlaces=o.dp=function(c,v){var p,$,y,b=this;if(c!=null)return We(c,0,Ye),v==null?v=s:We(v,0,8),se(new A(b),c+b.e+1,v);if(!(p=b.c))return null;if($=((y=p.length-1)-bt(this.e/be))*be,y=p[y])for(;y%10==0;y/=10,$--);return $<0&&($=0),$},o.dividedBy=o.div=function(c,v){return t(this,new A(c,v),a,s)},o.dividedToIntegerBy=o.idiv=function(c,v){return t(this,new A(c,v),0,1)},o.exponentiatedBy=o.pow=function(c,v){var p,$,y,b,q,D,S,x,T,R=this;if(c=new A(c),c.c&&!c.isInteger())throw Error(ht+"Exponent not an integer: "+j(c));if(v!=null&&(v=new A(v)),D=c.e>14,!R.c||!R.c[0]||R.c[0]==1&&!R.e&&R.c.length==1||!c.c||!c.c[0])return T=new A(Math.pow(+j(R),D?c.s*(2-vi(c)):+j(c))),v?T.mod(v):T;if(S=c.s<0,v){if(v.c?!v.c[0]:!v.s)return new A(NaN);$=!S&&R.isInteger()&&v.isInteger(),$&&(R=R.mod(v))}else{if(c.e>9&&(R.e>0||R.e<-1||(R.e==0?R.c[0]>1||D&&R.c[1]>=24e7:R.c[0]<8e13||D&&R.c[0]<=9999975e7)))return b=R.s<0&&vi(c)?-0:0,R.e>-1&&(b=1/b),new A(S?1/b:b);E&&(b=ro(E/be+2))}for(D?(p=new A(.5),S&&(c.s=1),x=vi(c)):(y=Math.abs(+j(c)),x=y%2),T=new A(r);;){if(x){if(T=T.times(R),!T.c)break;b?T.c.length>b&&(T.c.length=b):$&&(T=T.mod(v))}if(y){if(y=_t(y/2),y===0)break;x=y%2}else if(c=c.times(p),se(c,c.e+1,1),c.e>14)x=vi(c);else{if(y=+j(c),y===0)break;x=y%2}R=R.times(R),b?R.c&&R.c.length>b&&(R.c.length=b):$&&(R=R.mod(v))}return $?T:(S&&(T=r.div(T)),v?T.mod(v):b?se(T,E,s,q):T)},o.integerValue=function(c){var v=new A(this);return c==null?c=s:We(c,0,8),se(v,v.e+1,c)},o.isEqualTo=o.eq=function(c,v){return ln(this,new A(c,v))===0},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(c,v){return ln(this,new A(c,v))>0},o.isGreaterThanOrEqualTo=o.gte=function(c,v){return(v=ln(this,new A(c,v)))===1||v===0},o.isInteger=function(){return!!this.c&&bt(this.e/be)>this.c.length-2},o.isLessThan=o.lt=function(c,v){return ln(this,new A(c,v))<0},o.isLessThanOrEqualTo=o.lte=function(c,v){return(v=ln(this,new A(c,v)))===-1||v===0},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&this.c[0]==0},o.minus=function(c,v){var p,$,y,b,q=this,D=q.s;if(c=new A(c,v),v=c.s,!D||!v)return new A(NaN);if(D!=v)return c.s=-v,q.plus(c);var S=q.e/be,x=c.e/be,T=q.c,R=c.c;if(!S||!x){if(!T||!R)return T?(c.s=-v,c):new A(R?q:NaN);if(!T[0]||!R[0])return R[0]?(c.s=-v,c):new A(T[0]?q:s==3?-0:0)}if(S=bt(S),x=bt(x),T=T.slice(),D=S-x){for((b=D<0)?(D=-D,y=T):(x=S,y=R),y.reverse(),v=D;v--;y.push(0));y.reverse()}else for($=(b=(D=T.length)<(v=R.length))?D:v,D=v=0;v<$;v++)if(T[v]!=R[v]){b=T[v]<R[v];break}if(b&&(y=T,T=R,R=y,c.s=-c.s),v=($=R.length)-(p=T.length),v>0)for(;v--;T[p++]=0);for(v=qt-1;$>D;){if(T[--$]<R[$]){for(p=$;p&&!T[--p];T[p]=v);--T[p],T[$]+=qt}T[$]-=R[$]}for(;T[0]==0;T.splice(0,1),--x);return T[0]?pe(c,T,x):(c.s=s==3?-1:1,c.c=[c.e=0],c)},o.modulo=o.mod=function(c,v){var p,$,y=this;return c=new A(c,v),!y.c||!c.s||c.c&&!c.c[0]?new A(NaN):!c.c||y.c&&!y.c[0]?new A(y):(C==9?($=c.s,c.s=1,p=t(y,c,0,3),c.s=$,p.s*=$):p=t(y,c,0,C),c=y.minus(p.times(c)),!c.c[0]&&C==1&&(c.s=y.s),c)},o.multipliedBy=o.times=function(c,v){var p,$,y,b,q,D,S,x,T,R,oe,P,O,re,ge,ue=this,ee=ue.c,le=(c=new A(c,v)).c;if(!ee||!le||!ee[0]||!le[0])return!ue.s||!c.s||ee&&!ee[0]&&!le||le&&!le[0]&&!ee?c.c=c.e=c.s=null:(c.s*=ue.s,!ee||!le?c.c=c.e=null:(c.c=[0],c.e=0)),c;for($=bt(ue.e/be)+bt(c.e/be),c.s*=ue.s,S=ee.length,R=le.length,S<R&&(O=ee,ee=le,le=O,y=S,S=R,R=y),y=S+R,O=[];y--;O.push(0));for(re=qt,ge=nn,y=R;--y>=0;){for(p=0,oe=le[y]%ge,P=le[y]/ge|0,q=S,b=y+q;b>y;)x=ee[--q]%ge,T=ee[q]/ge|0,D=P*x+T*oe,x=oe*x+D%ge*ge+O[b]+p,p=(x/re|0)+(D/ge|0)+P*T,O[b--]=x%re;O[b]=p}return p?++$:O.splice(0,1),pe(c,O,$)},o.negated=function(){var c=new A(this);return c.s=-c.s||null,c},o.plus=function(c,v){var p,$=this,y=$.s;if(c=new A(c,v),v=c.s,!y||!v)return new A(NaN);if(y!=v)return c.s=-v,$.minus(c);var b=$.e/be,q=c.e/be,D=$.c,S=c.c;if(!b||!q){if(!D||!S)return new A(y/0);if(!D[0]||!S[0])return S[0]?c:new A(D[0]?$:y*0)}if(b=bt(b),q=bt(q),D=D.slice(),y=b-q){for(y>0?(q=b,p=S):(y=-y,p=D),p.reverse();y--;p.push(0));p.reverse()}for(y=D.length,v=S.length,y-v<0&&(p=S,S=D,D=p,v=y),y=0;v;)y=(D[--v]=D[v]+S[v]+y)/qt|0,D[v]=qt===D[v]?0:D[v]%qt;return y&&(D=[y].concat(D),++q),pe(c,D,q)},o.precision=o.sd=function(c,v){var p,$,y,b=this;if(c!=null&&c!==!!c)return We(c,1,Ye),v==null?v=s:We(v,0,8),se(new A(b),c,v);if(!(p=b.c))return null;if(y=p.length-1,$=y*be+1,y=p[y]){for(;y%10==0;y/=10,$--);for(y=p[0];y>=10;y/=10,$++);}return c&&b.e+1>$&&($=b.e+1),$},o.shiftedBy=function(c){return We(c,-ao,ao),this.times("1e"+c)},o.squareRoot=o.sqrt=function(){var c,v,p,$,y,b=this,q=b.c,D=b.s,S=b.e,x=a+4,T=new A("0.5");if(D!==1||!q||!q[0])return new A(!D||D<0&&(!q||q[0])?NaN:q?b:1/0);if(D=Math.sqrt(+j(b)),D==0||D==1/0?(v=wt(q),(v.length+S)%2==0&&(v+="0"),D=Math.sqrt(+v),S=bt((S+1)/2)-(S<0||S%2),D==1/0?v="5e"+S:(v=D.toExponential(),v=v.slice(0,v.indexOf("e")+1)+S),p=new A(v)):p=new A(D+""),p.c[0]){for(S=p.e,D=S+x,D<3&&(D=0);;)if(y=p,p=T.times(y.plus(t(b,y,x,1))),wt(y.c).slice(0,D)===(v=wt(p.c)).slice(0,D))if(p.e<S&&--D,v=v.slice(D-3,D+1),v=="9999"||!$&&v=="4999"){if(!$&&(se(y,y.e+a+2,0),y.times(y).eq(b))){p=y;break}x+=4,D+=4,$=1}else{(!+v||!+v.slice(1)&&v.charAt(0)=="5")&&(se(p,p.e+a+2,1),c=!p.times(p).eq(b));break}}return se(p,p.e+a+1,s,c)},o.toExponential=function(c,v){return c!=null&&(We(c,0,Ye),c++),F(this,c,v,1)},o.toFixed=function(c,v){return c!=null&&(We(c,0,Ye),c=c+this.e+1),F(this,c,v)},o.toFormat=function(c,v,p){var $,y=this;if(p==null)c!=null&&v&&typeof v=="object"?(p=v,v=null):c&&typeof c=="object"?(p=c,c=v=null):p=N;else if(typeof p!="object")throw Error(ht+"Argument not an object: "+p);if($=y.toFixed(c,v),y.c){var b,q=$.split("."),D=+p.groupSize,S=+p.secondaryGroupSize,x=p.groupSeparator||"",T=q[0],R=q[1],oe=y.s<0,P=oe?T.slice(1):T,O=P.length;if(S&&(b=D,D=S,S=b,O-=b),D>0&&O>0){for(b=O%D||D,T=P.substr(0,b);b<O;b+=D)T+=x+P.substr(b,D);S>0&&(T+=x+P.slice(b)),oe&&(T="-"+T)}$=R?T+(p.decimalSeparator||"")+((S=+p.fractionGroupSize)?R.replace(new RegExp("\\d{"+S+"}\\B","g"),"$&"+(p.fractionGroupSeparator||"")):R):T}return(p.prefix||"")+$+(p.suffix||"")},o.toFraction=function(c){var v,p,$,y,b,q,D,S,x,T,R,oe,P=this,O=P.c;if(c!=null&&(D=new A(c),!D.isInteger()&&(D.c||D.s!==1)||D.lt(r)))throw Error(ht+"Argument "+(D.isInteger()?"out of range: ":"not an integer: ")+j(D));if(!O)return new A(P);for(v=new A(r),x=p=new A(r),$=S=new A(r),oe=wt(O),b=v.e=oe.length-P.e-1,v.c[0]=so[(q=b%be)<0?be+q:q],c=!c||D.comparedTo(v)>0?b>0?v:x:D,q=w,w=1/0,D=new A(oe),S.c[0]=0;T=t(D,v,0,1),y=p.plus(T.times($)),y.comparedTo(c)!=1;)p=$,$=y,x=S.plus(T.times(y=x)),S=y,v=D.minus(T.times(y=v)),D=y;return y=t(c.minus(p),$,0,1),S=S.plus(y.times(x)),p=p.plus(y.times($)),S.s=x.s=P.s,b=b*2,R=t(x,$,b,s).minus(P).abs().comparedTo(t(S,p,b,s).minus(P).abs())<1?[x,$]:[S,p],w=q,R},o.toNumber=function(){return+j(this)},o.toPrecision=function(c,v){return c!=null&&We(c,1,Ye),F(this,c,v,2)},o.toString=function(c){var v,p=this,$=p.s,y=p.e;return y===null?$?(v="Infinity",$<0&&(v="-"+v)):v="NaN":(c==null?v=y<=l||y>=h?pi(wt(p.c),y):Kt(wt(p.c),y,"0"):c===10&&K?(p=se(new A(p),a+y+1,s),v=Kt(wt(p.c),p.e,"0")):(We(c,2,U.length,"Base"),v=n(Kt(wt(p.c),y,"0"),10,c,$,!0)),$<0&&p.c[0]&&(v="-"+v)),v},o.valueOf=o.toJSON=function(){return j(this)},o._isBigNumber=!0,o[Symbol.toStringTag]="BigNumber",o[Symbol.for("nodejs.util.inspect.custom")]=o.valueOf,e!=null&&A.set(e),A}function bt(e){var t=e|0;return e>0||e===t?t:t-1}function wt(e){for(var t,n,i=1,o=e.length,r=e[0]+"";i<o;){for(t=e[i++]+"",n=be-t.length;n--;t="0"+t);r+=t}for(o=r.length;r.charCodeAt(--o)===48;);return r.slice(0,o+1||1)}function ln(e,t){var n,i,o=e.c,r=t.c,a=e.s,s=t.s,l=e.e,h=t.e;if(!a||!s)return null;if(n=o&&!o[0],i=r&&!r[0],n||i)return n?i?0:-s:a;if(a!=s)return a;if(n=a<0,i=l==h,!o||!r)return i?0:!o^n?1:-1;if(!i)return l>h^n?1:-1;for(s=(l=o.length)<(h=r.length)?l:h,a=0;a<s;a++)if(o[a]!=r[a])return o[a]>r[a]^n?1:-1;return l==h?0:l>h^n?1:-1}function We(e,t,n,i){if(e<t||e>n||e!==_t(e))throw Error(ht+(i||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function vi(e){var t=e.c.length-1;return bt(e.e/be)==t&&e.c[t]%2!=0}function pi(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function Kt(e,t,n){var i,o;if(t<0){for(o=n+".";++t;o+=n);e=o+e}else if(i=e.length,++t>i){for(o=n,t-=i;--t;o+=n);e+=o}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}var qr=Aa();class d extends Array{constructor(t,n){if(t>d.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");super(t),this.sign=n}static BigInt(t){var n=Math.floor,i=Number.isFinite;if(typeof t=="number"){if(t===0)return d.__zero();if((0|t)===t)return 0>t?d.__oneDigit(-t,!0):d.__oneDigit(t,!1);if(!i(t)||n(t)!==t)throw new RangeError("The number "+t+" cannot be converted to BigInt because it is not an integer");return d.__fromDouble(t)}if(typeof t=="string"){const o=d.__fromString(t);if(o===null)throw new SyntaxError("Cannot convert "+t+" to a BigInt");return o}if(typeof t=="boolean")return t===!0?d.__oneDigit(1,!1):d.__zero();if(typeof t=="object"){if(t.constructor===d)return t;const o=d.__toPrimitive(t);return d.BigInt(o)}throw new TypeError("Cannot convert "+t+" to a BigInt")}toDebugString(){const t=["BigInt["];for(const n of this)t.push((n&&(n>>>0).toString(16))+", ");return t.push("]"),t.join("")}toString(t=10){if(2>t||36<t)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(t&t-1)==0?d.__toStringBasePowerOfTwo(this,t):d.__toStringGeneric(this,t,!1)}static toNumber(t){const n=t.length;if(n===0)return 0;if(n===1){const U=t.__unsignedDigit(0);return t.sign?-U:U}const i=t.__digit(n-1),o=d.__clz32(i),r=32*n-o;if(1024<r)return t.sign?-1/0:1/0;let a=r-1,s=i,l=n-1;const h=o+1;let g=h===32?0:s<<h;g>>>=12;const w=h-12;let _=12<=h?0:s<<20+h,C=20+h;0<w&&0<l&&(l--,s=t.__digit(l),g|=s>>>32-w,_=s<<w,C=w),0<C&&0<l&&(l--,s=t.__digit(l),_|=s>>>32-C,C-=32);const E=d.__decideRounding(t,C,l,s);if((E===1||E===0&&(1&_)==1)&&(_=_+1>>>0,_===0&&(g++,g>>>20!=0&&(g=0,a++,1023<a))))return t.sign?-1/0:1/0;const N=t.sign?-2147483648:0;return a=a+1023<<20,d.__kBitConversionInts[1]=N|a|g,d.__kBitConversionInts[0]=_,d.__kBitConversionDouble[0]}static unaryMinus(t){if(t.length===0)return t;const n=t.__copy();return n.sign=!t.sign,n}static bitwiseNot(t){return t.sign?d.__absoluteSubOne(t).__trim():d.__absoluteAddOne(t,!0)}static exponentiate(t,n){if(n.sign)throw new RangeError("Exponent must be positive");if(n.length===0)return d.__oneDigit(1,!1);if(t.length===0)return t;if(t.length===1&&t.__digit(0)===1)return t.sign&&(1&n.__digit(0))==0?d.unaryMinus(t):t;if(1<n.length)throw new RangeError("BigInt too big");let i=n.__unsignedDigit(0);if(i===1)return t;if(i>=d.__kMaxLengthBits)throw new RangeError("BigInt too big");if(t.length===1&&t.__digit(0)===2){const a=1+(i>>>5),s=t.sign&&(1&i)!=0,l=new d(a,s);l.__initializeDigits();const h=1<<(31&i);return l.__setDigit(a-1,h),l}let o=null,r=t;for((1&i)!=0&&(o=t),i>>=1;i!==0;i>>=1)r=d.multiply(r,r),(1&i)!=0&&(o===null?o=r:o=d.multiply(o,r));return o}static multiply(t,n){if(t.length===0)return t;if(n.length===0)return n;let i=t.length+n.length;32<=t.__clzmsd()+n.__clzmsd()&&i--;const o=new d(i,t.sign!==n.sign);o.__initializeDigits();for(let r=0;r<t.length;r++)d.__multiplyAccumulate(n,t.__digit(r),o,r);return o.__trim()}static divide(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>d.__absoluteCompare(t,n))return d.__zero();const i=t.sign!==n.sign,o=n.__unsignedDigit(0);let r;if(n.length===1&&65535>=o){if(o===1)return i===t.sign?t:d.unaryMinus(t);r=d.__absoluteDivSmall(t,o,null)}else r=d.__absoluteDivLarge(t,n,!0,!1);return r.sign=i,r.__trim()}static remainder(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>d.__absoluteCompare(t,n))return t;const i=n.__unsignedDigit(0);if(n.length===1&&65535>=i){if(i===1)return d.__zero();const r=d.__absoluteModSmall(t,i);return r===0?d.__zero():d.__oneDigit(r,t.sign)}const o=d.__absoluteDivLarge(t,n,!1,!0);return o.sign=t.sign,o.__trim()}static add(t,n){const i=t.sign;return i===n.sign?d.__absoluteAdd(t,n,i):0<=d.__absoluteCompare(t,n)?d.__absoluteSub(t,n,i):d.__absoluteSub(n,t,!i)}static subtract(t,n){const i=t.sign;return i===n.sign?0<=d.__absoluteCompare(t,n)?d.__absoluteSub(t,n,i):d.__absoluteSub(n,t,!i):d.__absoluteAdd(t,n,i)}static leftShift(t,n){return n.length===0||t.length===0?t:n.sign?d.__rightShiftByAbsolute(t,n):d.__leftShiftByAbsolute(t,n)}static signedRightShift(t,n){return n.length===0||t.length===0?t:n.sign?d.__leftShiftByAbsolute(t,n):d.__rightShiftByAbsolute(t,n)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(t,n){return 0>d.__compareToBigInt(t,n)}static lessThanOrEqual(t,n){return 0>=d.__compareToBigInt(t,n)}static greaterThan(t,n){return 0<d.__compareToBigInt(t,n)}static greaterThanOrEqual(t,n){return 0<=d.__compareToBigInt(t,n)}static equal(t,n){if(t.sign!==n.sign||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t.__digit(i)!==n.__digit(i))return!1;return!0}static notEqual(t,n){return!d.equal(t,n)}static bitwiseAnd(t,n){var i=Math.max;if(!t.sign&&!n.sign)return d.__absoluteAnd(t,n).__trim();if(t.sign&&n.sign){const o=i(t.length,n.length)+1;let r=d.__absoluteSubOne(t,o);const a=d.__absoluteSubOne(n);return r=d.__absoluteOr(r,a,r),d.__absoluteAddOne(r,!0,r).__trim()}return t.sign&&([t,n]=[n,t]),d.__absoluteAndNot(t,d.__absoluteSubOne(n)).__trim()}static bitwiseXor(t,n){var i=Math.max;if(!t.sign&&!n.sign)return d.__absoluteXor(t,n).__trim();if(t.sign&&n.sign){const a=i(t.length,n.length),s=d.__absoluteSubOne(t,a),l=d.__absoluteSubOne(n);return d.__absoluteXor(s,l,s).__trim()}const o=i(t.length,n.length)+1;t.sign&&([t,n]=[n,t]);let r=d.__absoluteSubOne(n,o);return r=d.__absoluteXor(r,t,r),d.__absoluteAddOne(r,!0,r).__trim()}static bitwiseOr(t,n){var i=Math.max;const o=i(t.length,n.length);if(!t.sign&&!n.sign)return d.__absoluteOr(t,n).__trim();if(t.sign&&n.sign){let a=d.__absoluteSubOne(t,o);const s=d.__absoluteSubOne(n);return a=d.__absoluteAnd(a,s,a),d.__absoluteAddOne(a,!0,a).__trim()}t.sign&&([t,n]=[n,t]);let r=d.__absoluteSubOne(n,o);return r=d.__absoluteAndNot(r,t,r),d.__absoluteAddOne(r,!0,r).__trim()}static asIntN(t,n){if(n.length===0)return n;if(t===0)return d.__zero();if(t>=d.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=n.__unsignedDigit(i-1),r=1<<(31&t-1);if(n.length===i&&o<r)return n;if((o&r)!==r)return d.__truncateToNBits(t,n);if(!n.sign)return d.__truncateAndSubFromPowerOfTwo(t,n,!0);if((o&r-1)==0){for(let a=i-2;0<=a;a--)if(n.__digit(a)!==0)return d.__truncateAndSubFromPowerOfTwo(t,n,!1);return n.length===i&&o===r?n:d.__truncateToNBits(t,n)}return d.__truncateAndSubFromPowerOfTwo(t,n,!1)}static asUintN(t,n){if(n.length===0)return n;if(t===0)return d.__zero();if(n.sign){if(t>d.__kMaxLengthBits)throw new RangeError("BigInt too big");return d.__truncateAndSubFromPowerOfTwo(t,n,!1)}if(t>=d.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=31&t;return n.length==i&&(o===0||n.__digit(i-1)>>>o==0)?n:d.__truncateToNBits(t,n)}static ADD(t,n){if(t=d.__toPrimitive(t),n=d.__toPrimitive(n),typeof t=="string")return typeof n!="string"&&(n=n.toString()),t+n;if(typeof n=="string")return t.toString()+n;if(t=d.__toNumeric(t),n=d.__toNumeric(n),d.__isBigInt(t)&&d.__isBigInt(n))return d.add(t,n);if(typeof t=="number"&&typeof n=="number")return t+n;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(t,n){return d.__compare(t,n,0)}static LE(t,n){return d.__compare(t,n,1)}static GT(t,n){return d.__compare(t,n,2)}static GE(t,n){return d.__compare(t,n,3)}static EQ(t,n){for(;;){if(d.__isBigInt(t))return d.__isBigInt(n)?d.equal(t,n):d.EQ(n,t);if(typeof t=="number"){if(d.__isBigInt(n))return d.__equalToNumber(n,t);if(typeof n!="object")return t==n;n=d.__toPrimitive(n)}else if(typeof t=="string"){if(d.__isBigInt(n))return t=d.__fromString(t),t!==null&&d.equal(t,n);if(typeof n!="object")return t==n;n=d.__toPrimitive(n)}else if(typeof t=="boolean"){if(d.__isBigInt(n))return d.__equalToNumber(n,+t);if(typeof n!="object")return t==n;n=d.__toPrimitive(n)}else if(typeof t=="symbol"){if(d.__isBigInt(n))return!1;if(typeof n!="object")return t==n;n=d.__toPrimitive(n)}else if(typeof t=="object"){if(typeof n=="object"&&n.constructor!==d)return t==n;t=d.__toPrimitive(t)}else return t==n}}static NE(t,n){return!d.EQ(t,n)}static __zero(){return new d(0,!1)}static __oneDigit(t,n){const i=new d(1,n);return i.__setDigit(0,t),i}__copy(){const t=new d(this.length,this.sign);for(let n=0;n<this.length;n++)t[n]=this[n];return t}__trim(){let t=this.length,n=this[t-1];for(;n===0;)t--,n=this[t-1],this.pop();return t===0&&(this.sign=!1),this}__initializeDigits(){for(let t=0;t<this.length;t++)this[t]=0}static __decideRounding(t,n,i,o){if(0<n)return-1;let r;if(0>n)r=-n-1;else{if(i===0)return-1;i--,o=t.__digit(i),r=31}let a=1<<r;if((o&a)==0)return-1;if(a-=1,(o&a)!=0)return 1;for(;0<i;)if(i--,t.__digit(i)!==0)return 1;return 0}static __fromDouble(t){d.__kBitConversionDouble[0]=t;const n=2047&d.__kBitConversionInts[1]>>>20,i=n-1023,o=(i>>>5)+1,r=new d(o,0>t);let a=1048575&d.__kBitConversionInts[1]|1048576,s=d.__kBitConversionInts[0];const l=20,h=31&i;let g,w=0;if(h<20){const _=l-h;w=_+32,g=a>>>_,a=a<<32-_|s>>>_,s<<=32-_}else if(h===20)w=32,g=a,a=s;else{const _=h-l;w=32-_,g=a<<_|s>>>32-_,a=s<<_}r.__setDigit(o-1,g);for(let _=o-2;0<=_;_--)0<w?(w-=32,g=a,a=s):g=0,r.__setDigit(_,g);return r.__trim()}static __isWhitespace(t){return 13>=t&&9<=t||(159>=t?t==32:131071>=t?t==160||t==5760:196607>=t?(t&=131071,10>=t||t==40||t==41||t==47||t==95||t==4096):t==65279)}static __fromString(t,n=0){let i=0;const o=t.length;let r=0;if(r===o)return d.__zero();let a=t.charCodeAt(r);for(;d.__isWhitespace(a);){if(++r===o)return d.__zero();a=t.charCodeAt(r)}if(a===43){if(++r===o)return null;a=t.charCodeAt(r),i=1}else if(a===45){if(++r===o)return null;a=t.charCodeAt(r),i=-1}if(n===0){if(n=10,a===48){if(++r===o)return d.__zero();if(a=t.charCodeAt(r),a===88||a===120){if(n=16,++r===o)return null;a=t.charCodeAt(r)}else if(a===79||a===111){if(n=8,++r===o)return null;a=t.charCodeAt(r)}else if(a===66||a===98){if(n=2,++r===o)return null;a=t.charCodeAt(r)}}}else if(n===16&&a===48){if(++r===o)return d.__zero();if(a=t.charCodeAt(r),a===88||a===120){if(++r===o)return null;a=t.charCodeAt(r)}}for(;a===48;){if(++r===o)return d.__zero();a=t.charCodeAt(r)}const s=o-r;let l=d.__kMaxBitsPerChar[n],h=d.__kBitsPerCharTableMultiplier-1;if(s>1073741824/l)return null;const g=l*s+h>>>d.__kBitsPerCharTableShift,w=new d(g+31>>>5,!1),_=10>n?n:10,C=10<n?n-10:0;if((n&n-1)==0){l>>=d.__kBitsPerCharTableShift;const E=[],N=[];let U=!1;do{let K=0,A=0;for(;;){let F;if(a-48>>>0<_)F=a-48;else if((32|a)-97>>>0<C)F=(32|a)-87;else{U=!0;break}if(A+=l,K=K<<l|F,++r===o){U=!0;break}if(a=t.charCodeAt(r),32<A+l)break}E.push(K),N.push(A)}while(!U);d.__fillFromParts(w,E,N)}else{w.__initializeDigits();let E=!1,N=0;do{let U=0,K=1;for(;;){let F;if(a-48>>>0<_)F=a-48;else if((32|a)-97>>>0<C)F=(32|a)-87;else{E=!0;break}const X=K*n;if(4294967295<X)break;if(K=X,U=U*n+F,N++,++r===o){E=!0;break}a=t.charCodeAt(r)}h=32*d.__kBitsPerCharTableMultiplier-1;const A=l*N+h>>>d.__kBitsPerCharTableShift+5;w.__inplaceMultiplyAdd(K,U,A)}while(!E)}if(r!==o){if(!d.__isWhitespace(a))return null;for(r++;r<o;r++)if(a=t.charCodeAt(r),!d.__isWhitespace(a))return null}return i!=0&&n!==10?null:(w.sign=i==-1,w.__trim())}static __fillFromParts(t,n,i){let o=0,r=0,a=0;for(let s=n.length-1;0<=s;s--){const l=n[s],h=i[s];r|=l<<a,a+=h,a===32?(t.__setDigit(o++,r),a=0,r=0):32<a&&(t.__setDigit(o++,r),a-=32,r=l>>>h-a)}if(r!==0){if(o>=t.length)throw new Error("implementation bug");t.__setDigit(o++,r)}for(;o<t.length;o++)t.__setDigit(o,0)}static __toStringBasePowerOfTwo(t,n){const i=t.length;let o=n-1;o=(85&o>>>1)+(85&o),o=(51&o>>>2)+(51&o),o=(15&o>>>4)+(15&o);const r=o,a=n-1,s=t.__digit(i-1),l=d.__clz32(s);let h=0|(32*i-l+r-1)/r;if(t.sign&&h++,268435456<h)throw new Error("string too long");const g=Array(h);let w=h-1,_=0,C=0;for(let N=0;N<i-1;N++){const U=t.__digit(N),K=(_|U<<C)&a;g[w--]=d.__kConversionChars[K];const A=r-C;for(_=U>>>A,C=32-A;C>=r;)g[w--]=d.__kConversionChars[_&a],_>>>=r,C-=r}const E=(_|s<<C)&a;for(g[w--]=d.__kConversionChars[E],_=s>>>r-C;_!==0;)g[w--]=d.__kConversionChars[_&a],_>>>=r;if(t.sign&&(g[w--]="-"),w!=-1)throw new Error("implementation bug");return g.join("")}static __toStringGeneric(t,n,i){const o=t.length;if(o===0)return"";if(o===1){let N=t.__unsignedDigit(0).toString(n);return i===!1&&t.sign&&(N="-"+N),N}const r=32*o-d.__clz32(t.__digit(o-1)),a=d.__kMaxBitsPerChar[n],s=a-1;let l=r*d.__kBitsPerCharTableMultiplier;l+=s-1,l=0|l/s;const h=l+1>>1,g=d.exponentiate(d.__oneDigit(n,!1),d.__oneDigit(h,!1));let w,_;const C=g.__unsignedDigit(0);if(g.length===1&&65535>=C){w=new d(t.length,!1),w.__initializeDigits();let N=0;for(let U=2*t.length-1;0<=U;U--){const K=N<<16|t.__halfDigit(U);w.__setHalfDigit(U,0|K/C),N=0|K%C}_=N.toString(n)}else{const N=d.__absoluteDivLarge(t,g,!0,!0);w=N.quotient;const U=N.remainder.__trim();_=d.__toStringGeneric(U,n,!0)}w.__trim();let E=d.__toStringGeneric(w,n,!0);for(;_.length<h;)_="0"+_;return i===!1&&t.sign&&(E="-"+E),E+_}static __unequalSign(t){return t?-1:1}static __absoluteGreater(t){return t?-1:1}static __absoluteLess(t){return t?1:-1}static __compareToBigInt(t,n){const i=t.sign;if(i!==n.sign)return d.__unequalSign(i);const o=d.__absoluteCompare(t,n);return 0<o?d.__absoluteGreater(i):0>o?d.__absoluteLess(i):0}static __compareToNumber(t,n){if(n|!0){const i=t.sign,o=0>n;if(i!==o)return d.__unequalSign(i);if(t.length===0){if(o)throw new Error("implementation bug");return n===0?0:-1}if(1<t.length)return d.__absoluteGreater(i);const r=Math.abs(n),a=t.__unsignedDigit(0);return a>r?d.__absoluteGreater(i):a<r?d.__absoluteLess(i):0}return d.__compareToDouble(t,n)}static __compareToDouble(t,n){if(n!==n)return n;if(n===1/0)return-1;if(n===-1/0)return 1;const i=t.sign;if(i!==0>n)return d.__unequalSign(i);if(n===0)throw new Error("implementation bug: should be handled elsewhere");if(t.length===0)return-1;d.__kBitConversionDouble[0]=n;const o=2047&d.__kBitConversionInts[1]>>>20;if(o==2047)throw new Error("implementation bug: handled elsewhere");const r=o-1023;if(0>r)return d.__absoluteGreater(i);const a=t.length;let s=t.__digit(a-1);const l=d.__clz32(s),h=32*a-l,g=r+1;if(h<g)return d.__absoluteLess(i);if(h>g)return d.__absoluteGreater(i);let w=1048576|1048575&d.__kBitConversionInts[1],_=d.__kBitConversionInts[0];const C=20,E=31-l;if(E!==(h-1)%31)throw new Error("implementation bug");let N,U=0;if(20>E){const K=C-E;U=K+32,N=w>>>K,w=w<<32-K|_>>>K,_<<=32-K}else if(E===20)U=32,N=w,w=_;else{const K=E-C;U=32-K,N=w<<K|_>>>32-K,w=_<<K}if(s>>>=0,N>>>=0,s>N)return d.__absoluteGreater(i);if(s<N)return d.__absoluteLess(i);for(let K=a-2;0<=K;K--){0<U?(U-=32,N=w>>>0,w=_,_=0):N=0;const A=t.__unsignedDigit(K);if(A>N)return d.__absoluteGreater(i);if(A<N)return d.__absoluteLess(i)}if(w!==0||_!==0){if(U===0)throw new Error("implementation bug");return d.__absoluteLess(i)}return 0}static __equalToNumber(t,n){var i=Math.abs;return n|n===0?n===0?t.length===0:t.length===1&&t.sign===0>n&&t.__unsignedDigit(0)===i(n):d.__compareToDouble(t,n)===0}static __comparisonResultToBool(t,n){switch(n){case 0:return 0>t;case 1:return 0>=t;case 2:return 0<t;case 3:return 0<=t}throw new Error("unreachable")}static __compare(t,n,i){if(t=d.__toPrimitive(t),n=d.__toPrimitive(n),typeof t=="string"&&typeof n=="string")switch(i){case 0:return t<n;case 1:return t<=n;case 2:return t>n;case 3:return t>=n}if(d.__isBigInt(t)&&typeof n=="string")return n=d.__fromString(n),n!==null&&d.__comparisonResultToBool(d.__compareToBigInt(t,n),i);if(typeof t=="string"&&d.__isBigInt(n))return t=d.__fromString(t),t!==null&&d.__comparisonResultToBool(d.__compareToBigInt(t,n),i);if(t=d.__toNumeric(t),n=d.__toNumeric(n),d.__isBigInt(t)){if(d.__isBigInt(n))return d.__comparisonResultToBool(d.__compareToBigInt(t,n),i);if(typeof n!="number")throw new Error("implementation bug");return d.__comparisonResultToBool(d.__compareToNumber(t,n),i)}if(typeof t!="number")throw new Error("implementation bug");if(d.__isBigInt(n))return d.__comparisonResultToBool(d.__compareToNumber(n,t),2^i);if(typeof n!="number")throw new Error("implementation bug");return i===0?t<n:i===1?t<=n:i===2?t>n:i===3?t>=n:void 0}__clzmsd(){return d.__clz32(this[this.length-1])}static __absoluteAdd(t,n,i){if(t.length<n.length)return d.__absoluteAdd(n,t,i);if(t.length===0)return t;if(n.length===0)return t.sign===i?t:d.unaryMinus(t);let o=t.length;(t.__clzmsd()===0||n.length===t.length&&n.__clzmsd()===0)&&o++;const r=new d(o,i);let a=0,s=0;for(;s<n.length;s++){const l=n.__digit(s),h=t.__digit(s),g=(65535&h)+(65535&l)+a,w=(h>>>16)+(l>>>16)+(g>>>16);a=w>>>16,r.__setDigit(s,65535&g|w<<16)}for(;s<t.length;s++){const l=t.__digit(s),h=(65535&l)+a,g=(l>>>16)+(h>>>16);a=g>>>16,r.__setDigit(s,65535&h|g<<16)}return s<r.length&&r.__setDigit(s,a),r.__trim()}static __absoluteSub(t,n,i){if(t.length===0)return t;if(n.length===0)return t.sign===i?t:d.unaryMinus(t);const o=new d(t.length,i);let r=0,a=0;for(;a<n.length;a++){const s=t.__digit(a),l=n.__digit(a),h=(65535&s)-(65535&l)-r;r=1&h>>>16;const g=(s>>>16)-(l>>>16)-r;r=1&g>>>16,o.__setDigit(a,65535&h|g<<16)}for(;a<t.length;a++){const s=t.__digit(a),l=(65535&s)-r;r=1&l>>>16;const h=(s>>>16)-r;r=1&h>>>16,o.__setDigit(a,65535&l|h<<16)}return o.__trim()}static __absoluteAddOne(t,n,i=null){const o=t.length;i===null?i=new d(o,n):i.sign=n;let r=!0;for(let a,s=0;s<o;s++){if(a=t.__digit(s),r){const l=a===-1;a=0|a+1,r=l}i.__setDigit(s,a)}return r&&i.__setDigitGrow(o,1),i}static __absoluteSubOne(t,n){const i=t.length;n=n||i;const o=new d(n,!1);let r=!0;for(let a,s=0;s<i;s++){if(a=t.__digit(s),r){const l=a===0;a=0|a-1,r=l}o.__setDigit(s,a)}if(r)throw new Error("implementation bug");for(let a=i;a<n;a++)o.__setDigit(a,0);return o}static __absoluteAnd(t,n,i=null){let o=t.length,r=n.length,a=r;if(o<r){a=o;const h=t,g=o;t=n,o=r,n=h,r=g}let s=a;i===null?i=new d(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&n.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteAndNot(t,n,i=null){const o=t.length,r=n.length;let a=r;o<r&&(a=o);let s=o;i===null?i=new d(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&~n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteOr(t,n,i=null){let o=t.length,r=n.length,a=r;if(o<r){a=o;const h=t,g=o;t=n,o=r,n=h,r=g}let s=o;i===null?i=new d(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)|n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteXor(t,n,i=null){let o=t.length,r=n.length,a=r;if(o<r){a=o;const h=t,g=o;t=n,o=r,n=h,r=g}let s=o;i===null?i=new d(s,!1):s=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)^n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<s;l++)i.__setDigit(l,0);return i}static __absoluteCompare(t,n){const i=t.length-n.length;if(i!=0)return i;let o=t.length-1;for(;0<=o&&t.__digit(o)===n.__digit(o);)o--;return 0>o?0:t.__unsignedDigit(o)>n.__unsignedDigit(o)?1:-1}static __multiplyAccumulate(t,n,i,o){if(n===0)return;const r=65535&n,a=n>>>16;let s=0,l=0,h=0;for(let g=0;g<t.length;g++,o++){let w=i.__digit(o),_=65535&w,C=w>>>16;const E=t.__digit(g),N=65535&E,U=E>>>16,K=d.__imul(N,r),A=d.__imul(N,a),F=d.__imul(U,r),X=d.__imul(U,a);_+=l+(65535&K),C+=h+s+(_>>>16)+(K>>>16)+(65535&A)+(65535&F),s=C>>>16,l=(A>>>16)+(F>>>16)+(65535&X)+s,s=l>>>16,l&=65535,h=X>>>16,w=65535&_|C<<16,i.__setDigit(o,w)}for(;s!=0||l!==0||h!==0;o++){let g=i.__digit(o);const w=(65535&g)+l,_=(g>>>16)+(w>>>16)+h+s;l=0,h=0,s=_>>>16,g=65535&w|_<<16,i.__setDigit(o,g)}}static __internalMultiplyAdd(t,n,i,o,r){let a=i,s=0;for(let l=0;l<o;l++){const h=t.__digit(l),g=d.__imul(65535&h,n),w=(65535&g)+s+a;a=w>>>16;const _=d.__imul(h>>>16,n),C=(65535&_)+(g>>>16)+a;a=C>>>16,s=_>>>16,r.__setDigit(l,C<<16|65535&w)}if(r.length>o)for(r.__setDigit(o++,a+s);o<r.length;)r.__setDigit(o++,0);else if(a+s!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(t,n,i){i>this.length&&(i=this.length);const o=65535&t,r=t>>>16;let a=0,s=65535&n,l=n>>>16;for(let h=0;h<i;h++){const g=this.__digit(h),w=65535&g,_=g>>>16,C=d.__imul(w,o),E=d.__imul(w,r),N=d.__imul(_,o),U=d.__imul(_,r),K=s+(65535&C),A=l+a+(K>>>16)+(C>>>16)+(65535&E)+(65535&N);s=(E>>>16)+(N>>>16)+(65535&U)+(A>>>16),a=s>>>16,s&=65535,l=U>>>16,this.__setDigit(h,65535&K|A<<16)}if(a!=0||s!==0||l!==0)throw new Error("implementation bug")}static __absoluteDivSmall(t,n,i){i===null&&(i=new d(t.length,!1));let o=0;for(let r,a=2*t.length-1;0<=a;a-=2){r=(o<<16|t.__halfDigit(a))>>>0;const s=0|r/n;o=0|r%n,r=(o<<16|t.__halfDigit(a-1))>>>0;const l=0|r/n;o=0|r%n,i.__setDigit(a>>>1,s<<16|l)}return i}static __absoluteModSmall(t,n){let i=0;for(let o=2*t.length-1;0<=o;o--){const r=(i<<16|t.__halfDigit(o))>>>0;i=0|r%n}return i}static __absoluteDivLarge(t,n,i,o){const r=n.__halfDigitLength(),a=n.length,s=t.__halfDigitLength()-r;let l=null;i&&(l=new d(s+2>>>1,!1),l.__initializeDigits());const h=new d(r+2>>>1,!1);h.__initializeDigits();const g=d.__clz16(n.__halfDigit(r-1));0<g&&(n=d.__specialLeftShift(n,g,0));const w=d.__specialLeftShift(t,g,1),_=n.__halfDigit(r-1);let C=0;for(let E,N=s;0<=N;N--){E=65535;const U=w.__halfDigit(N+r);if(U!==_){const A=(U<<16|w.__halfDigit(N+r-1))>>>0;E=0|A/_;let F=0|A%_;const X=n.__halfDigit(r-2),pe=w.__halfDigit(N+r-2);for(;d.__imul(E,X)>>>0>(F<<16|pe)>>>0&&(E--,F+=_,!(65535<F)););}d.__internalMultiplyAdd(n,E,0,a,h);let K=w.__inplaceSub(h,N,r+1);K!==0&&(K=w.__inplaceAdd(n,N,r),w.__setHalfDigit(N+r,w.__halfDigit(N+r)+K),E--),i&&(1&N?C=E<<16:l.__setDigit(N>>>1,C|E))}return o?(w.__inplaceRightShift(g),i?{quotient:l,remainder:w}:w):i?l:void 0}static __clz16(t){return d.__clz32(t)-16}__inplaceAdd(t,n,i){let o=0;for(let r=0;r<i;r++){const a=this.__halfDigit(n+r)+t.__halfDigit(r)+o;o=a>>>16,this.__setHalfDigit(n+r,a)}return o}__inplaceSub(t,n,i){let o=0;if(1&n){n>>=1;let r=this.__digit(n),a=65535&r,s=0;for(;s<i-1>>>1;s++){const g=t.__digit(s),w=(r>>>16)-(65535&g)-o;o=1&w>>>16,this.__setDigit(n+s,w<<16|65535&a),r=this.__digit(n+s+1),a=(65535&r)-(g>>>16)-o,o=1&a>>>16}const l=t.__digit(s),h=(r>>>16)-(65535&l)-o;if(o=1&h>>>16,this.__setDigit(n+s,h<<16|65535&a),n+s+1>=this.length)throw new RangeError("out of bounds");(1&i)==0&&(r=this.__digit(n+s+1),a=(65535&r)-(l>>>16)-o,o=1&a>>>16,this.__setDigit(n+t.length,4294901760&r|65535&a))}else{n>>=1;let r=0;for(;r<t.length-1;r++){const g=this.__digit(n+r),w=t.__digit(r),_=(65535&g)-(65535&w)-o;o=1&_>>>16;const C=(g>>>16)-(w>>>16)-o;o=1&C>>>16,this.__setDigit(n+r,C<<16|65535&_)}const a=this.__digit(n+r),s=t.__digit(r),l=(65535&a)-(65535&s)-o;o=1&l>>>16;let h=0;(1&i)==0&&(h=(a>>>16)-(s>>>16)-o,o=1&h>>>16),this.__setDigit(n+r,h<<16|65535&l)}return o}__inplaceRightShift(t){if(t===0)return;let n=this.__digit(0)>>>t;const i=this.length-1;for(let o=0;o<i;o++){const r=this.__digit(o+1);this.__setDigit(o,r<<32-t|n),n=r>>>t}this.__setDigit(i,n)}static __specialLeftShift(t,n,i){const o=t.length,r=new d(o+i,!1);if(n===0){for(let s=0;s<o;s++)r.__setDigit(s,t.__digit(s));return 0<i&&r.__setDigit(o,0),r}let a=0;for(let s=0;s<o;s++){const l=t.__digit(s);r.__setDigit(s,l<<n|a),a=l>>>32-n}return 0<i&&r.__setDigit(o,a),r}static __leftShiftByAbsolute(t,n){const i=d.__toShiftAmount(n);if(0>i)throw new RangeError("BigInt too big");const o=i>>>5,r=31&i,a=t.length,s=r!==0&&t.__digit(a-1)>>>32-r!=0,l=a+o+(s?1:0),h=new d(l,t.sign);if(r===0){let g=0;for(;g<o;g++)h.__setDigit(g,0);for(;g<l;g++)h.__setDigit(g,t.__digit(g-o))}else{let g=0;for(let w=0;w<o;w++)h.__setDigit(w,0);for(let w=0;w<a;w++){const _=t.__digit(w);h.__setDigit(w+o,_<<r|g),g=_>>>32-r}if(s)h.__setDigit(a+o,g);else if(g!==0)throw new Error("implementation bug")}return h.__trim()}static __rightShiftByAbsolute(t,n){const i=t.length,o=t.sign,r=d.__toShiftAmount(n);if(0>r)return d.__rightShiftByMaximum(o);const a=r>>>5,s=31&r;let l=i-a;if(0>=l)return d.__rightShiftByMaximum(o);let h=!1;if(o){if((t.__digit(a)&(1<<s)-1)!=0)h=!0;else for(let w=0;w<a;w++)if(t.__digit(w)!==0){h=!0;break}}h&&s===0&&~t.__digit(i-1)==0&&l++;let g=new d(l,o);if(s===0)for(let w=a;w<i;w++)g.__setDigit(w-a,t.__digit(w));else{let w=t.__digit(a)>>>s;const _=i-a-1;for(let C=0;C<_;C++){const E=t.__digit(C+a+1);g.__setDigit(C,E<<32-s|w),w=E>>>s}g.__setDigit(_,w)}return h&&(g=d.__absoluteAddOne(g,!0,g)),g.__trim()}static __rightShiftByMaximum(t){return t?d.__oneDigit(1,!0):d.__zero()}static __toShiftAmount(t){if(1<t.length)return-1;const n=t.__unsignedDigit(0);return n>d.__kMaxLengthBits?-1:n}static __toPrimitive(t,n="default"){if(typeof t!="object"||t.constructor===d)return t;const i=t[Symbol.toPrimitive];if(i){const a=i(n);if(typeof a!="object")return a;throw new TypeError("Cannot convert object to primitive value")}const o=t.valueOf;if(o){const a=o.call(t);if(typeof a!="object")return a}const r=t.toString;if(r){const a=r.call(t);if(typeof a!="object")return a}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(t){return d.__isBigInt(t)?t:+t}static __isBigInt(t){return typeof t=="object"&&t!==null&&t.constructor===d}static __truncateToNBits(t,n){const i=t+31>>>5,o=new d(i,n.sign),r=i-1;for(let s=0;s<r;s++)o.__setDigit(s,n.__digit(s));let a=n.__digit(r);if((31&t)!=0){const s=32-(31&t);a=a<<s>>>s}return o.__setDigit(r,a),o.__trim()}static __truncateAndSubFromPowerOfTwo(t,n,i){var o=Math.min;const r=t+31>>>5,a=new d(r,i);let s=0;const l=r-1;let h=0;for(const C=o(l,n.length);s<C;s++){const E=n.__digit(s),N=0-(65535&E)-h;h=1&N>>>16;const U=0-(E>>>16)-h;h=1&U>>>16,a.__setDigit(s,65535&N|U<<16)}for(;s<l;s++)a.__setDigit(s,0|-h);let g=l<n.length?n.__digit(l):0;const w=31&t;let _;if(w==0){const C=0-(65535&g)-h;h=1&C>>>16;const E=0-(g>>>16)-h;_=65535&C|E<<16}else{const C=32-w;g=g<<C>>>C;const E=1<<32-C,N=(65535&E)-(65535&g)-h;h=1&N>>>16;const U=(E>>>16)-(g>>>16)-h;_=65535&N|U<<16,_&=E-1}return a.__setDigit(l,_),a.__trim()}__digit(t){return this[t]}__unsignedDigit(t){return this[t]>>>0}__setDigit(t,n){this[t]=0|n}__setDigitGrow(t,n){this[t]=0|n}__halfDigitLength(){const t=this.length;return 65535>=this.__unsignedDigit(t-1)?2*t-1:2*t}__halfDigit(t){return 65535&this[t>>>1]>>>((1&t)<<4)}__setHalfDigit(t,n){const i=t>>>1,o=this.__digit(i),r=1&t?65535&o|n<<16:4294901760&o|65535&n;this.__setDigit(i,r)}static __digitPow(t,n){let i=1;for(;0<n;)1&n&&(i*=t),n>>>=1,t*=t;return i}}d.__kMaxLength=33554432,d.__kMaxLengthBits=d.__kMaxLength<<5,d.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],d.__kBitsPerCharTableShift=5,d.__kBitsPerCharTableMultiplier=1<<d.__kBitsPerCharTableShift,d.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],d.__kBitConversionBuffer=new ArrayBuffer(8),d.__kBitConversionDouble=new Float64Array(d.__kBitConversionBuffer),d.__kBitConversionInts=new Int32Array(d.__kBitConversionBuffer),d.__clz32=Math.clz32||function(e){return e===0?32:0|31-(0|Math.log(e>>>0)/Math.LN2)},d.__imul=Math.imul||function(e,t){return 0|e*t};var Ag=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Ig=18446744073709552e3,Tr=function(e,t){return d.bitwiseXor(d.asUintN(64,d.leftShift(e,d.BigInt(t))),d.BigInt(d.asUintN(64,d.signedRightShift(e,d.subtract(d.BigInt(64),d.BigInt(t))))))},Rg=function(){function e(t){var n=this;this.next=function(){return new qr(n.roll().toString())},this.nextDouble=function(){return new qr(n.roll().toString()).div(Ig+1)},this.nextInt=function(o,r){return Math.floor(n.nextDouble().toNumber()*(r-o+1)+o)},this.nextByte=function(){return n.nextInt(0,255)},this.nextData=function(o){return Ag(new Array(o)).map(function(){return n.nextByte()})};var i=lm(t);this.s=[d.BigInt(0),d.BigInt(0),d.BigInt(0),d.BigInt(0)],this.setS(i)}return e.prototype.setS=function(t){for(var n=0;n<4;n++){for(var i=n*8,o=d.BigInt(0),r=0;r<8;r++)o=d.asUintN(64,d.leftShift(o,d.BigInt(8))),o=d.asUintN(64,d.bitwiseOr(o,d.BigInt(t[i+r])));this.s[n]=d.asUintN(64,o)}},e.prototype.roll=function(){var t=d.asUintN(64,d.multiply(Tr(d.asUintN(64,d.multiply(this.s[1],d.BigInt(5))),7),d.BigInt(9))),n=d.asUintN(64,d.leftShift(this.s[1],d.BigInt(17)));return this.s[2]=d.asUintN(64,d.bitwiseXor(this.s[2],d.BigInt(this.s[0]))),this.s[3]=d.asUintN(64,d.bitwiseXor(this.s[3],d.BigInt(this.s[1]))),this.s[1]=d.asUintN(64,d.bitwiseXor(this.s[1],d.BigInt(this.s[2]))),this.s[0]=d.asUintN(64,d.bitwiseXor(this.s[0],d.BigInt(this.s[3]))),this.s[2]=d.asUintN(64,d.bitwiseXor(this.s[2],d.BigInt(n))),this.s[3]=d.asUintN(64,Tr(this.s[3],45)),t},e}();function si(e,t,n){this.alias=[],this.prob=[],this.outcomes=t||this.indexedOutcomes(e.length),this.rng=n||Math.random,this.precomputeAlias(e)}si.prototype.next=function(e){var t=e||1,n=[],i=0;do{var o=Math.floor(this.rng()*this.prob.length);n[i]=this.outcomes[this.rng()<this.prob[o]?o:this.alias[o]]}while(++i<t);return t>1?n:n[0]};si.prototype.precomputeAlias=function(e){var t=e.length,n=0,i=0,o=0,r=[],a=[],s=[],l,h,g;for(h=0;h<t;++h){if(e[h]<0)throw"Probability must be a positive: p["+h+"]="+e[h];n+=e[h]}if(n===0)throw"Probability cannot be zero.";for(h=0;h<t;++h)r[h]=e[h]*t/n;for(h=t-1;h>=0;--h)r[h]<1?a[i++]=h:s[o++]=h;for(;i&&o;)g=a[--i],l=s[--o],this.prob[g]=r[g],this.alias[g]=l,r[l]=r[l]+r[g]-1,r[l]<1?a[i++]=l:s[o++]=l;for(;o;)this.prob[s[--o]]=1;for(;i;)this.prob[a[--i]]=1};si.prototype.indexedOutcomes=function(e){for(var t=[],n=0;n<e;n++)t[n]=n;return t};si.prototype.randomInt=function(e,t){return Math.floor(this.rng()*(t-e))+e};var Ug=function(e,t,n){return new si(e,t,n)},Oo=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Ng=function(e,t){var n=Oo(new Array(e)).map(function(o,r){return 1/(r+1)}),i=Ug(n,null,t.nextDouble);return i.next()+1},Og=function(e,t){for(var n=Oo(e),i=[];n.length>0;){var o=t.nextInt(0,n.length-1),r=n[o];n.splice(o,1),i.push(r)}return i},Ia=function(e,t,n){if(e<=t)return[e-1];var i=Ne.Buffer.concat([br(e),br(n)]),o=new Rg(i),r=Ng(t,o),a=Oo(new Array(t)).map(function(l,h){return h}),s=Og(a,o);return s.slice(0,r)},Ra=function(){function e(t,n,i,o,r){this._seqNum=t,this._seqLength=n,this._messageLength=i,this._checksum=o,this._fragment=r}return Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqNum",{get:function(){return this._seqNum},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqLength",{get:function(){return this._seqLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checksum",{get:function(){return this._checksum},enumerable:!1,configurable:!0}),e.prototype.cbor=function(){var t=xa([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return Ne.Buffer.from(t)},e.prototype.description=function(){return"seqNum:"+this._seqNum+", seqLen:"+this._seqLength+", messageLen:"+this._messageLength+", checksum:"+this._checksum+", data:"+this._fragment.toString("hex")},e.fromCBOR=function(t){var n=Ea(t),i=n[0],o=n[1],r=n[2],a=n[3],s=n[4];if(typeof i!="number"||typeof o!="number"||typeof r!="number"||typeof a!="number"||Ne.Buffer.isBuffer(s)&&s.length<=0)throw new Error("type error");return new e(i,o,r,a,Ne.Buffer.from(s))},e}(),Lg=function(){function e(t,n,i,o){n===void 0&&(n=100),i===void 0&&(i=0),o===void 0&&(o=10);var r=e.findNominalFragmentLength(t.length,o,n);this._messageLength=t.length,this._fragments=e.partitionMessage(t,r),this.fragmentLength=r,this.seqNum=vo(i),this.checksum=ya(t)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this._fragments.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this._fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),e.prototype.isComplete=function(){return this.seqNum>=this._fragments.length},e.prototype.isSinglePart=function(){return this._fragments.length===1},e.prototype.seqLength=function(){return this._fragments.length},e.prototype.mix=function(t){var n=this;return t.reduce(function(i,o){return _a(n._fragments[o],i)},Ne.Buffer.alloc(this.fragmentLength,0))},e.prototype.nextPart=function(){this.seqNum=vo(this.seqNum+1);var t=Ia(this.seqNum,this._fragments.length,this.checksum),n=this.mix(t);return new Ra(this.seqNum,this._fragments.length,this._messageLength,this.checksum,n)},e.findNominalFragmentLength=function(t,n,i){if(t<=0||n<=0||i<n)throw new Error("invalid fragment or message length");for(var o=Math.ceil(t/n),r=0,a=1;a<=o&&(r=Math.ceil(t/a),!(r<=i));a++);return r},e.partitionMessage=function(t,n){for(var i,o=Ne.Buffer.from(t),r,a=[];o.length>0;)i=pa(o,-n),r=i[0],o=i[1],r=Ne.Buffer.alloc(n,0).fill(r,0,r.length),a.push(r);return a},e}(),Ua=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Bg="ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom",yi=[],Vg=256,rn=4,Fg=2,xt;(function(e){e.STANDARD="standard",e.URI="uri",e.MINIMAL="minimal"})(xt||(xt={}));var Ei=function(e){return Bg.slice(e*rn,e*rn+rn)},zg=function(e){var t=Ei(e);return""+t[0]+t[rn-1]},Na=function(e){var t=wa(Ne.Buffer.from(e,"hex"));return""+e+t},Pr=function(e,t){var n=Na(e),i=Ne.Buffer.from(n,"hex"),o=i.reduce(function(r,a){return Ua(r,[Ei(a)])},[]);return o.join(t)},jg=function(e){var t=Na(e),n=Ne.Buffer.from(t,"hex"),i=n.reduce(function(o,r){return o+zg(r)},"");return i},Wg=function(e,t){if(e.length!==t)throw new Error("'Invalid Bytewords: word.length does not match wordLength provided'");var n=26;if(yi.length===0){var i=n*n;yi=Ua(new Array(i)).map(function(){return-1});for(var o=0;o<Vg;o++){var r=Ei(o),a=r[0].charCodeAt(0)-"a".charCodeAt(0),s=r[3].charCodeAt(0)-"a".charCodeAt(0),l=s*n+a;yi[l]=o}}var h=e[0].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),g=e[t==4?3:1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0);if(!(0<=h&&h<n&&0<=g&&g<n))throw new Error("Invalid Bytewords: invalid word");var w=g*n+h,_=yi[w];if(_===-1)throw new Error("Invalid Bytewords: value not in lookup table");if(t==rn){var r=Ei(_),C=e[1].toLowerCase(),E=e[2].toLowerCase();if(!(C===r[1]&&E===r[2]))throw new Error("Invalid Bytewords: invalid middle letters of word")}return Ne.Buffer.from([_]).toString("hex")},lo=function(e,t,n){var i=n==rn?e.split(t):um(e,2),o=i.map(function(h){return Wg(h,n)}).join("");if(o.length<5)throw new Error("Invalid Bytewords: invalid decoded string length");var r=pa(Ne.Buffer.from(o,"hex"),4),a=r[0],s=r[1],l=wa(a);if(l!==s.toString("hex"))throw new Error("Invalid Checksum");return a.toString("hex")},Hg=function(e,t){switch(t===void 0&&(t=xt.MINIMAL),t){case xt.STANDARD:return lo(e," ",rn);case xt.URI:return lo(e,"-",rn);case xt.MINIMAL:return lo(e,"",Fg);default:throw new Error("Invalid style "+t)}},Kg=function(e,t){switch(t===void 0&&(t=xt.MINIMAL),t){case xt.STANDARD:return Pr(e," ");case xt.URI:return Pr(e,"-");case xt.MINIMAL:return jg(e);default:throw new Error("Invalid style "+t)}},on={decode:Hg,encode:Kg,STYLES:xt},Qg=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},Xg=function(){function e(t,n,i,o){this.ur=t,this.fountainEncoder=new Lg(t.cbor,n,i,o)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this.fountainEncoder.fragmentsLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this.fountainEncoder.fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this.fountainEncoder.messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this.ur.cbor},enumerable:!1,configurable:!0}),e.prototype.encodeWhole=function(){var t=this;return Qg(new Array(this.fragmentsLength)).map(function(){return t.nextPart()})},e.prototype.nextPart=function(){var t=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?e.encodeSinglePart(this.ur):e.encodePart(this.ur.type,t)},e.encodeUri=function(t,n){var i=n.join("/");return[t,i].join(":")},e.encodeUR=function(t){return e.encodeUri("ur",t)},e.encodePart=function(t,n){var i=n.seqNum+"-"+n.seqLength,o=on.encode(n.cbor().toString("hex"),on.STYLES.MINIMAL);return e.encodeUR([t,i,o])},e.encodeSinglePart=function(t){var n=on.encode(t.cbor.toString("hex"),on.STYLES.MINIMAL);return e.encodeUR([t.type,n])},e}(),wi=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},$r=function(){function e(t,n){this._indexes=t,this._fragment=n}return Object.defineProperty(e.prototype,"indexes",{get:function(){return this._indexes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),e.fromEncoderPart=function(t){var n=Ia(t.seqNum,t.seqLength,t.checksum),i=t.fragment;return new e(n,i)},e.prototype.isSimple=function(){return this.indexes.length===1},e}(),Gg=function(){function e(){this.result=void 0,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}return e.prototype.validatePart=function(t){var n=this;if(this.expectedPartIndexes.length===0)wi(new Array(t.seqLength)).forEach(function(i,o){return n.expectedPartIndexes.push(o)}),this.expectedMessageLength=t.messageLength,this.expectedChecksum=t.checksum,this.expectedFragmentLength=t.fragment.length;else if(this.expectedPartIndexes.length!==t.seqLength||this.expectedMessageLength!==t.messageLength||this.expectedChecksum!==t.checksum||this.expectedFragmentLength!==t.fragment.length)return!1;return!0},e.prototype.reducePartByPart=function(t,n){if(cm(t.indexes,n.indexes)){var i=dm(t.indexes,n.indexes),o=_a(t.fragment,n.fragment);return new $r(i,o)}else return t},e.prototype.reduceMixedBy=function(t){var n=this,i=[];this.mixedParts.map(function(o){var r=o.value;return n.reducePartByPart(r,t)}).forEach(function(o){o.isSimple()?n.queuedParts.push(o):i.push({key:o.indexes,value:o})}),this.mixedParts=i},e.prototype.processSimplePart=function(t){var n=t.indexes[0];if(!this.receivedPartIndexes.includes(n))if(this.simpleParts.push({key:t.indexes,value:t}),this.receivedPartIndexes.push(n),kr(this.receivedPartIndexes,this.expectedPartIndexes)){var i=this.simpleParts.map(function(a){var s=a.value;return s}).sort(function(a,s){return a.indexes[0]-s.indexes[0]}),o=e.joinFragments(i.map(function(a){return a.fragment}),this.expectedMessageLength),r=ya(o);r===this.expectedChecksum?this.result=o:this.error=new am}else this.reduceMixedBy(t)},e.prototype.processMixedPart=function(t){var n=this;if(!this.mixedParts.some(function(o){var r=o.key;return kr(r,t.indexes)})){var i=this.simpleParts.reduce(function(o,r){var a=r.value;return n.reducePartByPart(o,a)},t);i=this.mixedParts.reduce(function(o,r){var a=r.value;return n.reducePartByPart(o,a)},i),i.isSimple()?this.queuedParts.push(i):(this.reduceMixedBy(i),this.mixedParts.push({key:i.indexes,value:i}))}},e.prototype.processQueuedItem=function(){if(this.queuedParts.length!==0){var t=this.queuedParts.shift();t.isSimple()?this.processSimplePart(t):this.processMixedPart(t)}},e.prototype.receivePart=function(t){if(this.isComplete()||!this.validatePart(t))return!1;var n=$r.fromEncoderPart(t);for(this.lastPartIndexes=n.indexes,this.queuedParts.push(n);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0},e.prototype.isComplete=function(){return Boolean(this.result!==void 0&&this.result.length>0)},e.prototype.isSuccess=function(){return Boolean(this.error===void 0&&this.isComplete())},e.prototype.resultMessage=function(){return this.isSuccess()?this.result:Ne.Buffer.from([])},e.prototype.isFailure=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.expectedPartIndexes.length},e.prototype.getExpectedPartIndexes=function(){return wi(this.expectedPartIndexes)},e.prototype.getReceivedPartIndexes=function(){return wi(this.receivedPartIndexes)},e.prototype.getLastPartIndexes=function(){return wi(this.lastPartIndexes)},e.prototype.estimatedPercentComplete=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:Math.min(.99,this.processedPartsCount/(t*1.75))},e.prototype.getProgress=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:this.receivedPartIndexes.length/t},e.joinFragments=function(t,n){return Ne.Buffer.concat(t).slice(0,n)},e}(),Yg=function(){function e(t,n){if(t===void 0&&(t=new Gg),n===void 0&&(n="bytes"),this.fountainDecoder=t,this.type=n,!Ci(n))throw new Error("Invalid UR type");this.expected_type=""}return e.decodeBody=function(t,n){var i=on.decode(n,on.STYLES.MINIMAL);return new Si(Ne.Buffer.from(i,"hex"),t)},e.prototype.validatePart=function(t){return this.expected_type?this.expected_type===t:Ci(t)?(this.expected_type=t,!0):!1},e.decode=function(t){var n=this.parse(t),i=n[0],o=n[1];if(o.length===0)throw new io;var r=o[0];return e.decodeBody(i,r)},e.parse=function(t){var n=t.toLowerCase(),i=n.slice(0,3);if(i!=="ur:")throw new wr;var o=n.slice(3).split("/"),r=o[0];if(o.length<2)throw new io;if(!Ci(r))throw new ga;return[r,o.slice(1)]},e.parseSequenceComponent=function(t){var n=t.split("-");if(n.length!==2)throw new _r;var i=vo(Number(n[0])),o=Number(n[1]);if(i<1||o<1)throw new _r;return[i,o]},e.prototype.receivePart=function(t){if(this.result!==void 0)return!1;var n=e.parse(t),i=n[0],o=n[1];if(!this.validatePart(i))return!1;if(o.length===1)return this.result=e.decodeBody(i,o[0]),!0;if(o.length!==2)throw new io;var r=o[0],a=o[1],s=e.parseSequenceComponent(r),l=s[0],h=s[1],g=on.decode(a,on.STYLES.MINIMAL),w=Ra.fromCBOR(g);return l!==w.seqNum||h!==w.seqLength||!this.fountainDecoder.receivePart(w)?!1:(this.fountainDecoder.isSuccess()?this.result=new Si(this.fountainDecoder.resultMessage(),i):this.fountainDecoder.isFailure()&&(this.error=new wr),!0)},e.prototype.resultUR=function(){return this.result?this.result:new Si(Ne.Buffer.from([]))},e.prototype.isComplete=function(){return!!(this.result&&this.result.cbor.length>0)},e.prototype.isSuccess=function(){return!this.error&&this.isComplete()},e.prototype.isError=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.fountainDecoder.expectedPartCount()},e.prototype.expectedPartIndexes=function(){return this.fountainDecoder.getExpectedPartIndexes()},e.prototype.receivedPartIndexes=function(){return this.fountainDecoder.getReceivedPartIndexes()},e.prototype.lastPartIndexes=function(){return this.fountainDecoder.getLastPartIndexes()},e.prototype.estimatedPercentComplete=function(){return this.fountainDecoder.estimatedPercentComplete()},e.prototype.getProgress=function(){return this.fountainDecoder.getProgress()},e}();const Zg=Oe({name:"SendPaymentRequest",mixins:[windowMixin],props:{},data:function(){return{}},watch:{},computed:{...ve(ni,["showSendTokens","showLockInput","sendData"]),...de(De,["activeMintUrl","mints"])},methods:{...ce(Bt,["isLocked","isLockedToUs"]),...ce(It,["parseAndPayPaymentRequest"]),clickPaymentRequest:function(){this.parseAndPayPaymentRequest(this.sendData.paymentRequest,this.sendData.tokensBase64)},getPaymentRequestTransportType:function(e){if(!e||!e.transport)return"Unknown";console.log(`### getPaymentRequestTransportType: ${e}`);const t=e.transport;for(const n of t){if(n.type==di.NOSTR)return"Nostr";if(n.type==di.POST)return"HTTP"}},getPaymentRequestTarget:function(e){if(!e||!e.transport)return"Unknown";console.log(`### getPaymentRequestDestination: ${e}`);const t=e.transport;for(const n of t){if(n.type==di.NOSTR)return`${n.target.slice(0,20)}..${n.target.slice(-10)}`;if(n.type==di.POST)try{return new URL(n.target).hostname}catch(i){return console.error(`Invalid URL in transport.target: ${n.target}`,i),"Invalid URL"}}}}}),Jg={key:0,class:"q-pa-none q-ma-none q-mt-md"},ev={class:"q-mb-md text-center"},tv={class:"q-mb-md text-center"},nv={class:"q-mt-md q-mb-md text-center",style:{"white-space":"pre-wrap","word-wrap":"break-word","max-width":"350px",margin:"0 auto"}};function iv(e,t,n,i,o,r){return e.sendData.paymentRequest?(M(),V("div",Jg,[f("div",ev,[u(L,{rounded:"",dense:"",color:"primary",class:"q-px-md",onClick:e.clickPaymentRequest},{default:m(()=>[u(me,{name:"send",class:"q-pr-xs"}),I(" Pay via "+ae(e.getPaymentRequestTransportType(e.sendData.paymentRequest)),1)]),_:1},8,["onClick"])]),f("div",tv,[f("pre",nv,ae(e.getPaymentRequestTarget(e.sendData.paymentRequest))+`
      `,1)])])):z("",!0)}var ov=Ee(Zg,[["render",iv]]);const rv=Oe({name:"NumericKeyboard",props:{modelValue:{type:String,default:"0"}},emits:["update:modelValue","done"],computed:{...ve($e,["showNumericKeyboard"]),...ve(An,["useNumericKeyboard"])},methods:{addDigit(e){const t=this.modelValue||"0",n=t==="0"?e:t+e;this.$emit("update:modelValue",n)},backspace(){const e=this.modelValue||"0",t=e.length>1?e.slice(0,-1):"0";this.$emit("update:modelValue",t)},addComma(){const e=this.modelValue||"0";e.includes(".")||this.$emit("update:modelValue",e+".")},closeKeyboard(){this.useNumericKeyboard=!1,this.showNumericKeyboard=!1,Hr("Keyboard disabled. You can re-enable the keyboard in the settings.","bottom")},emitDone(){this.$emit("done")}}}),av=e=>(Ft("data-v-3f1fbef3"),e=e(),zt(),e),sv={class:"keyboard-grid"},lv=av(()=>f("br",null,null,-1));function uv(e,t,n,i,o,r){return M(),W(Je,{name:"slide-up-fade"},{default:m(()=>[e.showNumericKeyboard?(M(),W(ct,{key:0,class:"numeric-keyboard q-pa-md q-pb-xl q-pt-lg",style:{position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%","max-width":"650px"}},{default:m(()=>[f("div",sv,[u(L,{flat:"",dense:"",class:"text-h5",onClick:t[0]||(t[0]=a=>e.addDigit("1"))},{default:m(()=>[I("1")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[1]||(t[1]=a=>e.addDigit("2"))},{default:m(()=>[I("2")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[2]||(t[2]=a=>e.addDigit("3"))},{default:m(()=>[I("3")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[3]||(t[3]=a=>e.addDigit("4"))},{default:m(()=>[I("4")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[4]||(t[4]=a=>e.addDigit("5"))},{default:m(()=>[I("5")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[5]||(t[5]=a=>e.addDigit("6"))},{default:m(()=>[I("6")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[6]||(t[6]=a=>e.addDigit("7"))},{default:m(()=>[I("7")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[7]||(t[7]=a=>e.addDigit("8"))},{default:m(()=>[I("8")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[8]||(t[8]=a=>e.addDigit("9"))},{default:m(()=>[I("9")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:e.addComma},{default:m(()=>[I(".")]),_:1},8,["onClick"]),u(L,{flat:"",dense:"",class:"text-h5",onClick:t[9]||(t[9]=a=>e.addDigit("0"))},{default:m(()=>[I("0")]),_:1}),u(L,{flat:"",dense:"",class:"text-h5",onClick:e.backspace},{default:m(()=>[u(me,{name:"backspace",size:"sm"})]),_:1},8,["onClick"]),u(L,{flat:"",dense:"",onClick:e.closeKeyboard},{default:m(()=>[I("Close")]),_:1},8,["onClick"]),lv,u(L,{flat:"",dense:"",onClick:e.emitDone},{default:m(()=>[I("Enter")]),_:1},8,["onClick"])])]),_:1})):z("",!0)]),_:1})}var Oa=Ee(rv,[["render",uv],["__scopeId","data-v-3f1fbef3"]]),fe={},vt={};Object.defineProperty(vt,"__esModule",{value:!0});vt.encodeBase64ToJson=vt.encodeJsonToBase64=vt.encodeBase64toUint8=vt.encodeUint8toBase64Url=vt.encodeUint8toBase64=void 0;var li=Ne;function cv(e){return li.Buffer.from(e).toString("base64")}vt.encodeUint8toBase64=cv;function dv(e){return li.Buffer.from(e).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}vt.encodeUint8toBase64Url=dv;function fv(e){return li.Buffer.from(e,"base64")}vt.encodeBase64toUint8=fv;function hv(e){var t=JSON.stringify(e);return vv(li.Buffer.from(t).toString("base64"))}vt.encodeJsonToBase64=hv;function mv(e){var t=li.Buffer.from(gv(e),"base64").toString(),n=JSON.parse(t);return n}vt.encodeBase64ToJson=mv;function gv(e){return e.replace(/-/g,"+").replace(/_/g,"/").split("=")[0]}function vv(e){return e.replace(/\+/g,"-").replace(/\//g,"_").split("=")[0]}var xn={};Object.defineProperty(xn,"__esModule",{value:!0});xn.TOKEN_PREFIX=xn.TOKEN_VERSION=void 0;var pv="A";xn.TOKEN_VERSION=pv;var yv="cashu";xn.TOKEN_PREFIX=yv;var fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.decodeCBOR=fn.encodeCBOR=void 0;function wv(e){return typeof e=="number"||typeof e=="string"}function _v(e){var t=[];return Lo(e,t),new Uint8Array(t)}fn.encodeCBOR=_v;function Lo(e,t){if(e===null)t.push(246);else if(e===void 0)t.push(247);else if(typeof e=="boolean")t.push(e?245:244);else if(typeof e=="number")La(e,t);else if(typeof e=="string")Ba(e,t);else if(Array.isArray(e))kv(e,t);else if(e instanceof Uint8Array)bv(e,t);else if(typeof e=="object")Dv(e,t);else throw new Error("Unsupported type")}function La(e,t){if(e<24)t.push(e);else if(e<256)t.push(24,e);else if(e<65536)t.push(25,e>>8,e&255);else if(e<4294967296)t.push(26,e>>24,e>>16&255,e>>8&255,e&255);else throw new Error("Unsupported integer size")}function bv(e,t){var n=e.length;if(n<24)t.push(64+n);else if(n<256)t.push(88,n);else if(n<65536)t.push(89,n>>8&255,n&255);else if(n<4294967296)t.push(90,n>>24&255,n>>16&255,n>>8&255,n&255);else throw new Error("Byte string too long to encode");for(var i=0;i<e.length;i++)t.push(e[i])}function Ba(e,t){var n=new TextEncoder().encode(e),i=n.length;if(i<24)t.push(96+i);else if(i<256)t.push(120,i);else if(i<65536)t.push(121,i>>8&255,i&255);else if(i<4294967296)t.push(122,i>>24&255,i>>16&255,i>>8&255,i&255);else throw new Error("String too long to encode");for(var o=0;o<n.length;o++)t.push(n[o])}function kv(e,t){var n=e.length;if(n<24)t.push(128|n);else if(n<256)t.push(152,n);else if(n<65536)t.push(153,n>>8,n&255);else throw new Error("Unsupported array length");for(var i=0,o=e;i<o.length;i++){var r=o[i];Lo(r,t)}}function Dv(e,t){var n=Object.keys(e);La(n.length,t),t[t.length-1]|=160;for(var i=0,o=n;i<o.length;i++){var r=o[i];Ba(r,t),Lo(e[r],t)}}function Cv(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=Ai(t,0);return n.value}fn.decodeCBOR=Cv;function Ai(e,t){if(t>=e.byteLength)throw new Error("Unexpected end of data");var n=e.getUint8(t++),i=n>>5,o=n&31;switch(i){case 0:return Mv(e,t,o);case 1:return Sv(e,t,o);case 2:return qv(e,t,o);case 3:return Tv(e,t,o);case 4:return Pv(e,t,o);case 5:return $v(e,t,o);case 7:return Ev(e,t,o);default:throw new Error("Unsupported major type: ".concat(i))}}function On(e,t,n){if(n<24)return{value:n,offset:t};if(n===24)return{value:e.getUint8(t++),offset:t};if(n===25){var i=e.getUint16(t,!1);return t+=2,{value:i,offset:t}}if(n===26){var i=e.getUint32(t,!1);return t+=4,{value:i,offset:t}}if(n===27){var o=e.getUint32(t,!1),r=e.getUint32(t+4,!1);return t+=8,{value:o*Math.pow(2,32)+r,offset:t}}throw new Error("Unsupported length: ".concat(n))}function Mv(e,t,n){var i=On(e,t,n),o=i.value,r=i.offset;return{value:o,offset:r}}function Sv(e,t,n){var i=On(e,t,n),o=i.value,r=i.offset;return{value:-1-o,offset:r}}function qv(e,t,n){var i=On(e,t,n),o=i.value,r=i.offset;if(r+o>e.byteLength)throw new Error("Byte string length exceeds data length");var a=new Uint8Array(e.buffer,e.byteOffset+r,o);return{value:a,offset:r+o}}function Tv(e,t,n){var i=On(e,t,n),o=i.value,r=i.offset;if(r+o>e.byteLength)throw new Error("String length exceeds data length");var a=new Uint8Array(e.buffer,e.byteOffset+r,o),s=new TextDecoder().decode(a);return{value:s,offset:r+o}}function Pv(e,t,n){for(var i=On(e,t,n),o=i.value,r=i.offset,a=[],s=r,l=0;l<o;l++){var h=Ai(e,s);a.push(h.value),s=h.offset}return{value:a,offset:s}}function $v(e,t,n){for(var i=On(e,t,n),o=i.value,r=i.offset,a={},s=r,l=0;l<o;l++){var h=Ai(e,s);if(!wv(h.value))throw new Error("Invalid key type");var g=Ai(e,h.offset);a[h.value]=g.value,s=g.offset}return{value:a,offset:s}}function xv(e){var t=(e&31744)>>10,n=e&1023,i=e&32768?-1:1;return t===0?i*Math.pow(2,-14)*(n/1024):t===31?n?NaN:i*(1/0):i*Math.pow(2,t-15)*(1+n/1024)}function Ev(e,t,n){if(n<24)switch(n){case 20:return{value:!1,offset:t};case 21:return{value:!0,offset:t};case 22:return{value:null,offset:t};case 23:return{value:void 0,offset:t};default:throw new Error("Unknown simple value: ".concat(n))}if(n===24)return{value:e.getUint8(t++),offset:t};if(n===25){var i=xv(e.getUint16(t,!1));return t+=2,{value:i,offset:t}}if(n===26){var i=e.getFloat32(t,!1);return t+=4,{value:i,offset:t}}if(n===27){var i=e.getFloat64(t,!1);return t+=8,{value:i,offset:t}}throw new Error("Unknown simple or float value: ".concat(n))}var ji={};Object.defineProperty(ji,"__esModule",{value:!0});ji.PaymentRequest=void 0;var Av=vt,xr=fn,Iv=Ne,Rv=function(){function e(t,n,i,o,r,a,s){s===void 0&&(s=!1),this.transport=t,this.id=n,this.amount=i,this.unit=o,this.mints=r,this.description=a,this.singleUse=s}return e.prototype.toEncodedRequest=function(){var t={t:this.transport.map(function(o){return{t:o.type,a:o.target,g:o.tags}})};this.id&&(t.i=this.id),this.amount&&(t.a=this.amount),this.unit&&(t.u=this.unit),this.mints&&(t.m=this.mints),this.description&&(t.d=this.description),this.singleUse&&(t.s=this.singleUse);var n=(0,xr.encodeCBOR)(t),i=Iv.Buffer.from(n).toString("base64");return"creqA"+i},e.prototype.getTransport=function(t){return this.transport.find(function(n){return n.type===t})},e.fromEncodedRequest=function(t){if(!t.startsWith("creq"))throw new Error("unsupported pr: invalid prefix");var n=t[4];if(n!=="A")throw new Error("unsupported pr version");var i=t.slice(5),o=(0,Av.encodeBase64toUint8)(i),r=(0,xr.decodeCBOR)(o),a=r.t.map(function(s){return{type:s.t,target:s.a,tags:s.g}});return new e(a,r.i,r.a,r.u,r.m,r.d,r.s)},e}();ji.PaymentRequest=Rv;var ei=dr&&dr.__assign||function(){return ei=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ei.apply(this,arguments)};Object.defineProperty(fe,"__esModule",{value:!0});fe.hasValidDleq=fe.stripDleq=fe.MessageQueue=fe.MessageNode=fe.decodePaymentRequest=fe.sumProofs=fe.sanitizeUrl=fe.joinUrls=fe.checkResponse=fe.isObj=fe.sortProofsById=fe.mergeUInt8Arrays=fe.deriveKeysetId=fe.handleTokens=fe.getDecodedToken=fe.getEncodedTokenV4=fe.getEncodedToken=po=fe.getEncodedTokenV3=fe.bigIntStringify=fe.hasNonHexId=fe.numberToHexPadded64=fe.hexToNumber=fe.bytesToNumber=fe.hasCorrespondingKey=fe.getKeysetAmounts=fe.getKeepAmounts=fe.splitAmount=void 0;var Ii=vt,Er=xn,mt=ul,Uv=cl,Va=fn,Nv=ji,Ar=dl,Ov=fl;function Fa(e,t,n,i){if(n){if(n.reduce(function(r,a){return r+a},0)>e)throw new Error("Split is greater than total amount: ".concat(n.reduce(function(r,a){return r+a},0)," > ").concat(e));n.forEach(function(r){if(!Vo(r,t))throw new Error("Provided amount preferences do not match the amounts of the mint keyset.")}),e=e-n.reduce(function(r,a){return r+a},0)}else n=[];var o=Bo(t);return o.forEach(function(r){for(var a=Math.floor(e/r),s=0;s<a;++s)n?.push(r);e%=r}),n.sort(function(r,a){return i==="desc"?a-r:r-a})}fe.splitAmount=Fa;function Lv(e,t,n,i){var o=[],r=e.map(function(g){return g.amount}),a=Bo(n,"asc");a.forEach(function(g){for(var w=r.filter(function(E){return E===g}).length,_=Math.max(i-w,0),C=0;C<_&&!(o.reduce(function(E,N){return E+N},0)+g>t);++C)o.push(g)});var s=t-o.reduce(function(g,w){return g+w},0);if(s){var l=Fa(s,n);l.forEach(function(g){o.push(g)})}var h=o.sort(function(g,w){return g-w});return h}fe.getKeepAmounts=Lv;function Bo(e,t){return t===void 0&&(t="desc"),t=="desc"?Object.keys(e).map(function(n){return parseInt(n)}).sort(function(n,i){return i-n}):Object.keys(e).map(function(n){return parseInt(n)}).sort(function(n,i){return n-i})}fe.getKeysetAmounts=Bo;function Vo(e,t){return e in t}fe.hasCorrespondingKey=Vo;function Bv(e){return Fo((0,mt.bytesToHex)(e))}fe.bytesToNumber=Bv;function Fo(e){return BigInt("0x".concat(e))}fe.hexToNumber=Fo;function Vv(e){return e.toString(16).padStart(64,"0")}fe.numberToHexPadded64=Vv;function Ir(e){return/^[a-f0-9]*$/i.test(e)}function zo(e){return Array.isArray(e)?e.some(function(t){return!Ir(t.id)}):Ir(e.id)}fe.hasNonHexId=zo;function Fv(e,t){return typeof t=="bigint"?t.toString():t}fe.bigIntStringify=Fv;function za(e){var t={token:[{mint:e.mint,proofs:e.proofs}]};return e.unit&&(t.unit=e.unit),e.memo&&(t.memo=e.memo),Er.TOKEN_PREFIX+Er.TOKEN_VERSION+(0,Ii.encodeJsonToBase64)(t)}var po=fe.getEncodedTokenV3=za;function zv(e,t){var n=zo(e.proofs);if(n||t?.version===3){if(t?.version===4)throw new Error("can not encode to v4 token if proofs contain non-hex keyset id");return za(e)}return ja(e)}fe.getEncodedToken=zv;function ja(e){e.proofs.forEach(function(w){if(w.dleq&&w.dleq.r==null)throw new Error("Missing blinding factor in included DLEQ proof")});var t=zo(e.proofs);if(t)throw new Error("can not encode to v4 token if proofs contain non-hex keyset id");for(var n={},i=e.mint,o=0;o<e.proofs.length;o++){var r=e.proofs[o];n[r.id]?n[r.id].push(r):n[r.id]=[r]}var a={m:i,u:e.unit||"sat",t:Object.keys(n).map(function(w){return{i:(0,mt.hexToBytes)(w),p:n[w].map(function(_){var C;return ei({a:_.amount,s:_.secret,c:(0,mt.hexToBytes)(_.C)},_.dleq&&{d:{e:(0,mt.hexToBytes)(_.dleq.e),s:(0,mt.hexToBytes)(_.dleq.s),r:(0,mt.hexToBytes)((C=_.dleq.r)!==null&&C!==void 0?C:"00")}})})}})};e.memo&&(a.d=e.memo);var s=(0,Va.encodeCBOR)(a),l="cashu",h="B",g=(0,Ii.encodeUint8toBase64Url)(s);return l+h+g}fe.getEncodedTokenV4=ja;function jv(e){var t=["web+cashu://","cashu://","cashu:","cashu"];return t.forEach(function(n){!e.startsWith(n)||(e=e.slice(n.length))}),Wa(e)}fe.getDecodedToken=jv;function Wa(e){var t=e.slice(0,1),n=e.slice(1);if(t==="A"){var i=(0,Ii.encodeBase64ToJson)(n);if(i.token.length>1)throw new Error("Multi entry token are not supported");var o=i.token[0],r={mint:o.mint,proofs:o.proofs,unit:i.unit||"sat"};return i.memo&&(r.memo=i.memo),r}else if(t==="B"){var a=(0,Ii.encodeBase64toUint8)(n),s=(0,Va.decodeCBOR)(a),l=[];s.t.forEach(function(g){return g.p.forEach(function(w){l.push(ei({secret:w.s,C:(0,mt.bytesToHex)(w.c),amount:w.a,id:(0,mt.bytesToHex)(g.i)},w.d&&{dleq:{r:(0,mt.bytesToHex)(w.d.r),s:(0,mt.bytesToHex)(w.d.s),e:(0,mt.bytesToHex)(w.d.e)}}))})});var h={mint:s.m,proofs:l,unit:s.u||"sat"};return s.d&&(h.memo=s.d),h}throw new Error("Token version is not supported")}fe.handleTokens=Wa;function Wv(e){var t=Object.entries(e).sort(function(o,r){return+o[0]-+r[0]}).map(function(o){var r=o[1];return(0,mt.hexToBytes)(r)}).reduce(function(o,r){return Ha(o,r)},new Uint8Array),n=(0,Uv.sha256)(t),i=Buffer.from(n).toString("hex").slice(0,14);return"00"+i}fe.deriveKeysetId=Wv;function Ha(e,t){var n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}fe.mergeUInt8Arrays=Ha;function Hv(e){return e.sort(function(t,n){return t.id.localeCompare(n.id)})}fe.sortProofsById=Hv;function Ka(e){return typeof e=="object"}fe.isObj=Ka;function Kv(e){if(!!Ka(e)){if("error"in e&&e.error)throw new Error(e.error);if("detail"in e&&e.detail)throw new Error(e.detail)}}fe.checkResponse=Kv;function Qv(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.map(function(n){return n.replace(/(^\/+|\/+$)/g,"")}).join("/")}fe.joinUrls=Qv;function Xv(e){return e.replace(/\/$/,"")}fe.sanitizeUrl=Xv;function Gv(e){return e.reduce(function(t,n){return t+n.amount},0)}fe.sumProofs=Gv;function Yv(e){return Nv.PaymentRequest.fromEncodedRequest(e)}fe.decodePaymentRequest=Yv;var Qa=function(){function e(t){this._value=t,this._next=null}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"next",{get:function(){return this._next},set:function(t){this._next=t},enumerable:!1,configurable:!0}),e}();fe.MessageNode=Qa;var Zv=function(){function e(){this._first=null,this._last=null,this._size=0}return Object.defineProperty(e.prototype,"first",{get:function(){return this._first},set:function(t){this._first=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this._last},set:function(t){this._last=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size=t},enumerable:!1,configurable:!0}),e.prototype.enqueue=function(t){var n=new Qa(t);return this._size===0||!this._last?(this._first=n,this._last=n):(this._last.next=n,this._last=n),this._size++,!0},e.prototype.dequeue=function(){if(this._size===0||!this._first)return null;var t=this._first;return this._first=t.next,t.next=null,this._size--,t.value},e}();fe.MessageQueue=Zv;function Jv(e){return e.map(function(t){var n=ei({},t);return delete n.dleq,delete n.dleqValid,n})}fe.stripDleq=Jv;function ep(e,t){var n;if(e.dleq==null)return!1;var i={e:(0,mt.hexToBytes)(e.dleq.e),s:(0,mt.hexToBytes)(e.dleq.s),r:Fo((n=e.dleq.r)!==null&&n!==void 0?n:"00")};if(!Vo(e.amount,t.keys))throw new Error("undefined key for amount ".concat(e.amount));var o=t.keys[e.amount];return!!(0,Ov.verifyDLEQProof_reblind)(new TextEncoder().encode(e.secret),i,(0,Ar.pointFromHex)(e.C),(0,Ar.pointFromHex)(o))}fe.hasValidDleq=ep;const tp=Oe({name:"SendTokenDialog",mixins:[windowMixin],components:{ChooseMint:Bi,TokenInformation:da,SendPaymentRequest:ov,NumericKeyboard:Oa,ScanIcon:hn,NfcIcon:qo},props:{},data:function(){return{baseURL:location.protocol+"//"+location.host+location.pathname,showAnimatedQR:!1,qrCodeFragment:"",qrInterval:null,encoder:null,showDeleteDialog:!1,p2pkInput:"",currentFragmentLength:150,fragmentLengthMedium:100,fragmentLengthShort:50,fragmentLengthLong:150,fragmentLengthLabel:"L",currentFragmentInterval:150,fragmentIntervalMedium:250,fragmentIntervalFast:150,framentInervalSlow:500,fragmentSpeedLabel:"F",isV4Token:!1,scanningCard:!1,showExpandedButtons:!1}},computed:{...ve(ni,["showSendTokens","showLockInput","sendData"]),...ve(et,["camera","hasCamera"]),...de($e,["tickerShort","canPasteFromClipboard","globalMutexLock","ndefSupported"]),...ve($e,["showNumericKeyboard"]),...de(De,["mints","activeProofs","activeUnit","activeUnitLabel","activeUnitCurrencyMultiplyer","activeMintUrl","activeBalance"]),...de(An,["checkSentTokens","includeFeesInSendAmount","nfcEncoding","useNumericKeyboard"]),...de(Xn,["bitcoinPrice"]),...de(dn,["tokenWorkerRunning"]),sumProofs:function(){return Se.getProofs(Se.decode(this.sendData.tokensBase64)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return Se.getUnit(Se.decode(this.sendData.tokensBase64))},tokenMintUrl:function(){return Se.getMint(Se.decode(this.sendData.tokensBase64))},paidFees:function(){return this.sumProofs-Math.abs(this.sendData.historyAmount)},displayMemo:function(){return Se.getMemo(Se.decode(this.sendData.tokensBase64))},shortUrl:function(){return Lt(this.tokenMintUrl)},decodedToken:function(){return Se.decode(this.sendData.tokensBase64)},runnerActive:function(){return this.tokenWorkerRunning},canSpendOffline:function(){if(!this.sendData.amount)return!1;let e=this.spendableProofs(this.activeProofs);const t=Xe().wallet;let n=this.coinSelect(e,t,this.sendData.amount*this.activeUnitCurrencyMultiplyer,this.includeFeesInSendAmount);const i=this.includeFeesInSendAmount?this.getFeesForProofs(n):0;return n.flat().reduce((r,a)=>r+=a.amount,0)==this.sendData.amount*this.activeUnitCurrencyMultiplyer+i}},watch:{"sendData.tokensBase64":function(e){if(this.showAnimatedQR=!1,!e.length)return;const n=Se.decode(e).proofs;if(n.length)n.length<=2?this.qrCodeFragment=e:(this.showAnimatedQR=!0,this.qrCodeFragment="",this.startQrCodeLoop());else return;this.isV4Token=e.startsWith("cashuB")},showSendTokens:function(e){e?this.$nextTick(()=>{this.sendData.tokensBase64.length?this.showNumericKeyboard=!1:this.showNumericKeyboard=!0}):(clearInterval(this.qrInterval),this.sendData.data="",this.sendData.tokensBase64="")}},methods:{...ce(dn,["clearAllWorkers"]),...ce(Xe,["send","sendToLock","coinSelect","spendableProofs","getFeesForProofs","onTokenPaid","mintWallet"]),...ce(Qr,["serializeProofs"]),...ce(Gt,["addPendingToken","setTokenPaid","deleteToken"]),...ce(Bt,["isValidPubkey","maybeConvertNpub"]),...ce(et,["closeCamera","showCamera"]),...ce(De,["toggleUnit"]),encodeToPeanut:function(e){return"\u{1F95C}"+Array.from(e).map(t=>{const n=t.charCodeAt(0);if(n>=0&&n<=15)return String.fromCodePoint(65024+n);if(n>=16&&n<=255)return String.fromCodePoint(917760+(n-16))}).join("")},decodeToken:function(e){return Se.decode(e)},getProofs:function(e){return Se.getProofs(e)},getAmount:function(e){return Se.getAmount(e)},getUnit:function(e){return Se.getUnit(e)},getMint:function(e){return Se.getMint(e)},toggleExpandButtons(){this.showExpandedButtons=!this.showExpandedButtons},startQrCodeLoop:async function(){if(this.sendData.tokensBase64.length==0)return;const e=Ne.Buffer.from(this.sendData.tokensBase64),t=Si.fromBuffer(e),n=0;this.encoder=new Xg(t,this.currentFragmentLength,n),clearInterval(this.qrInterval),this.qrInterval=setInterval(()=>{this.qrCodeFragment=this.encoder.nextPart()},this.currentFragmentInterval)},updateQrCode:function(){this.qrCodeFragment=this.encoder.nextPart()},changeSpeed:function(){this.currentFragmentInterval==this.fragmentIntervalMedium?(this.currentFragmentInterval=this.framentInervalSlow,this.fragmentSpeedLabel="S"):this.currentFragmentInterval==this.framentInervalSlow?(this.currentFragmentInterval=this.fragmentIntervalFast,this.fragmentSpeedLabel="F"):(this.currentFragmentInterval=this.fragmentIntervalMedium,this.fragmentSpeedLabel="M"),console.log("### this.currentFragmentInterval",this.currentFragmentInterval),this.startQrCodeLoop()},changeSize:function(){this.currentFragmentLength==this.fragmentLengthMedium?(this.currentFragmentLength=this.fragmentLengthShort,this.fragmentLengthLabel="S"):this.currentFragmentLength==this.fragmentLengthShort?(this.currentFragmentLength=this.fragmentLengthLong,this.fragmentLengthLabel="L"):(this.currentFragmentLength=this.fragmentLengthMedium,this.fragmentLengthLabel="M"),console.log("### this.currentFragmentLength",this.currentFragmentLength),this.startQrCodeLoop()},toggleTokenEncoding:function(){const e=hl(this.sendData.tokensBase64);if(this.sendData.tokensBase64.startsWith("cashuA"))try{this.sendData.tokensBase64=ml(e)}catch{console.log("### Could not encode token to V4"),this.sendData.tokensBase64=po(e)}else this.sendData.tokensBase64=po(e)},deleteThisToken:function(){this.deleteToken(this.sendData.tokensBase64),this.showSendTokens=!1,this.showDeleteDialog=!1,this.clearAllWorkers()},writeTokensToCard:function(){if(!this.scanningCard)try{this.ndef=new NDEFReader,this.controller=new AbortController;const e=this.controller.signal;this.ndef.scan({signal:e}).then(()=>{console.log("> Scan started"),this.ndef.onreadingerror=t=>{console.error(`Cannot read NDEF data! ${t}`),Tn("Cannot read data from the NFC tag"),this.controller.abort(),this.scanningCard=!1},this.ndef.onreading=({message:t,serialNumber:n})=>{console.log(`Read card ${n}`),this.controller.abort(),this.scanningCard=!1;try{let i=[];switch(this.nfcEncoding){case"text":i=[{recordType:"text",data:`${this.sendData.tokensBase64}`,lang:"en"}];break;case"weburl":i=[{recordType:"url",data:`${window.location}#token=${this.sendData.tokensBase64}`}];break;case"binary":throw new Error("Binary encoding not supported yet");default:throw new Error(`Unknown NFC encoding: ${this.nfcEncoding}`)}fr("Writing to NFC card..."),this.ndef.write({records:i},{overwrite:!0}).then(()=>{console.log("Successfully flashed token to card!"),fr("Successfully flashed token to card!")}).catch(o=>{console.error(`NFC write failed: The card may not have enough capacity (needed ${i[0].data.length} bytes).`),Tn(`The card may not have enough capacity (needed ${i[0].data.length} bytes).`,"NFC write failed")})}catch(i){console.error(`NFC error: ${i.message}`),Tn(`${i.message}`,"NFC error")}},this.scanningCard=!0}).catch(t=>{console.error(`NFC error: ${t.message}`),Tn(`${err.message}`,"NFC error"),this.scanningCard=!1})}catch(e){console.error(`NFC error: ${e.message}`),Tn(`${err.message}`,"NFC error"),this.scanningCard=!1}},closeCardScanner:function(){this.controller.abort(),this.scanningCard=!1},lockTokens:async function(){let e=Math.floor(this.sendData.amount*this.activeUnitCurrencyMultiplyer);try{const t=this.mintWallet(this.activeMintUrl,this.activeUnit);let{_:n,sendProofs:i}=await this.sendToLock(this.activeProofs,t,e,this.sendData.p2pkPubkey);this.sendData.tokens=i,this.sendData.tokensBase64=this.serializeProofs(i);const o={amount:-this.sendData.amount,token:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl};this.addPendingToken(o),this.g.offline||this.onTokenPaid(o)}catch(t){console.error(t)}},sendTokens:async function(){if(this.showNumericKeyboard=!1,this.sendData.p2pkPubkey=this.maybeConvertNpub(this.sendData.p2pkPubkey),this.sendData.p2pkPubkey&&this.isValidPubkey(this.sendData.p2pkPubkey)){await this.lockTokens();return}try{let e=Math.floor(this.sendData.amount*this.activeUnitCurrencyMultiplyer);const t=this.mintWallet(this.activeMintUrl,this.activeUnit);let{_:n,sendProofs:i}=await this.send(this.activeProofs,t,e,!0,this.includeFeesInSendAmount);this.sendData.tokens=i,this.sendData.tokensBase64=this.serializeProofs(i),this.sendData.historyAmount=-this.sendData.amount*this.activeUnitCurrencyMultiplyer;const o={amount:-e,token:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl,paymentRequest:this.sendData.paymentRequest};this.addPendingToken(o),this.g.offline||this.onTokenPaid(o)}catch(e){console.error(e)}},pasteToP2PKField:async function(){console.log("pasteToParseDialog");const e=await $e().pasteFromClipboard();this.sendData.p2pkPubkey=e.trim()}}}),np={key:1},ip={class:"row items-center no-wrap q-mb-sm q-pr-lg q-py-lg"},op={class:"col-9"},rp={class:"text-h6"},ap={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},sp={class:"col-3",style:{height:"30px"}},lp=f("span",{class:"text-subtitle2 text-weight-medium"},"Offline",-1),up={class:"row items-center no-wrap q-my-sm q-py-none"},cp={class:"col-12"},dp={key:0,class:"row items-center no-wrap"},fp={class:"col-4 q-mx-md"},hp={key:0,class:"row q-mt-lg"},mp={key:1,class:"row"},gp={key:1,class:"row q-mt-lg"},vp={key:2,class:"text-center q-mb-xs"},pp={key:0,class:"text-center q-mb-md"},yp={class:"q-pb-xs q-ba-none q-gutter-sm"},wp={class:"row justify-center"},_p={class:"row justify-center q-pt-sm"},bp={key:0,class:"row justify-center q-pt-sm"},kp={class:"row justify-center q-pt-md"},Dp={key:1,class:"row justify-center q-pt-sm"},Cp={class:"row items-center justify-between q-mt-lg"},Mp={class:"row items-center"},Sp={key:0,class:"row q-gutter-sm"},qp=f("div",{class:"row items-center no-wrap q-mb-sm"},[f("div",{class:"col-12"},[f("span",{class:"text-h6"},"Delete Ecash")])],-1),Tp={class:"row items-center no-wrap q-my-sm q-py-none"},Pp={class:"col-12"},$p={class:"row q-mt-lg"};function xp(e,t,n,i,o,r){const a=J("NumericKeyboard"),s=J("ChooseMint"),l=J("ScanIcon"),h=J("vue-qrcode"),g=J("TokenInformation"),w=J("SendPaymentRequest"),_=J("NfcIcon");return M(),V(at,null,[u(ut,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[10]||(t[10]=C=>e.showSendTokens=C),position:"top",maximized:e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":"","full-height":"",onShow:e.onDialogShown},{default:m(()=>[u(ct,{class:"q-pa-none q-pt-none qcard"},{default:m(()=>[e.showNumericKeyboard&&e.useNumericKeyboard?(M(),W(a,{key:0,"model-value":e.sendData.amount,"onUpdate:modelValue":t[0]||(t[0]=C=>e.sendData.amount=C),onDone:e.sendTokens},null,8,["model-value","onDone"])):z("",!0),e.sendData.tokens?(M(),V("div",vp,[u(st,{class:"q-pa-none q-pt-md"},{default:m(()=>[e.qrCodeFragment?(M(),V("div",pp,[u(ko,{ratio:1,class:"q-mx-none"},{default:m(()=>[u(h,{value:e.qrCodeFragment,options:{width:400},class:"rounded-borders",onClick:t[5]||(t[5]=C=>e.copyText(e.sendData.tokensBase64))},null,8,["value"])]),_:1})])):z("",!0),f("div",yp,[e.showAnimatedQR?(M(),W(L,{key:0,flat:"",style:{"font-size":"10px"},color:"grey",class:"q-ma-none",onClick:e.changeSpeed},{default:m(()=>[u(me,{name:"speed",style:{"margin-right":"8px"}}),I(" Speed: "+ae(e.fragmentSpeedLabel),1)]),_:1},8,["onClick"])):z("",!0),u($t,{color:e.isV4Token?"grey":"primary",label:e.isV4Token?"V4":"V3",class:"q-my-sm q-mx-md cursor-pointer",onClick:e.toggleTokenEncoding,outline:e.isV4Token},null,8,["color","label","onClick","outline"]),e.showAnimatedQR?(M(),W(L,{key:1,flat:"",style:{"font-size":"10px"},class:"q-ma-none",color:"grey",onClick:e.changeSize},{default:m(()=>[u(me,{name:"zoom_in",style:{"margin-right":"8px"}}),I(" Size: "+ae(e.fragmentLengthLabel),1)]),_:1},8,["onClick"])):z("",!0)]),u(st,{class:"q-pa-sm"},{default:m(()=>[f("div",wp,[u(Ie,{overline:"",class:"q-mb-sm text-white",style:{"font-size":"1rem"}},{default:m(()=>[I(ae(e.sendData.historyAmount&&e.sendData.historyAmount<0?"Sent":"Received")+" Ecash",1)]),_:1})]),f("div",_p,[u(Ie,{style:{"font-size":"30px"},class:"text-weight-bold"},{default:m(()=>[e.runnerActive?(M(),W(Fh,{key:0,color:"primary",size:"0.8em",class:"q-mr-md"})):z("",!0),f("strong",null,ae(e.displayUnit),1)]),_:1})]),e.paidFees?(M(),V("div",bp,[u(Ie,{class:"text-weight-bold"},{default:m(()=>[I(" Fee: "+ae(e.formatCurrency(e.paidFees,e.tokenUnit)),1)]),_:1})])):z("",!0),f("div",kp,[u(g,{encodedToken:e.sendData.tokensBase64,showAmount:!1,showP2PKCheck:!1},null,8,["encodedToken"])]),e.sendData.paymentRequest?(M(),V("div",Dp,[u(w)])):z("",!0),f("div",Cp,[f("div",Mp,[u(L,{class:"q-ml-md",size:"md",flat:"",dense:"",onClick:t[6]||(t[6]=C=>e.copyText(e.sendData.tokensBase64))},{default:m(()=>[I("Copy")]),_:1}),u(L,{class:"q-mx-none",size:"md",flat:"",dense:"",onClick:e.toggleExpandButtons},{default:m(()=>[u(me,{name:e.showExpandedButtons?"chevron_left":"chevron_right"},null,8,["name"])]),_:1},8,["onClick"]),e.showExpandedButtons?(M(),V("div",Sp,[u(L,{class:"q-mr-xs",size:"md",flat:"",dense:"",onClick:t[7]||(t[7]=C=>e.copyText(e.encodeToPeanut(e.sendData.tokensBase64)))},{default:m(()=>[I("\u{1F95C} "),u(Ze,null,{default:m(()=>[I("Copy Emoji")]),_:1})]),_:1}),u(L,{class:"q-mx-none",color:"grey",size:"md",dense:"",icon:"link",flat:"",onClick:t[8]||(t[8]=C=>e.copyText(e.baseURL+"#token="+e.sendData.tokensBase64))},{default:m(()=>[u(Ze,null,{default:m(()=>[I("Copy link")]),_:1})]),_:1}),e.hasCamera&&!e.sendData.paymentRequest&&e.sendData.historyAmount<0?(M(),W(L,{key:0,unelevated:"",dense:"",size:"sm",class:"q-mx-none",onClick:e.showCamera},{default:m(()=>[u(l)]),_:1},8,["onClick"])):z("",!0),e.ndefSupported&&!e.sendData.paymentRequest&&e.sendData.historyAmount<0?(M(),W(L,{key:1,unelevated:"",dense:"",disabled:e.scanningCard,loading:e.scanningCard,class:"q-mx-none",size:"sm",onClick:e.writeTokensToCard,flat:""},{loading:m(()=>[u(Ui,{onClick:e.closeCardScanner},null,8,["onClick"])]),default:m(()=>[u(_),u(Ze,null,{default:m(()=>[I(ae(e.ndefSupported?"Flash to NFC card":"NDEF unsupported"),1)]),_:1})]),_:1},8,["disabled","loading","onClick"])):z("",!0),u(L,{class:"q-mx-none",color:"grey",dense:"",icon:"delete",size:"md",onClick:t[9]||(t[9]=C=>{e.showDeleteDialog=!0,e.closeCardScanner()}),flat:""},{default:m(()=>[u(Ze,null,{default:m(()=>[I("Delete from history")]),_:1})]),_:1})])):z("",!0)]),Fe((M(),W(L,{onClick:e.closeCardScanner,flat:"",color:"grey",class:"q-ml-auto q-mr-md"},{default:m(()=>[I("Close")]),_:1},8,["onClick"])),[[He]])])]),_:1})]),_:1})])):(M(),V("div",np,[u(st,{class:"q-pa-lg q-pt-md"},{default:m(()=>[f("div",ip,[f("div",op,[f("span",rp,"Send "+ae(e.sendData.amount?e.formatCurrency(e.sendData.amount*e.activeUnitCurrencyMultiplyer,e.activeUnit):"Ecash"),1),e.sendData.amount&&e.bitcoinPrice&&e.activeUnit=="sat"?(M(),V("span",ap," ("+ae(e.formatCurrency(e.bitcoinPrice/1e8*e.sendData.amount*e.activeUnitCurrencyMultiplyer,"USD",!0))+") ",1)):z("",!0)]),f("div",sp,[u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:m(()=>[e.canSpendOffline&&!e.sendData.p2pkPubkey&&!e.showLockInput?(M(),W($t,{key:0,outline:"",rounded:"",color:"grey",class:"q-mr-auto q-pl-sm q-ml-md q-pr-sm q-my-xs q-mt-xs",size:"lg"},{default:m(()=>[u(me,{name:"check",color:"primary",class:"q-mr-sm",size:"sm"}),lp]),_:1})):z("",!0)]),_:1})])]),f("div",up,[f("div",cp,[u(s)])]),u(lt,{type:"number",modelValue:e.sendData.amount,"onUpdate:modelValue":t[2]||(t[2]=C=>e.sendData.amount=C),modelModifiers:{number:!0},label:"Amount ("+e.tickerShort+") *",mask:"#","fill-mask":"0","reverse-fill-mask":"",round:"",outlined:"",autofocus:"",class:"q-mb-lg",onKeyup:Et(e.sendTokens,["enter"])},{default:m(()=>[u(L,{flat:"",color:"primary",onClick:t[1]||(t[1]=C=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup"]),u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:m(()=>[e.showLockInput?(M(),V("div",dp,[f("div",{class:qi(e.sendData.p2pkPubkey?"col-12":"col-8")},[u(lt,{modelValue:e.sendData.p2pkPubkey,"onUpdate:modelValue":t[3]||(t[3]=C=>e.sendData.p2pkPubkey=C),label:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?"Invalid public key":"Receiver public key",outlined:"",clearable:"",color:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?"red":"",onKeyup:Et(e.lockTokens,["enter"])},null,8,["modelValue","label","color","onKeyup"])],2),f("div",fp,[e.canPasteFromClipboard&&!e.sendData.p2pkPubkey?(M(),W(L,{key:0,unelevated:"",icon:"content_paste",onClick:e.pasteToP2PKField},{default:m(()=>[u(Ze,null,{default:m(()=>[I("Paste")]),_:1})]),_:1},8,["onClick"])):z("",!0),e.sendData.p2pkPubkey?z("",!0):(M(),W(L,{key:1,align:"center",flat:"",outline:"",color:"primary",round:"",onClick:e.showCamera},{default:m(()=>[u(l,{size:"1.5em"})]),_:1},8,["onClick"]))])])):z("",!0)]),_:1}),e.activeBalance>=e.sendData.amount?(M(),V("div",hp,[e.sendData.tokens?z("",!0):(M(),W(L,{key:0,disable:e.sendData.amount==null||e.sendData.amount<=0||e.sendData.p2pkPubkey!=""&&!e.isValidPubkey(e.sendData.p2pkPubkey),onClick:e.sendTokens,color:"primary",rounded:"",type:"submit",loading:e.globalMutexLock},{loading:m(()=>[u(Rt)]),default:m(()=>[I("Send ")]),_:1},8,["disable","onClick","loading"])),e.sendData.p2pkPubkey&&e.isValidPubkey(e.sendData.p2pkPubkey)?(M(),V("div",mp,[u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:m(()=>[u(cn,{outline:"",color:"primary",icon:"lock",class:"q-ml-md q-pa-md"},{default:m(()=>[I(" Locked ")]),_:1})]),_:1})])):z("",!0),u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:m(()=>[e.sendData.amount>0&&!e.showLockInput&&e.activeBalance>=e.sendData.amount?(M(),W(L,{key:0,disable:e.sendData.p2pkPubkey==null||e.sendData.amount<=0,color:"primary",class:"q-ml-sm",rounded:"",flat:"",onClick:t[4]||(t[4]=C=>e.showLockInput=!0)},{default:m(()=>[I(" Lock")]),_:1},8,["disable"])):z("",!0)]),_:1}),Fe((M(),W(L,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])):(M(),V("div",gp,[u(L,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:m(()=>[I("Too much")]),_:1}),Fe((M(),W(L,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])]))]),_:1})]))]),_:1})]),_:1},8,["modelValue","maximized","onShow"]),u(ut,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[11]||(t[11]=C=>e.showDeleteDialog=C)},{default:m(()=>[u(ct,{class:"q-pa-lg q-pt-md qcard"},{default:m(()=>[u(st,{class:"q-pa-none"},{default:m(()=>[qp,f("div",Tp,[f("div",Pp,[u(Ie,null,{default:m(()=>[I(" Are you sure you want to delete this transaction from your history? ")]),_:1}),u(Ie,{class:"q-pt-md text-weight-bold"},{default:m(()=>[I(" Warning: This action cannot be undone and there is no way to recover the token. ")]),_:1})])]),f("div",$p,[u(L,{onClick:e.deleteThisToken,color:"negative",rounded:"",class:"q-mr-sm"},{default:m(()=>[I("Delete")]),_:1},8,["onClick"]),Fe((M(),W(L,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Cancel")]),_:1})),[[He]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Ep=Ee(tp,[["render",xp]]),Rr=Ct({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:t,emit:n}){const i=Vt(),o=ye(null);let r=0;const a=[];function s(C){const E=typeof C=="boolean"?C:e.noErrorFocus!==!0,N=++r,U=(F,X)=>{n(`validation${F===!0?"Success":"Error"}`,X)},K=F=>{const X=F.validate();return typeof X.then=="function"?X.then(pe=>({valid:pe,comp:F}),pe=>({valid:!1,comp:F,err:pe})):Promise.resolve({valid:X,comp:F})};return(e.greedy===!0?Promise.all(a.map(K)).then(F=>F.filter(X=>X.valid!==!0)):a.reduce((F,X)=>F.then(()=>K(X).then(pe=>{if(pe.valid===!1)return Promise.reject(pe)})),Promise.resolve()).catch(F=>[F])).then(F=>{if(F===void 0||F.length===0)return N===r&&U(!0),!0;if(N===r){const{comp:X,err:pe}=F[0];if(pe!==void 0&&console.error(pe),U(!1,X),E===!0){const se=F.find(({comp:j})=>typeof j.focus=="function"&&_i(j.$)===!1);se!==void 0&&se.comp.focus()}}return!1})}function l(){r++,a.forEach(C=>{typeof C.resetValidation=="function"&&C.resetValidation()})}function h(C){C!==void 0&&Dt(C);const E=r+1;s().then(N=>{E===r&&N===!0&&(e.onSubmit!==void 0?n("submit",C):C!==void 0&&C.target!==void 0&&typeof C.target.submit=="function"&&C.target.submit())})}function g(C){C!==void 0&&Dt(C),n("reset"),Qt(()=>{l(),e.autofocus===!0&&e.noResetFocus!==!0&&w()})}function w(){zr(()=>{if(o.value===null)return;const C=o.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(o.value.querySelectorAll("[tabindex]"),E=>E.tabIndex!==-1);C?.focus({preventScroll:!0})})}Lr(Ts,{bindComponent(C){a.push(C)},unbindComponent(C){const E=a.indexOf(C);E!==-1&&a.splice(E,1)}});let _=!1;return _o(()=>{_=!0}),bo(()=>{_===!0&&e.autofocus===!0&&w()}),Ri(()=>{e.autofocus===!0&&w()}),Object.assign(i.proxy,{validate:s,resetValidation:l,submit:h,reset:g,focus:w,getValidationComponents:()=>a}),()=>Y("form",{class:"q-form",ref:o,onSubmit:h,onReset:g},ti(t.default))}});const Ap=Oe({name:"PayInvoiceDialog",mixins:[windowMixin],components:{ChooseMint:Bi,ToggleUnit:So,ScanIcon:hn},props:{},data:function(){return{}},watch:{activeMintUrl:async function(){this.payInvoiceData.show&&await this.meltQuoteInvoiceData()},activeUnit:async function(){this.payInvoiceData.show&&await this.meltQuoteInvoiceData()}},computed:{...de($e,["tickerShort","globalMutexLock"]),...ve(et,["camera","hasCamera"]),...de(Xe,["payInvoiceData"]),...de(De,["activeMintUrl","activeProofs","mints","activeUnit","totalUnitBalance","activeBalance"]),...de(Xn,["bitcoinPrice"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},enoughtotalUnitBalance:function(){return this.activeBalance>=this.payInvoiceData.meltQuote.response.amount}},methods:{...ce(Xe,["meltInvoiceData","meltQuoteInvoiceData","decodeRequest","lnurlPaySecond"]),...ce(et,["closeCamera","showCamera"]),canPay:function(){return this.payInvoiceData.invoice?payInvoiceData.meltQuote.response.amount<=this.totalUnitBalance:!1},closeParseDialog:function(){setTimeout(()=>{clearInterval(this.payInvoiceData.paymentChecker)},1e4)},decodeAndQuote:async function(e){await this.decodeRequest(e)},pasteToParseDialog:async function(){console.log("pasteToParseDialog");const e=await $e().pasteFromClipboard();e&&(this.payInvoiceData.input.request=e.trim())},handleMeltButton:function(){if(this.payInvoiceData.blocking)throw new Error("already processing an invoice.");this.meltInvoiceData()}},created:function(){}}),Wi=e=>(Ft("data-v-ee09c12c"),e=e(),zt(),e),Ip={key:0},Rp={class:"row items-center no-wrap q-mb-sm"},Up={class:"col-10"},Np={key:0},Op={class:"q-my-none inline-block"},Lp={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},Bp={key:1,class:"q-my-none"},Vp={key:2,class:"q-my-none"},Fp={class:"col-2"},zp={class:"text-wrap"},jp={key:0},Wp=Wi(()=>f("br",null,null,-1)),Hp={class:"col-12"},Kp={key:0,class:"row q-mt-lg"},Qp={key:1,class:"row q-mt-lg"},Xp={key:1},Gp={key:0,class:"q-my-none text-h6 text-center"},Yp={key:1,class:"q-my-none text-h6 text-center"},Zp=Wi(()=>f("br",null,null,-1)),Jp={key:2,class:"row"},e0={class:"col text-justify text-italic"},t0={key:0,class:"col-4 q-pl-md"},n0={class:"row"},i0={class:"col"},o0={key:0,class:"col-8 q-pl-md"},r0={class:"row q-mt-lg"},a0={key:2},s0=Wi(()=>f("div",{class:"row items-center no-wrap q-mb-xl"},[f("div",{class:"col-10"},[f("span",{class:"text-h6"},"Pay Lightning")])],-1)),l0={class:"row q-mt-lg"},u0=Wi(()=>f("span",{class:"q-pl-sm"},"Scan",-1));function c0(e,t,n,i,o,r){const a=J("ToggleUnit"),s=J("ChooseMint"),l=J("ScanIcon");return e.camera.show?z("",!0):(M(),W(ut,{key:0,modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[6]||(t[6]=h=>e.payInvoiceData.show=h),onHide:e.closeParseDialog,position:"top",maximized:e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":"","full-height":""},{default:m(()=>[u(ct,{class:"q-pa-lg q-pt-xl qcard"},{default:m(()=>[e.payInvoiceData.invoice?(M(),V("div",Ip,[f("div",Rp,[f("div",Up,[e.payInvoiceData.meltQuote.response&&e.payInvoiceData.meltQuote.response.amount>0?(M(),V("div",Np,[f("h6",Op," Pay "+ae(e.formatCurrency(e.payInvoiceData.meltQuote.response.amount,e.activeUnit,!0)),1),e.bitcoinPrice&&e.activeUnit=="sat"?(M(),V("span",Lp," ("+ae(e.formatCurrency(e.bitcoinPrice/1e8*e.payInvoiceData.meltQuote.response.amount,"USD",!0))+") ",1)):z("",!0)])):e.payInvoiceData.meltQuote.error!=""?(M(),V("h6",Bp,ae(e.payInvoiceData.meltQuote.error),1)):(M(),V("h6",Vp,"Processing..."))]),f("div",Fp,[u(a,{class:"q-mt-md"})])]),f("p",zp,[e.payInvoiceData.invoice.description?(M(),V("strong",jp,"Memo:")):z("",!0),I(" "+ae(e.payInvoiceData.invoice.description),1),Wp]),f("div",Hp,[u(s)]),e.enoughtotalUnitBalance||e.globalMutexLock?(M(),V("div",Kp,[u(L,{unelevated:"",rounded:"",color:"primary",disabled:e.payInvoiceData.blocking||e.payInvoiceData.meltQuote.error!="",onClick:e.handleMeltButton,label:e.payInvoiceData.meltQuote.error!=""?"Error":e.payInvoiceData.blocking?"Processing...":"Pay",loading:e.globalMutexLock&&!e.payInvoiceData.blocking,class:"q-px-lg"},{loading:m(()=>[u(Rt)]),_:1},8,["disabled","onClick","label","loading"]),Fe((M(),W(L,{flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])):(M(),V("div",Qp,[u(L,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:m(()=>[I("Balance too low")]),_:1}),Fe((M(),W(L,{flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])]))])):e.payInvoiceData.lnurlpay?(M(),V("div",Xp,[u(Rr,{onSubmit:e.lnurlPaySecond,class:"q-gutter-md"},{default:m(()=>[e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable?(M(),V("p",Gp,[f("b",null,ae(e.payInvoiceData.lnurlpay.domain),1),I(" is requesting "+ae(e.payInvoiceData.lnurlpay.maxSendable/1e3)+" "+ae(e.tickerShort),1)])):(M(),V("p",Yp,[f("b",null,ae(e.payInvoiceData.lnurlpay.targetUser||e.payInvoiceData.lnurlpay.domain),1),I(" is requesting "),Zp,I(" between "),f("b",null,ae(e.payInvoiceData.lnurlpay.minSendable/1e3),1),I(" and "),f("b",null,ae(e.payInvoiceData.lnurlpay.maxSendable/1e3),1),I(" "+ae(e.tickerShort),1)])),u(jr,{class:"q-my-sm"}),e.payInvoiceData.lnurlpay.description?(M(),V("div",Jp,[f("p",e0,ae(e.payInvoiceData.lnurlpay.description),1),e.payInvoiceData.lnurlpay.image?(M(),V("p",t0,[u(Zr,{src:e.payInvoiceData.lnurlpay.image},null,8,["src"])])):z("",!0)])):z("",!0),f("div",n0,[f("div",i0,[u(lt,{filled:"",dense:"",autofocus:"",modelValue:e.payInvoiceData.input.amount,"onUpdate:modelValue":t[0]||(t[0]=h=>e.payInvoiceData.input.amount=h),modelModifiers:{number:!0},type:"number",label:"Amount ("+e.tickerShort+") *",min:e.payInvoiceData.lnurlpay.minSendable/1e3,max:e.payInvoiceData.lnurlpay.maxSendable/1e3,readonly:e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable},null,8,["modelValue","label","min","max","readonly"])]),e.payInvoiceData.lnurlpay.commentAllowed>0?(M(),V("div",o0,[u(lt,{filled:"",dense:"",modelValue:e.payInvoiceData.input.comment,"onUpdate:modelValue":t[1]||(t[1]=h=>e.payInvoiceData.input.comment=h),_type:"payInvoiceData.lnurlpay.commentAllowed > 64 ? 'textarea' : 'text'",label:"Comment (optional)",maxlength:e.payInvoiceData.lnurlpay.commentAllowed},null,8,["modelValue","maxlength"])])):z("",!0)]),f("div",r0,[u(L,{unelevated:"",color:"primary",type:"submit"},{default:m(()=>[I("Send")]),_:1}),Fe((M(),W(L,{flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])]),_:1},8,["onSubmit"])])):(M(),V("div",a0,[s0,e.camera.show?z("",!0):(M(),W(Rr,{key:0,onSubmit:t[5]||(t[5]=h=>e.decodeAndQuote(e.payInvoiceData.input.request)),class:"q-gutter-md relative-container"},{default:m(()=>[u(lt,{ref:"parseDialogInput",round:"",outlined:"",class:"request-input",spellcheck:"false",modelValue:e.payInvoiceData.input.request,"onUpdate:modelValue":t[3]||(t[3]=h=>e.payInvoiceData.input.request=h),modelModifiers:{trim:!0},type:"textarea",label:"Lightning invoice or address",autofocus:"",onKeyup:t[4]||(t[4]=Et(h=>e.decodeAndQuote(e.payInvoiceData.input.request),["enter"]))},{default:m(()=>[e.payInvoiceData.input.request?(M(),W(me,{key:0,name:"close",color:"dark",class:"cursor-pointer floating-button",onClick:t[2]||(t[2]=h=>e.payInvoiceData.input.request="")})):z("",!0)]),_:1},8,["modelValue"]),f("div",l0,[e.payInvoiceData.input.request!=""?(M(),W(L,{key:0,rounded:"",color:"primary",class:"q-mr-sm",type:"submit"},{default:m(()=>[I("Enter")]),_:1})):z("",!0),e.canPasteFromClipboard&&e.payInvoiceData.input.request==""?(M(),W(L,{key:1,unelevated:"",dense:"",onClick:e.pasteToParseDialog},{default:m(()=>[u(me,{name:"content_paste",class:"q-pr-sm"}),I("Paste")]),_:1},8,["onClick"])):z("",!0),e.hasCamera&&e.payInvoiceData.input.request==""?(M(),W(L,{key:2,unelevated:"",class:"q-mx-0",onClick:e.showCamera},{default:m(()=>[u(l),u0]),_:1},8,["onClick"])):z("",!0),Fe((M(),W(L,{flat:"",rounded:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])]),_:1}))]))]),_:1})]),_:1},8,["modelValue","onHide","maximized"]))}var d0=Ee(Ap,[["render",c0],["__scopeId","data-v-ee09c12c"]]);const f0=Oe({name:"InvoiceDetailDialog",mixins:[windowMixin],components:{ChooseMint:Bi,VueQrcode:Co,NumericKeyboard:Oa},props:{},data:function(){return{createInvoiceButtonBlocked:!1}},watch:{showInvoiceDetails:function(e){e&&this.$nextTick(()=>{this.invoiceData.amount?this.showNumericKeyboard=!1:this.showNumericKeyboard=!0})}},computed:{...de(Xe,["invoiceData"]),...de(De,["activeUnit","activeUnitLabel","activeUnitCurrencyMultiplyer"]),...de(dn,["invoiceWorkerRunning"]),...ve($e,["showInvoiceDetails","tickerShort","globalMutexLock","showNumericKeyboard"]),...de(An,["useNumericKeyboard"]),displayUnit:function(){return this.formatCurrency(this.invoiceData.amount,this.invoiceData.unit,!0)},shortUrl:function(){return Lt(this.invoiceData.mint)},runnerActive:function(){return this.invoiceWorkerRunning},isSmallScreen(){return this.$q.screen.lt.sm}},methods:{...ce(Xe,["requestMint","lnurlPaySecond","mintOnPaid"]),...ce(De,["toggleUnit"]),requestMintButton:async function(){if(!!this.invoiceData.amount)try{this.showNumericKeyboard=!1;const e=De();this.invoiceData.amount*=this.activeUnitCurrencyMultiplyer,this.createInvoiceButtonBlocked=!0;const t=Xe().mintWallet(e.activeMintUrl,e.activeUnit),n=await this.requestMint(this.invoiceData.amount,t);await this.mintOnPaid(n.quote)}catch(e){console.log("#### requestMintButton",e)}finally{this.createInvoiceButtonBlocked=!1}}}}),h0=e=>(Ft("data-v-21d6c2b8"),e=e(),zt(),e),m0={key:1},g0=h0(()=>f("div",{class:"row items-center no-wrap q-mb-sm q-pr-md q-py-lg"},[f("div",{class:"col-10"},[f("span",{class:"text-h6"},"Create Invoice")])],-1)),v0={class:"row items-center no-wrap q-my-sm q-py-none"},p0={class:"col-12"},y0={class:"row items-center no-wrap q-my-sm q-py-none"},w0={key:2,class:"text-center q-mt-none q-pt-none"},_0=["href"],b0={class:"row justify-center"},k0={class:"row justify-center"},D0={class:"row justify-center q-py-md"},C0={key:0,class:"row justify-center q-pt-sm"},M0={key:1,class:"row justify-center"},S0={class:"q-mt-lg text-h6"},q0={class:"row q-mt-lg"};function T0(e,t,n,i,o,r){const a=J("NumericKeyboard"),s=J("ChooseMint"),l=J("vue-qrcode");return M(),W(ut,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[4]||(t[4]=h=>e.showInvoiceDetails=h),position:"top",maximized:e.$q.screen.lt.sm,"full-width":e.$q.screen.lt.sm,"full-height":e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":""},{default:m(()=>[u(ct,{class:"q-pa-lg q-px-sm qcard q-card-top"},{default:m(()=>[e.showNumericKeyboard&&e.useNumericKeyboard?(M(),W(a,{key:0,"model-value":e.invoiceData.amount,"onUpdate:modelValue":t[0]||(t[0]=h=>e.invoiceData.amount=h),onDone:e.requestMintButton},null,8,["model-value","onDone"])):z("",!0),e.invoiceData.bolt11?(M(),V("div",w0,[f("a",{class:"text-secondary",href:"lightning:"+e.invoiceData.bolt11},[u(ko,{ratio:1,class:"q-ma-none q-ma-none"},{default:m(()=>[u(l,{value:"lightning:"+e.invoiceData.bolt11.toUpperCase(),options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1})],8,_0),f("div",b0,[u(st,{class:"q-pa-sm"},{default:m(()=>[f("div",k0,[u(Ie,{overline:"",class:"q-mb-sm q-pt-md text-white",style:{"font-size":"1rem"}},{default:m(()=>[I(" Lightning invoice")]),_:1})]),f("div",D0,[u(Ie,{style:{"font-size":"28px"},class:"text-weight-bold"},{default:m(()=>[u(me,{name:e.invoiceData.amount>=0?"call_received":"call_made",color:e.invoiceData.status==="paid"?e.invoiceData.amount>=0?"green":"red":"",class:"q-mr-sm",size:"sm"},null,8,["name","color"]),f("strong",null,ae(e.displayUnit),1)]),_:1})]),this.invoiceData.mint!=null?(M(),V("div",C0,[u(cn,{outline:"",class:"q-pa-md",style:{height:"36px","font-family":"monospace"}},{default:m(()=>[u(me,{name:"account_balance",size:"xs",class:"q-mr-sm"}),I(" "+ae(e.shortUrl),1)]),_:1})])):z("",!0),e.invoiceData.amount>0&&e.invoiceData.status==="paid"?(M(),V("div",M0,[u(Je,{appear:"","enter-active-class":"animated tada"},{default:m(()=>[f("span",S0,[u(me,{name:"check_circle",size:"1.5rem",color:"positive",class:"q-mr-sm q-mb-xs"}),I("Paid! ")])]),_:1})])):z("",!0)]),_:1})]),f("div",q0,[e.invoiceData.bolt11?(M(),W(L,{key:0,class:"q-mx-xs",size:"md",flat:"",onClick:t[3]||(t[3]=h=>e.copyText(e.invoiceData.bolt11))},{default:m(()=>[I("Copy")]),_:1})):z("",!0),Fe((M(),W(L,{flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])])):(M(),V("div",m0,[g0,f("div",v0,[f("div",p0,[u(s)])]),u(lt,{round:"",outlined:"",type:"number",modelValue:e.invoiceData.amount,"onUpdate:modelValue":t[2]||(t[2]=h=>e.invoiceData.amount=h),modelModifiers:{number:!0},label:"Amount ("+e.tickerShort+") *",mask:"#","fill-mask":"0","reverse-fill-mask":"",autofocus:"",class:"q-mb-lg",onKeyup:Et(e.requestMintButton,["enter"])},{default:m(()=>[u(L,{flat:"",color:"primary",onClick:t[1]||(t[1]=h=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup"]),f("div",y0,[u(L,{color:"primary",rounded:"",onClick:e.requestMintButton,disable:!(e.invoiceData.amount>0)||e.createInvoiceButtonBlocked,label:e.createInvoiceButtonBlocked?"Creating invoice...":"Create Invoice",loading:e.globalMutexLock},{loading:m(()=>[u(Rt),I(" Creating ")]),_:1},8,["onClick","disable","label","loading"]),Fe((M(),W(L,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])]))]),_:1})]),_:1},8,["modelValue","maximized","full-width","full-height"])}var P0=Ee(f0,[["render",T0],["__scopeId","data-v-21d6c2b8"]]);const $0=Oe({name:"SendDialog",components:{XIcon:Li,CoinsIcon:ea,ZapIcon:na,ScanIcon:hn},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...de(De,["mints"]),...ve($e,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...ve(Xe,["invoiceHistory","invoiceData","payInvoiceData"]),...ve(et,["camera"]),...ve(ni,["showSendTokens","sendData","showLockInput"]),canMakePayments:function(){return!!this.mints.length}},methods:{...ce(et,["closeCamera","showCamera"]),showParseDialog:function(){if(!this.canMakePayments){co("No mints available"),this.showSendDialog=!1;return}this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.payInvoiceData.input.paymentChecker=null,this.camera.show=!1,this.showSendDialog=!1},showSendTokensDialog:function(){if(console.log("##### showSendTokensDialog"),!this.canMakePayments){co("No mints available"),this.showSendDialog=!1;return}this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.sendData.p2pkPubkey="",this.sendData.paymentRequest=void 0,this.showSendDialog=!1,this.showSendTokens=!0,this.showLockInput=!1}},created:function(){}}),jo=e=>(Ft("data-v-454d966a"),e=e(),zt(),e),x0=jo(()=>f("div",{class:"col text-center"},[f("span",{class:"text-h6"},"Send")],-1)),E0={class:"q-gutter-y-md"},A0={class:"row items-center full-width"},I0={class:"icon-background q-mr-md"},R0=jo(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"ECASH")],-1)),U0={class:"row items-center full-width"},N0={class:"icon-background q-mr-md"},O0=jo(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"LIGHTNING")],-1));function L0(e,t,n,i,o,r){const a=J("XIcon"),s=J("ScanIcon"),l=J("CoinsIcon"),h=J("ZapIcon");return M(),W(ut,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[0]||(t[0]=g=>e.showSendDialog=g),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:m(()=>[u(st,{class:"row items-center q-pb-sm"},{default:m(()=>[Fe((M(),W(L,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:m(()=>[u(a)]),_:1})),[[He]]),x0,u(L,{flat:"",round:"",dense:"",class:"q-mr-sm",onClick:e.showCamera,color:"primary"},{default:m(()=>[u(s)]),_:1},8,["onClick"])]),_:1}),u(st,{class:"q-pa-md"},{default:m(()=>[f("div",E0,[u(L,{class:"full-width custom-btn",onClick:e.showSendTokensDialog},{default:m(()=>[f("div",A0,[f("div",I0,[u(l)]),R0])]),_:1},8,["onClick"]),u(L,{class:"full-width custom-btn",onClick:e.showParseDialog},{default:m(()=>[f("div",U0,[f("div",N0,[u(h)]),O0])]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])}var B0=Ee($0,[["render",L0],["__scopeId","data-v-454d966a"]]);const V0=Oe({name:"PRDialog",mixins:[windowMixin],components:{VueQrcode:Co,ToggleUnit:So},data(){return{paymentRequestAmount:void 0,isEditingAmount:!1,amountInputValue:"",amountLabelDefault:"Add amount",amountLabel:"Add amount",defaultAnyMint:"Any Mint",chosenMintUrl:void 0,memo:""}},computed:{...de(It,["showPRKData"]),...de(De,["activeMintUrl","activeUnit","activeUnitCurrencyMultiplyer"]),...ve(It,["showPRDialog"])},methods:{...ce(It,["newPaymentRequest"]),toggleUnit(){this.paymentRequestAmount=void 0,this.amountLabel=this.amountLabelDefault,this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl)},newRequest(){this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl)},getShortUrl(e){return e?Lt(e):this.defaultAnyMint},setActiveMintUrl(){this.activeMintUrl!=this.chosenMintUrl&&(this.chosenMintUrl=this.activeMintUrl,this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl))},startEditingAmount(){this.isEditingAmount=!0,this.$nextTick(()=>{this.$refs.amountInput&&this.$refs.amountInput.focus()})},finishEditingAmount(){const e=parseFloat(this.amountInputValue);isNaN(e)||e<=0||this.amountInputValue==""?(this.paymentRequestAmount=void 0,this.amountLabel=this.amountLabelDefault):(this.paymentRequestAmount=e*this.activeUnitCurrencyMultiplyer,this.amountLabel=$e().formatCurrency(e*this.activeUnitCurrencyMultiplyer,this.activeUnit)),this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl),this.isEditingAmount=!1,this.amountInputValue=""}}}),F0={class:"text-center q-mb-md q-mt-none q-pt-none"},z0={class:"row justify-center"},j0={class:"row justify-center"},W0={class:"row justify-center q-pt-sm"},H0={class:"row justify-center"},K0={class:"row justify-center q-pt-sm"},Q0={class:"row justify-center"},X0={class:"row justify-center q-pt-sm"},G0={key:0},Y0={key:1},Z0={class:"row q-mt-lg"};function J0(e,t,n,i,o,r){const a=J("vue-qrcode"),s=J("ToggleUnit");return M(),W(ut,{modelValue:e.showPRDialog,"onUpdate:modelValue":t[3]||(t[3]=l=>e.showPRDialog=l),position:"top","backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[e.showPRKData?(M(),W(ct,{key:0,class:"q-px-lg q-pt-md q-pb-md qcard"},{default:m(()=>[f("div",F0,[u(ko,{ratio:1,class:"q-mx-md q-mt-none q-pt-none"},{default:m(()=>[u(a,{value:e.showPRKData,options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1}),f("div",z0,[u(st,{class:"q-pa-sm"},{default:m(()=>[f("div",j0,[u(Ie,{overline:"",class:"q-mb-sm q-pt-md text-white",style:{"font-size":"1rem"}},{default:m(()=>[I(" Payment Request")]),_:1})]),f("div",W0,[u(Ie,{caption:"",class:"text-weight-light text-white",style:{"font-size":"14px"}},{default:m(()=>[I("Receive payments via Nostr")]),_:1})])]),_:1})]),f("div",H0,[u(st,{class:"q-pa-sm"},{default:m(()=>[f("div",K0,[u(cn,{outline:"",clickable:"",class:"q-pa-md q-py-md",style:Ti(e.chosenMintUrl==null?"":"height: 36px; font-family: monospace"),onClick:e.setActiveMintUrl},{default:m(()=>[u(me,{name:"account_balance",size:"xs",class:"q-mr-sm"}),I(" "+ae(e.getShortUrl(e.chosenMintUrl)),1)]),_:1},8,["style","onClick"]),f("div",{onClick:t[0]||(t[0]=(...l)=>e.toggleUnit&&e.toggleUnit(...l)),class:"q-mt-xs q-ml-sm"},[u(s,{class:"q-py-none",color:"white"})])])]),_:1})]),f("div",Q0,[u(st,{class:"q-pa-sm"},{default:m(()=>[f("div",X0,[e.isEditingAmount?(M(),V("div",Y0,[u(lt,{ref:"amountInput",modelValue:e.amountInputValue,"onUpdate:modelValue":t[1]||(t[1]=l=>e.amountInputValue=l),type:"number",placeholder:"Enter amount",onBlur:e.finishEditingAmount,onKeyup:Et(e.finishEditingAmount,["enter"])},null,8,["modelValue","onBlur","onKeyup"])])):(M(),V("div",G0,[u(L,{color:"primary",rounded:"",onClick:e.startEditingAmount},{default:m(()=>[u(me,{name:"edit_note",size:"xs",class:"q-mr-sm"}),I(" "+ae(e.amountLabel),1)]),_:1},8,["onClick"])]))])]),_:1})]),u(L,{class:"q-mx-xs q-px-md q-mt-lg",size:"md",flat:"",rounded:"",dense:"",onClick:e.newRequest},{default:m(()=>[u(me,{name:"refresh",class:"q-pr-sm",size:"xs"}),I(" New request")]),_:1},8,["onClick"]),f("div",Z0,[u(L,{class:"q-mx-xs",size:"md",flat:"",onClick:t[2]||(t[2]=l=>e.copyText(e.showPRKData))},{default:m(()=>[I("Copy")]),_:1}),Fe((M(),W(L,{flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1})),[[He]])])])]),_:1})):z("",!0)]),_:1},8,["modelValue"])}var ey=Ee(V0,[["render",J0]]);const ty=Oe({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{P2PKDialog:ol,PRDialog:ey,ChevronLeftIcon:Lu,ClipboardIcon:Bu,FileTextIcon:zu,LockIcon:Wu,ScanIcon:hn,NfcIcon:qo},data:function(){return{showP2PKDialog:!1}},computed:{...ve(At,["showReceiveTokens","receiveData","scanningCard","watchClipboardPaste"]),...de($e,["tickerShort","ndefSupported"]),...de(De,["activeProofs","activeUnit","addMintBlocking"]),...de(An,["showNfcButtonInDrawer","autoPasteEcashReceive"]),...ve($e,["showReceiveEcashDrawer"]),...ve(De,["addMintData","showAddMintDialog"]),...ve(It,["showPRDialog"]),...de(et,["hasCamera"]),...de(Bt,["p2pkKeys","showP2PkButtonInDrawer"]),...de(It,["enablePaymentRequest"]),...ve($e,["showReceiveDialog"]),...de(et,["lastScannedResult"])},methods:{...ce(Xe,["redeem"]),...ce(et,["closeCamera","showCamera"]),...ce(Gt,["addPendingToken"]),...ce(Bt,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...ce(De,["addMint"]),...ce(At,["receiveIfDecodes","decodeToken","knowThisMintOfTokenJson","toggleScanner","pasteToParseDialog"]),...ve(At,["showReceiveTokens","receiveData"]),isiOsSafari(){const e=window.navigator.userAgent.toLowerCase(),t=/iphone|ipad|ipod/.test(e)&&/safari/.test(e);return console.log(`User agent: ${e}, is iOS Safari: ${t}`),t},handlePasteBtn:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveEcashDrawer=!1,this.autoPasteEcashReceive&&(this.watchClipboardPaste=!0)},handleLockBtn:function(){this.showP2PKDialog=!this.showP2PKDialog,(!this.p2pkKeys.length||!this.showP2PKDialog)&&this.generateKeypair(),this.showLastKey(),this.showReceiveEcashDrawer=!1},handlePaymentRequestBtn:function(){const e=It();this.showPRDialog=!this.showPRDialog,this.showPRDialog&&e.newPaymentRequest(),this.showReceiveEcashDrawer=!1},handleNFCBtn:function(){this.toggleScanner()},handleQrCodeDecode(e){console.log("QR code decoded:",e),this.closeCamera()},goBack:function(){this.showReceiveEcashDrawer=!1,this.showReceiveDialog=!0}}}),ui=e=>(Ft("data-v-4cfe33c2"),e=e(),zt(),e),ny=ui(()=>f("div",{class:"col text-center"},[f("span",{class:"text-h6"},"Receive Ecash")],-1)),iy={class:"q-gutter-y-md"},oy={class:"row items-center full-width"},ry={class:"icon-background q-mr-md"},ay=ui(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"PASTE")],-1)),sy={class:"row items-center full-width"},ly={class:"icon-background q-mr-md"},uy=ui(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"SCAN")],-1)),cy={class:"row items-center full-width"},dy={class:"icon-background q-mr-md"},fy=ui(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"REQUEST")],-1)),hy={class:"row items-center full-width"},my={class:"icon-background q-mr-md"},gy=ui(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"LOCK")],-1)),vy={class:"row items-center full-width"},py={class:"icon-background q-mr-md"},yy={class:"text-left"},wy={class:"text-weight-bold custom-btn-text"};function _y(e,t,n,i,o,r){const a=J("ChevronLeftIcon"),s=J("ScanIcon"),l=J("ClipboardIcon"),h=J("FileTextIcon"),g=J("LockIcon"),w=J("NfcIcon"),_=J("P2PKDialog"),C=J("PRDialog");return M(),V(at,null,[u(ut,{modelValue:e.showReceiveEcashDrawer,"onUpdate:modelValue":t[0]||(t[0]=E=>e.showReceiveEcashDrawer=E),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:m(()=>[u(st,{class:"row items-center q-pb-sm"},{default:m(()=>[u(L,{flat:"",round:"",dense:"",onClick:e.goBack,class:"q-ml-sm",color:"primary"},{default:m(()=>[u(a)]),_:1},8,["onClick"]),ny,u(L,{flat:"",round:"",dense:"",onClick:e.showCamera,class:"q-mr-sm",color:"primary"},{default:m(()=>[u(s)]),_:1},8,["onClick"])]),_:1}),u(st,{class:"q-pa-md"},{default:m(()=>[f("div",iy,[u(L,{class:"full-width custom-btn",onClick:e.handlePasteBtn},{default:m(()=>[f("div",oy,[f("div",ry,[u(l)]),ay])]),_:1},8,["onClick"]),u(L,{class:"full-width custom-btn",onClick:e.showCamera},{default:m(()=>[f("div",sy,[f("div",ly,[u(s)]),uy])]),_:1},8,["onClick"]),e.enablePaymentRequest?(M(),W(L,{key:0,class:"full-width custom-btn",onClick:e.handlePaymentRequestBtn},{default:m(()=>[f("div",cy,[f("div",dy,[u(h)]),fy])]),_:1},8,["onClick"])):z("",!0),e.showP2PkButtonInDrawer?(M(),W(L,{key:1,class:"full-width custom-btn",onClick:e.handleLockBtn},{default:m(()=>[f("div",hy,[f("div",my,[u(g)]),gy])]),_:1},8,["onClick"])):z("",!0),e.ndefSupported&&e.showNfcButtonInDrawer?(M(),W(L,{key:2,class:"full-width custom-btn",onClick:e.handleNFCBtn},{default:m(()=>[f("div",vy,[f("div",py,[e.scanningCard?(M(),W(Ui,{key:0,size:"sm"})):(M(),W(w,{key:1}))]),f("div",yy,[f("div",wy," NFC "+ae(e.scanningCard?"Scanning...":""),1)])])]),_:1},8,["onClick"])):z("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),u(_,{modelValue:e.showP2PKDialog,"onUpdate:modelValue":t[1]||(t[1]=E=>e.showP2PKDialog=E)},null,8,["modelValue"]),u(C,{modelValue:e.showPRDialog,"onUpdate:modelValue":t[2]||(t[2]=E=>e.showPRDialog=E)},null,8,["modelValue"])],64)}var by=Ee(ty,[["render",_y],["__scopeId","data-v-4cfe33c2"]]);const ky=Oe({name:"ReceiveDialog",components:{XIcon:Li,CoinsIcon:ea,ZapIcon:na,ScanIcon:hn,ReceiveEcashDrawer:by},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...ve($e,["showInvoiceDetails","showReceiveDialog","showReceiveEcashDrawer"]),...ve(At,["showReceiveTokens","receiveData"]),...ve(Xe,["invoiceData"]),...de(De,["mints"]),canReceivePayments:function(){return!!this.mints.length}},methods:{toggleReceiveEcashDrawer:function(){this.showReceiveDialog=!1,this.showReceiveTokens=!1,this.showReceiveEcashDrawer=!0},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveDialog=!1},showInvoiceCreateDialog:async function(){if(!this.canReceivePayments){co("You need to connect to a mint to receive via Lightning"),this.showReceiveDialog=!1;return}console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0,this.showReceiveDialog=!1},...ce(et,["closeCamera","showCamera"])},created:function(){}}),Wo=e=>(Ft("data-v-04dbee34"),e=e(),zt(),e),Dy=Wo(()=>f("div",{class:"col text-center"},[f("span",{class:"text-h6"},"Receive")],-1)),Cy={class:"q-gutter-y-md"},My={class:"row items-center full-width"},Sy={class:"icon-background q-mr-md"},qy=Wo(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"ECASH")],-1)),Ty={class:"row items-center full-width"},Py={class:"icon-background q-mr-md"},$y=Wo(()=>f("div",{class:"text-left"},[f("div",{class:"text-weight-bold custom-btn-text"},"LIGHTNING")],-1));function xy(e,t,n,i,o,r){const a=J("XIcon"),s=J("ScanIcon"),l=J("CoinsIcon"),h=J("ZapIcon"),g=J("ReceiveEcashDrawer");return M(),V(at,null,[u(ut,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=w=>e.showReceiveDialog=w),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(ct,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:m(()=>[u(st,{class:"row items-center q-pb-sm"},{default:m(()=>[Fe((M(),W(L,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:m(()=>[u(a)]),_:1})),[[He]]),Dy,u(L,{flat:"",round:"",dense:"",class:"q-mr-sm",onClick:e.showCamera,color:"primary"},{default:m(()=>[u(s)]),_:1},8,["onClick"])]),_:1}),u(st,{class:"q-pa-md"},{default:m(()=>[f("div",Cy,[u(L,{class:"full-width custom-btn",onClick:e.toggleReceiveEcashDrawer},{default:m(()=>[f("div",My,[f("div",Sy,[u(l)]),qy])]),_:1},8,["onClick"]),u(L,{class:"full-width custom-btn",onClick:e.showInvoiceCreateDialog},{default:m(()=>[f("div",Ty,[f("div",Py,[u(h)]),$y])]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),u(g)],64)}var Ey=Ee(ky,[["render",xy],["__scopeId","data-v-04dbee34"]]);class ke{constructor(t,n,i,o,r){this._legacyCanvasSize=ke.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),i&&typeof i=="object"?this._onDecode=n:(console.warn(i||o||r?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=n),n=typeof i=="object"?i:{},this._onDecodeError=n.onDecodeError||(typeof i=="function"?i:this._onDecodeError),this._calculateScanRegion=n.calculateScanRegion||(typeof o=="function"?o:this._calculateScanRegion),this._preferredCamera=n.preferredCamera||r||this._preferredCamera,this._legacyCanvasSize=typeof i=="number"?i:typeof o=="number"?o:this._legacyCanvasSize,this._maxScansPerSecond=n.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;let a=!1;if(t.hidden&&(t.hidden=!1,a=!0),document.body.contains(t)||(document.body.appendChild(t),a=!0),i=t.parentElement,n.highlightScanRegion||n.highlightCodeOutline){if(o=!!n.overlay,this.$overlay=n.overlay||document.createElement("div"),r=this.$overlay.style,r.position="absolute",r.display="none",r.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!o&&n.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}i.insertBefore(this.$overlay,this.$video.nextSibling)}n.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame(()=>{let s=window.getComputedStyle(t);s.display==="none"&&(t.style.setProperty("display","block","important"),a=!0),s.visibility!=="visible"&&(t.style.setProperty("visibility","visible","important"),a=!0),a&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=ke.createQrEngine()}static set WORKER_PATH(t){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await ke.listCameras(!1)).length}catch{return!1}}static async listCameras(t=!1){if(!navigator.mediaDevices)return[];let n=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(o=>o.kind==="videoinput"),i;try{t&&(await n()).every(o=>!o.label)&&(i=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await n()).map((o,r)=>({id:o.deviceId,label:o.label||(r===0?"Default Camera":`Camera ${r+1}`)}))}finally{i&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),ke._stopVideoStream(i))}}async hasFlash(){let t;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;t=this.$video.srcObject}else t=(await this._getCameraStream()).stream;return"torch"in t.getVideoTracks()[0].getSettings()}catch{return!1}finally{t&&t!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),ke._stopVideoStream(t))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(t){throw this._flashOn=!1,t}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),ke._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:t,facingMode:n}=await this._getCameraStream();!this._active||this._paused?ke._stopVideoStream(t):(this._setVideoMirror(n),this.$video.srcObject=t,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(t){if(!this._paused)throw this._active=!1,t}}stop(){this.pause(),this._active=!1}async pause(t=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let n=()=>{this.$video.srcObject instanceof MediaStream&&(ke._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return t?(n(),!0):(await new Promise(i=>setTimeout(i,300)),this._paused?(n(),!0):!1)}async setCamera(t){t!==this._preferredCamera&&(this._preferredCamera=t,await this._restartVideoStream())}static async scanImage(t,n,i,o,r=!1,a=!1){let s,l=!1;n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(s=n.scanRegion,i=n.qrEngine,o=n.canvas,r=n.disallowCanvasResizing||!1,a=n.alsoTryWithoutScanRegion||!1,l=!0):console.warn(n||i||o||r||a?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!i;try{let h,g;[i,h]=await Promise.all([i||ke.createQrEngine(),ke._loadImage(t)]),[o,g]=ke._drawToCanvas(h,s,o,r);let w;if(i instanceof Worker){let _=i;n||ke._postWorkerMessageSync(_,"inversionMode","both"),w=await new Promise((C,E)=>{let N,U,K,A=-1;U=X=>{X.data.id===A&&(_.removeEventListener("message",U),_.removeEventListener("error",K),clearTimeout(N),X.data.data!==null?C({data:X.data.data,cornerPoints:ke._convertPoints(X.data.cornerPoints,s)}):E(ke.NO_QR_CODE_FOUND))},K=X=>{_.removeEventListener("message",U),_.removeEventListener("error",K),clearTimeout(N),E("Scanner error: "+(X?X.message||X:"Unknown Error"))},_.addEventListener("message",U),_.addEventListener("error",K),N=setTimeout(()=>K("timeout"),1e4);let F=g.getImageData(0,0,o.width,o.height);A=ke._postWorkerMessageSync(_,"decode",F,[F.data.buffer])})}else w=await Promise.race([new Promise((_,C)=>window.setTimeout(()=>C("Scanner error: timeout"),1e4)),(async()=>{try{var[_]=await i.detect(o);if(!_)throw ke.NO_QR_CODE_FOUND;return{data:_.rawValue,cornerPoints:ke._convertPoints(_.cornerPoints,s)}}catch(C){if(_=C.message||C,/not implemented|service unavailable/.test(_))return ke._disableBarcodeDetector=!0,ke.scanImage(t,{scanRegion:s,canvas:o,disallowCanvasResizing:r,alsoTryWithoutScanRegion:a});throw`Scanner error: ${_}`}})()]);return l?w:w.data}catch(h){if(!s||!a)throw h;let g=await ke.scanImage(t,{qrEngine:i,canvas:o,disallowCanvasResizing:r});return l?g:g.data}finally{n||ke._postWorkerMessage(i,"close")}}setGrayscaleWeights(t,n,i,o=!0){ke._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:n,blue:i,useIntegerApproximation:o})}setInversionMode(t){ke._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}static async createQrEngine(t){if(t&&console.warn("Specifying a worker path is not required and not supported anymore."),t=()=>Ps(()=>import("./qr-scanner-worker.min.56d417f3.js"),[]).then(i=>i.createWorker()),!(!ke._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return t();let n=navigator.userAgentData;return n&&n.brands.some(({brand:i})=>/Chromium/i.test(i))&&/mac ?OS/i.test(n.platform)&&await n.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:i,platformVersion:o})=>/arm/i.test(i||"arm")&&13<=parseInt(o||"13")).catch(()=>!0)?t():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(t){let n=Math.round(.6666666666666666*Math.min(t.videoWidth,t.videoHeight));return{x:Math.round((t.videoWidth-n)/2),y:Math.round((t.videoHeight-n)/2),width:n,height:n,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var t=this.$video,n=t.videoWidth,i=t.videoHeight,o=t.offsetWidth,r=t.offsetHeight,a=t.offsetLeft,s=t.offsetTop,l=window.getComputedStyle(t),h=l.objectFit,g=n/i,w=o/r;switch(h){case"none":var _=n,C=i;break;case"fill":_=o,C=r;break;default:(h==="cover"?g>w:g<w)?(C=r,_=C*g):(_=o,C=_/g),h==="scale-down"&&(_=Math.min(_,n),C=Math.min(C,i))}var[E,N]=l.objectPosition.split(" ").map((K,A)=>{const F=parseFloat(K);return K.endsWith("%")?(A?r-C:o-_)*F/100:F});l=this._scanRegion.width||n,w=this._scanRegion.height||i,h=this._scanRegion.x||0;var U=this._scanRegion.y||0;g=this.$overlay.style,g.width=`${l/n*_}px`,g.height=`${w/i*C}px`,g.top=`${s+N+U/i*C}px`,i=/scaleX\(-1\)/.test(t.style.transform),g.left=`${a+(i?o-E-_:E)+(i?n-h-l:h)/n*_}px`,g.transform=t.style.transform}})}static _convertPoints(t,n){if(!n)return t;let i=n.x||0,o=n.y||0,r=n.width&&n.downScaledWidth?n.width/n.downScaledWidth:1;n=n.height&&n.downScaledHeight?n.height/n.downScaledHeight:1;for(let a of t)a.x=a.x*r+i,a.y=a.y*n+o;return t}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var t=Date.now()-this._lastScanTimestamp,n=1e3/this._maxScansPerSecond;t<n&&await new Promise(o=>setTimeout(o,n-t)),this._lastScanTimestamp=Date.now();try{var i=await ke.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(o){if(!this._active)return;this._onDecodeError(o)}!ke._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=ke.createQrEngine()),i?(this._onDecode?this._onDecode(i):this._legacyOnDecode&&this._legacyOnDecode(i.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",i.cornerPoints.map(({x:o,y:r})=>`${o},${r}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(t){t!==ke.NO_QR_CODE_FOUND&&console.log(t)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",n=[{width:{min:1024}},{width:{min:768}},{}],i=n.map(o=>Object.assign({},o,{[t]:{exact:this._preferredCamera}}));for(let o of[...i,...n])try{let r=await navigator.mediaDevices.getUserMedia({video:o,audio:!1}),a=this._getFacingMode(r)||(o.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:r,facingMode:a}}catch{}throw"Camera not found."}async _restartVideoStream(){let t=this._paused;await this.pause(!0)&&!t&&this._active&&await this.start()}static _stopVideoStream(t){for(let n of t.getTracks())n.stop(),t.removeTrack(n)}_setVideoMirror(t){this.$video.style.transform="scaleX("+(t==="user"?-1:1)+")"}_getFacingMode(t){return(t=t.getVideoTracks()[0])?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(t,n,i,o=!1){i=i||document.createElement("canvas");let r=n&&n.x?n.x:0,a=n&&n.y?n.y:0,s=n&&n.width?n.width:t.videoWidth||t.width,l=n&&n.height?n.height:t.videoHeight||t.height;return o||(o=n&&n.downScaledWidth?n.downScaledWidth:s,n=n&&n.downScaledHeight?n.downScaledHeight:l,i.width!==o&&(i.width=o),i.height!==n&&(i.height=n)),n=i.getContext("2d",{alpha:!1}),n.imageSmoothingEnabled=!1,n.drawImage(t,r,a,s,l,0,0,i.width,i.height),[i,n]}static async _loadImage(t){if(t instanceof Image)return await ke._awaitImageLoad(t),t;if(t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement||t instanceof SVGImageElement||"OffscreenCanvas"in window&&t instanceof OffscreenCanvas||"ImageBitmap"in window&&t instanceof ImageBitmap)return t;if(t instanceof File||t instanceof Blob||t instanceof URL||typeof t=="string"){let n=new Image;n.src=t instanceof File||t instanceof Blob?URL.createObjectURL(t):t.toString();try{return await ke._awaitImageLoad(n),n}finally{(t instanceof File||t instanceof Blob)&&URL.revokeObjectURL(n.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(t){t.complete&&t.naturalWidth!==0||await new Promise((n,i)=>{let o=r=>{t.removeEventListener("load",o),t.removeEventListener("error",o),r instanceof ErrorEvent?i("Image load error"):n()};t.addEventListener("load",o),t.addEventListener("error",o)})}static async _postWorkerMessage(t,n,i,o){return ke._postWorkerMessageSync(await t,n,i,o)}static _postWorkerMessageSync(t,n,i,o){if(!(t instanceof Worker))return-1;let r=ke._workerMessageId++;return t.postMessage({id:r,type:n,data:i},o),r}}ke.DEFAULT_CANVAS_SIZE=400;ke.NO_QR_CODE_FOUND="No QR code found";ke._disableBarcodeDetector=!1;ke._workerMessageId=0;const Ay={emits:["decode"],data(){return{qrScanner:null,urDecoder:null,urDecoderProgress:0}},mounted(){this.qrScanner=new ke(this.$refs.cameraEl,e=>{this.handleResult(e)},{returnDetailedScanResult:!0,highlightScanRegion:!0,highlightCodeOutline:!0,onDecodeError:()=>{}}),this.qrScanner.start(),this.urDecoder=new Yg},computed:{...de(et,["camera","hasCamera"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText}},methods:{...ce(et,["closeCamera","showCamera"]),handleResult(e){if(e.data.toLowerCase().startsWith("ur:")){if(this.urDecoder?.receivePart(e.data),this.urDecoderProgress=this.urDecoder?.estimatedPercentComplete()||0,this.urDecoder?.isComplete()&&this.urDecoder?.isSuccess()){const n=(this.urDecoder?.resultUR()).decodeCBOR();this.$emit("decode",n.toString()),this.qrScanner?.stop(),this.urDecoderProgress=0}}else this.$emit("decode",e.data),this.qrScanner?.stop()},pasteToParseDialog:async function(){const e=await $e().pasteFromClipboard();e&&this.$emit("decode",e)}},unmounted(){this.qrScanner?.destroy()}},Iy={class:"text-center"},Ry={ref:"cameraEl",style:{width:"100%"}},Uy={class:"row q-justify-center"},Ny={class:"absolute-full flex flex-center"},Oy={class:"row q-my-sm"};function Ly(e,t,n,i,o,r){return M(),W(ct,null,{default:m(()=>[f("div",Iy,[f("div",null,[f("video",Ry,null,512)]),f("div",null,[f("div",Uy,[o.urDecoderProgress>0?(M(),W(Cl,{key:0,rounded:"",size:"30px",value:o.urDecoderProgress,indeterminate:o.urDecoderProgress===0,class:"q-mt-none",color:"secondary"},{default:m(()=>[f("div",Ny,[u($t,{color:"white","text-color":"secondary",style:{"font-size":"1rem",padding:"5px"},class:"text-weight-bold",label:Math.round(o.urDecoderProgress*100)+"%"+(o.urDecoderProgress>.9?" - Keep scanning":"")},null,8,["label"])])]),_:1},8,["value","indeterminate"])):z("",!0)])])]),f("div",Oy,[r.canPasteFromClipboard?(M(),W(L,{key:0,unelevated:"",onClick:r.pasteToParseDialog},{default:m(()=>[u(me,{name:"content_paste",class:"q-mr-sm"}),I(" Paste")]),_:1},8,["onClick"])):z("",!0),u(L,{onClick:e.closeCamera,flat:"",color:"grey",class:"q-ml-auto"},{default:m(()=>[I("Close")]),_:1},8,["onClick"])])]),_:1})}var By=Ee(Ay,[["render",Ly]]);const Vy=Oe({name:"ActivityOrb",mixins:[windowMixin],components:{},props:{},data:function(){return{enableSpinner:!1}},mounted(){},computed:{...ve($e,["activityOrb"]),...de(Xe,["activeWebsocketConnections"]),...de(At,["scanningCard"])},watch:{activityOrb:function(){this.activityOrb?(this.enableSpinner=!0,setTimeout(()=>{this.activityOrb=!1,this.enableSpinner=!1},2e3)):this.enableSpinner=!1},scanningCard:function(){this.scanningCard?this.enableSpinner=!0:this.enableSpinner=!1}},methods:{}}),Fy={class:"row justify-center q-mb-none",style:{position:"absolute",top:"60px",left:"0",width:"100%"}};function zy(e,t,n,i,o,r){return M(),V("div",Fy,[f("div",null,[u(Je,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:m(()=>[e.enableSpinner?(M(),W(me,{key:0,name:"adjust",color:"primary",size:"1.5em"})):z("",!0)]),_:1})])])}var jy=Ee(Vy,[["render",zy],["__scopeId","data-v-096046ed"]]);const Wy=Oe({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{TokenInformation:da,NfcIcon:qo,ScanIcon:hn,ChooseMint:Bi},data:function(){return{showP2PKDialog:!1,swapSelected:!1}},watch:{watchClipboardPaste(e){e&&this.$nextTick(()=>{this.pasteToParseDialog(),this.watchClipboardPaste=!1})}},computed:{...ve(At,["showReceiveTokens","watchClipboardPaste","receiveData","scanningCard"]),...de($e,["tickerShort","ndefSupported"]),...de(Xn,["bitcoinPrice"]),...de(De,["activeMintUrl","activeProofs","activeUnit","addMintBlocking","mints"]),...de(An,["enableReceiveSwaps"]),...ve(De,["addMintData","showAddMintDialog"]),...ve(It,["showPRDialog"]),...de(et,["hasCamera"]),...de(Bt,["p2pkKeys"]),...de(It,["enablePaymentRequest"]),...de(Hn,["swapBlocking"]),...ve($e,["showReceiveDialog"]),...de(et,["lastScannedResult"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},tokenDecodesCorrectly:function(){return this.decodeToken(this.receiveData.tokensBase64)!==void 0?!0:this.decodePeanut(this.receiveData.tokensBase64)!==void 0},knowThisMint:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return e==null?!1:this.knowThisMintOfTokenJson(e)},tokenAmount:function(){if(!this.tokenDecodesCorrectly)return 0;const e=this.decodeToken(this.receiveData.tokensBase64);return this.getProofs(e).reduce((t,n)=>t+=n.amount,0)},tokenUnit:function(){if(!this.tokenDecodesCorrectly)return"";const e=this.decodeToken(this.receiveData.tokensBase64);return Se.getUnit(e)},tokenMint:function(){if(!this.tokenDecodesCorrectly)return"";const e=this.decodeToken(this.receiveData.tokensBase64);return this.getMint(e)},swapToMintAmount:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return this.tokenAmount-Hn().meltToMintFees(e)}},methods:{...ce(Xe,["redeem"]),...ce(et,["closeCamera","showCamera"]),...ce(Gt,["addPendingToken"]),...ce(Bt,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...ce(De,["addMint"]),...ce(At,["receiveIfDecodes","decodeToken","knowThisMintOfTokenJson","toggleScanner","pasteToParseDialog"]),decodePeanut:function(e){try{let t=[];const n=Array.from(e);if(!n.length)return;const i=function(o){const r=o.codePointAt(0);if(r>=65024&&r<=65039){const a=r-65024;return String.fromCharCode(a)}if(r>=917760&&r<=917999){const a=r-917760+16;return String.fromCharCode(a)}return null};for(const o of n){let r=i(o);if(r===null&&t.length>0)break;if(r===null)continue;t.push(r)}return t=t.join(""),t&&(this.receiveData.tokensBase64=t),this.decodeToken(t)}catch{return}},getProofs:function(e){return Se.getProofs(e)},getMint:function(e){return Se.getMint(e)},tokenAlreadyInHistory:function(e){return Gt().historyTokens.find(n=>n.token===e)!==void 0},addPendingTokenToHistory:function(e){if(this.tokenAlreadyInHistory(e)){this.notifySuccess("Ecash already in History"),this.showReceiveTokens=!1;return}const t=Gt(),n=this.decodeToken(e),i=this.getMint(n),o=Se.getUnit(n),r=this.getProofs(n).reduce((a,s)=>a+=s.amount,0);t.addPendingToken({amount:r,token:e,mintInToken:i,unitInToken:o}),this.showReceiveTokens=!1,this.notifySuccess("Ecash added to History")},handleSwapToTrustedMint:async function(){const e=De().activeMint().mint;await At().meltTokenToMint(this.receiveData.tokensBase64,e),this.swapSelected=!1}}}),Hy=e=>(Ft("data-v-3e2e4dd6"),e=e(),zt(),e),Ky={class:"row items-center no-wrap q-mb-sm q-mb-sm q-py-lg"},Qy={class:"col-9"},Xy={class:"text-h6"},Gy={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},Yy={class:"relative-container"},Zy={class:"row"},Jy={key:1},e1=Hy(()=>f("span",{class:"q-pl-sm"},"Scan",-1)),t1={key:2,class:"q-mr-xl"},n1={class:"row"},i1={key:0,class:"row q-pt-md"},o1={key:1,class:"row q-pl-md q-pt-sm"},r1={key:2,class:"row q-pt-xs"},a1={key:3,class:"row q-pt-sm"};function s1(e,t,n,i,o,r){const a=J("ScanIcon"),s=J("NfcIcon"),l=J("TokenInformation"),h=J("ChooseMint");return M(),W(ut,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[7]||(t[7]=g=>e.showReceiveTokens=g),position:"top",maximized:e.$q.screen.lt.sm,"transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":""},{default:m(()=>[u(ct,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[6]||(t[6]=g=>e.showReceiveTokens=g),class:"q-pa-lg qcard q-card-top"},{default:m(()=>[Fe((M(),W(L,{rounded:"",flat:"",color:"grey",class:"close-btn-position"},{default:m(()=>[I("Close")]),_:1})),[[He]]),f("div",null,[f("div",Ky,[f("div",Qy,[f("span",Xy,"Receive "+ae(e.tokenAmount&&e.tokenUnit?e.formatCurrency(e.tokenAmount,e.tokenUnit):"Ecash"),1),e.tokenAmount&&e.tokenUnit&&e.tokenUnit=="sat"&&e.bitcoinPrice?(M(),V("span",Gy," ("+ae(e.formatCurrency(e.bitcoinPrice/1e8*e.tokenAmount,"USD",!0))+") ",1)):z("",!0)])]),f("div",Yy,[u(lt,{round:"",outlined:"",spellcheck:"false",modelValue:e.receiveData.tokensBase64,"onUpdate:modelValue":t[1]||(t[1]=g=>e.receiveData.tokensBase64=g),label:"Paste Cashu token",type:"textarea",autofocus:"",class:"q-mb-lg cashub-nowrap",onKeyup:Et(e.receiveIfDecodes,["enter"])},{default:m(()=>[e.receiveData.tokensBase64?(M(),W(me,{key:0,color:"dark",name:"close",class:"floating-button cursor-pointer",onClick:t[0]||(t[0]=g=>e.receiveData.tokensBase64="")})):z("",!0)]),_:1},8,["modelValue","onKeyup"])])]),f("div",Zy,[e.receiveData.tokensBase64.length&&!e.tokenDecodesCorrectly?(M(),W(L,{key:0,disabled:"",color:"yellow","text-color":"black",rounded:"",unelevated:"",class:"q-ml-xs q-mr-sm",label:"Invalid token"})):z("",!0),e.receiveData.tokensBase64.length?z("",!0):(M(),V("div",Jy,[e.canPasteFromClipboard?(M(),W(L,{key:0,unelevated:"",dense:"",class:"q-mr-sm",onClick:t[2]||(t[2]=g=>e.pasteToParseDialog(!0))},{default:m(()=>[u(me,{name:"content_paste",class:"q-pr-sm"}),I("Paste")]),_:1})):z("",!0),e.hasCamera?(M(),W(L,{key:1,unelevated:"",dense:"",class:"q-mx-sm",onClick:e.showCamera},{default:m(()=>[u(a,{size:"1.5em"}),e1]),_:1},8,["onClick"])):z("",!0),e.ndefSupported?(M(),W(L,{key:2,unelevated:"",dense:"",class:"q-mx-sm",loading:e.scanningCard,disabled:e.scanningCard,onClick:e.toggleScanner},{loading:m(()=>[u(Ui,{onClick:e.toggleScanner},null,8,["onClick"])]),default:m(()=>[u(s,{class:"q-pr-xs"}),u(Ze,null,{default:m(()=>[I(ae(e.ndefSupported?"Read from NFC card":"NDEF unsupported"),1)]),_:1}),I(" NFC ")]),_:1},8,["loading","disabled","onClick"])):z("",!0)])),e.tokenDecodesCorrectly?(M(),V("div",t1,[f("div",n1,[u(l,{encodedToken:e.receiveData.tokensBase64,showAmount:!0,showMintCheck:!0,showP2PKCheck:!0},null,8,["encodedToken"])]),e.swapSelected?z("",!0):(M(),V("div",i1,[u(L,{onClick:e.receiveIfDecodes,color:"primary",rounded:"",class:"q-ml-xs q-mr-sm",disabled:e.addMintBlocking,loading:e.swapBlocking,label:e.knowThisMint&&e.addMintBlocking?"Adding mint ...":"Receive"},{loading:m(()=>[u(Rt)]),_:1},8,["onClick","disabled","loading","label"]),e.enableReceiveSwaps&&e.activeMintUrl&&e.mints.length?(M(),W(L,{key:0,onClick:t[3]||(t[3]=g=>e.swapSelected=!0),color:"primary",rounded:"",flat:"",class:"q-mr-none"},{default:m(()=>[u(me,{name:"swap_horiz",class:"q-pr-sm"}),I(" Swap "),u(Ze,null,{default:m(()=>[I("Swap to a trusted mint")]),_:1})]),_:1})):z("",!0),u(L,{onClick:t[4]||(t[4]=g=>e.addPendingTokenToHistory(e.receiveData.tokensBase64)),color:"primary",rounded:"",flat:"",class:"q-mr-none"},{default:m(()=>[I("Later "),u(Ze,null,{default:m(()=>[I("Add to history to receive later")]),_:1})]),_:1})])),e.swapSelected?(M(),V("div",o1,[f("div",null,[u(me,{name:"arrow_downward",class:"q-mr-xs",color:"positive"}),f("span",null,[I("Swap "),f("strong",null,ae(e.formatCurrency(e.swapToMintAmount,e.tokenUnit)),1)])])])):z("",!0),e.swapSelected?(M(),V("div",r1,[u(h,{rounded:!0,title:"",style:"font-family: monospace; font-size: 12px;"})])):z("",!0),e.swapSelected?(M(),V("div",a1,[u(L,{onClick:e.handleSwapToTrustedMint,color:"primary",rounded:"",class:"q-pr-md",loading:e.swapBlocking,disabled:e.activeMintUrl==e.tokenMint},{loading:m(()=>[u(Rt,{size:"xs"}),I(" Swap ")]),default:m(()=>[u(me,{name:"swap_horiz",class:"q-pr-sm"}),I(" Swap "),u(Ze,null,{default:m(()=>[I("Swap to a trusted mint")]),_:1})]),_:1},8,["onClick","loading","disabled"]),e.swapBlocking?z("",!0):(M(),W(L,{key:0,onClick:t[5]||(t[5]=g=>e.swapSelected=!1),color:"grey",rounded:"",flat:"",class:"q-mr-none q-pr-sm"},{default:m(()=>[u(me,{name:"close",class:"q-pr-sm"}),I(" Cancel "),u(Ze,null,{default:m(()=>[I("Cancel swap")]),_:1})]),_:1}))])):z("",!0)])):z("",!0)])]),_:1},8,["modelValue"])]),_:1},8,["modelValue","maximized"])}var l1=Ee(Wy,[["render",s1],["__scopeId","data-v-3e2e4dd6"]]);const u1=Vr("migrations",{state:()=>({currentVersion:Ml("cashu.migrations.version",0),migrations:[]}),actions:{registerMigration(e){this.migrations.some(t=>t.version===e.version)||(this.migrations.push(e),this.migrations.sort((t,n)=>t.version-n.version))},async runMigrations(){const e=this.migrations.filter(n=>n.version>this.currentVersion);if(e.length===0){console.log("No migrations to run");return}console.log(`Running ${e.length} migrations...`);const t=$e();await t.lockMutex();try{for(const n of e){console.log(`Running migration ${n.version}: ${n.name}`);try{await n.execute(),this.currentVersion=n.version,console.log(`Migration ${n.version} completed successfully`)}catch(i){console.error(`Migration ${n.version} failed:`,i);break}}}finally{await t.unlockMutex()}},async migrateStablenutsToCash(){const e=De();let t=!1;for(let n=0;n<e.mints.length;n++)e.mints[n].url==="https://stablenut.umint.cash"&&(console.log("Updating mint URL from stablenuts.cash to umint.cash"),e.mints[n].url="https://stablenut.cashu.network",e.activeMintUrl==="https://stablenut.umint.cash"&&(e.activeMintUrl="https://stablenut.cashu.network"),t=!0);console.log(t?"Successfully updated mint URL":"No stablenuts.cash mint found to update")},initMigrations(){this.registerMigration({version:1,name:"Migrate stablenuts.cash to umint.cash",description:"Updates mint URL from https://stablenut.umint.cash to https://stablenut.cashu.network",execute:async()=>await this.migrateStablenutsToCash()})}}});const c1={mixins:[windowMixin],components:{BalanceView:ru,MintSettings:Zd,InvoicesTable:gh,HistoryTable:Dh,NoMintWarnBanner:xh,WelcomeDialog:Bh,SendTokenDialog:Ep,ReceiveTokenDialog:l1,PayInvoiceDialog:d0,InvoiceDetailDialog:P0,QrcodeReader:By,SendDialog:B0,ReceiveDialog:Ey,iOSPWAPrompt:Qs,AndroidPWAPrompt:Xs,ScanIcon:hn,ActivityOrb:jy},data:function(){return{name:"",mintId:"",mintName:"",deferredPWAInstallPrompt:null,action:"main",parse:{show:!1,invoice:null,lnurlpay:null,lnurlauth:null,data:{request:"",amount:0,comment:""},paymentChecker:null,camera:{show:!1,camera:"auto"}},payments:[],paymentsChart:{show:!1},welcomeDialog:{show:!1},baseHost:location.protocol+"//"+location.host,baseURL:location.protocol+"//"+location.host+location.pathname,credit:0,newName:""}},computed:{...de($e,["tickerShort"]),...ve($e,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...ve($e,["expandHistory"]),...ve(At,["showReceiveTokens","receiveData"]),...ve(ni,["showSendTokens","sendData"]),...de(De,["activeMintUrl","activeProofs","keys","mints","activeMint"]),...ve(Xe,["invoiceHistory","invoiceData","payInvoiceData"]),...ve(De,["addMintData","showAddMintDialog"]),...ve(dn,["invoiceCheckListener","tokensCheckSpendableListener"]),...de(Gt,["historyTokens"]),...de(It,["enablePaymentRequest"]),...ve(et,["camera","hasCamera"]),...ve(Bt,["showP2PKDialog"]),...ve(ur,["showNWCDialog","nwcEnabled"]),pendingPaymentsExist:function(){return this.payments.findIndex(e=>e.pending)!==-1},balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)}},filters:{},methods:{...ce(Qr,["serializeProofs","getProofsMint","serializeProofsV2","sumProofs","deleteProofs"]),...ce(De,["activateMintUrl","addMint","assertMintError","getBalance","setActiveProofs","setProofs","getKeysForKeyset"]),...ce(dn,["clearAllWorkers","invoiceCheckWorker"]),...ce(Gt,["setTokenPaid"]),...ce(Xe,["setInvoicePaid","mint","checkPendingTokens","decodeRequest","initializeMnemonic"]),...ce(et,["closeCamera","showCamera"]),...ce(ur,["listenToNWCCommands"]),...ce(rl,["generateNPCConnection","claimAllTokens"]),...ce(uo,["sendNip04DirectMessage","sendNip17DirectMessage","subscribeToNip04DirectMessages","subscribeToNip17DirectMessages","sendNip17DirectMessageToNprofile","initSigner"]),...ce(gl,["migrateToDexie"]),...ce(Kr,["checkLocalStorage"]),...ce(It,["createPaymentRequest"]),...ce(vl,["startInvoiceCheckerWorker","checkPendingInvoices"]),decodeToken:function(e){try{return Se.decode(e)}catch{return null}},getProofs:function(e){return Se.getProofs(e)},getMint:function(e){return Se.getMint(e)},shortenString:function(e){return Mo(e,20,10)},getTokenList:function(){const e=this.activeProofs.map(n=>n.amount),t={};for(const n of e)t[n]=t[n]?t[n]+1:1;return Object.keys(t).map(n=>({value:parseInt(n),count:parseInt(t[n]),sum:n*t[n]}))},paymentTableRowKey:function(e){return e.payment_hash+e.amount},showChart:function(){this.paymentsChart.show=!0,this.$nextTick(()=>{generateChart(this.$refs.canvas,this.payments)})},focusInput(e){},showParseDialog:function(){this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.payInvoiceData.input.paymentChecker=null,this.camera.show=!1,this.focusInput("parseDialogInput")},showWelcomePage:function(){if(Yi().termsAccepted||(Yi().showWelcome=!0),Yi().showWelcome){const e=window.location.search,t=window.location.hash;this.$router.push("/welcome"+e+t)}},setTab:function(e){this.tab=e},decodeQR:function(e){this.camera.data=e,this.camera.show=!1,this.decodeRequest(e)},showInvoiceCreateDialog:async function(){console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0},showSendTokensDialog:function(){console.log("##### showSendTokensDialog"),this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.showSendTokens=!0},hideSendTokensDialog:function(){this.showSendTokens=!1},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0},registerPWAEventHook:function(){window.addEventListener("beforeinstallprompt",e=>{this.deferredPWAInstallPrompt=e,console.log("'beforeinstallprompt' event was fired.",this.getPwaDisplayMode())})},getPwaDisplayMode:function(){const e=window.matchMedia("(display-mode: standalone)").matches;return document.referrer.startsWith("android-app://")?"twa":navigator.standalone||e?"standalone":"browser"},triggerPwaInstall:function(){this.deferredPWAInstallPrompt.prompt(),this.deferredPWAInstallPrompt.userChoice.then(e=>{e.outcome==="accepted"?(console.log("User accepted the install prompt"),this.setWelcomeDialogSeen()):console.log("User dismissed the install prompt")})},registerBroadcastChannel:async function(){sessionStorage.getItem("tabId")||sessionStorage.setItem("tabId",Math.random().toString(36).substring(2)+new Date().getTime().toString(36));const e=sessionStorage.getItem("tabId"),t=new BroadcastChannel("app_channel");t.postMessage({type:"new_tab_opened",senderId:e}),t.onmessage=async n=>{n.data.senderId!==e&&(n.data.type=="new_tab_opened"?t.postMessage({type:"already_running",senderId:e}):n.data.type=="already_running"&&this.$router.push("/already-running"))}}},watch:{},mounted:function(){this.generateNPCConnection(),this.claimAllTokens()},created:async function(){const e=u1();e.initMigrations(),await e.runMigrations(),this.registerBroadcastChannel();let t=new URL(document.location).searchParams,n=new URL(document.location).hash;if(t.get("mint")){let r=t.get("mint");await this.setTab("mints"),this.showAddMintDialog=!0,this.addMintData={url:r}}if(localStorage.getItem("cashu.activeMintUrl")||this.setTab("mints"),console.log("Mint URL "+this.activeMintUrl),console.log("Wallet URL "+this.baseURL),t.get("token")||n.includes("token")){let r=t.get("token")||n.split("token=")[1],a=!1;for(var i=0;i<this.historyTokens.length;i++){var o=this.historyTokens[i].token;o==r&&this.historyTokens[i].amount>0&&(a=!0)}a||(this.receiveData.tokensBase64=r,this.showReceiveTokens=!0)}t.get("lightning")&&(this.showParseDialog(),this.payInvoiceData.input.request=t.get("lightning")),console.log(`hash: ${window.location.hash}`),$e().enableDebugConsole(),await this.migrateToDexie(),this.checkLocalStorage(),this.registerPWAEventHook(),this.initializeMnemonic(),this.initSigner(),this.showWelcomePage(),this.nwcEnabled&&this.listenToNWCCommands(),this.enablePaymentRequest&&this.subscribeToNip17DirectMessages(),this.startInvoiceCheckerWorker(),this.checkPendingInvoices()}},d1={class:"row q-col-gutter-y-md justify-center q-pt-sm q-pb-md"},f1={class:"col-12 col-sm-11 col-md-8 text-center q-gutter-y-md"},h1={class:"row items-center justify-center no-wrap q-mb-none q-mx-none q-px-none q-pt-lg q-pb-md"},m1={class:"col-5 q-mb-md"},g1={class:"col-2 q-mb-md q-mx-none"},v1={class:"col-5 q-mb-md"},p1={style:{"margin-bottom":"0rem"}},y1={class:"row q-pt-sm"},w1={class:"col-12 q-pt-xs"},_1=f("b",null,"Install",-1);function b1(e,t,n,i,o,r){const a=J("ActivityOrb"),s=J("NoMintWarnBanner"),l=J("BalanceView"),h=J("ScanIcon"),g=J("ReceiveDialog"),w=J("SendDialog"),_=J("HistoryTable"),C=J("InvoicesTable"),E=J("MintSettings"),N=J("iOSPWAPrompt"),U=J("AndroidPWAPrompt"),K=J("PayInvoiceDialog"),A=J("QrcodeReader"),F=J("WelcomeDialog"),X=J("InvoiceDetailDialog"),pe=J("SendTokenDialog"),se=J("ReceiveTokenDialog");return M(),V("div",d1,[f("div",f1,[u(a),e.mints.length==0?(M(),W(s,{key:0})):(M(),W(l,{key:1,"set-tab":r.setTab},null,8,["set-tab"])),f("div",h1,[f("div",m1,[u(L,{rounded:"",dense:"",class:"q-px-md",color:"primary",style:{width:"140px"},onClick:t[0]||(t[0]=j=>e.showReceiveDialog=!0),size:"1.2rem"},{default:m(()=>[u(me,{name:"south_west",size:"1.2rem",class:"q-mr-xs"}),I(" Receive")]),_:1})]),u(Je,{appear:"","enter-active-class":"animated pulse"},{default:m(()=>[f("div",g1,[u(L,{align:"center",size:"lg",outline:"",color:"primary",flat:"",onClick:e.showCamera},{default:m(()=>[u(h,{size:"2em"})]),_:1},8,["onClick"])])]),_:1}),f("div",v1,[u(L,{rounded:"",dense:"",class:"q-px-md",style:{width:"140px"},color:"primary",onClick:t[1]||(t[1]=j=>e.showSendDialog=!0),size:"1.2rem"},{default:m(()=>[u(me,{name:"north_east",size:"1.2rem",class:"q-mr-xs"}),I(" Send")]),_:1})]),u(g,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[2]||(t[2]=j=>e.showReceiveDialog=j)},null,8,["modelValue"]),u(w,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[3]||(t[3]=j=>e.showSendDialog=j)},null,8,["modelValue"])]),u(Wr,{"expand-icon-class":"hidden",modelValue:e.expandHistory,"onUpdate:modelValue":t[6]||(t[6]=j=>e.expandHistory=j)},{header:m(({expanded:j})=>[u(dt,{class:"item-center text-center"},{default:m(()=>[f("span",null,[u(me,{color:"primary",name:j?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])])]),_:2},1024)]),default:m(()=>[u(El,{modelValue:e.tab,"onUpdate:modelValue":t[4]||(t[4]=j=>e.tab=j),"no-caps":"",class:qi(e.$q.dark.isActive?"bg-dark":"bg-white")},{default:m(()=>[u(Zi,{name:"history",class:"text-secondary",label:"History"}),u(Zi,{name:"invoices",class:"text-secondary",label:"Invoices"}),u(Zi,{name:"mints",class:"text-secondary",label:"Mints"})]),_:1},8,["modelValue","class"]),u(Al,{class:qi(e.$q.dark.isActive?"bg-dark":"bg-white"),modelValue:e.tab,"onUpdate:modelValue":t[5]||(t[5]=j=>e.tab=j),animated:""},{default:m(()=>[u(Ji,{name:"history"},{default:m(()=>[u(_)]),_:1}),u(Ji,{name:"invoices"},{default:m(()=>[u(C)]),_:1}),u(Ji,{name:"mints",class:"q-px-sm"},{default:m(()=>[u(E)]),_:1})]),_:1},8,["class","modelValue"])]),_:1},8,["modelValue"]),f("div",p1,[f("div",y1,[f("div",w1,[r.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?(M(),W(L,{key:0,class:"q-mx-xs q-px-sm q-my-sm",outline:"",size:"0.6rem",color:"primary",onClick:t[7]||(t[7]=j=>r.triggerPwaInstall())},{default:m(()=>[_1,u(Ze,null,{default:m(()=>[I("Install Cashu")]),_:1})]),_:1})):z("",!0)])])]),u(N),u(U)]),u(K,{modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[8]||(t[8]=j=>e.payInvoiceData.show=j)},null,8,["modelValue"]),u(ut,{modelValue:e.camera.show,"onUpdate:modelValue":t[9]||(t[9]=j=>e.camera.show=j),"backdrop-filter":"blur(2px) brightness(60%)"},{default:m(()=>[u(A,{onDecode:r.decodeQR},null,8,["onDecode"])]),_:1},8,["modelValue"]),u(F,{"welcome-dialog":e.welcomeDialog,"trigger-pwa-install":r.triggerPwaInstall,"set-tab":r.setTab,"get-pwa-display-mode":r.getPwaDisplayMode,"set-welcome-dialog-seen":e.setWelcomeDialogSeen},null,8,["welcome-dialog","trigger-pwa-install","set-tab","get-pwa-display-mode","set-welcome-dialog-seen"]),u(X,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[10]||(t[10]=j=>e.showInvoiceDetails=j)},null,8,["modelValue"]),u(pe,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[11]||(t[11]=j=>e.showSendTokens=j)},null,8,["modelValue"]),u(se,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[12]||(t[12]=j=>e.showReceiveTokens=j)},null,8,["modelValue"])])}var z1=Ee(c1,[["render",b1]]);export{z1 as default};
