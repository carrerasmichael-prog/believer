import{c as u,Q as d,b as a}from"./QItem.18ca9374.js";import{j as S,au as b,aw as x,av as q,K as k,V as Q,L as i,W as m,a5 as l,Q as t,O as s,T as n,X as g,M as p,S as _,U as y,a0 as v,a1 as R,R as E}from"./index.916cb52e.js";import{Q as A}from"./QInput.265349d8.js";import{a as f,Q as B}from"./QList.1f08d45c.js";import{Q as F}from"./QSpinnerHourglass.12e6d1e7.js";import{Q as z}from"./QLinearProgress.00741bf9.js";import{Q as I}from"./private.use-form.be065f06.js";import{M as L,f as M,E as N,a as P,e as U,u as W}from"./ui.b6121134.js";import{u as w}from"./restore.025c481c.js";import"./index.42f06193.js";const j=S({name:"RestoreView",mixins:[windowMixin],data(){return{mnemonicError:"",restoreAllMintsText:"Restore All Mints"}},computed:{...b(P,["mints"]),...x(U,["mnemonic"]),...x(w,["mnemonicToRestore","restoreProgress"]),...b(w,["restoringState","restoringMint","restoreStatus"]),isMnemonicValid(){return this.mnemonicToRestore?this.mnemonicToRestore.trim().split(/\s+/).length>=12:!1}},methods:{...q(w,["restoreMint"]),...q(W,["pasteFromClipboard"]),mintClass(e){return new L(e)},validateMnemonic(){return this.mnemonicToRestore.trim().split(/\s+/).length<12?(this.mnemonicError="Mnemonic should be at least 12 words.",!1):(this.mnemonicError="",!0)},async restoreMintForMint(e){if(!!this.validateMnemonic())try{this.restoreAllMintsText="Restoring mint ...",await this.restoreMint(e)}catch(r){console.error("Error restoring mint:",r),M(`Error restoring mint: ${r.message||r}`)}finally{this.restoreAllMintsText="Restore All Mints"}},async pasteMnemonic(){try{const e=await this.pasteFromClipboard();this.mnemonicToRestore=e.trim()}catch{M("Failed to read clipboard contents.")}},async restoreAllMints(){let e=0;if(!!this.validateMnemonic())try{for(const r of this.mints)this.restoreAllMintsText=`Restoring mint ${++e} of ${this.mints.length} ...`,await this.restoreMint(r.url);N("Restore finished successfully")}catch(r){console.error("Error restoring mints:",r),M(`Error restoring mints: ${r.message||r}`)}finally{this.restoreAllMintsText="Restore All Mints"}}}}),D={style:{"max-width":"800px",margin:"0 auto"}},H={class:"q-px-xs text-left","on-left":""},K={class:"row q-pt-md"},O={class:"col-12"},X={class:"q-px-xs text-left","on-left":""},Y=l("i",null,"restore",-1),G={class:"q-px-xs text-left q-mt-md","on-left":""},J={class:"q-pb-md q-px-xs text-left","on-left":""};function Z(e,r,C,T,$,V){const h=Q("q-span");return i(),m("div",D,[l("div",H,[t(f,{padding:""},{default:s(()=>[t(u,null,{default:s(()=>[t(d,null,{default:s(()=>[t(a,{overline:"",class:"text-weight-bold"},{default:s(()=>[n(" Restore from Seed Phrase ")]),_:1}),t(a,{caption:""},{default:s(()=>[n(" Enter your seed phrase to restore your wallet. Before you restore, make sure you have added all the mints that you have used before. ")]),_:1}),l("div",K,[l("div",O,[t(A,{outlined:"",modelValue:e.mnemonicToRestore,"onUpdate:modelValue":r[0]||(r[0]=o=>e.mnemonicToRestore=o),label:"Seed phrase",autogrow:"",type:"textarea",error:e.mnemonicError!=="","error-message":e.mnemonicError},{append:s(()=>[t(g,{flat:"",dense:"",icon:"content_paste",onClick:e.pasteMnemonic,class:"cursor-pointer q-mt-md"},null,8,["onClick"])]),_:1},8,["modelValue","error","error-message"])])])]),_:1})]),_:1})]),_:1})]),l("div",X,[t(f,{padding:""},{default:s(()=>[t(u,null,{default:s(()=>[t(d,null,{default:s(()=>[t(a,{overline:"",class:"text-weight-bold"},{default:s(()=>[n(" Information ")]),_:1}),t(a,{caption:""},{default:s(()=>[n(" The wizard will only "),Y,n(" ecash from another seed phrase, you will not be able to use this seed phrase or change the seed phrase of the wallet that you're currently using. This means that restored ecash will not be protected by your current seed phrase as long as you don't send the ecash to yourself once. ")]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",G,[t(f,{padding:""},{default:s(()=>[t(u,null,{default:s(()=>[t(d,null,{default:s(()=>[t(a,{overline:"",class:"text-weight-bold"},{default:s(()=>[n(" Restore Mints ")]),_:1}),t(a,{caption:""},{default:s(()=>[n(' Select the mint to restore. You can add more mints in the main screen under "Mints" and restore them here. ')]),_:1})]),_:1})]),_:1})]),_:1})]),l("div",J,[t(g,{class:"q-ml-sm q-px-md",color:"primary",size:"md",rounded:"",dense:"",outline:"",onClick:e.restoreAllMints,disabled:!e.isMnemonicValid||e.restoringState},{default:s(()=>[e.restoringState?(i(),p(F,{key:0,size:"sm",class:"q-mr-sm"})):_("",!0),n(" "+y(e.restoreAllMintsText),1)]),_:1},8,["onClick","disabled"]),t(f,{padding:"",class:"q-pt-md"},{default:s(()=>[(i(!0),m(v,null,R(e.mints,o=>(i(),m("div",{key:o.url},[t(u,null,{default:s(()=>[t(d,null,{default:s(()=>[t(a,{class:"q-mb-xs",lines:"1",style:{"word-break":"break-all","overflow-wrap":"break-word","white-space":"normal"}},{default:s(()=>[t(E,{name:"account_balance",size:"xs",class:"q-ml-xs q-mb-xs"}),t(h,{class:"q-ma-xs",style:{"font-size":"15px"}},{default:s(()=>[n(y(o.nickname||o.url),1)]),_:2},1024)]),_:2},1024),t(a,null,{default:s(()=>[(i(!0),m(v,null,R(e.mintClass(o).units,c=>(i(),p(B,{key:c,color:"primary",label:e.formatCurrency(e.mintClass(o).unitBalance(c),c),class:"q-mx-xs q-mb-xs"},null,8,["label"]))),128))]),_:2},1024),e.restoringMint===o.url?(i(),p(a,{key:0,class:"q-px-xs q-pt-xs q-pb-xs",caption:""},{default:s(()=>[n(y(e.restoreStatus),1)]),_:1})):_("",!0),e.restoringMint===o.url?(i(),p(z,{key:1,value:e.restoreProgress,color:"primary",class:"q-pl-md",style:{"max-width":"630px"}},null,8,["value"])):_("",!0)]),_:2},1024),t(d,{side:""},{default:s(()=>[t(g,{class:"q-ml-sm q-px-md",color:"primary",size:"md",rounded:"",dense:"",outline:"",onClick:c=>e.restoreMintForMint(o.url),disabled:!e.isMnemonicValid||e.restoringState,loading:e.restoringMint===o.url},{default:s(()=>[n(" Restore ")]),_:2},1032,["onClick","disabled","loading"])]),_:2},1024)]),_:2},1024),t(I,{spaced:""})]))),128))]),_:1})])])}var ee=k(j,[["render",Z]]);const te=S({name:"ErrorNotFound",components:{RestoreView:ee}}),se={class:"bg-dark text-white text-center q-pa-md flex flex-center"};function re(e,r,C,T,$,V){const h=Q("RestoreView");return i(),m("div",se,[t(h)])}var fe=k(te,[["render",re]]);export{fe as default};
